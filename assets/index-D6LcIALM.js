(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))l(c);new MutationObserver(c=>{for(const m of c)if(m.type==="childList")for(const y of m.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&l(y)}).observe(document,{childList:!0,subtree:!0});function r(c){const m={};return c.integrity&&(m.integrity=c.integrity),c.referrerPolicy&&(m.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?m.credentials="include":c.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function l(c){if(c.ep)return;c.ep=!0;const m=r(c);fetch(c.href,m)}})();function getDefaultExportFromCjs(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReact_production_min;function requireReact_production_min(){if(hasRequiredReact_production_min)return react_production_min;hasRequiredReact_production_min=1;var t=Symbol.for("react.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),l=Symbol.for("react.strict_mode"),c=Symbol.for("react.profiler"),m=Symbol.for("react.provider"),y=Symbol.for("react.context"),_=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),k=Symbol.for("react.memo"),C=Symbol.for("react.lazy"),R=Symbol.iterator;function T(I){return I===null||typeof I!="object"?null:(I=R&&I[R]||I["@@iterator"],typeof I=="function"?I:null)}var A={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},M=Object.assign,B={};function j(I,G,Ee){this.props=I,this.context=G,this.refs=B,this.updater=Ee||A}j.prototype.isReactComponent={},j.prototype.setState=function(I,G){if(typeof I!="object"&&typeof I!="function"&&I!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,I,G,"setState")},j.prototype.forceUpdate=function(I){this.updater.enqueueForceUpdate(this,I,"forceUpdate")};function re(){}re.prototype=j.prototype;function de(I,G,Ee){this.props=I,this.context=G,this.refs=B,this.updater=Ee||A}var se=de.prototype=new re;se.constructor=de,M(se,j.prototype),se.isPureReactComponent=!0;var ye=Array.isArray,z=Object.prototype.hasOwnProperty,W={current:null},Q={key:!0,ref:!0,__self:!0,__source:!0};function te(I,G,Ee){var we,pe={},_e=null,Re=null;if(G!=null)for(we in G.ref!==void 0&&(Re=G.ref),G.key!==void 0&&(_e=""+G.key),G)z.call(G,we)&&!Q.hasOwnProperty(we)&&(pe[we]=G[we]);var Ie=arguments.length-2;if(Ie===1)pe.children=Ee;else if(1<Ie){for(var Me=Array(Ie),Ke=0;Ke<Ie;Ke++)Me[Ke]=arguments[Ke+2];pe.children=Me}if(I&&I.defaultProps)for(we in Ie=I.defaultProps,Ie)pe[we]===void 0&&(pe[we]=Ie[we]);return{$$typeof:t,type:I,key:_e,ref:Re,props:pe,_owner:W.current}}function le(I,G){return{$$typeof:t,type:I.type,key:G,ref:I.ref,props:I.props,_owner:I._owner}}function me(I){return typeof I=="object"&&I!==null&&I.$$typeof===t}function F(I){var G={"=":"=0",":":"=2"};return"$"+I.replace(/[=:]/g,function(Ee){return G[Ee]})}var K=/\/+/g;function D(I,G){return typeof I=="object"&&I!==null&&I.key!=null?F(""+I.key):G.toString(36)}function Y(I,G,Ee,we,pe){var _e=typeof I;(_e==="undefined"||_e==="boolean")&&(I=null);var Re=!1;if(I===null)Re=!0;else switch(_e){case"string":case"number":Re=!0;break;case"object":switch(I.$$typeof){case t:case e:Re=!0}}if(Re)return Re=I,pe=pe(Re),I=we===""?"."+D(Re,0):we,ye(pe)?(Ee="",I!=null&&(Ee=I.replace(K,"$&/")+"/"),Y(pe,G,Ee,"",function(Ke){return Ke})):pe!=null&&(me(pe)&&(pe=le(pe,Ee+(!pe.key||Re&&Re.key===pe.key?"":(""+pe.key).replace(K,"$&/")+"/")+I)),G.push(pe)),1;if(Re=0,we=we===""?".":we+":",ye(I))for(var Ie=0;Ie<I.length;Ie++){_e=I[Ie];var Me=we+D(_e,Ie);Re+=Y(_e,G,Ee,Me,pe)}else if(Me=T(I),typeof Me=="function")for(I=Me.call(I),Ie=0;!(_e=I.next()).done;)_e=_e.value,Me=we+D(_e,Ie++),Re+=Y(_e,G,Ee,Me,pe);else if(_e==="object")throw G=String(I),Error("Objects are not valid as a React child (found: "+(G==="[object Object]"?"object with keys {"+Object.keys(I).join(", ")+"}":G)+"). If you meant to render a collection of children, use an array instead.");return Re}function $(I,G,Ee){if(I==null)return I;var we=[],pe=0;return Y(I,we,"","",function(_e){return G.call(Ee,_e,pe++)}),we}function U(I){if(I._status===-1){var G=I._result;G=G(),G.then(function(Ee){(I._status===0||I._status===-1)&&(I._status=1,I._result=Ee)},function(Ee){(I._status===0||I._status===-1)&&(I._status=2,I._result=Ee)}),I._status===-1&&(I._status=0,I._result=G)}if(I._status===1)return I._result.default;throw I._result}var ne={current:null},V={transition:null},ae={ReactCurrentDispatcher:ne,ReactCurrentBatchConfig:V,ReactCurrentOwner:W};function q(){throw Error("act(...) is not supported in production builds of React.")}return react_production_min.Children={map:$,forEach:function(I,G,Ee){$(I,function(){G.apply(this,arguments)},Ee)},count:function(I){var G=0;return $(I,function(){G++}),G},toArray:function(I){return $(I,function(G){return G})||[]},only:function(I){if(!me(I))throw Error("React.Children.only expected to receive a single React element child.");return I}},react_production_min.Component=j,react_production_min.Fragment=r,react_production_min.Profiler=c,react_production_min.PureComponent=de,react_production_min.StrictMode=l,react_production_min.Suspense=w,react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ae,react_production_min.act=q,react_production_min.cloneElement=function(I,G,Ee){if(I==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+I+".");var we=M({},I.props),pe=I.key,_e=I.ref,Re=I._owner;if(G!=null){if(G.ref!==void 0&&(_e=G.ref,Re=W.current),G.key!==void 0&&(pe=""+G.key),I.type&&I.type.defaultProps)var Ie=I.type.defaultProps;for(Me in G)z.call(G,Me)&&!Q.hasOwnProperty(Me)&&(we[Me]=G[Me]===void 0&&Ie!==void 0?Ie[Me]:G[Me])}var Me=arguments.length-2;if(Me===1)we.children=Ee;else if(1<Me){Ie=Array(Me);for(var Ke=0;Ke<Me;Ke++)Ie[Ke]=arguments[Ke+2];we.children=Ie}return{$$typeof:t,type:I.type,key:pe,ref:_e,props:we,_owner:Re}},react_production_min.createContext=function(I){return I={$$typeof:y,_currentValue:I,_currentValue2:I,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},I.Provider={$$typeof:m,_context:I},I.Consumer=I},react_production_min.createElement=te,react_production_min.createFactory=function(I){var G=te.bind(null,I);return G.type=I,G},react_production_min.createRef=function(){return{current:null}},react_production_min.forwardRef=function(I){return{$$typeof:_,render:I}},react_production_min.isValidElement=me,react_production_min.lazy=function(I){return{$$typeof:C,_payload:{_status:-1,_result:I},_init:U}},react_production_min.memo=function(I,G){return{$$typeof:k,type:I,compare:G===void 0?null:G}},react_production_min.startTransition=function(I){var G=V.transition;V.transition={};try{I()}finally{V.transition=G}},react_production_min.unstable_act=q,react_production_min.useCallback=function(I,G){return ne.current.useCallback(I,G)},react_production_min.useContext=function(I){return ne.current.useContext(I)},react_production_min.useDebugValue=function(){},react_production_min.useDeferredValue=function(I){return ne.current.useDeferredValue(I)},react_production_min.useEffect=function(I,G){return ne.current.useEffect(I,G)},react_production_min.useId=function(){return ne.current.useId()},react_production_min.useImperativeHandle=function(I,G,Ee){return ne.current.useImperativeHandle(I,G,Ee)},react_production_min.useInsertionEffect=function(I,G){return ne.current.useInsertionEffect(I,G)},react_production_min.useLayoutEffect=function(I,G){return ne.current.useLayoutEffect(I,G)},react_production_min.useMemo=function(I,G){return ne.current.useMemo(I,G)},react_production_min.useReducer=function(I,G,Ee){return ne.current.useReducer(I,G,Ee)},react_production_min.useRef=function(I){return ne.current.useRef(I)},react_production_min.useState=function(I){return ne.current.useState(I)},react_production_min.useSyncExternalStore=function(I,G,Ee){return ne.current.useSyncExternalStore(I,G,Ee)},react_production_min.useTransition=function(){return ne.current.useTransition()},react_production_min.version="18.3.1",react_production_min}var hasRequiredReact;function requireReact(){return hasRequiredReact||(hasRequiredReact=1,react.exports=requireReact_production_min()),react.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactJsxRuntime_production_min;function requireReactJsxRuntime_production_min(){if(hasRequiredReactJsxRuntime_production_min)return reactJsxRuntime_production_min;hasRequiredReactJsxRuntime_production_min=1;var t=requireReact(),e=Symbol.for("react.element"),r=Symbol.for("react.fragment"),l=Object.prototype.hasOwnProperty,c=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,m={key:!0,ref:!0,__self:!0,__source:!0};function y(_,w,k){var C,R={},T=null,A=null;k!==void 0&&(T=""+k),w.key!==void 0&&(T=""+w.key),w.ref!==void 0&&(A=w.ref);for(C in w)l.call(w,C)&&!m.hasOwnProperty(C)&&(R[C]=w[C]);if(_&&_.defaultProps)for(C in w=_.defaultProps,w)R[C]===void 0&&(R[C]=w[C]);return{$$typeof:e,type:_,key:T,ref:A,props:R,_owner:c.current}}return reactJsxRuntime_production_min.Fragment=r,reactJsxRuntime_production_min.jsx=y,reactJsxRuntime_production_min.jsxs=y,reactJsxRuntime_production_min}var hasRequiredJsxRuntime;function requireJsxRuntime(){return hasRequiredJsxRuntime||(hasRequiredJsxRuntime=1,jsxRuntime.exports=requireReactJsxRuntime_production_min()),jsxRuntime.exports}var jsxRuntimeExports=requireJsxRuntime(),reactExports=requireReact();const React=getDefaultExportFromCjs(reactExports);var client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredScheduler_production_min;function requireScheduler_production_min(){return hasRequiredScheduler_production_min||(hasRequiredScheduler_production_min=1,(function(t){function e(V,ae){var q=V.length;V.push(ae);e:for(;0<q;){var I=q-1>>>1,G=V[I];if(0<c(G,ae))V[I]=ae,V[q]=G,q=I;else break e}}function r(V){return V.length===0?null:V[0]}function l(V){if(V.length===0)return null;var ae=V[0],q=V.pop();if(q!==ae){V[0]=q;e:for(var I=0,G=V.length,Ee=G>>>1;I<Ee;){var we=2*(I+1)-1,pe=V[we],_e=we+1,Re=V[_e];if(0>c(pe,q))_e<G&&0>c(Re,pe)?(V[I]=Re,V[_e]=q,I=_e):(V[I]=pe,V[we]=q,I=we);else if(_e<G&&0>c(Re,q))V[I]=Re,V[_e]=q,I=_e;else break e}}return ae}function c(V,ae){var q=V.sortIndex-ae.sortIndex;return q!==0?q:V.id-ae.id}if(typeof performance=="object"&&typeof performance.now=="function"){var m=performance;t.unstable_now=function(){return m.now()}}else{var y=Date,_=y.now();t.unstable_now=function(){return y.now()-_}}var w=[],k=[],C=1,R=null,T=3,A=!1,M=!1,B=!1,j=typeof setTimeout=="function"?setTimeout:null,re=typeof clearTimeout=="function"?clearTimeout:null,de=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function se(V){for(var ae=r(k);ae!==null;){if(ae.callback===null)l(k);else if(ae.startTime<=V)l(k),ae.sortIndex=ae.expirationTime,e(w,ae);else break;ae=r(k)}}function ye(V){if(B=!1,se(V),!M)if(r(w)!==null)M=!0,U(z);else{var ae=r(k);ae!==null&&ne(ye,ae.startTime-V)}}function z(V,ae){M=!1,B&&(B=!1,re(te),te=-1),A=!0;var q=T;try{for(se(ae),R=r(w);R!==null&&(!(R.expirationTime>ae)||V&&!F());){var I=R.callback;if(typeof I=="function"){R.callback=null,T=R.priorityLevel;var G=I(R.expirationTime<=ae);ae=t.unstable_now(),typeof G=="function"?R.callback=G:R===r(w)&&l(w),se(ae)}else l(w);R=r(w)}if(R!==null)var Ee=!0;else{var we=r(k);we!==null&&ne(ye,we.startTime-ae),Ee=!1}return Ee}finally{R=null,T=q,A=!1}}var W=!1,Q=null,te=-1,le=5,me=-1;function F(){return!(t.unstable_now()-me<le)}function K(){if(Q!==null){var V=t.unstable_now();me=V;var ae=!0;try{ae=Q(!0,V)}finally{ae?D():(W=!1,Q=null)}}else W=!1}var D;if(typeof de=="function")D=function(){de(K)};else if(typeof MessageChannel<"u"){var Y=new MessageChannel,$=Y.port2;Y.port1.onmessage=K,D=function(){$.postMessage(null)}}else D=function(){j(K,0)};function U(V){Q=V,W||(W=!0,D())}function ne(V,ae){te=j(function(){V(t.unstable_now())},ae)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(V){V.callback=null},t.unstable_continueExecution=function(){M||A||(M=!0,U(z))},t.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):le=0<V?Math.floor(1e3/V):5},t.unstable_getCurrentPriorityLevel=function(){return T},t.unstable_getFirstCallbackNode=function(){return r(w)},t.unstable_next=function(V){switch(T){case 1:case 2:case 3:var ae=3;break;default:ae=T}var q=T;T=ae;try{return V()}finally{T=q}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(V,ae){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var q=T;T=V;try{return ae()}finally{T=q}},t.unstable_scheduleCallback=function(V,ae,q){var I=t.unstable_now();switch(typeof q=="object"&&q!==null?(q=q.delay,q=typeof q=="number"&&0<q?I+q:I):q=I,V){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=q+G,V={id:C++,callback:ae,priorityLevel:V,startTime:q,expirationTime:G,sortIndex:-1},q>I?(V.sortIndex=q,e(k,V),r(w)===null&&V===r(k)&&(B?(re(te),te=-1):B=!0,ne(ye,q-I))):(V.sortIndex=G,e(w,V),M||A||(M=!0,U(z))),V},t.unstable_shouldYield=F,t.unstable_wrapCallback=function(V){var ae=T;return function(){var q=T;T=ae;try{return V.apply(this,arguments)}finally{T=q}}}})(scheduler_production_min)),scheduler_production_min}var hasRequiredScheduler;function requireScheduler(){return hasRequiredScheduler||(hasRequiredScheduler=1,scheduler.exports=requireScheduler_production_min()),scheduler.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactDom_production_min;function requireReactDom_production_min(){if(hasRequiredReactDom_production_min)return reactDom_production_min;hasRequiredReactDom_production_min=1;var t=requireReact(),e=requireScheduler();function r(n){for(var a="https://reactjs.org/docs/error-decoder.html?invariant="+n,p=1;p<arguments.length;p++)a+="&args[]="+encodeURIComponent(arguments[p]);return"Minified React error #"+n+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var l=new Set,c={};function m(n,a){y(n,a),y(n+"Capture",a)}function y(n,a){for(c[n]=a,n=0;n<a.length;n++)l.add(a[n])}var _=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),w=Object.prototype.hasOwnProperty,k=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,C={},R={};function T(n){return w.call(R,n)?!0:w.call(C,n)?!1:k.test(n)?R[n]=!0:(C[n]=!0,!1)}function A(n,a,p,v){if(p!==null&&p.type===0)return!1;switch(typeof a){case"function":case"symbol":return!0;case"boolean":return v?!1:p!==null?!p.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function M(n,a,p,v){if(a===null||typeof a>"u"||A(n,a,p,v))return!0;if(v)return!1;if(p!==null)switch(p.type){case 3:return!a;case 4:return a===!1;case 5:return isNaN(a);case 6:return isNaN(a)||1>a}return!1}function B(n,a,p,v,b,E,P){this.acceptsBooleans=a===2||a===3||a===4,this.attributeName=v,this.attributeNamespace=b,this.mustUseProperty=p,this.propertyName=n,this.type=a,this.sanitizeURL=E,this.removeEmptyString=P}var j={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){j[n]=new B(n,0,!1,n,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var a=n[0];j[a]=new B(a,1,!1,n[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(n){j[n]=new B(n,2,!1,n.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){j[n]=new B(n,2,!1,n,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){j[n]=new B(n,3,!1,n.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(n){j[n]=new B(n,3,!0,n,null,!1,!1)}),["capture","download"].forEach(function(n){j[n]=new B(n,4,!1,n,null,!1,!1)}),["cols","rows","size","span"].forEach(function(n){j[n]=new B(n,6,!1,n,null,!1,!1)}),["rowSpan","start"].forEach(function(n){j[n]=new B(n,5,!1,n.toLowerCase(),null,!1,!1)});var re=/[\-:]([a-z])/g;function de(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var a=n.replace(re,de);j[a]=new B(a,1,!1,n,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var a=n.replace(re,de);j[a]=new B(a,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(n){var a=n.replace(re,de);j[a]=new B(a,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(n){j[n]=new B(n,1,!1,n.toLowerCase(),null,!1,!1)}),j.xlinkHref=new B("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(n){j[n]=new B(n,1,!1,n.toLowerCase(),null,!0,!0)});function se(n,a,p,v){var b=j.hasOwnProperty(a)?j[a]:null;(b!==null?b.type!==0:v||!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(M(a,p,b,v)&&(p=null),v||b===null?T(a)&&(p===null?n.removeAttribute(a):n.setAttribute(a,""+p)):b.mustUseProperty?n[b.propertyName]=p===null?b.type===3?!1:"":p:(a=b.attributeName,v=b.attributeNamespace,p===null?n.removeAttribute(a):(b=b.type,p=b===3||b===4&&p===!0?"":""+p,v?n.setAttributeNS(v,a,p):n.setAttribute(a,p))))}var ye=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,z=Symbol.for("react.element"),W=Symbol.for("react.portal"),Q=Symbol.for("react.fragment"),te=Symbol.for("react.strict_mode"),le=Symbol.for("react.profiler"),me=Symbol.for("react.provider"),F=Symbol.for("react.context"),K=Symbol.for("react.forward_ref"),D=Symbol.for("react.suspense"),Y=Symbol.for("react.suspense_list"),$=Symbol.for("react.memo"),U=Symbol.for("react.lazy"),ne=Symbol.for("react.offscreen"),V=Symbol.iterator;function ae(n){return n===null||typeof n!="object"?null:(n=V&&n[V]||n["@@iterator"],typeof n=="function"?n:null)}var q=Object.assign,I;function G(n){if(I===void 0)try{throw Error()}catch(p){var a=p.stack.trim().match(/\n( *(at )?)/);I=a&&a[1]||""}return`
`+I+n}var Ee=!1;function we(n,a){if(!n||Ee)return"";Ee=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(a)if(a=function(){throw Error()},Object.defineProperty(a.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(a,[])}catch(he){var v=he}Reflect.construct(n,[],a)}else{try{a.call()}catch(he){v=he}n.call(a.prototype)}else{try{throw Error()}catch(he){v=he}n()}}catch(he){if(he&&v&&typeof he.stack=="string"){for(var b=he.stack.split(`
`),E=v.stack.split(`
`),P=b.length-1,O=E.length-1;1<=P&&0<=O&&b[P]!==E[O];)O--;for(;1<=P&&0<=O;P--,O--)if(b[P]!==E[O]){if(P!==1||O!==1)do if(P--,O--,0>O||b[P]!==E[O]){var Z=`
`+b[P].replace(" at new "," at ");return n.displayName&&Z.includes("<anonymous>")&&(Z=Z.replace("<anonymous>",n.displayName)),Z}while(1<=P&&0<=O);break}}}finally{Ee=!1,Error.prepareStackTrace=p}return(n=n?n.displayName||n.name:"")?G(n):""}function pe(n){switch(n.tag){case 5:return G(n.type);case 16:return G("Lazy");case 13:return G("Suspense");case 19:return G("SuspenseList");case 0:case 2:case 15:return n=we(n.type,!1),n;case 11:return n=we(n.type.render,!1),n;case 1:return n=we(n.type,!0),n;default:return""}}function _e(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Q:return"Fragment";case W:return"Portal";case le:return"Profiler";case te:return"StrictMode";case D:return"Suspense";case Y:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case F:return(n.displayName||"Context")+".Consumer";case me:return(n._context.displayName||"Context")+".Provider";case K:var a=n.render;return n=n.displayName,n||(n=a.displayName||a.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case $:return a=n.displayName||null,a!==null?a:_e(n.type)||"Memo";case U:a=n._payload,n=n._init;try{return _e(n(a))}catch{}}return null}function Re(n){var a=n.type;switch(n.tag){case 24:return"Cache";case 9:return(a.displayName||"Context")+".Consumer";case 10:return(a._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=a.render,n=n.displayName||n.name||"",a.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return a;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return _e(a);case 8:return a===te?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a}return null}function Ie(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Me(n){var a=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function Ke(n){var a=Me(n)?"checked":"value",p=Object.getOwnPropertyDescriptor(n.constructor.prototype,a),v=""+n[a];if(!n.hasOwnProperty(a)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var b=p.get,E=p.set;return Object.defineProperty(n,a,{configurable:!0,get:function(){return b.call(this)},set:function(P){v=""+P,E.call(this,P)}}),Object.defineProperty(n,a,{enumerable:p.enumerable}),{getValue:function(){return v},setValue:function(P){v=""+P},stopTracking:function(){n._valueTracker=null,delete n[a]}}}}function kt(n){n._valueTracker||(n._valueTracker=Ke(n))}function at(n){if(!n)return!1;var a=n._valueTracker;if(!a)return!0;var p=a.getValue(),v="";return n&&(v=Me(n)?n.checked?"true":"false":n.value),n=v,n!==p?(a.setValue(n),!0):!1}function vt(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function Cn(n,a){var p=a.checked;return q({},a,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:p??n._wrapperState.initialChecked})}function ur(n,a){var p=a.defaultValue==null?"":a.defaultValue,v=a.checked!=null?a.checked:a.defaultChecked;p=Ie(a.value!=null?a.value:p),n._wrapperState={initialChecked:v,initialValue:p,controlled:a.type==="checkbox"||a.type==="radio"?a.checked!=null:a.value!=null}}function cr(n,a){a=a.checked,a!=null&&se(n,"checked",a,!1)}function Wr(n,a){cr(n,a);var p=Ie(a.value),v=a.type;if(p!=null)v==="number"?(p===0&&n.value===""||n.value!=p)&&(n.value=""+p):n.value!==""+p&&(n.value=""+p);else if(v==="submit"||v==="reset"){n.removeAttribute("value");return}a.hasOwnProperty("value")?vs(n,a.type,p):a.hasOwnProperty("defaultValue")&&vs(n,a.type,Ie(a.defaultValue)),a.checked==null&&a.defaultChecked!=null&&(n.defaultChecked=!!a.defaultChecked)}function qr(n,a,p){if(a.hasOwnProperty("value")||a.hasOwnProperty("defaultValue")){var v=a.type;if(!(v!=="submit"&&v!=="reset"||a.value!==void 0&&a.value!==null))return;a=""+n._wrapperState.initialValue,p||a===n.value||(n.value=a),n.defaultValue=a}p=n.name,p!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,p!==""&&(n.name=p)}function vs(n,a,p){(a!=="number"||vt(n.ownerDocument)!==n)&&(p==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+p&&(n.defaultValue=""+p))}var hr=Array.isArray;function Rn(n,a,p,v){if(n=n.options,a){a={};for(var b=0;b<p.length;b++)a["$"+p[b]]=!0;for(p=0;p<n.length;p++)b=a.hasOwnProperty("$"+n[p].value),n[p].selected!==b&&(n[p].selected=b),b&&v&&(n[p].defaultSelected=!0)}else{for(p=""+Ie(p),a=null,b=0;b<n.length;b++){if(n[b].value===p){n[b].selected=!0,v&&(n[b].defaultSelected=!0);return}a!==null||n[b].disabled||(a=n[b])}a!==null&&(a.selected=!0)}}function Si(n,a){if(a.dangerouslySetInnerHTML!=null)throw Error(r(91));return q({},a,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function _s(n,a){var p=a.value;if(p==null){if(p=a.children,a=a.defaultValue,p!=null){if(a!=null)throw Error(r(92));if(hr(p)){if(1<p.length)throw Error(r(93));p=p[0]}a=p}a==null&&(a=""),p=a}n._wrapperState={initialValue:Ie(p)}}function go(n,a){var p=Ie(a.value),v=Ie(a.defaultValue);p!=null&&(p=""+p,p!==n.value&&(n.value=p),a.defaultValue==null&&n.defaultValue!==p&&(n.defaultValue=p)),v!=null&&(n.defaultValue=""+v)}function yo(n){var a=n.textContent;a===n._wrapperState.initialValue&&a!==""&&a!==null&&(n.value=a)}function Ci(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ri(n,a){return n==null||n==="http://www.w3.org/1999/xhtml"?Ci(a):n==="http://www.w3.org/2000/svg"&&a==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Gr,vo=(function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(a,p,v,b){MSApp.execUnsafeLocalFunction(function(){return n(a,p,v,b)})}:n})(function(n,a){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=a;else{for(Gr=Gr||document.createElement("div"),Gr.innerHTML="<svg>"+a.valueOf().toString()+"</svg>",a=Gr.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;a.firstChild;)n.appendChild(a.firstChild)}});function dr(n,a){if(a){var p=n.firstChild;if(p&&p===n.lastChild&&p.nodeType===3){p.nodeValue=a;return}}n.textContent=a}var fr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ja=["Webkit","ms","Moz","O"];Object.keys(fr).forEach(function(n){ja.forEach(function(a){a=a+n.charAt(0).toUpperCase()+n.substring(1),fr[a]=fr[n]})});function ws(n,a,p){return a==null||typeof a=="boolean"||a===""?"":p||typeof a!="number"||a===0||fr.hasOwnProperty(n)&&fr[n]?(""+a).trim():a+"px"}function Ti(n,a){n=n.style;for(var p in a)if(a.hasOwnProperty(p)){var v=p.indexOf("--")===0,b=ws(p,a[p],v);p==="float"&&(p="cssFloat"),v?n.setProperty(p,b):n[p]=b}}var _o=q({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function xs(n,a){if(a){if(_o[n]&&(a.children!=null||a.dangerouslySetInnerHTML!=null))throw Error(r(137,n));if(a.dangerouslySetInnerHTML!=null){if(a.children!=null)throw Error(r(60));if(typeof a.dangerouslySetInnerHTML!="object"||!("__html"in a.dangerouslySetInnerHTML))throw Error(r(61))}if(a.style!=null&&typeof a.style!="object")throw Error(r(62))}}function jn(n,a){if(n.indexOf("-")===-1)return typeof a.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var bs=null;function Es(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Pi=null,Un=null,Fn=null;function wo(n){if(n=er(n)){if(typeof Pi!="function")throw Error(r(280));var a=n.stateNode;a&&(a=ns(a),Pi(n.stateNode,n.type,a))}}function xo(n){Un?Fn?Fn.push(n):Fn=[n]:Un=n}function bo(){if(Un){var n=Un,a=Fn;if(Fn=Un=null,wo(n),a)for(n=0;n<a.length;n++)wo(a[n])}}function Eo(n,a){return n(a)}function ko(){}var ks=!1;function Li(n,a,p){if(ks)return n(a,p);ks=!0;try{return Eo(n,a,p)}finally{ks=!1,(Un!==null||Fn!==null)&&(ko(),bo())}}function Yr(n,a){var p=n.stateNode;if(p===null)return null;var v=ns(p);if(v===null)return null;p=v[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(v=!v.disabled)||(n=n.type,v=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!v;break e;default:n=!1}if(n)return null;if(p&&typeof p!="function")throw Error(r(231,a,typeof p));return p}var Ss=!1;if(_)try{var Jr={};Object.defineProperty(Jr,"passive",{get:function(){Ss=!0}}),window.addEventListener("test",Jr,Jr),window.removeEventListener("test",Jr,Jr)}catch{Ss=!1}function Ua(n,a,p,v,b,E,P,O,Z){var he=Array.prototype.slice.call(arguments,3);try{a.apply(p,he)}catch(be){this.onError(be)}}var St=!1,Ae=null,Xr=!1,Ni=null,So={onError:function(n){St=!0,Ae=n}};function Co(n,a,p,v,b,E,P,O,Z){St=!1,Ae=null,Ua.apply(So,arguments)}function Cs(n,a,p,v,b,E,P,O,Z){if(Co.apply(this,arguments),St){if(St){var he=Ae;St=!1,Ae=null}else throw Error(r(198));Xr||(Xr=!0,Ni=he)}}function Tn(n){var a=n,p=n;if(n.alternate)for(;a.return;)a=a.return;else{n=a;do a=n,(a.flags&4098)!==0&&(p=a.return),n=a.return;while(n)}return a.tag===3?p:null}function Hn(n){if(n.tag===13){var a=n.memoizedState;if(a===null&&(n=n.alternate,n!==null&&(a=n.memoizedState)),a!==null)return a.dehydrated}return null}function Rs(n){if(Tn(n)!==n)throw Error(r(188))}function Fa(n){var a=n.alternate;if(!a){if(a=Tn(n),a===null)throw Error(r(188));return a!==n?null:n}for(var p=n,v=a;;){var b=p.return;if(b===null)break;var E=b.alternate;if(E===null){if(v=b.return,v!==null){p=v;continue}break}if(b.child===E.child){for(E=b.child;E;){if(E===p)return Rs(b),n;if(E===v)return Rs(b),a;E=E.sibling}throw Error(r(188))}if(p.return!==v.return)p=b,v=E;else{for(var P=!1,O=b.child;O;){if(O===p){P=!0,p=b,v=E;break}if(O===v){P=!0,v=b,p=E;break}O=O.sibling}if(!P){for(O=E.child;O;){if(O===p){P=!0,p=E,v=b;break}if(O===v){P=!0,v=E,p=b;break}O=O.sibling}if(!P)throw Error(r(189))}}if(p.alternate!==v)throw Error(r(190))}if(p.tag!==3)throw Error(r(188));return p.stateNode.current===p?n:a}function Ro(n){return n=Fa(n),n!==null?To(n):null}function To(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var a=To(n);if(a!==null)return a;n=n.sibling}return null}var Po=e.unstable_scheduleCallback,Ts=e.unstable_cancelCallback,Ha=e.unstable_shouldYield,Ai=e.unstable_requestPaint,rt=e.unstable_now,Ka=e.unstable_getCurrentPriorityLevel,Ps=e.unstable_ImmediatePriority,Lo=e.unstable_UserBlockingPriority,Ii=e.unstable_NormalPriority,Ls=e.unstable_LowPriority,pr=e.unstable_IdlePriority,Qr=null,Vt=null;function ei(n){if(Vt&&typeof Vt.onCommitFiberRoot=="function")try{Vt.onCommitFiberRoot(Qr,n,void 0,(n.current.flags&128)===128)}catch{}}var Fe=Math.clz32?Math.clz32:mr,et=Math.log,Bi=Math.LN2;function mr(n){return n>>>=0,n===0?32:31-(et(n)/Bi|0)|0}var mn=64,gr=4194304;function Ue(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Xe(n,a){var p=n.pendingLanes;if(p===0)return 0;var v=0,b=n.suspendedLanes,E=n.pingedLanes,P=p&268435455;if(P!==0){var O=P&~b;O!==0?v=Ue(O):(E&=P,E!==0&&(v=Ue(E)))}else P=p&~b,P!==0?v=Ue(P):E!==0&&(v=Ue(E));if(v===0)return 0;if(a!==0&&a!==v&&(a&b)===0&&(b=v&-v,E=a&-a,b>=E||b===16&&(E&4194240)!==0))return a;if((v&4)!==0&&(v|=p&16),a=n.entangledLanes,a!==0)for(n=n.entanglements,a&=v;0<a;)p=31-Fe(a),b=1<<p,v|=n[p],a&=~b;return v}function Ns(n,a){switch(n){case 1:case 2:case 4:return a+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Mi(n,a){for(var p=n.suspendedLanes,v=n.pingedLanes,b=n.expirationTimes,E=n.pendingLanes;0<E;){var P=31-Fe(E),O=1<<P,Z=b[P];Z===-1?((O&p)===0||(O&v)!==0)&&(b[P]=Ns(O,a)):Z<=a&&(n.expiredLanes|=O),E&=~O}}function Ct(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function No(){var n=mn;return mn<<=1,(mn&4194240)===0&&(mn=64),n}function yr(n){for(var a=[],p=0;31>p;p++)a.push(n);return a}function Zt(n,a,p){n.pendingLanes|=a,a!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,a=31-Fe(a),n[a]=p}function lt(n,a){var p=n.pendingLanes&~a;n.pendingLanes=a,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=a,n.mutableReadLanes&=a,n.entangledLanes&=a,a=n.entanglements;var v=n.eventTimes;for(n=n.expirationTimes;0<p;){var b=31-Fe(p),E=1<<b;a[b]=0,v[b]=-1,n[b]=-1,p&=~E}}function gn(n,a){var p=n.entangledLanes|=a;for(n=n.entanglements;p;){var v=31-Fe(p),b=1<<v;b&a|n[v]&a&&(n[v]|=a),p&=~b}}var Ze=0;function vr(n){return n&=-n,1<n?4<n?(n&268435455)!==0?16:536870912:4:1}var $i,Kn,Di,Oi,ti,ni=!1,_r=[],Wt=null,yn=null,nn=null,ri=new Map,ze=new Map,pt=[],Ye="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function As(n,a){switch(n){case"focusin":case"focusout":Wt=null;break;case"dragenter":case"dragleave":yn=null;break;case"mouseover":case"mouseout":nn=null;break;case"pointerover":case"pointerout":ri.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":ze.delete(a.pointerId)}}function Vn(n,a,p,v,b,E){return n===null||n.nativeEvent!==E?(n={blockedOn:a,domEventName:p,eventSystemFlags:v,nativeEvent:E,targetContainers:[b]},a!==null&&(a=er(a),a!==null&&Kn(a)),n):(n.eventSystemFlags|=v,a=n.targetContainers,b!==null&&a.indexOf(b)===-1&&a.push(b),n)}function Is(n,a,p,v,b){switch(a){case"focusin":return Wt=Vn(Wt,n,a,p,v,b),!0;case"dragenter":return yn=Vn(yn,n,a,p,v,b),!0;case"mouseover":return nn=Vn(nn,n,a,p,v,b),!0;case"pointerover":var E=b.pointerId;return ri.set(E,Vn(ri.get(E)||null,n,a,p,v,b)),!0;case"gotpointercapture":return E=b.pointerId,ze.set(E,Vn(ze.get(E)||null,n,a,p,v,b)),!0}return!1}function zi(n){var a=Qn(n.target);if(a!==null){var p=Tn(a);if(p!==null){if(a=p.tag,a===13){if(a=Hn(p),a!==null){n.blockedOn=a,ti(n.priority,function(){Di(p)});return}}else if(a===3&&p.stateNode.current.memoizedState.isDehydrated){n.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}n.blockedOn=null}function rn(n){if(n.blockedOn!==null)return!1;for(var a=n.targetContainers;0<a.length;){var p=Fi(n.domEventName,n.eventSystemFlags,a[0],n.nativeEvent);if(p===null){p=n.nativeEvent;var v=new p.constructor(p.type,p);bs=v,p.target.dispatchEvent(v),bs=null}else return a=er(p),a!==null&&Kn(a),n.blockedOn=p,!1;a.shift()}return!0}function ji(n,a,p){rn(n)&&p.delete(a)}function ii(){ni=!1,Wt!==null&&rn(Wt)&&(Wt=null),yn!==null&&rn(yn)&&(yn=null),nn!==null&&rn(nn)&&(nn=null),ri.forEach(ji),ze.forEach(ji)}function it(n,a){n.blockedOn===a&&(n.blockedOn=null,ni||(ni=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,ii)))}function qt(n){function a(b){return it(b,n)}if(0<_r.length){it(_r[0],n);for(var p=1;p<_r.length;p++){var v=_r[p];v.blockedOn===n&&(v.blockedOn=null)}}for(Wt!==null&&it(Wt,n),yn!==null&&it(yn,n),nn!==null&&it(nn,n),ri.forEach(a),ze.forEach(a),p=0;p<pt.length;p++)v=pt[p],v.blockedOn===n&&(v.blockedOn=null);for(;0<pt.length&&(p=pt[0],p.blockedOn===null);)zi(p),p.blockedOn===null&&pt.shift()}var Zn=ye.ReactCurrentBatchConfig,si=!0;function Va(n,a,p,v){var b=Ze,E=Zn.transition;Zn.transition=null;try{Ze=1,oi(n,a,p,v)}finally{Ze=b,Zn.transition=E}}function Ao(n,a,p,v){var b=Ze,E=Zn.transition;Zn.transition=null;try{Ze=4,oi(n,a,p,v)}finally{Ze=b,Zn.transition=E}}function oi(n,a,p,v){if(si){var b=Fi(n,a,p,v);if(b===null)o(n,a,v,Ui,p),As(n,v);else if(Is(b,n,a,p,v))v.stopPropagation();else if(As(n,v),a&4&&-1<Ye.indexOf(n)){for(;b!==null;){var E=er(b);if(E!==null&&$i(E),E=Fi(n,a,p,v),E===null&&o(n,a,v,Ui,p),E===b)break;b=E}b!==null&&v.stopPropagation()}else o(n,a,v,null,p)}}var Ui=null;function Fi(n,a,p,v){if(Ui=null,n=Es(v),n=Qn(n),n!==null)if(a=Tn(n),a===null)n=null;else if(p=a.tag,p===13){if(n=Hn(a),n!==null)return n;n=null}else if(p===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;n=null}else a!==n&&(n=null);return Ui=n,null}function Ve(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ka()){case Ps:return 1;case Lo:return 4;case Ii:case Ls:return 16;case pr:return 536870912;default:return 16}default:return 16}}var Pn=null,It=null,Ln=null;function Bs(){if(Ln)return Ln;var n,a=It,p=a.length,v,b="value"in Pn?Pn.value:Pn.textContent,E=b.length;for(n=0;n<p&&a[n]===b[n];n++);var P=p-n;for(v=1;v<=P&&a[p-v]===b[E-v];v++);return Ln=b.slice(n,1<v?1-v:void 0)}function Hi(n){var a=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&a===13&&(n=13)):n=a,n===10&&(n=13),32<=n||n===13?n:0}function wr(){return!0}function Io(){return!1}function Rt(n){function a(p,v,b,E,P){this._reactName=p,this._targetInst=b,this.type=v,this.nativeEvent=E,this.target=P,this.currentTarget=null;for(var O in n)n.hasOwnProperty(O)&&(p=n[O],this[O]=p?p(E):E[O]);return this.isDefaultPrevented=(E.defaultPrevented!=null?E.defaultPrevented:E.returnValue===!1)?wr:Io,this.isPropagationStopped=Io,this}return q(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=wr)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=wr)},persist:function(){},isPersistent:wr}),a}var xr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ms=Rt(xr),Wn=q({},xr,{view:0,detail:0}),Za=Rt(Wn),Ot,$s,br,Gt=q({},Wn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Gn,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==br&&(br&&n.type==="mousemove"?(Ot=n.screenX-br.screenX,$s=n.screenY-br.screenY):$s=Ot=0,br=n),Ot)},movementY:function(n){return"movementY"in n?n.movementY:$s}}),Ds=Rt(Gt),Bo=q({},Gt,{dataTransfer:0}),Os=Rt(Bo),Wa=q({},Wn,{relatedTarget:0}),Ki=Rt(Wa),Mo=q({},xr,{animationName:0,elapsedTime:0,pseudoElement:0}),qa=Rt(Mo),Ga=q({},xr,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),zs=Rt(Ga),Ya=q({},xr,{data:0}),js=Rt(Ya),$o={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Vi={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},qn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ja(n){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(n):(n=qn[n])?!!a[n]:!1}function Gn(){return Ja}var zt=q({},Wn,{key:function(n){if(n.key){var a=$o[n.key]||n.key;if(a!=="Unidentified")return a}return n.type==="keypress"?(n=Hi(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Vi[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Gn,charCode:function(n){return n.type==="keypress"?Hi(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Hi(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Do=Rt(zt),Oo=q({},Gt,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),zo=Rt(Oo),Us=q({},Wn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Gn}),Fs=Rt(Us),Xa=q({},xr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Qa=Rt(Xa),jo=q({},Gt,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),el=Rt(jo),Yt=[9,13,27,32],Nn=_&&"CompositionEvent"in window,ai=null;_&&"documentMode"in document&&(ai=document.documentMode);var vn=_&&"TextEvent"in window&&!ai,Uo=_&&(!Nn||ai&&8<ai&&11>=ai),Yn=" ",Fo=!1;function Er(n,a){switch(n){case"keyup":return Yt.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Hs(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var _n=!1;function tl(n,a){switch(n){case"compositionend":return Hs(a);case"keypress":return a.which!==32?null:(Fo=!0,Yn);case"textInput":return n=a.data,n===Yn&&Fo?null:n;default:return null}}function An(n,a){if(_n)return n==="compositionend"||!Nn&&Er(n,a)?(n=Bs(),Ln=It=Pn=null,_n=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Uo&&a.locale!=="ko"?null:a.data;default:return null}}var Zi={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ho(n){var a=n&&n.nodeName&&n.nodeName.toLowerCase();return a==="input"?!!Zi[n.type]:a==="textarea"}function Wi(n,a,p,v){xo(v),a=g(a,"onChange"),0<a.length&&(p=new Ms("onChange","change",null,p,v),n.push({event:p,listeners:a}))}var li=null,Bt=null;function nl(n){Xs(n,0)}function wn(n){var a=tr(n);if(at(a))return n}function rl(n,a){if(n==="change")return a}var sn=!1;if(_){var kr;if(_){var qi="oninput"in document;if(!qi){var Gi=document.createElement("div");Gi.setAttribute("oninput","return;"),qi=typeof Gi.oninput=="function"}kr=qi}else kr=!1;sn=kr&&(!document.documentMode||9<document.documentMode)}function ui(){li&&(li.detachEvent("onpropertychange",Yi),Bt=li=null)}function Yi(n){if(n.propertyName==="value"&&wn(Bt)){var a=[];Wi(a,Bt,n,Es(n)),Li(nl,a)}}function Ji(n,a,p){n==="focusin"?(ui(),li=a,Bt=p,li.attachEvent("onpropertychange",Yi)):n==="focusout"&&ui()}function Sr(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return wn(Bt)}function Xi(n,a){if(n==="click")return wn(a)}function Ks(n,a){if(n==="input"||n==="change")return wn(a)}function Ko(n,a){return n===a&&(n!==0||1/n===1/a)||n!==n&&a!==a}var Jt=typeof Object.is=="function"?Object.is:Ko;function In(n,a){if(Jt(n,a))return!0;if(typeof n!="object"||n===null||typeof a!="object"||a===null)return!1;var p=Object.keys(n),v=Object.keys(a);if(p.length!==v.length)return!1;for(v=0;v<p.length;v++){var b=p[v];if(!w.call(a,b)||!Jt(n[b],a[b]))return!1}return!0}function Vo(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Vs(n,a){var p=Vo(n);n=0;for(var v;p;){if(p.nodeType===3){if(v=n+p.textContent.length,n<=a&&v>=a)return{node:p,offset:a-n};n=v}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=Vo(p)}}function Zo(n,a){return n&&a?n===a?!0:n&&n.nodeType===3?!1:a&&a.nodeType===3?Zo(n,a.parentNode):"contains"in n?n.contains(a):n.compareDocumentPosition?!!(n.compareDocumentPosition(a)&16):!1:!1}function Zs(){for(var n=window,a=vt();a instanceof n.HTMLIFrameElement;){try{var p=typeof a.contentWindow.location.href=="string"}catch{p=!1}if(p)n=a.contentWindow;else break;a=vt(n.document)}return a}function Ws(n){var a=n&&n.nodeName&&n.nodeName.toLowerCase();return a&&(a==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||a==="textarea"||n.contentEditable==="true")}function on(n){var a=Zs(),p=n.focusedElem,v=n.selectionRange;if(a!==p&&p&&p.ownerDocument&&Zo(p.ownerDocument.documentElement,p)){if(v!==null&&Ws(p)){if(a=v.start,n=v.end,n===void 0&&(n=a),"selectionStart"in p)p.selectionStart=a,p.selectionEnd=Math.min(n,p.value.length);else if(n=(a=p.ownerDocument||document)&&a.defaultView||window,n.getSelection){n=n.getSelection();var b=p.textContent.length,E=Math.min(v.start,b);v=v.end===void 0?E:Math.min(v.end,b),!n.extend&&E>v&&(b=v,v=E,E=b),b=Vs(p,E);var P=Vs(p,v);b&&P&&(n.rangeCount!==1||n.anchorNode!==b.node||n.anchorOffset!==b.offset||n.focusNode!==P.node||n.focusOffset!==P.offset)&&(a=a.createRange(),a.setStart(b.node,b.offset),n.removeAllRanges(),E>v?(n.addRange(a),n.extend(P.node,P.offset)):(a.setEnd(P.node,P.offset),n.addRange(a)))}}for(a=[],n=p;n=n.parentNode;)n.nodeType===1&&a.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof p.focus=="function"&&p.focus(),p=0;p<a.length;p++)n=a[p],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var Qi=_&&"documentMode"in document&&11>=document.documentMode,Cr=null,Rr=null,ci=null,es=!1;function Wo(n,a,p){var v=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;es||Cr==null||Cr!==vt(v)||(v=Cr,"selectionStart"in v&&Ws(v)?v={start:v.selectionStart,end:v.selectionEnd}:(v=(v.ownerDocument&&v.ownerDocument.defaultView||window).getSelection(),v={anchorNode:v.anchorNode,anchorOffset:v.anchorOffset,focusNode:v.focusNode,focusOffset:v.focusOffset}),ci&&In(ci,v)||(ci=v,v=g(Rr,"onSelect"),0<v.length&&(a=new Ms("onSelect","select",null,a,p),n.push({event:a,listeners:v}),a.target=Cr)))}function Bn(n,a){var p={};return p[n.toLowerCase()]=a.toLowerCase(),p["Webkit"+n]="webkit"+a,p["Moz"+n]="moz"+a,p}var Tr={animationend:Bn("Animation","AnimationEnd"),animationiteration:Bn("Animation","AnimationIteration"),animationstart:Bn("Animation","AnimationStart"),transitionend:Bn("Transition","TransitionEnd")},Mn={},qs={};_&&(qs=document.createElement("div").style,"AnimationEvent"in window||(delete Tr.animationend.animation,delete Tr.animationiteration.animation,delete Tr.animationstart.animation),"TransitionEvent"in window||delete Tr.transitionend.transition);function hi(n){if(Mn[n])return Mn[n];if(!Tr[n])return n;var a=Tr[n],p;for(p in a)if(a.hasOwnProperty(p)&&p in qs)return Mn[n]=a[p];return n}var qo=hi("animationend"),an=hi("animationiteration"),Gs=hi("animationstart"),Ys=hi("transitionend"),Pr=new Map,Go="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Xt(n,a){Pr.set(n,a),m(a,[n])}for(var Jn=0;Jn<Go.length;Jn++){var ts=Go[Jn],Yo=ts.toLowerCase(),il=ts[0].toUpperCase()+ts.slice(1);Xt(Yo,"on"+il)}Xt(qo,"onAnimationEnd"),Xt(an,"onAnimationIteration"),Xt(Gs,"onAnimationStart"),Xt("dblclick","onDoubleClick"),Xt("focusin","onFocus"),Xt("focusout","onBlur"),Xt(Ys,"onTransitionEnd"),y("onMouseEnter",["mouseout","mouseover"]),y("onMouseLeave",["mouseout","mouseover"]),y("onPointerEnter",["pointerout","pointerover"]),y("onPointerLeave",["pointerout","pointerover"]),m("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),m("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),m("onBeforeInput",["compositionend","keypress","textInput","paste"]),m("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),m("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),m("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Jo=new Set("cancel close invalid load scroll toggle".split(" ").concat(Lr));function Js(n,a,p){var v=n.type||"unknown-event";n.currentTarget=p,Cs(v,a,void 0,n),n.currentTarget=null}function Xs(n,a){a=(a&4)!==0;for(var p=0;p<n.length;p++){var v=n[p],b=v.event;v=v.listeners;e:{var E=void 0;if(a)for(var P=v.length-1;0<=P;P--){var O=v[P],Z=O.instance,he=O.currentTarget;if(O=O.listener,Z!==E&&b.isPropagationStopped())break e;Js(b,O,he),E=Z}else for(P=0;P<v.length;P++){if(O=v[P],Z=O.instance,he=O.currentTarget,O=O.listener,Z!==E&&b.isPropagationStopped())break e;Js(b,O,he),E=Z}}}if(Xr)throw n=Ni,Xr=!1,Ni=null,n}function Je(n,a){var p=a[Br];p===void 0&&(p=a[Br]=new Set);var v=n+"__bubble";p.has(v)||(Xo(a,n,2,!1),p.add(v))}function Qs(n,a,p){var v=0;a&&(v|=4),Xo(p,n,v,a)}var di="_reactListening"+Math.random().toString(36).slice(2);function Nr(n){if(!n[di]){n[di]=!0,l.forEach(function(p){p!=="selectionchange"&&(Jo.has(p)||Qs(p,!1,n),Qs(p,!0,n))});var a=n.nodeType===9?n:n.ownerDocument;a===null||a[di]||(a[di]=!0,Qs("selectionchange",!1,a))}}function Xo(n,a,p,v){switch(Ve(a)){case 1:var b=Va;break;case 4:b=Ao;break;default:b=oi}p=b.bind(null,a,p,n),b=void 0,!Ss||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(b=!0),v?b!==void 0?n.addEventListener(a,p,{capture:!0,passive:b}):n.addEventListener(a,p,!0):b!==void 0?n.addEventListener(a,p,{passive:b}):n.addEventListener(a,p,!1)}function o(n,a,p,v,b){var E=v;if((a&1)===0&&(a&2)===0&&v!==null)e:for(;;){if(v===null)return;var P=v.tag;if(P===3||P===4){var O=v.stateNode.containerInfo;if(O===b||O.nodeType===8&&O.parentNode===b)break;if(P===4)for(P=v.return;P!==null;){var Z=P.tag;if((Z===3||Z===4)&&(Z=P.stateNode.containerInfo,Z===b||Z.nodeType===8&&Z.parentNode===b))return;P=P.return}for(;O!==null;){if(P=Qn(O),P===null)return;if(Z=P.tag,Z===5||Z===6){v=E=P;continue e}O=O.parentNode}}v=v.return}Li(function(){var he=E,be=Es(p),ke=[];e:{var xe=Pr.get(n);if(xe!==void 0){var Te=Ms,Le=n;switch(n){case"keypress":if(Hi(p)===0)break e;case"keydown":case"keyup":Te=Do;break;case"focusin":Le="focus",Te=Ki;break;case"focusout":Le="blur",Te=Ki;break;case"beforeblur":case"afterblur":Te=Ki;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Te=Ds;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Te=Os;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Te=Fs;break;case qo:case an:case Gs:Te=qa;break;case Ys:Te=Qa;break;case"scroll":Te=Za;break;case"wheel":Te=el;break;case"copy":case"cut":case"paste":Te=zs;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Te=zo}var Ne=(a&4)!==0,ht=!Ne&&n==="scroll",oe=Ne?xe!==null?xe+"Capture":null:xe;Ne=[];for(var J=he,ue;J!==null;){ue=J;var Se=ue.stateNode;if(ue.tag===5&&Se!==null&&(ue=Se,oe!==null&&(Se=Yr(J,oe),Se!=null&&Ne.push(h(J,Se,ue)))),ht)break;J=J.return}0<Ne.length&&(xe=new Te(xe,Le,null,p,be),ke.push({event:xe,listeners:Ne}))}}if((a&7)===0){e:{if(xe=n==="mouseover"||n==="pointerover",Te=n==="mouseout"||n==="pointerout",xe&&p!==bs&&(Le=p.relatedTarget||p.fromElement)&&(Qn(Le)||Le[Ge]))break e;if((Te||xe)&&(xe=be.window===be?be:(xe=be.ownerDocument)?xe.defaultView||xe.parentWindow:window,Te?(Le=p.relatedTarget||p.toElement,Te=he,Le=Le?Qn(Le):null,Le!==null&&(ht=Tn(Le),Le!==ht||Le.tag!==5&&Le.tag!==6)&&(Le=null)):(Te=null,Le=he),Te!==Le)){if(Ne=Ds,Se="onMouseLeave",oe="onMouseEnter",J="mouse",(n==="pointerout"||n==="pointerover")&&(Ne=zo,Se="onPointerLeave",oe="onPointerEnter",J="pointer"),ht=Te==null?xe:tr(Te),ue=Le==null?xe:tr(Le),xe=new Ne(Se,J+"leave",Te,p,be),xe.target=ht,xe.relatedTarget=ue,Se=null,Qn(be)===he&&(Ne=new Ne(oe,J+"enter",Le,p,be),Ne.target=ue,Ne.relatedTarget=ht,Se=Ne),ht=Se,Te&&Le)t:{for(Ne=Te,oe=Le,J=0,ue=Ne;ue;ue=x(ue))J++;for(ue=0,Se=oe;Se;Se=x(Se))ue++;for(;0<J-ue;)Ne=x(Ne),J--;for(;0<ue-J;)oe=x(oe),ue--;for(;J--;){if(Ne===oe||oe!==null&&Ne===oe.alternate)break t;Ne=x(Ne),oe=x(oe)}Ne=null}else Ne=null;Te!==null&&S(ke,xe,Te,Ne,!1),Le!==null&&ht!==null&&S(ke,ht,Le,Ne,!0)}}e:{if(xe=he?tr(he):window,Te=xe.nodeName&&xe.nodeName.toLowerCase(),Te==="select"||Te==="input"&&xe.type==="file")var Be=rl;else if(Ho(xe))if(sn)Be=Ks;else{Be=Sr;var De=Ji}else(Te=xe.nodeName)&&Te.toLowerCase()==="input"&&(xe.type==="checkbox"||xe.type==="radio")&&(Be=Xi);if(Be&&(Be=Be(n,he))){Wi(ke,Be,p,be);break e}De&&De(n,xe,he),n==="focusout"&&(De=xe._wrapperState)&&De.controlled&&xe.type==="number"&&vs(xe,"number",xe.value)}switch(De=he?tr(he):window,n){case"focusin":(Ho(De)||De.contentEditable==="true")&&(Cr=De,Rr=he,ci=null);break;case"focusout":ci=Rr=Cr=null;break;case"mousedown":es=!0;break;case"contextmenu":case"mouseup":case"dragend":es=!1,Wo(ke,p,be);break;case"selectionchange":if(Qi)break;case"keydown":case"keyup":Wo(ke,p,be)}var Oe;if(Nn)e:{switch(n){case"compositionstart":var je="onCompositionStart";break e;case"compositionend":je="onCompositionEnd";break e;case"compositionupdate":je="onCompositionUpdate";break e}je=void 0}else _n?Er(n,p)&&(je="onCompositionEnd"):n==="keydown"&&p.keyCode===229&&(je="onCompositionStart");je&&(Uo&&p.locale!=="ko"&&(_n||je!=="onCompositionStart"?je==="onCompositionEnd"&&_n&&(Oe=Bs()):(Pn=be,It="value"in Pn?Pn.value:Pn.textContent,_n=!0)),De=g(he,je),0<De.length&&(je=new js(je,n,null,p,be),ke.push({event:je,listeners:De}),Oe?je.data=Oe:(Oe=Hs(p),Oe!==null&&(je.data=Oe)))),(Oe=vn?tl(n,p):An(n,p))&&(he=g(he,"onBeforeInput"),0<he.length&&(be=new js("onBeforeInput","beforeinput",null,p,be),ke.push({event:be,listeners:he}),be.data=Oe))}Xs(ke,a)})}function h(n,a,p){return{instance:n,listener:a,currentTarget:p}}function g(n,a){for(var p=a+"Capture",v=[];n!==null;){var b=n,E=b.stateNode;b.tag===5&&E!==null&&(b=E,E=Yr(n,p),E!=null&&v.unshift(h(n,E,b)),E=Yr(n,a),E!=null&&v.push(h(n,E,b))),n=n.return}return v}function x(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function S(n,a,p,v,b){for(var E=a._reactName,P=[];p!==null&&p!==v;){var O=p,Z=O.alternate,he=O.stateNode;if(Z!==null&&Z===v)break;O.tag===5&&he!==null&&(O=he,b?(Z=Yr(p,E),Z!=null&&P.unshift(h(p,Z,O))):b||(Z=Yr(p,E),Z!=null&&P.push(h(p,Z,O)))),p=p.return}P.length!==0&&n.push({event:a,listeners:P})}var N=/\r\n?/g,H=/\u0000|\uFFFD/g;function ie(n){return(typeof n=="string"?n:""+n).replace(N,`
`).replace(H,"")}function ce(n,a,p){if(a=ie(a),ie(n)!==a&&p)throw Error(r(425))}function ve(){}var Ce=null,$e=null;function He(n,a){return n==="textarea"||n==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var mt=typeof setTimeout=="function"?setTimeout:void 0,dt=typeof clearTimeout=="function"?clearTimeout:void 0,Mt=typeof Promise=="function"?Promise:void 0,Tt=typeof queueMicrotask=="function"?queueMicrotask:typeof Mt<"u"?function(n){return Mt.resolve(null).then(n).catch(Ar)}:mt;function Ar(n){setTimeout(function(){throw n})}function eo(n,a){var p=a,v=0;do{var b=p.nextSibling;if(n.removeChild(p),b&&b.nodeType===8)if(p=b.data,p==="/$"){if(v===0){n.removeChild(b),qt(a);return}v--}else p!=="$"&&p!=="$?"&&p!=="$!"||v++;p=b}while(p);qt(a)}function $n(n){for(;n!=null;n=n.nextSibling){var a=n.nodeType;if(a===1||a===3)break;if(a===8){if(a=n.data,a==="$"||a==="$!"||a==="$?")break;if(a==="/$")return null}}return n}function Qo(n){n=n.previousSibling;for(var a=0;n;){if(n.nodeType===8){var p=n.data;if(p==="$"||p==="$!"||p==="$?"){if(a===0)return n;a--}else p==="/$"&&a++}n=n.previousSibling}return null}var Xn=Math.random().toString(36).slice(2),ln="__reactFiber$"+Xn,Ir="__reactProps$"+Xn,Ge="__reactContainer$"+Xn,Br="__reactEvents$"+Xn,sl="__reactListeners$"+Xn,ol="__reactHandles$"+Xn;function Qn(n){var a=n[ln];if(a)return a;for(var p=n.parentNode;p;){if(a=p[Ge]||p[ln]){if(p=a.alternate,a.child!==null||p!==null&&p.child!==null)for(n=Qo(n);n!==null;){if(p=n[ln])return p;n=Qo(n)}return a}n=p,p=n.parentNode}return null}function er(n){return n=n[ln]||n[Ge],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function tr(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(r(33))}function ns(n){return n[Ir]||null}var al=[],rs=-1;function Mr(n){return{current:n}}function tt(n){0>rs||(n.current=al[rs],al[rs]=null,rs--)}function Qe(n,a){rs++,al[rs]=n.current,n.current=a}var $r={},Pt=Mr($r),jt=Mr(!1),fi=$r;function is(n,a){var p=n.type.contextTypes;if(!p)return $r;var v=n.stateNode;if(v&&v.__reactInternalMemoizedUnmaskedChildContext===a)return v.__reactInternalMemoizedMaskedChildContext;var b={},E;for(E in p)b[E]=a[E];return v&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=a,n.__reactInternalMemoizedMaskedChildContext=b),b}function Ut(n){return n=n.childContextTypes,n!=null}function ea(){tt(jt),tt(Pt)}function fu(n,a,p){if(Pt.current!==$r)throw Error(r(168));Qe(Pt,a),Qe(jt,p)}function pu(n,a,p){var v=n.stateNode;if(a=a.childContextTypes,typeof v.getChildContext!="function")return p;v=v.getChildContext();for(var b in v)if(!(b in a))throw Error(r(108,Re(n)||"Unknown",b));return q({},p,v)}function ta(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||$r,fi=Pt.current,Qe(Pt,n),Qe(jt,jt.current),!0}function mu(n,a,p){var v=n.stateNode;if(!v)throw Error(r(169));p?(n=pu(n,a,fi),v.__reactInternalMemoizedMergedChildContext=n,tt(jt),tt(Pt),Qe(Pt,n)):tt(jt),Qe(jt,p)}var nr=null,na=!1,ll=!1;function gu(n){nr===null?nr=[n]:nr.push(n)}function mh(n){na=!0,gu(n)}function Dr(){if(!ll&&nr!==null){ll=!0;var n=0,a=Ze;try{var p=nr;for(Ze=1;n<p.length;n++){var v=p[n];do v=v(!0);while(v!==null)}nr=null,na=!1}catch(b){throw nr!==null&&(nr=nr.slice(n+1)),Po(Ps,Dr),b}finally{Ze=a,ll=!1}}return null}var ss=[],os=0,ra=null,ia=0,un=[],cn=0,pi=null,rr=1,ir="";function mi(n,a){ss[os++]=ia,ss[os++]=ra,ra=n,ia=a}function yu(n,a,p){un[cn++]=rr,un[cn++]=ir,un[cn++]=pi,pi=n;var v=rr;n=ir;var b=32-Fe(v)-1;v&=~(1<<b),p+=1;var E=32-Fe(a)+b;if(30<E){var P=b-b%5;E=(v&(1<<P)-1).toString(32),v>>=P,b-=P,rr=1<<32-Fe(a)+b|p<<b|v,ir=E+n}else rr=1<<E|p<<b|v,ir=n}function ul(n){n.return!==null&&(mi(n,1),yu(n,1,0))}function cl(n){for(;n===ra;)ra=ss[--os],ss[os]=null,ia=ss[--os],ss[os]=null;for(;n===pi;)pi=un[--cn],un[cn]=null,ir=un[--cn],un[cn]=null,rr=un[--cn],un[cn]=null}var Qt=null,en=null,nt=!1,xn=null;function vu(n,a){var p=pn(5,null,null,0);p.elementType="DELETED",p.stateNode=a,p.return=n,a=n.deletions,a===null?(n.deletions=[p],n.flags|=16):a.push(p)}function _u(n,a){switch(n.tag){case 5:var p=n.type;return a=a.nodeType!==1||p.toLowerCase()!==a.nodeName.toLowerCase()?null:a,a!==null?(n.stateNode=a,Qt=n,en=$n(a.firstChild),!0):!1;case 6:return a=n.pendingProps===""||a.nodeType!==3?null:a,a!==null?(n.stateNode=a,Qt=n,en=null,!0):!1;case 13:return a=a.nodeType!==8?null:a,a!==null?(p=pi!==null?{id:rr,overflow:ir}:null,n.memoizedState={dehydrated:a,treeContext:p,retryLane:1073741824},p=pn(18,null,null,0),p.stateNode=a,p.return=n,n.child=p,Qt=n,en=null,!0):!1;default:return!1}}function hl(n){return(n.mode&1)!==0&&(n.flags&128)===0}function dl(n){if(nt){var a=en;if(a){var p=a;if(!_u(n,a)){if(hl(n))throw Error(r(418));a=$n(p.nextSibling);var v=Qt;a&&_u(n,a)?vu(v,p):(n.flags=n.flags&-4097|2,nt=!1,Qt=n)}}else{if(hl(n))throw Error(r(418));n.flags=n.flags&-4097|2,nt=!1,Qt=n}}}function wu(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Qt=n}function sa(n){if(n!==Qt)return!1;if(!nt)return wu(n),nt=!0,!1;var a;if((a=n.tag!==3)&&!(a=n.tag!==5)&&(a=n.type,a=a!=="head"&&a!=="body"&&!He(n.type,n.memoizedProps)),a&&(a=en)){if(hl(n))throw xu(),Error(r(418));for(;a;)vu(n,a),a=$n(a.nextSibling)}if(wu(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(r(317));e:{for(n=n.nextSibling,a=0;n;){if(n.nodeType===8){var p=n.data;if(p==="/$"){if(a===0){en=$n(n.nextSibling);break e}a--}else p!=="$"&&p!=="$!"&&p!=="$?"||a++}n=n.nextSibling}en=null}}else en=Qt?$n(n.stateNode.nextSibling):null;return!0}function xu(){for(var n=en;n;)n=$n(n.nextSibling)}function as(){en=Qt=null,nt=!1}function fl(n){xn===null?xn=[n]:xn.push(n)}var gh=ye.ReactCurrentBatchConfig;function to(n,a,p){if(n=p.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(p._owner){if(p=p._owner,p){if(p.tag!==1)throw Error(r(309));var v=p.stateNode}if(!v)throw Error(r(147,n));var b=v,E=""+n;return a!==null&&a.ref!==null&&typeof a.ref=="function"&&a.ref._stringRef===E?a.ref:(a=function(P){var O=b.refs;P===null?delete O[E]:O[E]=P},a._stringRef=E,a)}if(typeof n!="string")throw Error(r(284));if(!p._owner)throw Error(r(290,n))}return n}function oa(n,a){throw n=Object.prototype.toString.call(a),Error(r(31,n==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":n))}function bu(n){var a=n._init;return a(n._payload)}function Eu(n){function a(oe,J){if(n){var ue=oe.deletions;ue===null?(oe.deletions=[J],oe.flags|=16):ue.push(J)}}function p(oe,J){if(!n)return null;for(;J!==null;)a(oe,J),J=J.sibling;return null}function v(oe,J){for(oe=new Map;J!==null;)J.key!==null?oe.set(J.key,J):oe.set(J.index,J),J=J.sibling;return oe}function b(oe,J){return oe=Vr(oe,J),oe.index=0,oe.sibling=null,oe}function E(oe,J,ue){return oe.index=ue,n?(ue=oe.alternate,ue!==null?(ue=ue.index,ue<J?(oe.flags|=2,J):ue):(oe.flags|=2,J)):(oe.flags|=1048576,J)}function P(oe){return n&&oe.alternate===null&&(oe.flags|=2),oe}function O(oe,J,ue,Se){return J===null||J.tag!==6?(J=iu(ue,oe.mode,Se),J.return=oe,J):(J=b(J,ue),J.return=oe,J)}function Z(oe,J,ue,Se){var Be=ue.type;return Be===Q?be(oe,J,ue.props.children,Se,ue.key):J!==null&&(J.elementType===Be||typeof Be=="object"&&Be!==null&&Be.$$typeof===U&&bu(Be)===J.type)?(Se=b(J,ue.props),Se.ref=to(oe,J,ue),Se.return=oe,Se):(Se=Na(ue.type,ue.key,ue.props,null,oe.mode,Se),Se.ref=to(oe,J,ue),Se.return=oe,Se)}function he(oe,J,ue,Se){return J===null||J.tag!==4||J.stateNode.containerInfo!==ue.containerInfo||J.stateNode.implementation!==ue.implementation?(J=su(ue,oe.mode,Se),J.return=oe,J):(J=b(J,ue.children||[]),J.return=oe,J)}function be(oe,J,ue,Se,Be){return J===null||J.tag!==7?(J=Ei(ue,oe.mode,Se,Be),J.return=oe,J):(J=b(J,ue),J.return=oe,J)}function ke(oe,J,ue){if(typeof J=="string"&&J!==""||typeof J=="number")return J=iu(""+J,oe.mode,ue),J.return=oe,J;if(typeof J=="object"&&J!==null){switch(J.$$typeof){case z:return ue=Na(J.type,J.key,J.props,null,oe.mode,ue),ue.ref=to(oe,null,J),ue.return=oe,ue;case W:return J=su(J,oe.mode,ue),J.return=oe,J;case U:var Se=J._init;return ke(oe,Se(J._payload),ue)}if(hr(J)||ae(J))return J=Ei(J,oe.mode,ue,null),J.return=oe,J;oa(oe,J)}return null}function xe(oe,J,ue,Se){var Be=J!==null?J.key:null;if(typeof ue=="string"&&ue!==""||typeof ue=="number")return Be!==null?null:O(oe,J,""+ue,Se);if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case z:return ue.key===Be?Z(oe,J,ue,Se):null;case W:return ue.key===Be?he(oe,J,ue,Se):null;case U:return Be=ue._init,xe(oe,J,Be(ue._payload),Se)}if(hr(ue)||ae(ue))return Be!==null?null:be(oe,J,ue,Se,null);oa(oe,ue)}return null}function Te(oe,J,ue,Se,Be){if(typeof Se=="string"&&Se!==""||typeof Se=="number")return oe=oe.get(ue)||null,O(J,oe,""+Se,Be);if(typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case z:return oe=oe.get(Se.key===null?ue:Se.key)||null,Z(J,oe,Se,Be);case W:return oe=oe.get(Se.key===null?ue:Se.key)||null,he(J,oe,Se,Be);case U:var De=Se._init;return Te(oe,J,ue,De(Se._payload),Be)}if(hr(Se)||ae(Se))return oe=oe.get(ue)||null,be(J,oe,Se,Be,null);oa(J,Se)}return null}function Le(oe,J,ue,Se){for(var Be=null,De=null,Oe=J,je=J=0,xt=null;Oe!==null&&je<ue.length;je++){Oe.index>je?(xt=Oe,Oe=null):xt=Oe.sibling;var qe=xe(oe,Oe,ue[je],Se);if(qe===null){Oe===null&&(Oe=xt);break}n&&Oe&&qe.alternate===null&&a(oe,Oe),J=E(qe,J,je),De===null?Be=qe:De.sibling=qe,De=qe,Oe=xt}if(je===ue.length)return p(oe,Oe),nt&&mi(oe,je),Be;if(Oe===null){for(;je<ue.length;je++)Oe=ke(oe,ue[je],Se),Oe!==null&&(J=E(Oe,J,je),De===null?Be=Oe:De.sibling=Oe,De=Oe);return nt&&mi(oe,je),Be}for(Oe=v(oe,Oe);je<ue.length;je++)xt=Te(Oe,oe,je,ue[je],Se),xt!==null&&(n&&xt.alternate!==null&&Oe.delete(xt.key===null?je:xt.key),J=E(xt,J,je),De===null?Be=xt:De.sibling=xt,De=xt);return n&&Oe.forEach(function(Zr){return a(oe,Zr)}),nt&&mi(oe,je),Be}function Ne(oe,J,ue,Se){var Be=ae(ue);if(typeof Be!="function")throw Error(r(150));if(ue=Be.call(ue),ue==null)throw Error(r(151));for(var De=Be=null,Oe=J,je=J=0,xt=null,qe=ue.next();Oe!==null&&!qe.done;je++,qe=ue.next()){Oe.index>je?(xt=Oe,Oe=null):xt=Oe.sibling;var Zr=xe(oe,Oe,qe.value,Se);if(Zr===null){Oe===null&&(Oe=xt);break}n&&Oe&&Zr.alternate===null&&a(oe,Oe),J=E(Zr,J,je),De===null?Be=Zr:De.sibling=Zr,De=Zr,Oe=xt}if(qe.done)return p(oe,Oe),nt&&mi(oe,je),Be;if(Oe===null){for(;!qe.done;je++,qe=ue.next())qe=ke(oe,qe.value,Se),qe!==null&&(J=E(qe,J,je),De===null?Be=qe:De.sibling=qe,De=qe);return nt&&mi(oe,je),Be}for(Oe=v(oe,Oe);!qe.done;je++,qe=ue.next())qe=Te(Oe,oe,je,qe.value,Se),qe!==null&&(n&&qe.alternate!==null&&Oe.delete(qe.key===null?je:qe.key),J=E(qe,J,je),De===null?Be=qe:De.sibling=qe,De=qe);return n&&Oe.forEach(function(Gh){return a(oe,Gh)}),nt&&mi(oe,je),Be}function ht(oe,J,ue,Se){if(typeof ue=="object"&&ue!==null&&ue.type===Q&&ue.key===null&&(ue=ue.props.children),typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case z:e:{for(var Be=ue.key,De=J;De!==null;){if(De.key===Be){if(Be=ue.type,Be===Q){if(De.tag===7){p(oe,De.sibling),J=b(De,ue.props.children),J.return=oe,oe=J;break e}}else if(De.elementType===Be||typeof Be=="object"&&Be!==null&&Be.$$typeof===U&&bu(Be)===De.type){p(oe,De.sibling),J=b(De,ue.props),J.ref=to(oe,De,ue),J.return=oe,oe=J;break e}p(oe,De);break}else a(oe,De);De=De.sibling}ue.type===Q?(J=Ei(ue.props.children,oe.mode,Se,ue.key),J.return=oe,oe=J):(Se=Na(ue.type,ue.key,ue.props,null,oe.mode,Se),Se.ref=to(oe,J,ue),Se.return=oe,oe=Se)}return P(oe);case W:e:{for(De=ue.key;J!==null;){if(J.key===De)if(J.tag===4&&J.stateNode.containerInfo===ue.containerInfo&&J.stateNode.implementation===ue.implementation){p(oe,J.sibling),J=b(J,ue.children||[]),J.return=oe,oe=J;break e}else{p(oe,J);break}else a(oe,J);J=J.sibling}J=su(ue,oe.mode,Se),J.return=oe,oe=J}return P(oe);case U:return De=ue._init,ht(oe,J,De(ue._payload),Se)}if(hr(ue))return Le(oe,J,ue,Se);if(ae(ue))return Ne(oe,J,ue,Se);oa(oe,ue)}return typeof ue=="string"&&ue!==""||typeof ue=="number"?(ue=""+ue,J!==null&&J.tag===6?(p(oe,J.sibling),J=b(J,ue),J.return=oe,oe=J):(p(oe,J),J=iu(ue,oe.mode,Se),J.return=oe,oe=J),P(oe)):p(oe,J)}return ht}var ls=Eu(!0),ku=Eu(!1),aa=Mr(null),la=null,us=null,pl=null;function ml(){pl=us=la=null}function gl(n){var a=aa.current;tt(aa),n._currentValue=a}function yl(n,a,p){for(;n!==null;){var v=n.alternate;if((n.childLanes&a)!==a?(n.childLanes|=a,v!==null&&(v.childLanes|=a)):v!==null&&(v.childLanes&a)!==a&&(v.childLanes|=a),n===p)break;n=n.return}}function cs(n,a){la=n,pl=us=null,n=n.dependencies,n!==null&&n.firstContext!==null&&((n.lanes&a)!==0&&(Ft=!0),n.firstContext=null)}function hn(n){var a=n._currentValue;if(pl!==n)if(n={context:n,memoizedValue:a,next:null},us===null){if(la===null)throw Error(r(308));us=n,la.dependencies={lanes:0,firstContext:n}}else us=us.next=n;return a}var gi=null;function vl(n){gi===null?gi=[n]:gi.push(n)}function Su(n,a,p,v){var b=a.interleaved;return b===null?(p.next=p,vl(a)):(p.next=b.next,b.next=p),a.interleaved=p,sr(n,v)}function sr(n,a){n.lanes|=a;var p=n.alternate;for(p!==null&&(p.lanes|=a),p=n,n=n.return;n!==null;)n.childLanes|=a,p=n.alternate,p!==null&&(p.childLanes|=a),p=n,n=n.return;return p.tag===3?p.stateNode:null}var Or=!1;function _l(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Cu(n,a){n=n.updateQueue,a.updateQueue===n&&(a.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function or(n,a){return{eventTime:n,lane:a,tag:0,payload:null,callback:null,next:null}}function zr(n,a,p){var v=n.updateQueue;if(v===null)return null;if(v=v.shared,(We&2)!==0){var b=v.pending;return b===null?a.next=a:(a.next=b.next,b.next=a),v.pending=a,sr(n,p)}return b=v.interleaved,b===null?(a.next=a,vl(v)):(a.next=b.next,b.next=a),v.interleaved=a,sr(n,p)}function ua(n,a,p){if(a=a.updateQueue,a!==null&&(a=a.shared,(p&4194240)!==0)){var v=a.lanes;v&=n.pendingLanes,p|=v,a.lanes=p,gn(n,p)}}function Ru(n,a){var p=n.updateQueue,v=n.alternate;if(v!==null&&(v=v.updateQueue,p===v)){var b=null,E=null;if(p=p.firstBaseUpdate,p!==null){do{var P={eventTime:p.eventTime,lane:p.lane,tag:p.tag,payload:p.payload,callback:p.callback,next:null};E===null?b=E=P:E=E.next=P,p=p.next}while(p!==null);E===null?b=E=a:E=E.next=a}else b=E=a;p={baseState:v.baseState,firstBaseUpdate:b,lastBaseUpdate:E,shared:v.shared,effects:v.effects},n.updateQueue=p;return}n=p.lastBaseUpdate,n===null?p.firstBaseUpdate=a:n.next=a,p.lastBaseUpdate=a}function ca(n,a,p,v){var b=n.updateQueue;Or=!1;var E=b.firstBaseUpdate,P=b.lastBaseUpdate,O=b.shared.pending;if(O!==null){b.shared.pending=null;var Z=O,he=Z.next;Z.next=null,P===null?E=he:P.next=he,P=Z;var be=n.alternate;be!==null&&(be=be.updateQueue,O=be.lastBaseUpdate,O!==P&&(O===null?be.firstBaseUpdate=he:O.next=he,be.lastBaseUpdate=Z))}if(E!==null){var ke=b.baseState;P=0,be=he=Z=null,O=E;do{var xe=O.lane,Te=O.eventTime;if((v&xe)===xe){be!==null&&(be=be.next={eventTime:Te,lane:0,tag:O.tag,payload:O.payload,callback:O.callback,next:null});e:{var Le=n,Ne=O;switch(xe=a,Te=p,Ne.tag){case 1:if(Le=Ne.payload,typeof Le=="function"){ke=Le.call(Te,ke,xe);break e}ke=Le;break e;case 3:Le.flags=Le.flags&-65537|128;case 0:if(Le=Ne.payload,xe=typeof Le=="function"?Le.call(Te,ke,xe):Le,xe==null)break e;ke=q({},ke,xe);break e;case 2:Or=!0}}O.callback!==null&&O.lane!==0&&(n.flags|=64,xe=b.effects,xe===null?b.effects=[O]:xe.push(O))}else Te={eventTime:Te,lane:xe,tag:O.tag,payload:O.payload,callback:O.callback,next:null},be===null?(he=be=Te,Z=ke):be=be.next=Te,P|=xe;if(O=O.next,O===null){if(O=b.shared.pending,O===null)break;xe=O,O=xe.next,xe.next=null,b.lastBaseUpdate=xe,b.shared.pending=null}}while(!0);if(be===null&&(Z=ke),b.baseState=Z,b.firstBaseUpdate=he,b.lastBaseUpdate=be,a=b.shared.interleaved,a!==null){b=a;do P|=b.lane,b=b.next;while(b!==a)}else E===null&&(b.shared.lanes=0);_i|=P,n.lanes=P,n.memoizedState=ke}}function Tu(n,a,p){if(n=a.effects,a.effects=null,n!==null)for(a=0;a<n.length;a++){var v=n[a],b=v.callback;if(b!==null){if(v.callback=null,v=p,typeof b!="function")throw Error(r(191,b));b.call(v)}}}var no={},Dn=Mr(no),ro=Mr(no),io=Mr(no);function yi(n){if(n===no)throw Error(r(174));return n}function wl(n,a){switch(Qe(io,a),Qe(ro,n),Qe(Dn,no),n=a.nodeType,n){case 9:case 11:a=(a=a.documentElement)?a.namespaceURI:Ri(null,"");break;default:n=n===8?a.parentNode:a,a=n.namespaceURI||null,n=n.tagName,a=Ri(a,n)}tt(Dn),Qe(Dn,a)}function hs(){tt(Dn),tt(ro),tt(io)}function Pu(n){yi(io.current);var a=yi(Dn.current),p=Ri(a,n.type);a!==p&&(Qe(ro,n),Qe(Dn,p))}function xl(n){ro.current===n&&(tt(Dn),tt(ro))}var st=Mr(0);function ha(n){for(var a=n;a!==null;){if(a.tag===13){var p=a.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||p.data==="$?"||p.data==="$!"))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===n)break;for(;a.sibling===null;){if(a.return===null||a.return===n)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var bl=[];function El(){for(var n=0;n<bl.length;n++)bl[n]._workInProgressVersionPrimary=null;bl.length=0}var da=ye.ReactCurrentDispatcher,kl=ye.ReactCurrentBatchConfig,vi=0,ot=null,gt=null,_t=null,fa=!1,so=!1,oo=0,yh=0;function Lt(){throw Error(r(321))}function Sl(n,a){if(a===null)return!1;for(var p=0;p<a.length&&p<n.length;p++)if(!Jt(n[p],a[p]))return!1;return!0}function Cl(n,a,p,v,b,E){if(vi=E,ot=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,da.current=n===null||n.memoizedState===null?xh:bh,n=p(v,b),so){E=0;do{if(so=!1,oo=0,25<=E)throw Error(r(301));E+=1,_t=gt=null,a.updateQueue=null,da.current=Eh,n=p(v,b)}while(so)}if(da.current=ga,a=gt!==null&&gt.next!==null,vi=0,_t=gt=ot=null,fa=!1,a)throw Error(r(300));return n}function Rl(){var n=oo!==0;return oo=0,n}function On(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return _t===null?ot.memoizedState=_t=n:_t=_t.next=n,_t}function dn(){if(gt===null){var n=ot.alternate;n=n!==null?n.memoizedState:null}else n=gt.next;var a=_t===null?ot.memoizedState:_t.next;if(a!==null)_t=a,gt=n;else{if(n===null)throw Error(r(310));gt=n,n={memoizedState:gt.memoizedState,baseState:gt.baseState,baseQueue:gt.baseQueue,queue:gt.queue,next:null},_t===null?ot.memoizedState=_t=n:_t=_t.next=n}return _t}function ao(n,a){return typeof a=="function"?a(n):a}function Tl(n){var a=dn(),p=a.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=n;var v=gt,b=v.baseQueue,E=p.pending;if(E!==null){if(b!==null){var P=b.next;b.next=E.next,E.next=P}v.baseQueue=b=E,p.pending=null}if(b!==null){E=b.next,v=v.baseState;var O=P=null,Z=null,he=E;do{var be=he.lane;if((vi&be)===be)Z!==null&&(Z=Z.next={lane:0,action:he.action,hasEagerState:he.hasEagerState,eagerState:he.eagerState,next:null}),v=he.hasEagerState?he.eagerState:n(v,he.action);else{var ke={lane:be,action:he.action,hasEagerState:he.hasEagerState,eagerState:he.eagerState,next:null};Z===null?(O=Z=ke,P=v):Z=Z.next=ke,ot.lanes|=be,_i|=be}he=he.next}while(he!==null&&he!==E);Z===null?P=v:Z.next=O,Jt(v,a.memoizedState)||(Ft=!0),a.memoizedState=v,a.baseState=P,a.baseQueue=Z,p.lastRenderedState=v}if(n=p.interleaved,n!==null){b=n;do E=b.lane,ot.lanes|=E,_i|=E,b=b.next;while(b!==n)}else b===null&&(p.lanes=0);return[a.memoizedState,p.dispatch]}function Pl(n){var a=dn(),p=a.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=n;var v=p.dispatch,b=p.pending,E=a.memoizedState;if(b!==null){p.pending=null;var P=b=b.next;do E=n(E,P.action),P=P.next;while(P!==b);Jt(E,a.memoizedState)||(Ft=!0),a.memoizedState=E,a.baseQueue===null&&(a.baseState=E),p.lastRenderedState=E}return[E,v]}function Lu(){}function Nu(n,a){var p=ot,v=dn(),b=a(),E=!Jt(v.memoizedState,b);if(E&&(v.memoizedState=b,Ft=!0),v=v.queue,Ll(Bu.bind(null,p,v,n),[n]),v.getSnapshot!==a||E||_t!==null&&_t.memoizedState.tag&1){if(p.flags|=2048,lo(9,Iu.bind(null,p,v,b,a),void 0,null),wt===null)throw Error(r(349));(vi&30)!==0||Au(p,a,b)}return b}function Au(n,a,p){n.flags|=16384,n={getSnapshot:a,value:p},a=ot.updateQueue,a===null?(a={lastEffect:null,stores:null},ot.updateQueue=a,a.stores=[n]):(p=a.stores,p===null?a.stores=[n]:p.push(n))}function Iu(n,a,p,v){a.value=p,a.getSnapshot=v,Mu(a)&&$u(n)}function Bu(n,a,p){return p(function(){Mu(a)&&$u(n)})}function Mu(n){var a=n.getSnapshot;n=n.value;try{var p=a();return!Jt(n,p)}catch{return!0}}function $u(n){var a=sr(n,1);a!==null&&Sn(a,n,1,-1)}function Du(n){var a=On();return typeof n=="function"&&(n=n()),a.memoizedState=a.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ao,lastRenderedState:n},a.queue=n,n=n.dispatch=wh.bind(null,ot,n),[a.memoizedState,n]}function lo(n,a,p,v){return n={tag:n,create:a,destroy:p,deps:v,next:null},a=ot.updateQueue,a===null?(a={lastEffect:null,stores:null},ot.updateQueue=a,a.lastEffect=n.next=n):(p=a.lastEffect,p===null?a.lastEffect=n.next=n:(v=p.next,p.next=n,n.next=v,a.lastEffect=n)),n}function Ou(){return dn().memoizedState}function pa(n,a,p,v){var b=On();ot.flags|=n,b.memoizedState=lo(1|a,p,void 0,v===void 0?null:v)}function ma(n,a,p,v){var b=dn();v=v===void 0?null:v;var E=void 0;if(gt!==null){var P=gt.memoizedState;if(E=P.destroy,v!==null&&Sl(v,P.deps)){b.memoizedState=lo(a,p,E,v);return}}ot.flags|=n,b.memoizedState=lo(1|a,p,E,v)}function zu(n,a){return pa(8390656,8,n,a)}function Ll(n,a){return ma(2048,8,n,a)}function ju(n,a){return ma(4,2,n,a)}function Uu(n,a){return ma(4,4,n,a)}function Fu(n,a){if(typeof a=="function")return n=n(),a(n),function(){a(null)};if(a!=null)return n=n(),a.current=n,function(){a.current=null}}function Hu(n,a,p){return p=p!=null?p.concat([n]):null,ma(4,4,Fu.bind(null,a,n),p)}function Nl(){}function Ku(n,a){var p=dn();a=a===void 0?null:a;var v=p.memoizedState;return v!==null&&a!==null&&Sl(a,v[1])?v[0]:(p.memoizedState=[n,a],n)}function Vu(n,a){var p=dn();a=a===void 0?null:a;var v=p.memoizedState;return v!==null&&a!==null&&Sl(a,v[1])?v[0]:(n=n(),p.memoizedState=[n,a],n)}function Zu(n,a,p){return(vi&21)===0?(n.baseState&&(n.baseState=!1,Ft=!0),n.memoizedState=p):(Jt(p,a)||(p=No(),ot.lanes|=p,_i|=p,n.baseState=!0),a)}function vh(n,a){var p=Ze;Ze=p!==0&&4>p?p:4,n(!0);var v=kl.transition;kl.transition={};try{n(!1),a()}finally{Ze=p,kl.transition=v}}function Wu(){return dn().memoizedState}function _h(n,a,p){var v=Hr(n);if(p={lane:v,action:p,hasEagerState:!1,eagerState:null,next:null},qu(n))Gu(a,p);else if(p=Su(n,a,p,v),p!==null){var b=Dt();Sn(p,n,v,b),Yu(p,a,v)}}function wh(n,a,p){var v=Hr(n),b={lane:v,action:p,hasEagerState:!1,eagerState:null,next:null};if(qu(n))Gu(a,b);else{var E=n.alternate;if(n.lanes===0&&(E===null||E.lanes===0)&&(E=a.lastRenderedReducer,E!==null))try{var P=a.lastRenderedState,O=E(P,p);if(b.hasEagerState=!0,b.eagerState=O,Jt(O,P)){var Z=a.interleaved;Z===null?(b.next=b,vl(a)):(b.next=Z.next,Z.next=b),a.interleaved=b;return}}catch{}finally{}p=Su(n,a,b,v),p!==null&&(b=Dt(),Sn(p,n,v,b),Yu(p,a,v))}}function qu(n){var a=n.alternate;return n===ot||a!==null&&a===ot}function Gu(n,a){so=fa=!0;var p=n.pending;p===null?a.next=a:(a.next=p.next,p.next=a),n.pending=a}function Yu(n,a,p){if((p&4194240)!==0){var v=a.lanes;v&=n.pendingLanes,p|=v,a.lanes=p,gn(n,p)}}var ga={readContext:hn,useCallback:Lt,useContext:Lt,useEffect:Lt,useImperativeHandle:Lt,useInsertionEffect:Lt,useLayoutEffect:Lt,useMemo:Lt,useReducer:Lt,useRef:Lt,useState:Lt,useDebugValue:Lt,useDeferredValue:Lt,useTransition:Lt,useMutableSource:Lt,useSyncExternalStore:Lt,useId:Lt,unstable_isNewReconciler:!1},xh={readContext:hn,useCallback:function(n,a){return On().memoizedState=[n,a===void 0?null:a],n},useContext:hn,useEffect:zu,useImperativeHandle:function(n,a,p){return p=p!=null?p.concat([n]):null,pa(4194308,4,Fu.bind(null,a,n),p)},useLayoutEffect:function(n,a){return pa(4194308,4,n,a)},useInsertionEffect:function(n,a){return pa(4,2,n,a)},useMemo:function(n,a){var p=On();return a=a===void 0?null:a,n=n(),p.memoizedState=[n,a],n},useReducer:function(n,a,p){var v=On();return a=p!==void 0?p(a):a,v.memoizedState=v.baseState=a,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:a},v.queue=n,n=n.dispatch=_h.bind(null,ot,n),[v.memoizedState,n]},useRef:function(n){var a=On();return n={current:n},a.memoizedState=n},useState:Du,useDebugValue:Nl,useDeferredValue:function(n){return On().memoizedState=n},useTransition:function(){var n=Du(!1),a=n[0];return n=vh.bind(null,n[1]),On().memoizedState=n,[a,n]},useMutableSource:function(){},useSyncExternalStore:function(n,a,p){var v=ot,b=On();if(nt){if(p===void 0)throw Error(r(407));p=p()}else{if(p=a(),wt===null)throw Error(r(349));(vi&30)!==0||Au(v,a,p)}b.memoizedState=p;var E={value:p,getSnapshot:a};return b.queue=E,zu(Bu.bind(null,v,E,n),[n]),v.flags|=2048,lo(9,Iu.bind(null,v,E,p,a),void 0,null),p},useId:function(){var n=On(),a=wt.identifierPrefix;if(nt){var p=ir,v=rr;p=(v&~(1<<32-Fe(v)-1)).toString(32)+p,a=":"+a+"R"+p,p=oo++,0<p&&(a+="H"+p.toString(32)),a+=":"}else p=yh++,a=":"+a+"r"+p.toString(32)+":";return n.memoizedState=a},unstable_isNewReconciler:!1},bh={readContext:hn,useCallback:Ku,useContext:hn,useEffect:Ll,useImperativeHandle:Hu,useInsertionEffect:ju,useLayoutEffect:Uu,useMemo:Vu,useReducer:Tl,useRef:Ou,useState:function(){return Tl(ao)},useDebugValue:Nl,useDeferredValue:function(n){var a=dn();return Zu(a,gt.memoizedState,n)},useTransition:function(){var n=Tl(ao)[0],a=dn().memoizedState;return[n,a]},useMutableSource:Lu,useSyncExternalStore:Nu,useId:Wu,unstable_isNewReconciler:!1},Eh={readContext:hn,useCallback:Ku,useContext:hn,useEffect:Ll,useImperativeHandle:Hu,useInsertionEffect:ju,useLayoutEffect:Uu,useMemo:Vu,useReducer:Pl,useRef:Ou,useState:function(){return Pl(ao)},useDebugValue:Nl,useDeferredValue:function(n){var a=dn();return gt===null?a.memoizedState=n:Zu(a,gt.memoizedState,n)},useTransition:function(){var n=Pl(ao)[0],a=dn().memoizedState;return[n,a]},useMutableSource:Lu,useSyncExternalStore:Nu,useId:Wu,unstable_isNewReconciler:!1};function bn(n,a){if(n&&n.defaultProps){a=q({},a),n=n.defaultProps;for(var p in n)a[p]===void 0&&(a[p]=n[p]);return a}return a}function Al(n,a,p,v){a=n.memoizedState,p=p(v,a),p=p==null?a:q({},a,p),n.memoizedState=p,n.lanes===0&&(n.updateQueue.baseState=p)}var ya={isMounted:function(n){return(n=n._reactInternals)?Tn(n)===n:!1},enqueueSetState:function(n,a,p){n=n._reactInternals;var v=Dt(),b=Hr(n),E=or(v,b);E.payload=a,p!=null&&(E.callback=p),a=zr(n,E,b),a!==null&&(Sn(a,n,b,v),ua(a,n,b))},enqueueReplaceState:function(n,a,p){n=n._reactInternals;var v=Dt(),b=Hr(n),E=or(v,b);E.tag=1,E.payload=a,p!=null&&(E.callback=p),a=zr(n,E,b),a!==null&&(Sn(a,n,b,v),ua(a,n,b))},enqueueForceUpdate:function(n,a){n=n._reactInternals;var p=Dt(),v=Hr(n),b=or(p,v);b.tag=2,a!=null&&(b.callback=a),a=zr(n,b,v),a!==null&&(Sn(a,n,v,p),ua(a,n,v))}};function Ju(n,a,p,v,b,E,P){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(v,E,P):a.prototype&&a.prototype.isPureReactComponent?!In(p,v)||!In(b,E):!0}function Xu(n,a,p){var v=!1,b=$r,E=a.contextType;return typeof E=="object"&&E!==null?E=hn(E):(b=Ut(a)?fi:Pt.current,v=a.contextTypes,E=(v=v!=null)?is(n,b):$r),a=new a(p,E),n.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,a.updater=ya,n.stateNode=a,a._reactInternals=n,v&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=b,n.__reactInternalMemoizedMaskedChildContext=E),a}function Qu(n,a,p,v){n=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(p,v),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(p,v),a.state!==n&&ya.enqueueReplaceState(a,a.state,null)}function Il(n,a,p,v){var b=n.stateNode;b.props=p,b.state=n.memoizedState,b.refs={},_l(n);var E=a.contextType;typeof E=="object"&&E!==null?b.context=hn(E):(E=Ut(a)?fi:Pt.current,b.context=is(n,E)),b.state=n.memoizedState,E=a.getDerivedStateFromProps,typeof E=="function"&&(Al(n,a,E,p),b.state=n.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof b.getSnapshotBeforeUpdate=="function"||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(a=b.state,typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount(),a!==b.state&&ya.enqueueReplaceState(b,b.state,null),ca(n,p,b,v),b.state=n.memoizedState),typeof b.componentDidMount=="function"&&(n.flags|=4194308)}function ds(n,a){try{var p="",v=a;do p+=pe(v),v=v.return;while(v);var b=p}catch(E){b=`
Error generating stack: `+E.message+`
`+E.stack}return{value:n,source:a,stack:b,digest:null}}function Bl(n,a,p){return{value:n,source:null,stack:p??null,digest:a??null}}function Ml(n,a){try{console.error(a.value)}catch(p){setTimeout(function(){throw p})}}var kh=typeof WeakMap=="function"?WeakMap:Map;function ec(n,a,p){p=or(-1,p),p.tag=3,p.payload={element:null};var v=a.value;return p.callback=function(){Sa||(Sa=!0,Yl=v),Ml(n,a)},p}function tc(n,a,p){p=or(-1,p),p.tag=3;var v=n.type.getDerivedStateFromError;if(typeof v=="function"){var b=a.value;p.payload=function(){return v(b)},p.callback=function(){Ml(n,a)}}var E=n.stateNode;return E!==null&&typeof E.componentDidCatch=="function"&&(p.callback=function(){Ml(n,a),typeof v!="function"&&(Ur===null?Ur=new Set([this]):Ur.add(this));var P=a.stack;this.componentDidCatch(a.value,{componentStack:P!==null?P:""})}),p}function nc(n,a,p){var v=n.pingCache;if(v===null){v=n.pingCache=new kh;var b=new Set;v.set(a,b)}else b=v.get(a),b===void 0&&(b=new Set,v.set(a,b));b.has(p)||(b.add(p),n=Oh.bind(null,n,a,p),a.then(n,n))}function rc(n){do{var a;if((a=n.tag===13)&&(a=n.memoizedState,a=a!==null?a.dehydrated!==null:!0),a)return n;n=n.return}while(n!==null);return null}function ic(n,a,p,v,b){return(n.mode&1)===0?(n===a?n.flags|=65536:(n.flags|=128,p.flags|=131072,p.flags&=-52805,p.tag===1&&(p.alternate===null?p.tag=17:(a=or(-1,1),a.tag=2,zr(p,a,1))),p.lanes|=1),n):(n.flags|=65536,n.lanes=b,n)}var Sh=ye.ReactCurrentOwner,Ft=!1;function $t(n,a,p,v){a.child=n===null?ku(a,null,p,v):ls(a,n.child,p,v)}function sc(n,a,p,v,b){p=p.render;var E=a.ref;return cs(a,b),v=Cl(n,a,p,v,E,b),p=Rl(),n!==null&&!Ft?(a.updateQueue=n.updateQueue,a.flags&=-2053,n.lanes&=~b,ar(n,a,b)):(nt&&p&&ul(a),a.flags|=1,$t(n,a,v,b),a.child)}function oc(n,a,p,v,b){if(n===null){var E=p.type;return typeof E=="function"&&!ru(E)&&E.defaultProps===void 0&&p.compare===null&&p.defaultProps===void 0?(a.tag=15,a.type=E,ac(n,a,E,v,b)):(n=Na(p.type,null,v,a,a.mode,b),n.ref=a.ref,n.return=a,a.child=n)}if(E=n.child,(n.lanes&b)===0){var P=E.memoizedProps;if(p=p.compare,p=p!==null?p:In,p(P,v)&&n.ref===a.ref)return ar(n,a,b)}return a.flags|=1,n=Vr(E,v),n.ref=a.ref,n.return=a,a.child=n}function ac(n,a,p,v,b){if(n!==null){var E=n.memoizedProps;if(In(E,v)&&n.ref===a.ref)if(Ft=!1,a.pendingProps=v=E,(n.lanes&b)!==0)(n.flags&131072)!==0&&(Ft=!0);else return a.lanes=n.lanes,ar(n,a,b)}return $l(n,a,p,v,b)}function lc(n,a,p){var v=a.pendingProps,b=v.children,E=n!==null?n.memoizedState:null;if(v.mode==="hidden")if((a.mode&1)===0)a.memoizedState={baseLanes:0,cachePool:null,transitions:null},Qe(ps,tn),tn|=p;else{if((p&1073741824)===0)return n=E!==null?E.baseLanes|p:p,a.lanes=a.childLanes=1073741824,a.memoizedState={baseLanes:n,cachePool:null,transitions:null},a.updateQueue=null,Qe(ps,tn),tn|=n,null;a.memoizedState={baseLanes:0,cachePool:null,transitions:null},v=E!==null?E.baseLanes:p,Qe(ps,tn),tn|=v}else E!==null?(v=E.baseLanes|p,a.memoizedState=null):v=p,Qe(ps,tn),tn|=v;return $t(n,a,b,p),a.child}function uc(n,a){var p=a.ref;(n===null&&p!==null||n!==null&&n.ref!==p)&&(a.flags|=512,a.flags|=2097152)}function $l(n,a,p,v,b){var E=Ut(p)?fi:Pt.current;return E=is(a,E),cs(a,b),p=Cl(n,a,p,v,E,b),v=Rl(),n!==null&&!Ft?(a.updateQueue=n.updateQueue,a.flags&=-2053,n.lanes&=~b,ar(n,a,b)):(nt&&v&&ul(a),a.flags|=1,$t(n,a,p,b),a.child)}function cc(n,a,p,v,b){if(Ut(p)){var E=!0;ta(a)}else E=!1;if(cs(a,b),a.stateNode===null)wa(n,a),Xu(a,p,v),Il(a,p,v,b),v=!0;else if(n===null){var P=a.stateNode,O=a.memoizedProps;P.props=O;var Z=P.context,he=p.contextType;typeof he=="object"&&he!==null?he=hn(he):(he=Ut(p)?fi:Pt.current,he=is(a,he));var be=p.getDerivedStateFromProps,ke=typeof be=="function"||typeof P.getSnapshotBeforeUpdate=="function";ke||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(O!==v||Z!==he)&&Qu(a,P,v,he),Or=!1;var xe=a.memoizedState;P.state=xe,ca(a,v,P,b),Z=a.memoizedState,O!==v||xe!==Z||jt.current||Or?(typeof be=="function"&&(Al(a,p,be,v),Z=a.memoizedState),(O=Or||Ju(a,p,O,v,xe,Z,he))?(ke||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount()),typeof P.componentDidMount=="function"&&(a.flags|=4194308)):(typeof P.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=v,a.memoizedState=Z),P.props=v,P.state=Z,P.context=he,v=O):(typeof P.componentDidMount=="function"&&(a.flags|=4194308),v=!1)}else{P=a.stateNode,Cu(n,a),O=a.memoizedProps,he=a.type===a.elementType?O:bn(a.type,O),P.props=he,ke=a.pendingProps,xe=P.context,Z=p.contextType,typeof Z=="object"&&Z!==null?Z=hn(Z):(Z=Ut(p)?fi:Pt.current,Z=is(a,Z));var Te=p.getDerivedStateFromProps;(be=typeof Te=="function"||typeof P.getSnapshotBeforeUpdate=="function")||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(O!==ke||xe!==Z)&&Qu(a,P,v,Z),Or=!1,xe=a.memoizedState,P.state=xe,ca(a,v,P,b);var Le=a.memoizedState;O!==ke||xe!==Le||jt.current||Or?(typeof Te=="function"&&(Al(a,p,Te,v),Le=a.memoizedState),(he=Or||Ju(a,p,he,v,xe,Le,Z)||!1)?(be||typeof P.UNSAFE_componentWillUpdate!="function"&&typeof P.componentWillUpdate!="function"||(typeof P.componentWillUpdate=="function"&&P.componentWillUpdate(v,Le,Z),typeof P.UNSAFE_componentWillUpdate=="function"&&P.UNSAFE_componentWillUpdate(v,Le,Z)),typeof P.componentDidUpdate=="function"&&(a.flags|=4),typeof P.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof P.componentDidUpdate!="function"||O===n.memoizedProps&&xe===n.memoizedState||(a.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||O===n.memoizedProps&&xe===n.memoizedState||(a.flags|=1024),a.memoizedProps=v,a.memoizedState=Le),P.props=v,P.state=Le,P.context=Z,v=he):(typeof P.componentDidUpdate!="function"||O===n.memoizedProps&&xe===n.memoizedState||(a.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||O===n.memoizedProps&&xe===n.memoizedState||(a.flags|=1024),v=!1)}return Dl(n,a,p,v,E,b)}function Dl(n,a,p,v,b,E){uc(n,a);var P=(a.flags&128)!==0;if(!v&&!P)return b&&mu(a,p,!1),ar(n,a,E);v=a.stateNode,Sh.current=a;var O=P&&typeof p.getDerivedStateFromError!="function"?null:v.render();return a.flags|=1,n!==null&&P?(a.child=ls(a,n.child,null,E),a.child=ls(a,null,O,E)):$t(n,a,O,E),a.memoizedState=v.state,b&&mu(a,p,!0),a.child}function hc(n){var a=n.stateNode;a.pendingContext?fu(n,a.pendingContext,a.pendingContext!==a.context):a.context&&fu(n,a.context,!1),wl(n,a.containerInfo)}function dc(n,a,p,v,b){return as(),fl(b),a.flags|=256,$t(n,a,p,v),a.child}var Ol={dehydrated:null,treeContext:null,retryLane:0};function zl(n){return{baseLanes:n,cachePool:null,transitions:null}}function fc(n,a,p){var v=a.pendingProps,b=st.current,E=!1,P=(a.flags&128)!==0,O;if((O=P)||(O=n!==null&&n.memoizedState===null?!1:(b&2)!==0),O?(E=!0,a.flags&=-129):(n===null||n.memoizedState!==null)&&(b|=1),Qe(st,b&1),n===null)return dl(a),n=a.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?((a.mode&1)===0?a.lanes=1:n.data==="$!"?a.lanes=8:a.lanes=1073741824,null):(P=v.children,n=v.fallback,E?(v=a.mode,E=a.child,P={mode:"hidden",children:P},(v&1)===0&&E!==null?(E.childLanes=0,E.pendingProps=P):E=Aa(P,v,0,null),n=Ei(n,v,p,null),E.return=a,n.return=a,E.sibling=n,a.child=E,a.child.memoizedState=zl(p),a.memoizedState=Ol,n):jl(a,P));if(b=n.memoizedState,b!==null&&(O=b.dehydrated,O!==null))return Ch(n,a,P,v,O,b,p);if(E){E=v.fallback,P=a.mode,b=n.child,O=b.sibling;var Z={mode:"hidden",children:v.children};return(P&1)===0&&a.child!==b?(v=a.child,v.childLanes=0,v.pendingProps=Z,a.deletions=null):(v=Vr(b,Z),v.subtreeFlags=b.subtreeFlags&14680064),O!==null?E=Vr(O,E):(E=Ei(E,P,p,null),E.flags|=2),E.return=a,v.return=a,v.sibling=E,a.child=v,v=E,E=a.child,P=n.child.memoizedState,P=P===null?zl(p):{baseLanes:P.baseLanes|p,cachePool:null,transitions:P.transitions},E.memoizedState=P,E.childLanes=n.childLanes&~p,a.memoizedState=Ol,v}return E=n.child,n=E.sibling,v=Vr(E,{mode:"visible",children:v.children}),(a.mode&1)===0&&(v.lanes=p),v.return=a,v.sibling=null,n!==null&&(p=a.deletions,p===null?(a.deletions=[n],a.flags|=16):p.push(n)),a.child=v,a.memoizedState=null,v}function jl(n,a){return a=Aa({mode:"visible",children:a},n.mode,0,null),a.return=n,n.child=a}function va(n,a,p,v){return v!==null&&fl(v),ls(a,n.child,null,p),n=jl(a,a.pendingProps.children),n.flags|=2,a.memoizedState=null,n}function Ch(n,a,p,v,b,E,P){if(p)return a.flags&256?(a.flags&=-257,v=Bl(Error(r(422))),va(n,a,P,v)):a.memoizedState!==null?(a.child=n.child,a.flags|=128,null):(E=v.fallback,b=a.mode,v=Aa({mode:"visible",children:v.children},b,0,null),E=Ei(E,b,P,null),E.flags|=2,v.return=a,E.return=a,v.sibling=E,a.child=v,(a.mode&1)!==0&&ls(a,n.child,null,P),a.child.memoizedState=zl(P),a.memoizedState=Ol,E);if((a.mode&1)===0)return va(n,a,P,null);if(b.data==="$!"){if(v=b.nextSibling&&b.nextSibling.dataset,v)var O=v.dgst;return v=O,E=Error(r(419)),v=Bl(E,v,void 0),va(n,a,P,v)}if(O=(P&n.childLanes)!==0,Ft||O){if(v=wt,v!==null){switch(P&-P){case 4:b=2;break;case 16:b=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:b=32;break;case 536870912:b=268435456;break;default:b=0}b=(b&(v.suspendedLanes|P))!==0?0:b,b!==0&&b!==E.retryLane&&(E.retryLane=b,sr(n,b),Sn(v,n,b,-1))}return nu(),v=Bl(Error(r(421))),va(n,a,P,v)}return b.data==="$?"?(a.flags|=128,a.child=n.child,a=zh.bind(null,n),b._reactRetry=a,null):(n=E.treeContext,en=$n(b.nextSibling),Qt=a,nt=!0,xn=null,n!==null&&(un[cn++]=rr,un[cn++]=ir,un[cn++]=pi,rr=n.id,ir=n.overflow,pi=a),a=jl(a,v.children),a.flags|=4096,a)}function pc(n,a,p){n.lanes|=a;var v=n.alternate;v!==null&&(v.lanes|=a),yl(n.return,a,p)}function Ul(n,a,p,v,b){var E=n.memoizedState;E===null?n.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:v,tail:p,tailMode:b}:(E.isBackwards=a,E.rendering=null,E.renderingStartTime=0,E.last=v,E.tail=p,E.tailMode=b)}function mc(n,a,p){var v=a.pendingProps,b=v.revealOrder,E=v.tail;if($t(n,a,v.children,p),v=st.current,(v&2)!==0)v=v&1|2,a.flags|=128;else{if(n!==null&&(n.flags&128)!==0)e:for(n=a.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&pc(n,p,a);else if(n.tag===19)pc(n,p,a);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===a)break e;for(;n.sibling===null;){if(n.return===null||n.return===a)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}v&=1}if(Qe(st,v),(a.mode&1)===0)a.memoizedState=null;else switch(b){case"forwards":for(p=a.child,b=null;p!==null;)n=p.alternate,n!==null&&ha(n)===null&&(b=p),p=p.sibling;p=b,p===null?(b=a.child,a.child=null):(b=p.sibling,p.sibling=null),Ul(a,!1,b,p,E);break;case"backwards":for(p=null,b=a.child,a.child=null;b!==null;){if(n=b.alternate,n!==null&&ha(n)===null){a.child=b;break}n=b.sibling,b.sibling=p,p=b,b=n}Ul(a,!0,p,null,E);break;case"together":Ul(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function wa(n,a){(a.mode&1)===0&&n!==null&&(n.alternate=null,a.alternate=null,a.flags|=2)}function ar(n,a,p){if(n!==null&&(a.dependencies=n.dependencies),_i|=a.lanes,(p&a.childLanes)===0)return null;if(n!==null&&a.child!==n.child)throw Error(r(153));if(a.child!==null){for(n=a.child,p=Vr(n,n.pendingProps),a.child=p,p.return=a;n.sibling!==null;)n=n.sibling,p=p.sibling=Vr(n,n.pendingProps),p.return=a;p.sibling=null}return a.child}function Rh(n,a,p){switch(a.tag){case 3:hc(a),as();break;case 5:Pu(a);break;case 1:Ut(a.type)&&ta(a);break;case 4:wl(a,a.stateNode.containerInfo);break;case 10:var v=a.type._context,b=a.memoizedProps.value;Qe(aa,v._currentValue),v._currentValue=b;break;case 13:if(v=a.memoizedState,v!==null)return v.dehydrated!==null?(Qe(st,st.current&1),a.flags|=128,null):(p&a.child.childLanes)!==0?fc(n,a,p):(Qe(st,st.current&1),n=ar(n,a,p),n!==null?n.sibling:null);Qe(st,st.current&1);break;case 19:if(v=(p&a.childLanes)!==0,(n.flags&128)!==0){if(v)return mc(n,a,p);a.flags|=128}if(b=a.memoizedState,b!==null&&(b.rendering=null,b.tail=null,b.lastEffect=null),Qe(st,st.current),v)break;return null;case 22:case 23:return a.lanes=0,lc(n,a,p)}return ar(n,a,p)}var gc,Fl,yc,vc;gc=function(n,a){for(var p=a.child;p!==null;){if(p.tag===5||p.tag===6)n.appendChild(p.stateNode);else if(p.tag!==4&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===a)break;for(;p.sibling===null;){if(p.return===null||p.return===a)return;p=p.return}p.sibling.return=p.return,p=p.sibling}},Fl=function(){},yc=function(n,a,p,v){var b=n.memoizedProps;if(b!==v){n=a.stateNode,yi(Dn.current);var E=null;switch(p){case"input":b=Cn(n,b),v=Cn(n,v),E=[];break;case"select":b=q({},b,{value:void 0}),v=q({},v,{value:void 0}),E=[];break;case"textarea":b=Si(n,b),v=Si(n,v),E=[];break;default:typeof b.onClick!="function"&&typeof v.onClick=="function"&&(n.onclick=ve)}xs(p,v);var P;p=null;for(he in b)if(!v.hasOwnProperty(he)&&b.hasOwnProperty(he)&&b[he]!=null)if(he==="style"){var O=b[he];for(P in O)O.hasOwnProperty(P)&&(p||(p={}),p[P]="")}else he!=="dangerouslySetInnerHTML"&&he!=="children"&&he!=="suppressContentEditableWarning"&&he!=="suppressHydrationWarning"&&he!=="autoFocus"&&(c.hasOwnProperty(he)?E||(E=[]):(E=E||[]).push(he,null));for(he in v){var Z=v[he];if(O=b?.[he],v.hasOwnProperty(he)&&Z!==O&&(Z!=null||O!=null))if(he==="style")if(O){for(P in O)!O.hasOwnProperty(P)||Z&&Z.hasOwnProperty(P)||(p||(p={}),p[P]="");for(P in Z)Z.hasOwnProperty(P)&&O[P]!==Z[P]&&(p||(p={}),p[P]=Z[P])}else p||(E||(E=[]),E.push(he,p)),p=Z;else he==="dangerouslySetInnerHTML"?(Z=Z?Z.__html:void 0,O=O?O.__html:void 0,Z!=null&&O!==Z&&(E=E||[]).push(he,Z)):he==="children"?typeof Z!="string"&&typeof Z!="number"||(E=E||[]).push(he,""+Z):he!=="suppressContentEditableWarning"&&he!=="suppressHydrationWarning"&&(c.hasOwnProperty(he)?(Z!=null&&he==="onScroll"&&Je("scroll",n),E||O===Z||(E=[])):(E=E||[]).push(he,Z))}p&&(E=E||[]).push("style",p);var he=E;(a.updateQueue=he)&&(a.flags|=4)}},vc=function(n,a,p,v){p!==v&&(a.flags|=4)};function uo(n,a){if(!nt)switch(n.tailMode){case"hidden":a=n.tail;for(var p=null;a!==null;)a.alternate!==null&&(p=a),a=a.sibling;p===null?n.tail=null:p.sibling=null;break;case"collapsed":p=n.tail;for(var v=null;p!==null;)p.alternate!==null&&(v=p),p=p.sibling;v===null?a||n.tail===null?n.tail=null:n.tail.sibling=null:v.sibling=null}}function Nt(n){var a=n.alternate!==null&&n.alternate.child===n.child,p=0,v=0;if(a)for(var b=n.child;b!==null;)p|=b.lanes|b.childLanes,v|=b.subtreeFlags&14680064,v|=b.flags&14680064,b.return=n,b=b.sibling;else for(b=n.child;b!==null;)p|=b.lanes|b.childLanes,v|=b.subtreeFlags,v|=b.flags,b.return=n,b=b.sibling;return n.subtreeFlags|=v,n.childLanes=p,a}function Th(n,a,p){var v=a.pendingProps;switch(cl(a),a.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Nt(a),null;case 1:return Ut(a.type)&&ea(),Nt(a),null;case 3:return v=a.stateNode,hs(),tt(jt),tt(Pt),El(),v.pendingContext&&(v.context=v.pendingContext,v.pendingContext=null),(n===null||n.child===null)&&(sa(a)?a.flags|=4:n===null||n.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,xn!==null&&(Ql(xn),xn=null))),Fl(n,a),Nt(a),null;case 5:xl(a);var b=yi(io.current);if(p=a.type,n!==null&&a.stateNode!=null)yc(n,a,p,v,b),n.ref!==a.ref&&(a.flags|=512,a.flags|=2097152);else{if(!v){if(a.stateNode===null)throw Error(r(166));return Nt(a),null}if(n=yi(Dn.current),sa(a)){v=a.stateNode,p=a.type;var E=a.memoizedProps;switch(v[ln]=a,v[Ir]=E,n=(a.mode&1)!==0,p){case"dialog":Je("cancel",v),Je("close",v);break;case"iframe":case"object":case"embed":Je("load",v);break;case"video":case"audio":for(b=0;b<Lr.length;b++)Je(Lr[b],v);break;case"source":Je("error",v);break;case"img":case"image":case"link":Je("error",v),Je("load",v);break;case"details":Je("toggle",v);break;case"input":ur(v,E),Je("invalid",v);break;case"select":v._wrapperState={wasMultiple:!!E.multiple},Je("invalid",v);break;case"textarea":_s(v,E),Je("invalid",v)}xs(p,E),b=null;for(var P in E)if(E.hasOwnProperty(P)){var O=E[P];P==="children"?typeof O=="string"?v.textContent!==O&&(E.suppressHydrationWarning!==!0&&ce(v.textContent,O,n),b=["children",O]):typeof O=="number"&&v.textContent!==""+O&&(E.suppressHydrationWarning!==!0&&ce(v.textContent,O,n),b=["children",""+O]):c.hasOwnProperty(P)&&O!=null&&P==="onScroll"&&Je("scroll",v)}switch(p){case"input":kt(v),qr(v,E,!0);break;case"textarea":kt(v),yo(v);break;case"select":case"option":break;default:typeof E.onClick=="function"&&(v.onclick=ve)}v=b,a.updateQueue=v,v!==null&&(a.flags|=4)}else{P=b.nodeType===9?b:b.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=Ci(p)),n==="http://www.w3.org/1999/xhtml"?p==="script"?(n=P.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof v.is=="string"?n=P.createElement(p,{is:v.is}):(n=P.createElement(p),p==="select"&&(P=n,v.multiple?P.multiple=!0:v.size&&(P.size=v.size))):n=P.createElementNS(n,p),n[ln]=a,n[Ir]=v,gc(n,a,!1,!1),a.stateNode=n;e:{switch(P=jn(p,v),p){case"dialog":Je("cancel",n),Je("close",n),b=v;break;case"iframe":case"object":case"embed":Je("load",n),b=v;break;case"video":case"audio":for(b=0;b<Lr.length;b++)Je(Lr[b],n);b=v;break;case"source":Je("error",n),b=v;break;case"img":case"image":case"link":Je("error",n),Je("load",n),b=v;break;case"details":Je("toggle",n),b=v;break;case"input":ur(n,v),b=Cn(n,v),Je("invalid",n);break;case"option":b=v;break;case"select":n._wrapperState={wasMultiple:!!v.multiple},b=q({},v,{value:void 0}),Je("invalid",n);break;case"textarea":_s(n,v),b=Si(n,v),Je("invalid",n);break;default:b=v}xs(p,b),O=b;for(E in O)if(O.hasOwnProperty(E)){var Z=O[E];E==="style"?Ti(n,Z):E==="dangerouslySetInnerHTML"?(Z=Z?Z.__html:void 0,Z!=null&&vo(n,Z)):E==="children"?typeof Z=="string"?(p!=="textarea"||Z!=="")&&dr(n,Z):typeof Z=="number"&&dr(n,""+Z):E!=="suppressContentEditableWarning"&&E!=="suppressHydrationWarning"&&E!=="autoFocus"&&(c.hasOwnProperty(E)?Z!=null&&E==="onScroll"&&Je("scroll",n):Z!=null&&se(n,E,Z,P))}switch(p){case"input":kt(n),qr(n,v,!1);break;case"textarea":kt(n),yo(n);break;case"option":v.value!=null&&n.setAttribute("value",""+Ie(v.value));break;case"select":n.multiple=!!v.multiple,E=v.value,E!=null?Rn(n,!!v.multiple,E,!1):v.defaultValue!=null&&Rn(n,!!v.multiple,v.defaultValue,!0);break;default:typeof b.onClick=="function"&&(n.onclick=ve)}switch(p){case"button":case"input":case"select":case"textarea":v=!!v.autoFocus;break e;case"img":v=!0;break e;default:v=!1}}v&&(a.flags|=4)}a.ref!==null&&(a.flags|=512,a.flags|=2097152)}return Nt(a),null;case 6:if(n&&a.stateNode!=null)vc(n,a,n.memoizedProps,v);else{if(typeof v!="string"&&a.stateNode===null)throw Error(r(166));if(p=yi(io.current),yi(Dn.current),sa(a)){if(v=a.stateNode,p=a.memoizedProps,v[ln]=a,(E=v.nodeValue!==p)&&(n=Qt,n!==null))switch(n.tag){case 3:ce(v.nodeValue,p,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&ce(v.nodeValue,p,(n.mode&1)!==0)}E&&(a.flags|=4)}else v=(p.nodeType===9?p:p.ownerDocument).createTextNode(v),v[ln]=a,a.stateNode=v}return Nt(a),null;case 13:if(tt(st),v=a.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(nt&&en!==null&&(a.mode&1)!==0&&(a.flags&128)===0)xu(),as(),a.flags|=98560,E=!1;else if(E=sa(a),v!==null&&v.dehydrated!==null){if(n===null){if(!E)throw Error(r(318));if(E=a.memoizedState,E=E!==null?E.dehydrated:null,!E)throw Error(r(317));E[ln]=a}else as(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Nt(a),E=!1}else xn!==null&&(Ql(xn),xn=null),E=!0;if(!E)return a.flags&65536?a:null}return(a.flags&128)!==0?(a.lanes=p,a):(v=v!==null,v!==(n!==null&&n.memoizedState!==null)&&v&&(a.child.flags|=8192,(a.mode&1)!==0&&(n===null||(st.current&1)!==0?yt===0&&(yt=3):nu())),a.updateQueue!==null&&(a.flags|=4),Nt(a),null);case 4:return hs(),Fl(n,a),n===null&&Nr(a.stateNode.containerInfo),Nt(a),null;case 10:return gl(a.type._context),Nt(a),null;case 17:return Ut(a.type)&&ea(),Nt(a),null;case 19:if(tt(st),E=a.memoizedState,E===null)return Nt(a),null;if(v=(a.flags&128)!==0,P=E.rendering,P===null)if(v)uo(E,!1);else{if(yt!==0||n!==null&&(n.flags&128)!==0)for(n=a.child;n!==null;){if(P=ha(n),P!==null){for(a.flags|=128,uo(E,!1),v=P.updateQueue,v!==null&&(a.updateQueue=v,a.flags|=4),a.subtreeFlags=0,v=p,p=a.child;p!==null;)E=p,n=v,E.flags&=14680066,P=E.alternate,P===null?(E.childLanes=0,E.lanes=n,E.child=null,E.subtreeFlags=0,E.memoizedProps=null,E.memoizedState=null,E.updateQueue=null,E.dependencies=null,E.stateNode=null):(E.childLanes=P.childLanes,E.lanes=P.lanes,E.child=P.child,E.subtreeFlags=0,E.deletions=null,E.memoizedProps=P.memoizedProps,E.memoizedState=P.memoizedState,E.updateQueue=P.updateQueue,E.type=P.type,n=P.dependencies,E.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),p=p.sibling;return Qe(st,st.current&1|2),a.child}n=n.sibling}E.tail!==null&&rt()>gs&&(a.flags|=128,v=!0,uo(E,!1),a.lanes=4194304)}else{if(!v)if(n=ha(P),n!==null){if(a.flags|=128,v=!0,p=n.updateQueue,p!==null&&(a.updateQueue=p,a.flags|=4),uo(E,!0),E.tail===null&&E.tailMode==="hidden"&&!P.alternate&&!nt)return Nt(a),null}else 2*rt()-E.renderingStartTime>gs&&p!==1073741824&&(a.flags|=128,v=!0,uo(E,!1),a.lanes=4194304);E.isBackwards?(P.sibling=a.child,a.child=P):(p=E.last,p!==null?p.sibling=P:a.child=P,E.last=P)}return E.tail!==null?(a=E.tail,E.rendering=a,E.tail=a.sibling,E.renderingStartTime=rt(),a.sibling=null,p=st.current,Qe(st,v?p&1|2:p&1),a):(Nt(a),null);case 22:case 23:return tu(),v=a.memoizedState!==null,n!==null&&n.memoizedState!==null!==v&&(a.flags|=8192),v&&(a.mode&1)!==0?(tn&1073741824)!==0&&(Nt(a),a.subtreeFlags&6&&(a.flags|=8192)):Nt(a),null;case 24:return null;case 25:return null}throw Error(r(156,a.tag))}function Ph(n,a){switch(cl(a),a.tag){case 1:return Ut(a.type)&&ea(),n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 3:return hs(),tt(jt),tt(Pt),El(),n=a.flags,(n&65536)!==0&&(n&128)===0?(a.flags=n&-65537|128,a):null;case 5:return xl(a),null;case 13:if(tt(st),n=a.memoizedState,n!==null&&n.dehydrated!==null){if(a.alternate===null)throw Error(r(340));as()}return n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 19:return tt(st),null;case 4:return hs(),null;case 10:return gl(a.type._context),null;case 22:case 23:return tu(),null;case 24:return null;default:return null}}var xa=!1,At=!1,Lh=typeof WeakSet=="function"?WeakSet:Set,Pe=null;function fs(n,a){var p=n.ref;if(p!==null)if(typeof p=="function")try{p(null)}catch(v){ct(n,a,v)}else p.current=null}function Hl(n,a,p){try{p()}catch(v){ct(n,a,v)}}var _c=!1;function Nh(n,a){if(Ce=si,n=Zs(),Ws(n)){if("selectionStart"in n)var p={start:n.selectionStart,end:n.selectionEnd};else e:{p=(p=n.ownerDocument)&&p.defaultView||window;var v=p.getSelection&&p.getSelection();if(v&&v.rangeCount!==0){p=v.anchorNode;var b=v.anchorOffset,E=v.focusNode;v=v.focusOffset;try{p.nodeType,E.nodeType}catch{p=null;break e}var P=0,O=-1,Z=-1,he=0,be=0,ke=n,xe=null;t:for(;;){for(var Te;ke!==p||b!==0&&ke.nodeType!==3||(O=P+b),ke!==E||v!==0&&ke.nodeType!==3||(Z=P+v),ke.nodeType===3&&(P+=ke.nodeValue.length),(Te=ke.firstChild)!==null;)xe=ke,ke=Te;for(;;){if(ke===n)break t;if(xe===p&&++he===b&&(O=P),xe===E&&++be===v&&(Z=P),(Te=ke.nextSibling)!==null)break;ke=xe,xe=ke.parentNode}ke=Te}p=O===-1||Z===-1?null:{start:O,end:Z}}else p=null}p=p||{start:0,end:0}}else p=null;for($e={focusedElem:n,selectionRange:p},si=!1,Pe=a;Pe!==null;)if(a=Pe,n=a.child,(a.subtreeFlags&1028)!==0&&n!==null)n.return=a,Pe=n;else for(;Pe!==null;){a=Pe;try{var Le=a.alternate;if((a.flags&1024)!==0)switch(a.tag){case 0:case 11:case 15:break;case 1:if(Le!==null){var Ne=Le.memoizedProps,ht=Le.memoizedState,oe=a.stateNode,J=oe.getSnapshotBeforeUpdate(a.elementType===a.type?Ne:bn(a.type,Ne),ht);oe.__reactInternalSnapshotBeforeUpdate=J}break;case 3:var ue=a.stateNode.containerInfo;ue.nodeType===1?ue.textContent="":ue.nodeType===9&&ue.documentElement&&ue.removeChild(ue.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(Se){ct(a,a.return,Se)}if(n=a.sibling,n!==null){n.return=a.return,Pe=n;break}Pe=a.return}return Le=_c,_c=!1,Le}function co(n,a,p){var v=a.updateQueue;if(v=v!==null?v.lastEffect:null,v!==null){var b=v=v.next;do{if((b.tag&n)===n){var E=b.destroy;b.destroy=void 0,E!==void 0&&Hl(a,p,E)}b=b.next}while(b!==v)}}function ba(n,a){if(a=a.updateQueue,a=a!==null?a.lastEffect:null,a!==null){var p=a=a.next;do{if((p.tag&n)===n){var v=p.create;p.destroy=v()}p=p.next}while(p!==a)}}function Kl(n){var a=n.ref;if(a!==null){var p=n.stateNode;switch(n.tag){case 5:n=p;break;default:n=p}typeof a=="function"?a(n):a.current=n}}function wc(n){var a=n.alternate;a!==null&&(n.alternate=null,wc(a)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(a=n.stateNode,a!==null&&(delete a[ln],delete a[Ir],delete a[Br],delete a[sl],delete a[ol])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function xc(n){return n.tag===5||n.tag===3||n.tag===4}function bc(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||xc(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Vl(n,a,p){var v=n.tag;if(v===5||v===6)n=n.stateNode,a?p.nodeType===8?p.parentNode.insertBefore(n,a):p.insertBefore(n,a):(p.nodeType===8?(a=p.parentNode,a.insertBefore(n,p)):(a=p,a.appendChild(n)),p=p._reactRootContainer,p!=null||a.onclick!==null||(a.onclick=ve));else if(v!==4&&(n=n.child,n!==null))for(Vl(n,a,p),n=n.sibling;n!==null;)Vl(n,a,p),n=n.sibling}function Zl(n,a,p){var v=n.tag;if(v===5||v===6)n=n.stateNode,a?p.insertBefore(n,a):p.appendChild(n);else if(v!==4&&(n=n.child,n!==null))for(Zl(n,a,p),n=n.sibling;n!==null;)Zl(n,a,p),n=n.sibling}var bt=null,En=!1;function jr(n,a,p){for(p=p.child;p!==null;)Ec(n,a,p),p=p.sibling}function Ec(n,a,p){if(Vt&&typeof Vt.onCommitFiberUnmount=="function")try{Vt.onCommitFiberUnmount(Qr,p)}catch{}switch(p.tag){case 5:At||fs(p,a);case 6:var v=bt,b=En;bt=null,jr(n,a,p),bt=v,En=b,bt!==null&&(En?(n=bt,p=p.stateNode,n.nodeType===8?n.parentNode.removeChild(p):n.removeChild(p)):bt.removeChild(p.stateNode));break;case 18:bt!==null&&(En?(n=bt,p=p.stateNode,n.nodeType===8?eo(n.parentNode,p):n.nodeType===1&&eo(n,p),qt(n)):eo(bt,p.stateNode));break;case 4:v=bt,b=En,bt=p.stateNode.containerInfo,En=!0,jr(n,a,p),bt=v,En=b;break;case 0:case 11:case 14:case 15:if(!At&&(v=p.updateQueue,v!==null&&(v=v.lastEffect,v!==null))){b=v=v.next;do{var E=b,P=E.destroy;E=E.tag,P!==void 0&&((E&2)!==0||(E&4)!==0)&&Hl(p,a,P),b=b.next}while(b!==v)}jr(n,a,p);break;case 1:if(!At&&(fs(p,a),v=p.stateNode,typeof v.componentWillUnmount=="function"))try{v.props=p.memoizedProps,v.state=p.memoizedState,v.componentWillUnmount()}catch(O){ct(p,a,O)}jr(n,a,p);break;case 21:jr(n,a,p);break;case 22:p.mode&1?(At=(v=At)||p.memoizedState!==null,jr(n,a,p),At=v):jr(n,a,p);break;default:jr(n,a,p)}}function kc(n){var a=n.updateQueue;if(a!==null){n.updateQueue=null;var p=n.stateNode;p===null&&(p=n.stateNode=new Lh),a.forEach(function(v){var b=jh.bind(null,n,v);p.has(v)||(p.add(v),v.then(b,b))})}}function kn(n,a){var p=a.deletions;if(p!==null)for(var v=0;v<p.length;v++){var b=p[v];try{var E=n,P=a,O=P;e:for(;O!==null;){switch(O.tag){case 5:bt=O.stateNode,En=!1;break e;case 3:bt=O.stateNode.containerInfo,En=!0;break e;case 4:bt=O.stateNode.containerInfo,En=!0;break e}O=O.return}if(bt===null)throw Error(r(160));Ec(E,P,b),bt=null,En=!1;var Z=b.alternate;Z!==null&&(Z.return=null),b.return=null}catch(he){ct(b,a,he)}}if(a.subtreeFlags&12854)for(a=a.child;a!==null;)Sc(a,n),a=a.sibling}function Sc(n,a){var p=n.alternate,v=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(kn(a,n),zn(n),v&4){try{co(3,n,n.return),ba(3,n)}catch(Ne){ct(n,n.return,Ne)}try{co(5,n,n.return)}catch(Ne){ct(n,n.return,Ne)}}break;case 1:kn(a,n),zn(n),v&512&&p!==null&&fs(p,p.return);break;case 5:if(kn(a,n),zn(n),v&512&&p!==null&&fs(p,p.return),n.flags&32){var b=n.stateNode;try{dr(b,"")}catch(Ne){ct(n,n.return,Ne)}}if(v&4&&(b=n.stateNode,b!=null)){var E=n.memoizedProps,P=p!==null?p.memoizedProps:E,O=n.type,Z=n.updateQueue;if(n.updateQueue=null,Z!==null)try{O==="input"&&E.type==="radio"&&E.name!=null&&cr(b,E),jn(O,P);var he=jn(O,E);for(P=0;P<Z.length;P+=2){var be=Z[P],ke=Z[P+1];be==="style"?Ti(b,ke):be==="dangerouslySetInnerHTML"?vo(b,ke):be==="children"?dr(b,ke):se(b,be,ke,he)}switch(O){case"input":Wr(b,E);break;case"textarea":go(b,E);break;case"select":var xe=b._wrapperState.wasMultiple;b._wrapperState.wasMultiple=!!E.multiple;var Te=E.value;Te!=null?Rn(b,!!E.multiple,Te,!1):xe!==!!E.multiple&&(E.defaultValue!=null?Rn(b,!!E.multiple,E.defaultValue,!0):Rn(b,!!E.multiple,E.multiple?[]:"",!1))}b[Ir]=E}catch(Ne){ct(n,n.return,Ne)}}break;case 6:if(kn(a,n),zn(n),v&4){if(n.stateNode===null)throw Error(r(162));b=n.stateNode,E=n.memoizedProps;try{b.nodeValue=E}catch(Ne){ct(n,n.return,Ne)}}break;case 3:if(kn(a,n),zn(n),v&4&&p!==null&&p.memoizedState.isDehydrated)try{qt(a.containerInfo)}catch(Ne){ct(n,n.return,Ne)}break;case 4:kn(a,n),zn(n);break;case 13:kn(a,n),zn(n),b=n.child,b.flags&8192&&(E=b.memoizedState!==null,b.stateNode.isHidden=E,!E||b.alternate!==null&&b.alternate.memoizedState!==null||(Gl=rt())),v&4&&kc(n);break;case 22:if(be=p!==null&&p.memoizedState!==null,n.mode&1?(At=(he=At)||be,kn(a,n),At=he):kn(a,n),zn(n),v&8192){if(he=n.memoizedState!==null,(n.stateNode.isHidden=he)&&!be&&(n.mode&1)!==0)for(Pe=n,be=n.child;be!==null;){for(ke=Pe=be;Pe!==null;){switch(xe=Pe,Te=xe.child,xe.tag){case 0:case 11:case 14:case 15:co(4,xe,xe.return);break;case 1:fs(xe,xe.return);var Le=xe.stateNode;if(typeof Le.componentWillUnmount=="function"){v=xe,p=xe.return;try{a=v,Le.props=a.memoizedProps,Le.state=a.memoizedState,Le.componentWillUnmount()}catch(Ne){ct(v,p,Ne)}}break;case 5:fs(xe,xe.return);break;case 22:if(xe.memoizedState!==null){Tc(ke);continue}}Te!==null?(Te.return=xe,Pe=Te):Tc(ke)}be=be.sibling}e:for(be=null,ke=n;;){if(ke.tag===5){if(be===null){be=ke;try{b=ke.stateNode,he?(E=b.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none"):(O=ke.stateNode,Z=ke.memoizedProps.style,P=Z!=null&&Z.hasOwnProperty("display")?Z.display:null,O.style.display=ws("display",P))}catch(Ne){ct(n,n.return,Ne)}}}else if(ke.tag===6){if(be===null)try{ke.stateNode.nodeValue=he?"":ke.memoizedProps}catch(Ne){ct(n,n.return,Ne)}}else if((ke.tag!==22&&ke.tag!==23||ke.memoizedState===null||ke===n)&&ke.child!==null){ke.child.return=ke,ke=ke.child;continue}if(ke===n)break e;for(;ke.sibling===null;){if(ke.return===null||ke.return===n)break e;be===ke&&(be=null),ke=ke.return}be===ke&&(be=null),ke.sibling.return=ke.return,ke=ke.sibling}}break;case 19:kn(a,n),zn(n),v&4&&kc(n);break;case 21:break;default:kn(a,n),zn(n)}}function zn(n){var a=n.flags;if(a&2){try{e:{for(var p=n.return;p!==null;){if(xc(p)){var v=p;break e}p=p.return}throw Error(r(160))}switch(v.tag){case 5:var b=v.stateNode;v.flags&32&&(dr(b,""),v.flags&=-33);var E=bc(n);Zl(n,E,b);break;case 3:case 4:var P=v.stateNode.containerInfo,O=bc(n);Vl(n,O,P);break;default:throw Error(r(161))}}catch(Z){ct(n,n.return,Z)}n.flags&=-3}a&4096&&(n.flags&=-4097)}function Ah(n,a,p){Pe=n,Cc(n)}function Cc(n,a,p){for(var v=(n.mode&1)!==0;Pe!==null;){var b=Pe,E=b.child;if(b.tag===22&&v){var P=b.memoizedState!==null||xa;if(!P){var O=b.alternate,Z=O!==null&&O.memoizedState!==null||At;O=xa;var he=At;if(xa=P,(At=Z)&&!he)for(Pe=b;Pe!==null;)P=Pe,Z=P.child,P.tag===22&&P.memoizedState!==null?Pc(b):Z!==null?(Z.return=P,Pe=Z):Pc(b);for(;E!==null;)Pe=E,Cc(E),E=E.sibling;Pe=b,xa=O,At=he}Rc(n)}else(b.subtreeFlags&8772)!==0&&E!==null?(E.return=b,Pe=E):Rc(n)}}function Rc(n){for(;Pe!==null;){var a=Pe;if((a.flags&8772)!==0){var p=a.alternate;try{if((a.flags&8772)!==0)switch(a.tag){case 0:case 11:case 15:At||ba(5,a);break;case 1:var v=a.stateNode;if(a.flags&4&&!At)if(p===null)v.componentDidMount();else{var b=a.elementType===a.type?p.memoizedProps:bn(a.type,p.memoizedProps);v.componentDidUpdate(b,p.memoizedState,v.__reactInternalSnapshotBeforeUpdate)}var E=a.updateQueue;E!==null&&Tu(a,E,v);break;case 3:var P=a.updateQueue;if(P!==null){if(p=null,a.child!==null)switch(a.child.tag){case 5:p=a.child.stateNode;break;case 1:p=a.child.stateNode}Tu(a,P,p)}break;case 5:var O=a.stateNode;if(p===null&&a.flags&4){p=O;var Z=a.memoizedProps;switch(a.type){case"button":case"input":case"select":case"textarea":Z.autoFocus&&p.focus();break;case"img":Z.src&&(p.src=Z.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(a.memoizedState===null){var he=a.alternate;if(he!==null){var be=he.memoizedState;if(be!==null){var ke=be.dehydrated;ke!==null&&qt(ke)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}At||a.flags&512&&Kl(a)}catch(xe){ct(a,a.return,xe)}}if(a===n){Pe=null;break}if(p=a.sibling,p!==null){p.return=a.return,Pe=p;break}Pe=a.return}}function Tc(n){for(;Pe!==null;){var a=Pe;if(a===n){Pe=null;break}var p=a.sibling;if(p!==null){p.return=a.return,Pe=p;break}Pe=a.return}}function Pc(n){for(;Pe!==null;){var a=Pe;try{switch(a.tag){case 0:case 11:case 15:var p=a.return;try{ba(4,a)}catch(Z){ct(a,p,Z)}break;case 1:var v=a.stateNode;if(typeof v.componentDidMount=="function"){var b=a.return;try{v.componentDidMount()}catch(Z){ct(a,b,Z)}}var E=a.return;try{Kl(a)}catch(Z){ct(a,E,Z)}break;case 5:var P=a.return;try{Kl(a)}catch(Z){ct(a,P,Z)}}}catch(Z){ct(a,a.return,Z)}if(a===n){Pe=null;break}var O=a.sibling;if(O!==null){O.return=a.return,Pe=O;break}Pe=a.return}}var Ih=Math.ceil,Ea=ye.ReactCurrentDispatcher,Wl=ye.ReactCurrentOwner,fn=ye.ReactCurrentBatchConfig,We=0,wt=null,ft=null,Et=0,tn=0,ps=Mr(0),yt=0,ho=null,_i=0,ka=0,ql=0,fo=null,Ht=null,Gl=0,gs=1/0,lr=null,Sa=!1,Yl=null,Ur=null,Ca=!1,Fr=null,Ra=0,po=0,Jl=null,Ta=-1,Pa=0;function Dt(){return(We&6)!==0?rt():Ta!==-1?Ta:Ta=rt()}function Hr(n){return(n.mode&1)===0?1:(We&2)!==0&&Et!==0?Et&-Et:gh.transition!==null?(Pa===0&&(Pa=No()),Pa):(n=Ze,n!==0||(n=window.event,n=n===void 0?16:Ve(n.type)),n)}function Sn(n,a,p,v){if(50<po)throw po=0,Jl=null,Error(r(185));Zt(n,p,v),((We&2)===0||n!==wt)&&(n===wt&&((We&2)===0&&(ka|=p),yt===4&&Kr(n,Et)),Kt(n,v),p===1&&We===0&&(a.mode&1)===0&&(gs=rt()+500,na&&Dr()))}function Kt(n,a){var p=n.callbackNode;Mi(n,a);var v=Xe(n,n===wt?Et:0);if(v===0)p!==null&&Ts(p),n.callbackNode=null,n.callbackPriority=0;else if(a=v&-v,n.callbackPriority!==a){if(p!=null&&Ts(p),a===1)n.tag===0?mh(Nc.bind(null,n)):gu(Nc.bind(null,n)),Tt(function(){(We&6)===0&&Dr()}),p=null;else{switch(vr(v)){case 1:p=Ps;break;case 4:p=Lo;break;case 16:p=Ii;break;case 536870912:p=pr;break;default:p=Ii}p=zc(p,Lc.bind(null,n))}n.callbackPriority=a,n.callbackNode=p}}function Lc(n,a){if(Ta=-1,Pa=0,(We&6)!==0)throw Error(r(327));var p=n.callbackNode;if(ys()&&n.callbackNode!==p)return null;var v=Xe(n,n===wt?Et:0);if(v===0)return null;if((v&30)!==0||(v&n.expiredLanes)!==0||a)a=La(n,v);else{a=v;var b=We;We|=2;var E=Ic();(wt!==n||Et!==a)&&(lr=null,gs=rt()+500,xi(n,a));do try{$h();break}catch(O){Ac(n,O)}while(!0);ml(),Ea.current=E,We=b,ft!==null?a=0:(wt=null,Et=0,a=yt)}if(a!==0){if(a===2&&(b=Ct(n),b!==0&&(v=b,a=Xl(n,b))),a===1)throw p=ho,xi(n,0),Kr(n,v),Kt(n,rt()),p;if(a===6)Kr(n,v);else{if(b=n.current.alternate,(v&30)===0&&!Bh(b)&&(a=La(n,v),a===2&&(E=Ct(n),E!==0&&(v=E,a=Xl(n,E))),a===1))throw p=ho,xi(n,0),Kr(n,v),Kt(n,rt()),p;switch(n.finishedWork=b,n.finishedLanes=v,a){case 0:case 1:throw Error(r(345));case 2:bi(n,Ht,lr);break;case 3:if(Kr(n,v),(v&130023424)===v&&(a=Gl+500-rt(),10<a)){if(Xe(n,0)!==0)break;if(b=n.suspendedLanes,(b&v)!==v){Dt(),n.pingedLanes|=n.suspendedLanes&b;break}n.timeoutHandle=mt(bi.bind(null,n,Ht,lr),a);break}bi(n,Ht,lr);break;case 4:if(Kr(n,v),(v&4194240)===v)break;for(a=n.eventTimes,b=-1;0<v;){var P=31-Fe(v);E=1<<P,P=a[P],P>b&&(b=P),v&=~E}if(v=b,v=rt()-v,v=(120>v?120:480>v?480:1080>v?1080:1920>v?1920:3e3>v?3e3:4320>v?4320:1960*Ih(v/1960))-v,10<v){n.timeoutHandle=mt(bi.bind(null,n,Ht,lr),v);break}bi(n,Ht,lr);break;case 5:bi(n,Ht,lr);break;default:throw Error(r(329))}}}return Kt(n,rt()),n.callbackNode===p?Lc.bind(null,n):null}function Xl(n,a){var p=fo;return n.current.memoizedState.isDehydrated&&(xi(n,a).flags|=256),n=La(n,a),n!==2&&(a=Ht,Ht=p,a!==null&&Ql(a)),n}function Ql(n){Ht===null?Ht=n:Ht.push.apply(Ht,n)}function Bh(n){for(var a=n;;){if(a.flags&16384){var p=a.updateQueue;if(p!==null&&(p=p.stores,p!==null))for(var v=0;v<p.length;v++){var b=p[v],E=b.getSnapshot;b=b.value;try{if(!Jt(E(),b))return!1}catch{return!1}}}if(p=a.child,a.subtreeFlags&16384&&p!==null)p.return=a,a=p;else{if(a===n)break;for(;a.sibling===null;){if(a.return===null||a.return===n)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Kr(n,a){for(a&=~ql,a&=~ka,n.suspendedLanes|=a,n.pingedLanes&=~a,n=n.expirationTimes;0<a;){var p=31-Fe(a),v=1<<p;n[p]=-1,a&=~v}}function Nc(n){if((We&6)!==0)throw Error(r(327));ys();var a=Xe(n,0);if((a&1)===0)return Kt(n,rt()),null;var p=La(n,a);if(n.tag!==0&&p===2){var v=Ct(n);v!==0&&(a=v,p=Xl(n,v))}if(p===1)throw p=ho,xi(n,0),Kr(n,a),Kt(n,rt()),p;if(p===6)throw Error(r(345));return n.finishedWork=n.current.alternate,n.finishedLanes=a,bi(n,Ht,lr),Kt(n,rt()),null}function eu(n,a){var p=We;We|=1;try{return n(a)}finally{We=p,We===0&&(gs=rt()+500,na&&Dr())}}function wi(n){Fr!==null&&Fr.tag===0&&(We&6)===0&&ys();var a=We;We|=1;var p=fn.transition,v=Ze;try{if(fn.transition=null,Ze=1,n)return n()}finally{Ze=v,fn.transition=p,We=a,(We&6)===0&&Dr()}}function tu(){tn=ps.current,tt(ps)}function xi(n,a){n.finishedWork=null,n.finishedLanes=0;var p=n.timeoutHandle;if(p!==-1&&(n.timeoutHandle=-1,dt(p)),ft!==null)for(p=ft.return;p!==null;){var v=p;switch(cl(v),v.tag){case 1:v=v.type.childContextTypes,v!=null&&ea();break;case 3:hs(),tt(jt),tt(Pt),El();break;case 5:xl(v);break;case 4:hs();break;case 13:tt(st);break;case 19:tt(st);break;case 10:gl(v.type._context);break;case 22:case 23:tu()}p=p.return}if(wt=n,ft=n=Vr(n.current,null),Et=tn=a,yt=0,ho=null,ql=ka=_i=0,Ht=fo=null,gi!==null){for(a=0;a<gi.length;a++)if(p=gi[a],v=p.interleaved,v!==null){p.interleaved=null;var b=v.next,E=p.pending;if(E!==null){var P=E.next;E.next=b,v.next=P}p.pending=v}gi=null}return n}function Ac(n,a){do{var p=ft;try{if(ml(),da.current=ga,fa){for(var v=ot.memoizedState;v!==null;){var b=v.queue;b!==null&&(b.pending=null),v=v.next}fa=!1}if(vi=0,_t=gt=ot=null,so=!1,oo=0,Wl.current=null,p===null||p.return===null){yt=1,ho=a,ft=null;break}e:{var E=n,P=p.return,O=p,Z=a;if(a=Et,O.flags|=32768,Z!==null&&typeof Z=="object"&&typeof Z.then=="function"){var he=Z,be=O,ke=be.tag;if((be.mode&1)===0&&(ke===0||ke===11||ke===15)){var xe=be.alternate;xe?(be.updateQueue=xe.updateQueue,be.memoizedState=xe.memoizedState,be.lanes=xe.lanes):(be.updateQueue=null,be.memoizedState=null)}var Te=rc(P);if(Te!==null){Te.flags&=-257,ic(Te,P,O,E,a),Te.mode&1&&nc(E,he,a),a=Te,Z=he;var Le=a.updateQueue;if(Le===null){var Ne=new Set;Ne.add(Z),a.updateQueue=Ne}else Le.add(Z);break e}else{if((a&1)===0){nc(E,he,a),nu();break e}Z=Error(r(426))}}else if(nt&&O.mode&1){var ht=rc(P);if(ht!==null){(ht.flags&65536)===0&&(ht.flags|=256),ic(ht,P,O,E,a),fl(ds(Z,O));break e}}E=Z=ds(Z,O),yt!==4&&(yt=2),fo===null?fo=[E]:fo.push(E),E=P;do{switch(E.tag){case 3:E.flags|=65536,a&=-a,E.lanes|=a;var oe=ec(E,Z,a);Ru(E,oe);break e;case 1:O=Z;var J=E.type,ue=E.stateNode;if((E.flags&128)===0&&(typeof J.getDerivedStateFromError=="function"||ue!==null&&typeof ue.componentDidCatch=="function"&&(Ur===null||!Ur.has(ue)))){E.flags|=65536,a&=-a,E.lanes|=a;var Se=tc(E,O,a);Ru(E,Se);break e}}E=E.return}while(E!==null)}Mc(p)}catch(Be){a=Be,ft===p&&p!==null&&(ft=p=p.return);continue}break}while(!0)}function Ic(){var n=Ea.current;return Ea.current=ga,n===null?ga:n}function nu(){(yt===0||yt===3||yt===2)&&(yt=4),wt===null||(_i&268435455)===0&&(ka&268435455)===0||Kr(wt,Et)}function La(n,a){var p=We;We|=2;var v=Ic();(wt!==n||Et!==a)&&(lr=null,xi(n,a));do try{Mh();break}catch(b){Ac(n,b)}while(!0);if(ml(),We=p,Ea.current=v,ft!==null)throw Error(r(261));return wt=null,Et=0,yt}function Mh(){for(;ft!==null;)Bc(ft)}function $h(){for(;ft!==null&&!Ha();)Bc(ft)}function Bc(n){var a=Oc(n.alternate,n,tn);n.memoizedProps=n.pendingProps,a===null?Mc(n):ft=a,Wl.current=null}function Mc(n){var a=n;do{var p=a.alternate;if(n=a.return,(a.flags&32768)===0){if(p=Th(p,a,tn),p!==null){ft=p;return}}else{if(p=Ph(p,a),p!==null){p.flags&=32767,ft=p;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{yt=6,ft=null;return}}if(a=a.sibling,a!==null){ft=a;return}ft=a=n}while(a!==null);yt===0&&(yt=5)}function bi(n,a,p){var v=Ze,b=fn.transition;try{fn.transition=null,Ze=1,Dh(n,a,p,v)}finally{fn.transition=b,Ze=v}return null}function Dh(n,a,p,v){do ys();while(Fr!==null);if((We&6)!==0)throw Error(r(327));p=n.finishedWork;var b=n.finishedLanes;if(p===null)return null;if(n.finishedWork=null,n.finishedLanes=0,p===n.current)throw Error(r(177));n.callbackNode=null,n.callbackPriority=0;var E=p.lanes|p.childLanes;if(lt(n,E),n===wt&&(ft=wt=null,Et=0),(p.subtreeFlags&2064)===0&&(p.flags&2064)===0||Ca||(Ca=!0,zc(Ii,function(){return ys(),null})),E=(p.flags&15990)!==0,(p.subtreeFlags&15990)!==0||E){E=fn.transition,fn.transition=null;var P=Ze;Ze=1;var O=We;We|=4,Wl.current=null,Nh(n,p),Sc(p,n),on($e),si=!!Ce,$e=Ce=null,n.current=p,Ah(p),Ai(),We=O,Ze=P,fn.transition=E}else n.current=p;if(Ca&&(Ca=!1,Fr=n,Ra=b),E=n.pendingLanes,E===0&&(Ur=null),ei(p.stateNode),Kt(n,rt()),a!==null)for(v=n.onRecoverableError,p=0;p<a.length;p++)b=a[p],v(b.value,{componentStack:b.stack,digest:b.digest});if(Sa)throw Sa=!1,n=Yl,Yl=null,n;return(Ra&1)!==0&&n.tag!==0&&ys(),E=n.pendingLanes,(E&1)!==0?n===Jl?po++:(po=0,Jl=n):po=0,Dr(),null}function ys(){if(Fr!==null){var n=vr(Ra),a=fn.transition,p=Ze;try{if(fn.transition=null,Ze=16>n?16:n,Fr===null)var v=!1;else{if(n=Fr,Fr=null,Ra=0,(We&6)!==0)throw Error(r(331));var b=We;for(We|=4,Pe=n.current;Pe!==null;){var E=Pe,P=E.child;if((Pe.flags&16)!==0){var O=E.deletions;if(O!==null){for(var Z=0;Z<O.length;Z++){var he=O[Z];for(Pe=he;Pe!==null;){var be=Pe;switch(be.tag){case 0:case 11:case 15:co(8,be,E)}var ke=be.child;if(ke!==null)ke.return=be,Pe=ke;else for(;Pe!==null;){be=Pe;var xe=be.sibling,Te=be.return;if(wc(be),be===he){Pe=null;break}if(xe!==null){xe.return=Te,Pe=xe;break}Pe=Te}}}var Le=E.alternate;if(Le!==null){var Ne=Le.child;if(Ne!==null){Le.child=null;do{var ht=Ne.sibling;Ne.sibling=null,Ne=ht}while(Ne!==null)}}Pe=E}}if((E.subtreeFlags&2064)!==0&&P!==null)P.return=E,Pe=P;else e:for(;Pe!==null;){if(E=Pe,(E.flags&2048)!==0)switch(E.tag){case 0:case 11:case 15:co(9,E,E.return)}var oe=E.sibling;if(oe!==null){oe.return=E.return,Pe=oe;break e}Pe=E.return}}var J=n.current;for(Pe=J;Pe!==null;){P=Pe;var ue=P.child;if((P.subtreeFlags&2064)!==0&&ue!==null)ue.return=P,Pe=ue;else e:for(P=J;Pe!==null;){if(O=Pe,(O.flags&2048)!==0)try{switch(O.tag){case 0:case 11:case 15:ba(9,O)}}catch(Be){ct(O,O.return,Be)}if(O===P){Pe=null;break e}var Se=O.sibling;if(Se!==null){Se.return=O.return,Pe=Se;break e}Pe=O.return}}if(We=b,Dr(),Vt&&typeof Vt.onPostCommitFiberRoot=="function")try{Vt.onPostCommitFiberRoot(Qr,n)}catch{}v=!0}return v}finally{Ze=p,fn.transition=a}}return!1}function $c(n,a,p){a=ds(p,a),a=ec(n,a,1),n=zr(n,a,1),a=Dt(),n!==null&&(Zt(n,1,a),Kt(n,a))}function ct(n,a,p){if(n.tag===3)$c(n,n,p);else for(;a!==null;){if(a.tag===3){$c(a,n,p);break}else if(a.tag===1){var v=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof v.componentDidCatch=="function"&&(Ur===null||!Ur.has(v))){n=ds(p,n),n=tc(a,n,1),a=zr(a,n,1),n=Dt(),a!==null&&(Zt(a,1,n),Kt(a,n));break}}a=a.return}}function Oh(n,a,p){var v=n.pingCache;v!==null&&v.delete(a),a=Dt(),n.pingedLanes|=n.suspendedLanes&p,wt===n&&(Et&p)===p&&(yt===4||yt===3&&(Et&130023424)===Et&&500>rt()-Gl?xi(n,0):ql|=p),Kt(n,a)}function Dc(n,a){a===0&&((n.mode&1)===0?a=1:(a=gr,gr<<=1,(gr&130023424)===0&&(gr=4194304)));var p=Dt();n=sr(n,a),n!==null&&(Zt(n,a,p),Kt(n,p))}function zh(n){var a=n.memoizedState,p=0;a!==null&&(p=a.retryLane),Dc(n,p)}function jh(n,a){var p=0;switch(n.tag){case 13:var v=n.stateNode,b=n.memoizedState;b!==null&&(p=b.retryLane);break;case 19:v=n.stateNode;break;default:throw Error(r(314))}v!==null&&v.delete(a),Dc(n,p)}var Oc;Oc=function(n,a,p){if(n!==null)if(n.memoizedProps!==a.pendingProps||jt.current)Ft=!0;else{if((n.lanes&p)===0&&(a.flags&128)===0)return Ft=!1,Rh(n,a,p);Ft=(n.flags&131072)!==0}else Ft=!1,nt&&(a.flags&1048576)!==0&&yu(a,ia,a.index);switch(a.lanes=0,a.tag){case 2:var v=a.type;wa(n,a),n=a.pendingProps;var b=is(a,Pt.current);cs(a,p),b=Cl(null,a,v,n,b,p);var E=Rl();return a.flags|=1,typeof b=="object"&&b!==null&&typeof b.render=="function"&&b.$$typeof===void 0?(a.tag=1,a.memoizedState=null,a.updateQueue=null,Ut(v)?(E=!0,ta(a)):E=!1,a.memoizedState=b.state!==null&&b.state!==void 0?b.state:null,_l(a),b.updater=ya,a.stateNode=b,b._reactInternals=a,Il(a,v,n,p),a=Dl(null,a,v,!0,E,p)):(a.tag=0,nt&&E&&ul(a),$t(null,a,b,p),a=a.child),a;case 16:v=a.elementType;e:{switch(wa(n,a),n=a.pendingProps,b=v._init,v=b(v._payload),a.type=v,b=a.tag=Fh(v),n=bn(v,n),b){case 0:a=$l(null,a,v,n,p);break e;case 1:a=cc(null,a,v,n,p);break e;case 11:a=sc(null,a,v,n,p);break e;case 14:a=oc(null,a,v,bn(v.type,n),p);break e}throw Error(r(306,v,""))}return a;case 0:return v=a.type,b=a.pendingProps,b=a.elementType===v?b:bn(v,b),$l(n,a,v,b,p);case 1:return v=a.type,b=a.pendingProps,b=a.elementType===v?b:bn(v,b),cc(n,a,v,b,p);case 3:e:{if(hc(a),n===null)throw Error(r(387));v=a.pendingProps,E=a.memoizedState,b=E.element,Cu(n,a),ca(a,v,null,p);var P=a.memoizedState;if(v=P.element,E.isDehydrated)if(E={element:v,isDehydrated:!1,cache:P.cache,pendingSuspenseBoundaries:P.pendingSuspenseBoundaries,transitions:P.transitions},a.updateQueue.baseState=E,a.memoizedState=E,a.flags&256){b=ds(Error(r(423)),a),a=dc(n,a,v,p,b);break e}else if(v!==b){b=ds(Error(r(424)),a),a=dc(n,a,v,p,b);break e}else for(en=$n(a.stateNode.containerInfo.firstChild),Qt=a,nt=!0,xn=null,p=ku(a,null,v,p),a.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if(as(),v===b){a=ar(n,a,p);break e}$t(n,a,v,p)}a=a.child}return a;case 5:return Pu(a),n===null&&dl(a),v=a.type,b=a.pendingProps,E=n!==null?n.memoizedProps:null,P=b.children,He(v,b)?P=null:E!==null&&He(v,E)&&(a.flags|=32),uc(n,a),$t(n,a,P,p),a.child;case 6:return n===null&&dl(a),null;case 13:return fc(n,a,p);case 4:return wl(a,a.stateNode.containerInfo),v=a.pendingProps,n===null?a.child=ls(a,null,v,p):$t(n,a,v,p),a.child;case 11:return v=a.type,b=a.pendingProps,b=a.elementType===v?b:bn(v,b),sc(n,a,v,b,p);case 7:return $t(n,a,a.pendingProps,p),a.child;case 8:return $t(n,a,a.pendingProps.children,p),a.child;case 12:return $t(n,a,a.pendingProps.children,p),a.child;case 10:e:{if(v=a.type._context,b=a.pendingProps,E=a.memoizedProps,P=b.value,Qe(aa,v._currentValue),v._currentValue=P,E!==null)if(Jt(E.value,P)){if(E.children===b.children&&!jt.current){a=ar(n,a,p);break e}}else for(E=a.child,E!==null&&(E.return=a);E!==null;){var O=E.dependencies;if(O!==null){P=E.child;for(var Z=O.firstContext;Z!==null;){if(Z.context===v){if(E.tag===1){Z=or(-1,p&-p),Z.tag=2;var he=E.updateQueue;if(he!==null){he=he.shared;var be=he.pending;be===null?Z.next=Z:(Z.next=be.next,be.next=Z),he.pending=Z}}E.lanes|=p,Z=E.alternate,Z!==null&&(Z.lanes|=p),yl(E.return,p,a),O.lanes|=p;break}Z=Z.next}}else if(E.tag===10)P=E.type===a.type?null:E.child;else if(E.tag===18){if(P=E.return,P===null)throw Error(r(341));P.lanes|=p,O=P.alternate,O!==null&&(O.lanes|=p),yl(P,p,a),P=E.sibling}else P=E.child;if(P!==null)P.return=E;else for(P=E;P!==null;){if(P===a){P=null;break}if(E=P.sibling,E!==null){E.return=P.return,P=E;break}P=P.return}E=P}$t(n,a,b.children,p),a=a.child}return a;case 9:return b=a.type,v=a.pendingProps.children,cs(a,p),b=hn(b),v=v(b),a.flags|=1,$t(n,a,v,p),a.child;case 14:return v=a.type,b=bn(v,a.pendingProps),b=bn(v.type,b),oc(n,a,v,b,p);case 15:return ac(n,a,a.type,a.pendingProps,p);case 17:return v=a.type,b=a.pendingProps,b=a.elementType===v?b:bn(v,b),wa(n,a),a.tag=1,Ut(v)?(n=!0,ta(a)):n=!1,cs(a,p),Xu(a,v,b),Il(a,v,b,p),Dl(null,a,v,!0,n,p);case 19:return mc(n,a,p);case 22:return lc(n,a,p)}throw Error(r(156,a.tag))};function zc(n,a){return Po(n,a)}function Uh(n,a,p,v){this.tag=n,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=v,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function pn(n,a,p,v){return new Uh(n,a,p,v)}function ru(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Fh(n){if(typeof n=="function")return ru(n)?1:0;if(n!=null){if(n=n.$$typeof,n===K)return 11;if(n===$)return 14}return 2}function Vr(n,a){var p=n.alternate;return p===null?(p=pn(n.tag,a,n.key,n.mode),p.elementType=n.elementType,p.type=n.type,p.stateNode=n.stateNode,p.alternate=n,n.alternate=p):(p.pendingProps=a,p.type=n.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=n.flags&14680064,p.childLanes=n.childLanes,p.lanes=n.lanes,p.child=n.child,p.memoizedProps=n.memoizedProps,p.memoizedState=n.memoizedState,p.updateQueue=n.updateQueue,a=n.dependencies,p.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},p.sibling=n.sibling,p.index=n.index,p.ref=n.ref,p}function Na(n,a,p,v,b,E){var P=2;if(v=n,typeof n=="function")ru(n)&&(P=1);else if(typeof n=="string")P=5;else e:switch(n){case Q:return Ei(p.children,b,E,a);case te:P=8,b|=8;break;case le:return n=pn(12,p,a,b|2),n.elementType=le,n.lanes=E,n;case D:return n=pn(13,p,a,b),n.elementType=D,n.lanes=E,n;case Y:return n=pn(19,p,a,b),n.elementType=Y,n.lanes=E,n;case ne:return Aa(p,b,E,a);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case me:P=10;break e;case F:P=9;break e;case K:P=11;break e;case $:P=14;break e;case U:P=16,v=null;break e}throw Error(r(130,n==null?n:typeof n,""))}return a=pn(P,p,a,b),a.elementType=n,a.type=v,a.lanes=E,a}function Ei(n,a,p,v){return n=pn(7,n,v,a),n.lanes=p,n}function Aa(n,a,p,v){return n=pn(22,n,v,a),n.elementType=ne,n.lanes=p,n.stateNode={isHidden:!1},n}function iu(n,a,p){return n=pn(6,n,null,a),n.lanes=p,n}function su(n,a,p){return a=pn(4,n.children!==null?n.children:[],n.key,a),a.lanes=p,a.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},a}function Hh(n,a,p,v,b){this.tag=a,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=yr(0),this.expirationTimes=yr(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=yr(0),this.identifierPrefix=v,this.onRecoverableError=b,this.mutableSourceEagerHydrationData=null}function ou(n,a,p,v,b,E,P,O,Z){return n=new Hh(n,a,p,O,Z),a===1?(a=1,E===!0&&(a|=8)):a=0,E=pn(3,null,null,a),n.current=E,E.stateNode=n,E.memoizedState={element:v,isDehydrated:p,cache:null,transitions:null,pendingSuspenseBoundaries:null},_l(E),n}function Kh(n,a,p){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:W,key:v==null?null:""+v,children:n,containerInfo:a,implementation:p}}function jc(n){if(!n)return $r;n=n._reactInternals;e:{if(Tn(n)!==n||n.tag!==1)throw Error(r(170));var a=n;do{switch(a.tag){case 3:a=a.stateNode.context;break e;case 1:if(Ut(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break e}}a=a.return}while(a!==null);throw Error(r(171))}if(n.tag===1){var p=n.type;if(Ut(p))return pu(n,p,a)}return a}function Uc(n,a,p,v,b,E,P,O,Z){return n=ou(p,v,!0,n,b,E,P,O,Z),n.context=jc(null),p=n.current,v=Dt(),b=Hr(p),E=or(v,b),E.callback=a??null,zr(p,E,b),n.current.lanes=b,Zt(n,b,v),Kt(n,v),n}function Ia(n,a,p,v){var b=a.current,E=Dt(),P=Hr(b);return p=jc(p),a.context===null?a.context=p:a.pendingContext=p,a=or(E,P),a.payload={element:n},v=v===void 0?null:v,v!==null&&(a.callback=v),n=zr(b,a,P),n!==null&&(Sn(n,b,P,E),ua(n,b,P)),P}function Ba(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function Fc(n,a){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var p=n.retryLane;n.retryLane=p!==0&&p<a?p:a}}function au(n,a){Fc(n,a),(n=n.alternate)&&Fc(n,a)}function Vh(){return null}var Hc=typeof reportError=="function"?reportError:function(n){console.error(n)};function lu(n){this._internalRoot=n}Ma.prototype.render=lu.prototype.render=function(n){var a=this._internalRoot;if(a===null)throw Error(r(409));Ia(n,a,null,null)},Ma.prototype.unmount=lu.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var a=n.containerInfo;wi(function(){Ia(null,n,null,null)}),a[Ge]=null}};function Ma(n){this._internalRoot=n}Ma.prototype.unstable_scheduleHydration=function(n){if(n){var a=Oi();n={blockedOn:null,target:n,priority:a};for(var p=0;p<pt.length&&a!==0&&a<pt[p].priority;p++);pt.splice(p,0,n),p===0&&zi(n)}};function uu(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function $a(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function Kc(){}function Zh(n,a,p,v,b){if(b){if(typeof v=="function"){var E=v;v=function(){var he=Ba(P);E.call(he)}}var P=Uc(a,v,n,0,null,!1,!1,"",Kc);return n._reactRootContainer=P,n[Ge]=P.current,Nr(n.nodeType===8?n.parentNode:n),wi(),P}for(;b=n.lastChild;)n.removeChild(b);if(typeof v=="function"){var O=v;v=function(){var he=Ba(Z);O.call(he)}}var Z=ou(n,0,!1,null,null,!1,!1,"",Kc);return n._reactRootContainer=Z,n[Ge]=Z.current,Nr(n.nodeType===8?n.parentNode:n),wi(function(){Ia(a,Z,p,v)}),Z}function Da(n,a,p,v,b){var E=p._reactRootContainer;if(E){var P=E;if(typeof b=="function"){var O=b;b=function(){var Z=Ba(P);O.call(Z)}}Ia(a,P,n,b)}else P=Zh(p,a,n,b,v);return Ba(P)}$i=function(n){switch(n.tag){case 3:var a=n.stateNode;if(a.current.memoizedState.isDehydrated){var p=Ue(a.pendingLanes);p!==0&&(gn(a,p|1),Kt(a,rt()),(We&6)===0&&(gs=rt()+500,Dr()))}break;case 13:wi(function(){var v=sr(n,1);if(v!==null){var b=Dt();Sn(v,n,1,b)}}),au(n,1)}},Kn=function(n){if(n.tag===13){var a=sr(n,134217728);if(a!==null){var p=Dt();Sn(a,n,134217728,p)}au(n,134217728)}},Di=function(n){if(n.tag===13){var a=Hr(n),p=sr(n,a);if(p!==null){var v=Dt();Sn(p,n,a,v)}au(n,a)}},Oi=function(){return Ze},ti=function(n,a){var p=Ze;try{return Ze=n,a()}finally{Ze=p}},Pi=function(n,a,p){switch(a){case"input":if(Wr(n,p),a=p.name,p.type==="radio"&&a!=null){for(p=n;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll("input[name="+JSON.stringify(""+a)+'][type="radio"]'),a=0;a<p.length;a++){var v=p[a];if(v!==n&&v.form===n.form){var b=ns(v);if(!b)throw Error(r(90));at(v),Wr(v,b)}}}break;case"textarea":go(n,p);break;case"select":a=p.value,a!=null&&Rn(n,!!p.multiple,a,!1)}},Eo=eu,ko=wi;var Wh={usingClientEntryPoint:!1,Events:[er,tr,ns,xo,bo,eu]},mo={findFiberByHostInstance:Qn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},qh={bundleType:mo.bundleType,version:mo.version,rendererPackageName:mo.rendererPackageName,rendererConfig:mo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ye.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=Ro(n),n===null?null:n.stateNode},findFiberByHostInstance:mo.findFiberByHostInstance||Vh,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Oa=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Oa.isDisabled&&Oa.supportsFiber)try{Qr=Oa.inject(qh),Vt=Oa}catch{}}return reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Wh,reactDom_production_min.createPortal=function(n,a){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!uu(a))throw Error(r(200));return Kh(n,a,null,p)},reactDom_production_min.createRoot=function(n,a){if(!uu(n))throw Error(r(299));var p=!1,v="",b=Hc;return a!=null&&(a.unstable_strictMode===!0&&(p=!0),a.identifierPrefix!==void 0&&(v=a.identifierPrefix),a.onRecoverableError!==void 0&&(b=a.onRecoverableError)),a=ou(n,1,!1,null,null,p,!1,v,b),n[Ge]=a.current,Nr(n.nodeType===8?n.parentNode:n),new lu(a)},reactDom_production_min.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var a=n._reactInternals;if(a===void 0)throw typeof n.render=="function"?Error(r(188)):(n=Object.keys(n).join(","),Error(r(268,n)));return n=Ro(a),n=n===null?null:n.stateNode,n},reactDom_production_min.flushSync=function(n){return wi(n)},reactDom_production_min.hydrate=function(n,a,p){if(!$a(a))throw Error(r(200));return Da(null,n,a,!0,p)},reactDom_production_min.hydrateRoot=function(n,a,p){if(!uu(n))throw Error(r(405));var v=p!=null&&p.hydratedSources||null,b=!1,E="",P=Hc;if(p!=null&&(p.unstable_strictMode===!0&&(b=!0),p.identifierPrefix!==void 0&&(E=p.identifierPrefix),p.onRecoverableError!==void 0&&(P=p.onRecoverableError)),a=Uc(a,null,n,1,p??null,b,!1,E,P),n[Ge]=a.current,Nr(n),v)for(n=0;n<v.length;n++)p=v[n],b=p._getVersion,b=b(p._source),a.mutableSourceEagerHydrationData==null?a.mutableSourceEagerHydrationData=[p,b]:a.mutableSourceEagerHydrationData.push(p,b);return new Ma(a)},reactDom_production_min.render=function(n,a,p){if(!$a(a))throw Error(r(200));return Da(null,n,a,!1,p)},reactDom_production_min.unmountComponentAtNode=function(n){if(!$a(n))throw Error(r(40));return n._reactRootContainer?(wi(function(){Da(null,null,n,!1,function(){n._reactRootContainer=null,n[Ge]=null})}),!0):!1},reactDom_production_min.unstable_batchedUpdates=eu,reactDom_production_min.unstable_renderSubtreeIntoContainer=function(n,a,p,v){if(!$a(p))throw Error(r(200));if(n==null||n._reactInternals===void 0)throw Error(r(38));return Da(n,a,p,!1,v)},reactDom_production_min.version="18.3.1-next-f1338f8080-20240426",reactDom_production_min}var hasRequiredReactDom;function requireReactDom(){if(hasRequiredReactDom)return reactDom.exports;hasRequiredReactDom=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),reactDom.exports=requireReactDom_production_min(),reactDom.exports}var hasRequiredClient;function requireClient(){if(hasRequiredClient)return client;hasRequiredClient=1;var t=requireReactDom();return client.createRoot=t.createRoot,client.hydrateRoot=t.hydrateRoot,client}var clientExports=requireClient();const ReactDOM=getDefaultExportFromCjs(clientExports);var lib$1={},types={},hasRequiredTypes;function requireTypes(){return hasRequiredTypes||(hasRequiredTypes=1,Object.defineProperty(types,"__esModule",{value:!0})),types}var ee={},taskCollection$1={},taskCollection={},utils$1={},hasRequiredUtils$1;function requireUtils$1(){if(hasRequiredUtils$1)return utils$1;hasRequiredUtils$1=1,Object.defineProperty(utils$1,"__esModule",{value:!0}),utils$1._fast_remove_single=void 0;function t(e,r){r!==-1&&(r===0?e.shift():r===e.length-1?e.length=e.length-1:e.splice(r,1))}return utils$1._fast_remove_single=t,utils$1}var bakeCollection={},hasRequiredBakeCollection;function requireBakeCollection(){return hasRequiredBakeCollection||(hasRequiredBakeCollection=1,(function(exports){Object.defineProperty(exports,"__esModule",{value:!0}),exports.bakeCollectionVariadic=exports.bakeCollectionAwait=exports.bakeCollection=exports.BAKED_EMPTY_FUNC=void 0,exports.BAKED_EMPTY_FUNC=(function(){});var FORLOOP_FALLBACK=1500;function generateArgsDefCode(t){var e="";if(t===0)return e;for(var r=0;r<t-1;++r)e+="arg"+String(r)+", ";return e+="arg"+String(t-1),e}function generateBodyPartsCode(t,e){for(var r="",l="",c=0;c<e;++c)r+="var f".concat(c," = collection[").concat(c,`];
`),l+="f".concat(c,"(").concat(t,`)
`);return{funcDefCode:r,funcCallCode:l}}function generateBodyPartsVariadicCode(t){for(var e="",r="",l=0;l<t;++l)e+="var f".concat(l," = collection[").concat(l,`];
`),r+="f".concat(l,`.apply(undefined, arguments)
`);return{funcDefCode:e,funcCallCode:r}}function bakeCollection(collection,fixedArgsNum){if(collection.length===0)return exports.BAKED_EMPTY_FUNC;if(collection.length===1)return collection[0];var funcFactoryCode;if(collection.length<FORLOOP_FALLBACK){var argsDefCode=generateArgsDefCode(fixedArgsNum),_a=generateBodyPartsCode(argsDefCode,collection.length),funcDefCode=_a.funcDefCode,funcCallCode=_a.funcCallCode;funcFactoryCode=`(function(collection) {
            `.concat(funcDefCode,`
            collection = undefined;
            return (function(`).concat(argsDefCode,`) {
                `).concat(funcCallCode,`
            });
        })`)}else{var argsDefCode=generateArgsDefCode(fixedArgsNum);collection.length%10===0?funcFactoryCode=`(function(collection) {
                return (function(`.concat(argsDefCode,`) {
                    for (var i = 0; i < collection.length; i += 10) {
                        collection[i](`).concat(argsDefCode,`);
                        collection[i+1](`).concat(argsDefCode,`);
                        collection[i+2](`).concat(argsDefCode,`);
                        collection[i+3](`).concat(argsDefCode,`);
                        collection[i+4](`).concat(argsDefCode,`);
                        collection[i+5](`).concat(argsDefCode,`);
                        collection[i+6](`).concat(argsDefCode,`);
                        collection[i+7](`).concat(argsDefCode,`);
                        collection[i+8](`).concat(argsDefCode,`);
                        collection[i+9](`).concat(argsDefCode,`);
                    }
                });
            })`):collection.length%4===0?funcFactoryCode=`(function(collection) {
                return (function(`.concat(argsDefCode,`) {
                    for (var i = 0; i < collection.length; i += 4) {
                        collection[i](`).concat(argsDefCode,`);
                        collection[i+1](`).concat(argsDefCode,`);
                        collection[i+2](`).concat(argsDefCode,`);
                        collection[i+3](`).concat(argsDefCode,`);
                    }
                });
            })`):collection.length%3===0?funcFactoryCode=`(function(collection) {
                return (function(`.concat(argsDefCode,`) {
                    for (var i = 0; i < collection.length; i += 3) {
                        collection[i](`).concat(argsDefCode,`);
                        collection[i+1](`).concat(argsDefCode,`);
                        collection[i+2](`).concat(argsDefCode,`);
                    }
                });
            })`):funcFactoryCode=`(function(collection) {
                return (function(`.concat(argsDefCode,`) {
                    for (var i = 0; i < collection.length; ++i) {
                        collection[i](`).concat(argsDefCode,`);
                    }
                });
            })`)}{var funcFactory=eval(funcFactoryCode);return funcFactory(collection)}}exports.bakeCollection=bakeCollection;function bakeCollectionAwait(collection,fixedArgsNum){if(collection.length===0)return exports.BAKED_EMPTY_FUNC;if(collection.length===1)return collection[0];var funcFactoryCode;if(collection.length<FORLOOP_FALLBACK){var argsDefCode=generateArgsDefCode(fixedArgsNum),_a=generateBodyPartsCode(argsDefCode,collection.length),funcDefCode=_a.funcDefCode,funcCallCode=_a.funcCallCode;funcFactoryCode=`(function(collection) {
            `.concat(funcDefCode,`
            collection = undefined;
            return (function(`).concat(argsDefCode,`) {
                return Promise.all([ `).concat(funcCallCode,` ]);
            });
        })`)}else{var argsDefCode=generateArgsDefCode(fixedArgsNum);funcFactoryCode=`(function(collection) {
            return (function(`.concat(argsDefCode,`) {
                var promises = Array(collection.length);
                for (var i = 0; i < collection.length; ++i) {
                    promises[i] = collection[i](`).concat(argsDefCode,`);
                }
                return Promise.all(promises);
            });
        })`)}{var funcFactory=eval(funcFactoryCode);return funcFactory(collection)}}exports.bakeCollectionAwait=bakeCollectionAwait;function bakeCollectionVariadic(collection){if(collection.length===0)return exports.BAKED_EMPTY_FUNC;if(collection.length===1)return collection[0];var funcFactoryCode;if(collection.length<FORLOOP_FALLBACK){var _a=generateBodyPartsVariadicCode(collection.length),funcDefCode=_a.funcDefCode,funcCallCode=_a.funcCallCode;funcFactoryCode=`(function(collection) {
            `.concat(funcDefCode,`
            collection = undefined;
            return (function() {
                `).concat(funcCallCode,`
            });
        })`)}else funcFactoryCode=`(function(collection) {
            return (function() {
                for (var i = 0; i < collection.length; ++i) {
                    collection[i].apply(undefined, arguments);
                }
            });
        })`;{var funcFactory=eval(funcFactoryCode);return funcFactory(collection)}}exports.bakeCollectionVariadic=bakeCollectionVariadic})(bakeCollection)),bakeCollection}var hasRequiredTaskCollection$1;function requireTaskCollection$1(){if(hasRequiredTaskCollection$1)return taskCollection;hasRequiredTaskCollection$1=1;var t=taskCollection&&taskCollection.__spreadArray||function(se,ye,z){if(z||arguments.length===2)for(var W=0,Q=ye.length,te;W<Q;W++)(te||!(W in ye))&&(te||(te=Array.prototype.slice.call(ye,0,W)),te[W]=ye[W]);return se.concat(te||Array.prototype.slice.call(ye))};Object.defineProperty(taskCollection,"__esModule",{value:!0}),taskCollection.TaskCollection=void 0;var e=requireUtils$1(),r=requireBakeCollection();function l(se,ye){var z=this.length;if(z>1)if(ye){var W;(W=this._tasks).push.apply(W,arguments),this.length+=arguments.length}else this._tasks.push(se),this.length++;else if(ye){if(z===1){var Q=Array(1+arguments.length);Q.push(Q),Q.push.apply(Q,arguments),this._tasks=Q}else{var Q=Array(arguments.length);Q.push.apply(Q,arguments),this._tasks=Q}this.length+=arguments.length}else z===1?this._tasks=[this._tasks,se]:this._tasks=se,this.length++}function c(se,ye){var z=this.length;if(z>1)if(ye){var W;(W=this._tasks).push.apply(W,arguments),this.length+=arguments.length}else this._tasks.push(se),this.length++;else if(ye){if(z===1){var Q=Array(1+arguments.length);Q.push(Q),Q.push.apply(Q,arguments),this._tasks=Q}else{var Q=Array(arguments.length);Q.push.apply(Q,arguments),this._tasks=Q}this.length+=arguments.length}else z===1?this._tasks=[this._tasks,se]:this._tasks=se,this.length++;this.firstEmitBuildStrategy?this.call=R:this.rebuild()}function m(se){this.length!==0&&(this.length===1?this._tasks===se&&(this.length=0):((0,e._fast_remove_single)(this._tasks,this._tasks.lastIndexOf(se)),this._tasks.length===1?(this._tasks=this._tasks[0],this.length=1):this.length=this._tasks.length))}function y(se){if(this.length!==0){if(this.length===1)if(this._tasks===se&&(this.length=0),this.firstEmitBuildStrategy){this.call=r.BAKED_EMPTY_FUNC;return}else{this.rebuild();return}else(0,e._fast_remove_single)(this._tasks,this._tasks.lastIndexOf(se)),this._tasks.length===1?(this._tasks=this._tasks[0],this.length=1):this.length=this._tasks.length;this.firstEmitBuildStrategy?this.call=R:this.rebuild()}}function _(se){for(var ye,z=[],W=1;W<arguments.length;W++)z[W-1]=arguments[W];this.length===0?(this._tasks=z,this.length=1):this.length===1?(z.unshift(this._tasks),this._tasks=z,this.length=this._tasks.length):((ye=this._tasks).splice.apply(ye,t([se,0],z,!1)),this.length=this._tasks.length)}function w(se){for(var ye,z=[],W=1;W<arguments.length;W++)z[W-1]=arguments[W];this.length===0?(this._tasks=z,this.length=1):this.length===1?(z.unshift(this._tasks),this._tasks=z,this.length=this._tasks.length):((ye=this._tasks).splice.apply(ye,t([se,0],z,!1)),this.length=this._tasks.length),this.firstEmitBuildStrategy?this.call=R:this.rebuild()}function k(){this.length===0?this.call=r.BAKED_EMPTY_FUNC:this.length===1?this.call=this._tasks:this.call=(0,r.bakeCollection)(this._tasks,this.argsNum)}function C(){this.length===0?this.call=r.BAKED_EMPTY_FUNC:this.length===1?this.call=this._tasks:this.call=(0,r.bakeCollectionAwait)(this._tasks,this.argsNum)}function R(){this.rebuild(),this.call.apply(void 0,arguments)}var T=(function(){function se(ye,z,W,Q){z===void 0&&(z=!0),W===void 0&&(W=null),Q===void 0&&(Q=!1),this.awaitTasks=Q,this.call=r.BAKED_EMPTY_FUNC,this.argsNum=ye,this.firstEmitBuildStrategy=!0,Q?this.rebuild=C.bind(this):this.rebuild=k.bind(this),this.setAutoRebuild(z),W?typeof W=="function"?(this._tasks=W,this.length=1):(this._tasks=W,this.length=W.length):(this._tasks=null,this.length=0),z&&this.rebuild()}return se})();taskCollection.TaskCollection=T;function A(){this._tasks=null,this.length=0,this.call=r.BAKED_EMPTY_FUNC}function M(){this._tasks=null,this.length=0,this.call=r.BAKED_EMPTY_FUNC}function B(se){this.argsNum<se&&(this.argsNum=se,this.firstEmitBuildStrategy?this.call=R:this.rebuild())}function j(se){se?(this.push=c.bind(this),this.insert=w.bind(this),this.removeLast=y.bind(this)):(this.push=l.bind(this),this.insert=_.bind(this),this.removeLast=m.bind(this))}function re(){return this.length===0?[]:this.length===1?[this._tasks]:this._tasks}function de(se){se.length===0?(this.length=0,this.call=r.BAKED_EMPTY_FUNC):se.length===1?(this.length=1,this.call=se[0],this._tasks=se[0]):(this.length=se.length,this._tasks=se,this.firstEmitBuildStrategy?this.call=R:this.rebuild())}return T.prototype.fastClear=A,T.prototype.clear=M,T.prototype.growArgsNum=B,T.prototype.setAutoRebuild=j,T.prototype.tasksAsArray=re,T.prototype.setTasks=de,taskCollection}var hasRequiredTaskCollection;function requireTaskCollection(){return hasRequiredTaskCollection||(hasRequiredTaskCollection=1,(function(t){var e=taskCollection$1&&taskCollection$1.__createBinding||(Object.create?(function(l,c,m,y){y===void 0&&(y=m);var _=Object.getOwnPropertyDescriptor(c,m);(!_||("get"in _?!c.__esModule:_.writable||_.configurable))&&(_={enumerable:!0,get:function(){return c[m]}}),Object.defineProperty(l,y,_)}):(function(l,c,m,y){y===void 0&&(y=m),l[y]=c[m]})),r=taskCollection$1&&taskCollection$1.__exportStar||function(l,c){for(var m in l)m!=="default"&&!Object.prototype.hasOwnProperty.call(c,m)&&e(c,l,m)};Object.defineProperty(t,"__esModule",{value:!0}),r(requireTaskCollection$1(),t)})(taskCollection$1)),taskCollection$1}var utils={},hasRequiredUtils;function requireUtils(){if(hasRequiredUtils)return utils;hasRequiredUtils=1,Object.defineProperty(utils,"__esModule",{value:!0}),utils.nullObj=void 0;function t(){var e={};return e.__proto__=null,e}return utils.nullObj=t,utils}var hasRequiredEe;function requireEe(){if(hasRequiredEe)return ee;hasRequiredEe=1;var t=ee&&ee.__spreadArray||function(z,W,Q){if(Q||arguments.length===2)for(var te=0,le=W.length,me;te<le;te++)(me||!(te in W))&&(me||(me=Array.prototype.slice.call(W,0,te)),me[te]=W[te]);return z.concat(me||Array.prototype.slice.call(W))};Object.defineProperty(ee,"__esModule",{value:!0}),ee.EventEmitter=void 0;var e=requireTaskCollection(),r=requireUtils$1(),l=requireUtils();function c(z,W,Q,te,le,me){var F=this.events[z];if(F){if(F.length===0)return!1;if(F.argsNum<6)F.call(W,Q,te,le,me);else{for(var K=new Array(F.argsNum),D=0,Y=K.length;D<Y;++D)K[D]=arguments[D+1];F.call.apply(void 0,K)}return!0}return!1}function m(z,W,Q,te,le,me){var F=this.events[z],K;if(F!==void 0){if(F.length===0)return!1;if(F.argsNum<6)F.call(W,Q,te,le,me);else{K=new Array(F.argsNum);for(var D=0,Y=K.length;D<Y;++D)K[D]=arguments[D+1];F.call.apply(void 0,K)}}var $=this.onceEvents[z];if($){if(typeof $=="function")if(this.onceEvents[z]=void 0,arguments.length<6)$(W,Q,te,le,me);else{if(K===void 0){K=new Array(arguments.length-1);for(var D=0,Y=K.length;D<Y;++D)K[D]=arguments[D+1]}$.apply(void 0,K)}else{var U=$;if(this.onceEvents[z]=void 0,arguments.length<6)for(var D=0;D<U.length;++D)U[D](W,Q,te,le,me);else{if(K===void 0){K=new Array(arguments.length-1);for(var D=0,Y=K.length;D<Y;++D)K[D]=arguments[D+1]}for(var D=0;D<U.length;++D)U[D].apply(void 0,K)}}return!0}return F!==void 0}var y=(function(){function z(){this.events=(0,l.nullObj)(),this.onceEvents=(0,l.nullObj)(),this._symbolKeys=new Set,this.maxListeners=1/0}return Object.defineProperty(z.prototype,"_eventsCount",{get:function(){return this.eventNames().length},enumerable:!1,configurable:!0}),z})();ee.EventEmitter=y;function _(z,W){switch(this.emit===c&&(this.emit=m),typeof this.onceEvents[z]){case"undefined":this.onceEvents[z]=W,typeof z=="symbol"&&this._symbolKeys.add(z);break;case"function":this.onceEvents[z]=[this.onceEvents[z],W];break;case"object":this.onceEvents[z].push(W)}return this}function w(z,W,Q){if(Q===void 0&&(Q=W.length),typeof W!="function")throw new TypeError("The listener must be a function");var te=this.events[z];return te?(te.push(W),te.growArgsNum(Q),this.maxListeners!==1/0&&this.maxListeners<=te.length&&console.warn('Maximum event listeners for "'.concat(String(z),'" event!'))):(this.events[z]=new e.TaskCollection(Q,!0,W,!1),typeof z=="symbol"&&this._symbolKeys.add(z)),this}function k(z,W){var Q=this.events[z];Q&&Q.removeLast(W);var te=this.onceEvents[z];return te&&(typeof te=="function"?this.onceEvents[z]=void 0:typeof te=="object"&&(te.length===1&&te[0]===W?this.onceEvents[z]=void 0:(0,r._fast_remove_single)(te,te.lastIndexOf(W)))),this}function C(z,W,Q,te){Q===void 0&&(Q=this),te===void 0&&(te=W.length),this.boundFuncs||(this.boundFuncs=new Map);var le=W.bind(Q);return this.boundFuncs.set(W,le),this.addListener(z,le,te)}function R(z,W){var Q,te,le=(Q=this.boundFuncs)===null||Q===void 0?void 0:Q.get(W);return(te=this.boundFuncs)===null||te===void 0||te.delete(W),this.removeListener(z,le)}function T(z){return this.events[z]&&!!this.events[z].length}function A(z,W,Q){if(Q===void 0&&(Q=W.length),typeof W!="function")throw new TypeError("The listener must be a function");var te=this.events[z];return!te||!(te instanceof e.TaskCollection)?(te=this.events[z]=new e.TaskCollection(Q,!0,W,!1),typeof z=="symbol"&&this._symbolKeys.add(z)):(te.insert(0,W),te.growArgsNum(Q),this.maxListeners!==1/0&&this.maxListeners<=te.length&&console.warn('Maximum event listeners for "'.concat(String(z),'" event!'))),this}function M(z,W){this.emit===c&&(this.emit=m);var Q=this.onceEvents[z];return Q?typeof Q!="object"?(this.onceEvents[z]=[W,Q],typeof z=="symbol"&&this._symbolKeys.add(z)):(Q.unshift(W),this.maxListeners!==1/0&&this.maxListeners<=Q.length&&console.warn('Maximum event listeners for "'.concat(String(z),'" once event!'))):(this.onceEvents[z]=[W],typeof z=="symbol"&&this._symbolKeys.add(z)),this}function B(z){return z===void 0?(this.events=(0,l.nullObj)(),this.onceEvents=(0,l.nullObj)(),this._symbolKeys=new Set):(this.events[z]=void 0,this.onceEvents[z]=void 0,typeof z=="symbol"&&this._symbolKeys.delete(z)),this}function j(z){return this.maxListeners=z,this}function re(){return this.maxListeners}function de(z){return this.emit===c?this.events[z]?this.events[z].tasksAsArray().slice():[]:this.events[z]&&this.onceEvents[z]?t(t([],this.events[z].tasksAsArray(),!0),typeof this.onceEvents[z]=="function"?[this.onceEvents[z]]:this.onceEvents[z],!0):this.events[z]?this.events[z].tasksAsArray():this.onceEvents[z]?typeof this.onceEvents[z]=="function"?[this.onceEvents[z]]:this.onceEvents[z]:[]}function se(){var z=this;if(this.emit===c){var W=Object.keys(this.events);return t(t([],W,!0),Array.from(this._symbolKeys),!0).filter(function(te){return te in z.events&&z.events[te]&&z.events[te].length})}else{var W=Object.keys(this.events).filter(function(le){return z.events[le]&&z.events[le].length}),Q=Object.keys(this.onceEvents).filter(function(le){return z.onceEvents[le]&&z.onceEvents[le].length});return t(t(t([],W,!0),Q,!0),Array.from(this._symbolKeys).filter(function(le){return le in z.events&&z.events[le]&&z.events[le].length||le in z.onceEvents&&z.onceEvents[le]&&z.onceEvents[le].length}),!0)}}function ye(z){return this.emit===c?this.events[z]&&this.events[z].length||0:(this.events[z]&&this.events[z].length||0)+(this.onceEvents[z]&&this.onceEvents[z].length||0)}return y.prototype.emit=c,y.prototype.on=w,y.prototype.once=_,y.prototype.addListener=w,y.prototype.removeListener=k,y.prototype.addListenerBound=C,y.prototype.removeListenerBound=R,y.prototype.hasListeners=T,y.prototype.prependListener=A,y.prototype.prependOnceListener=M,y.prototype.off=k,y.prototype.removeAllListeners=B,y.prototype.setMaxListeners=j,y.prototype.getMaxListeners=re,y.prototype.listeners=de,y.prototype.eventNames=se,y.prototype.listenerCount=ye,ee}var hasRequiredLib$1;function requireLib$1(){return hasRequiredLib$1||(hasRequiredLib$1=1,(function(t){var e=lib$1&&lib$1.__createBinding||(Object.create?(function(l,c,m,y){y===void 0&&(y=m);var _=Object.getOwnPropertyDescriptor(c,m);(!_||("get"in _?!c.__esModule:_.writable||_.configurable))&&(_={enumerable:!0,get:function(){return c[m]}}),Object.defineProperty(l,y,_)}):(function(l,c,m,y){y===void 0&&(y=m),l[y]=c[m]})),r=lib$1&&lib$1.__exportStar||function(l,c){for(var m in l)m!=="default"&&!Object.prototype.hasOwnProperty.call(c,m)&&e(c,l,m)};Object.defineProperty(t,"__esModule",{value:!0}),r(requireTypes(),t),r(requireEe(),t)})(lib$1)),lib$1}var libExports=requireLib$1(),browser={exports:{}},ms,hasRequiredMs;function requireMs(){if(hasRequiredMs)return ms;hasRequiredMs=1;var t=1e3,e=t*60,r=e*60,l=r*24,c=l*7,m=l*365.25;ms=function(C,R){R=R||{};var T=typeof C;if(T==="string"&&C.length>0)return y(C);if(T==="number"&&isFinite(C))return R.long?w(C):_(C);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(C))};function y(C){if(C=String(C),!(C.length>100)){var R=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(C);if(R){var T=parseFloat(R[1]),A=(R[2]||"ms").toLowerCase();switch(A){case"years":case"year":case"yrs":case"yr":case"y":return T*m;case"weeks":case"week":case"w":return T*c;case"days":case"day":case"d":return T*l;case"hours":case"hour":case"hrs":case"hr":case"h":return T*r;case"minutes":case"minute":case"mins":case"min":case"m":return T*e;case"seconds":case"second":case"secs":case"sec":case"s":return T*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return T;default:return}}}}function _(C){var R=Math.abs(C);return R>=l?Math.round(C/l)+"d":R>=r?Math.round(C/r)+"h":R>=e?Math.round(C/e)+"m":R>=t?Math.round(C/t)+"s":C+"ms"}function w(C){var R=Math.abs(C);return R>=l?k(C,R,l,"day"):R>=r?k(C,R,r,"hour"):R>=e?k(C,R,e,"minute"):R>=t?k(C,R,t,"second"):C+" ms"}function k(C,R,T,A){var M=R>=T*1.5;return Math.round(C/T)+" "+A+(M?"s":"")}return ms}var common,hasRequiredCommon;function requireCommon(){if(hasRequiredCommon)return common;hasRequiredCommon=1;function t(e){l.debug=l,l.default=l,l.coerce=k,l.disable=_,l.enable=m,l.enabled=w,l.humanize=requireMs(),l.destroy=C,Object.keys(e).forEach(R=>{l[R]=e[R]}),l.names=[],l.skips=[],l.formatters={};function r(R){let T=0;for(let A=0;A<R.length;A++)T=(T<<5)-T+R.charCodeAt(A),T|=0;return l.colors[Math.abs(T)%l.colors.length]}l.selectColor=r;function l(R){let T,A=null,M,B;function j(...re){if(!j.enabled)return;const de=j,se=Number(new Date),ye=se-(T||se);de.diff=ye,de.prev=T,de.curr=se,T=se,re[0]=l.coerce(re[0]),typeof re[0]!="string"&&re.unshift("%O");let z=0;re[0]=re[0].replace(/%([a-zA-Z%])/g,(Q,te)=>{if(Q==="%%")return"%";z++;const le=l.formatters[te];if(typeof le=="function"){const me=re[z];Q=le.call(de,me),re.splice(z,1),z--}return Q}),l.formatArgs.call(de,re),(de.log||l.log).apply(de,re)}return j.namespace=R,j.useColors=l.useColors(),j.color=l.selectColor(R),j.extend=c,j.destroy=l.destroy,Object.defineProperty(j,"enabled",{enumerable:!0,configurable:!1,get:()=>A!==null?A:(M!==l.namespaces&&(M=l.namespaces,B=l.enabled(R)),B),set:re=>{A=re}}),typeof l.init=="function"&&l.init(j),j}function c(R,T){const A=l(this.namespace+(typeof T>"u"?":":T)+R);return A.log=this.log,A}function m(R){l.save(R),l.namespaces=R,l.names=[],l.skips=[];const T=(typeof R=="string"?R:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(const A of T)A[0]==="-"?l.skips.push(A.slice(1)):l.names.push(A)}function y(R,T){let A=0,M=0,B=-1,j=0;for(;A<R.length;)if(M<T.length&&(T[M]===R[A]||T[M]==="*"))T[M]==="*"?(B=M,j=A,M++):(A++,M++);else if(B!==-1)M=B+1,j++,A=j;else return!1;for(;M<T.length&&T[M]==="*";)M++;return M===T.length}function _(){const R=[...l.names,...l.skips.map(T=>"-"+T)].join(",");return l.enable(""),R}function w(R){for(const T of l.skips)if(y(R,T))return!1;for(const T of l.names)if(y(R,T))return!0;return!1}function k(R){return R instanceof Error?R.stack||R.message:R}function C(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return l.enable(l.load()),l}return common=t,common}var hasRequiredBrowser;function requireBrowser(){return hasRequiredBrowser||(hasRequiredBrowser=1,(function(t,e){var r={};e.formatArgs=c,e.save=m,e.load=y,e.useColors=l,e.storage=_(),e.destroy=(()=>{let k=!1;return()=>{k||(k=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function l(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let k;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(k=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(k[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function c(k){if(k[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+k[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const C="color: "+this.color;k.splice(1,0,C,"color: inherit");let R=0,T=0;k[0].replace(/%[a-zA-Z%]/g,A=>{A!=="%%"&&(R++,A==="%c"&&(T=R))}),k.splice(T,0,C)}e.log=console.debug||console.log||(()=>{});function m(k){try{k?e.storage.setItem("debug",k):e.storage.removeItem("debug")}catch{}}function y(){let k;try{k=e.storage.getItem("debug")||e.storage.getItem("DEBUG")}catch{}return!k&&typeof process<"u"&&"env"in process&&(k=r.DEBUG),k}function _(){try{return localStorage}catch{}}t.exports=requireCommon()(e);const{formatters:w}=t.exports;w.j=function(k){try{return JSON.stringify(k)}catch(C){return"[UnexpectedJSONParseError]: "+C.message}}})(browser,browser.exports)),browser.exports}var browserExports=requireBrowser();const createDebug5=getDefaultExportFromCjs(browserExports);function number$2(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function bytes$2(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function hash$1(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");number$2(t.outputLen),number$2(t.blockLen)}function exists$1(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function output$1(t,e){bytes$2(t);const r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}const crypto$3=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const u8a$2=t=>t instanceof Uint8Array,createView$2=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),rotr$2=(t,e)=>t<<32-e|t>>>e,isLE$2=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!isLE$2)throw new Error("Non little-endian hardware is not supported");function utf8ToBytes$3(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function toBytes$2(t){if(typeof t=="string"&&(t=utf8ToBytes$3(t)),!u8a$2(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}function concatBytes$3(...t){const e=new Uint8Array(t.reduce((l,c)=>l+c.length,0));let r=0;return t.forEach(l=>{if(!u8a$2(l))throw new Error("Uint8Array expected");e.set(l,r),r+=l.length}),e}let Hash$2=class{clone(){return this._cloneInto()}};function wrapConstructor$1(t){const e=l=>t().update(toBytes$2(l)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function randomBytes$2(t=32){if(crypto$3&&typeof crypto$3.getRandomValues=="function")return crypto$3.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}function setBigUint64$2(t,e,r,l){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,l);const c=BigInt(32),m=BigInt(4294967295),y=Number(r>>c&m),_=Number(r&m),w=l?4:0,k=l?0:4;t.setUint32(e+w,y,l),t.setUint32(e+k,_,l)}let SHA2$1=class extends Hash$2{constructor(e,r,l,c){super(),this.blockLen=e,this.outputLen=r,this.padOffset=l,this.isLE=c,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=createView$2(this.buffer)}update(e){exists$1(this);const{view:r,buffer:l,blockLen:c}=this;e=toBytes$2(e);const m=e.length;for(let y=0;y<m;){const _=Math.min(c-this.pos,m-y);if(_===c){const w=createView$2(e);for(;c<=m-y;y+=c)this.process(w,y);continue}l.set(e.subarray(y,y+_),this.pos),this.pos+=_,y+=_,this.pos===c&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){exists$1(this),output$1(e,this),this.finished=!0;const{buffer:r,view:l,blockLen:c,isLE:m}=this;let{pos:y}=this;r[y++]=128,this.buffer.subarray(y).fill(0),this.padOffset>c-y&&(this.process(l,0),y=0);for(let R=y;R<c;R++)r[R]=0;setBigUint64$2(l,c-8,BigInt(this.length*8),m),this.process(l,0);const _=createView$2(e),w=this.outputLen;if(w%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const k=w/4,C=this.get();if(k>C.length)throw new Error("_sha2: outputLen bigger than state");for(let R=0;R<k;R++)_.setUint32(4*R,C[R],m)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const l=e.slice(0,r);return this.destroy(),l}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:l,length:c,finished:m,destroyed:y,pos:_}=this;return e.length=c,e.pos=_,e.finished=m,e.destroyed=y,c%r&&e.buffer.set(l),e}};const Chi$2=(t,e,r)=>t&e^~t&r,Maj$2=(t,e,r)=>t&e^t&r^e&r,SHA256_K$2=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),IV$1=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),SHA256_W$2=new Uint32Array(64);let SHA256$2=class extends SHA2$1{constructor(){super(64,32,8,!1),this.A=IV$1[0]|0,this.B=IV$1[1]|0,this.C=IV$1[2]|0,this.D=IV$1[3]|0,this.E=IV$1[4]|0,this.F=IV$1[5]|0,this.G=IV$1[6]|0,this.H=IV$1[7]|0}get(){const{A:e,B:r,C:l,D:c,E:m,F:y,G:_,H:w}=this;return[e,r,l,c,m,y,_,w]}set(e,r,l,c,m,y,_,w){this.A=e|0,this.B=r|0,this.C=l|0,this.D=c|0,this.E=m|0,this.F=y|0,this.G=_|0,this.H=w|0}process(e,r){for(let R=0;R<16;R++,r+=4)SHA256_W$2[R]=e.getUint32(r,!1);for(let R=16;R<64;R++){const T=SHA256_W$2[R-15],A=SHA256_W$2[R-2],M=rotr$2(T,7)^rotr$2(T,18)^T>>>3,B=rotr$2(A,17)^rotr$2(A,19)^A>>>10;SHA256_W$2[R]=B+SHA256_W$2[R-7]+M+SHA256_W$2[R-16]|0}let{A:l,B:c,C:m,D:y,E:_,F:w,G:k,H:C}=this;for(let R=0;R<64;R++){const T=rotr$2(_,6)^rotr$2(_,11)^rotr$2(_,25),A=C+T+Chi$2(_,w,k)+SHA256_K$2[R]+SHA256_W$2[R]|0,B=(rotr$2(l,2)^rotr$2(l,13)^rotr$2(l,22))+Maj$2(l,c,m)|0;C=k,k=w,w=_,_=y+A|0,y=m,m=c,c=l,l=A+B|0}l=l+this.A|0,c=c+this.B|0,m=m+this.C|0,y=y+this.D|0,_=_+this.E|0,w=w+this.F|0,k=k+this.G|0,C=C+this.H|0,this.set(l,c,m,y,_,w,k,C)}roundClean(){SHA256_W$2.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};const sha256$3=wrapConstructor$1(()=>new SHA256$2);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _0n$9=BigInt(0),_1n$9=BigInt(1),_2n$5=BigInt(2),u8a$1=t=>t instanceof Uint8Array,hexes$2=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function bytesToHex$2(t){if(!u8a$1(t))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=hexes$2[t[r]];return e}function numberToHexUnpadded$1(t){const e=t.toString(16);return e.length&1?`0${e}`:e}function hexToNumber$1(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return BigInt(t===""?"0":`0x${t}`)}function hexToBytes$2(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(e/2);for(let l=0;l<r.length;l++){const c=l*2,m=t.slice(c,c+2),y=Number.parseInt(m,16);if(Number.isNaN(y)||y<0)throw new Error("Invalid byte sequence");r[l]=y}return r}function bytesToNumberBE$1(t){return hexToNumber$1(bytesToHex$2(t))}function bytesToNumberLE$1(t){if(!u8a$1(t))throw new Error("Uint8Array expected");return hexToNumber$1(bytesToHex$2(Uint8Array.from(t).reverse()))}function numberToBytesBE$1(t,e){return hexToBytes$2(t.toString(16).padStart(e*2,"0"))}function numberToBytesLE$1(t,e){return numberToBytesBE$1(t,e).reverse()}function numberToVarBytesBE(t){return hexToBytes$2(numberToHexUnpadded$1(t))}function ensureBytes$1(t,e,r){let l;if(typeof e=="string")try{l=hexToBytes$2(e)}catch(m){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${m}`)}else if(u8a$1(e))l=Uint8Array.from(e);else throw new Error(`${t} must be hex string or Uint8Array`);const c=l.length;if(typeof r=="number"&&c!==r)throw new Error(`${t} expected ${r} bytes, got ${c}`);return l}function concatBytes$2(...t){const e=new Uint8Array(t.reduce((l,c)=>l+c.length,0));let r=0;return t.forEach(l=>{if(!u8a$1(l))throw new Error("Uint8Array expected");e.set(l,r),r+=l.length}),e}function equalBytes$1(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function utf8ToBytes$2(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function bitLen$1(t){let e;for(e=0;t>_0n$9;t>>=_1n$9,e+=1);return e}function bitGet(t,e){return t>>BigInt(e)&_1n$9}const bitSet=(t,e,r)=>t|(r?_1n$9:_0n$9)<<BigInt(e),bitMask$1=t=>(_2n$5<<BigInt(t-1))-_1n$9,u8n=t=>new Uint8Array(t),u8fr=t=>Uint8Array.from(t);function createHmacDrbg$1(t,e,r){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let l=u8n(t),c=u8n(t),m=0;const y=()=>{l.fill(1),c.fill(0),m=0},_=(...R)=>r(c,l,...R),w=(R=u8n())=>{c=_(u8fr([0]),R),l=_(),R.length!==0&&(c=_(u8fr([1]),R),l=_())},k=()=>{if(m++>=1e3)throw new Error("drbg: tried 1000 values");let R=0;const T=[];for(;R<e;){l=_();const A=l.slice();T.push(A),R+=l.length}return concatBytes$2(...T)};return(R,T)=>{y(),w(R);let A;for(;!(A=T(k()));)w();return y(),A}}const validatorFns={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||t instanceof Uint8Array,isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function validateObject(t,e,r={}){const l=(c,m,y)=>{const _=validatorFns[m];if(typeof _!="function")throw new Error(`Invalid validator "${m}", expected function`);const w=t[c];if(!(y&&w===void 0)&&!_(w,t))throw new Error(`Invalid param ${String(c)}=${w} (${typeof w}), expected ${m}`)};for(const[c,m]of Object.entries(e))l(c,m,!1);for(const[c,m]of Object.entries(r))l(c,m,!0);return t}const ut=Object.freeze(Object.defineProperty({__proto__:null,bitGet,bitLen:bitLen$1,bitMask:bitMask$1,bitSet,bytesToHex:bytesToHex$2,bytesToNumberBE:bytesToNumberBE$1,bytesToNumberLE:bytesToNumberLE$1,concatBytes:concatBytes$2,createHmacDrbg:createHmacDrbg$1,ensureBytes:ensureBytes$1,equalBytes:equalBytes$1,hexToBytes:hexToBytes$2,hexToNumber:hexToNumber$1,numberToBytesBE:numberToBytesBE$1,numberToBytesLE:numberToBytesLE$1,numberToHexUnpadded:numberToHexUnpadded$1,numberToVarBytesBE,utf8ToBytes:utf8ToBytes$2,validateObject},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _0n$8=BigInt(0),_1n$8=BigInt(1),_2n$4=BigInt(2),_3n$3=BigInt(3),_4n$2=BigInt(4),_5n$1=BigInt(5),_8n$1=BigInt(8);BigInt(9);BigInt(16);function mod$1(t,e){const r=t%e;return r>=_0n$8?r:e+r}function pow(t,e,r){if(r<=_0n$8||e<_0n$8)throw new Error("Expected power/modulo > 0");if(r===_1n$8)return _0n$8;let l=_1n$8;for(;e>_0n$8;)e&_1n$8&&(l=l*t%r),t=t*t%r,e>>=_1n$8;return l}function pow2$1(t,e,r){let l=t;for(;e-- >_0n$8;)l*=l,l%=r;return l}function invert$1(t,e){if(t===_0n$8||e<=_0n$8)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=mod$1(t,e),l=e,c=_0n$8,m=_1n$8;for(;r!==_0n$8;){const _=l/r,w=l%r,k=c-m*_;l=r,r=w,c=m,m=k}if(l!==_1n$8)throw new Error("invert: does not exist");return mod$1(c,e)}function tonelliShanks$1(t){const e=(t-_1n$8)/_2n$4;let r,l,c;for(r=t-_1n$8,l=0;r%_2n$4===_0n$8;r/=_2n$4,l++);for(c=_2n$4;c<t&&pow(c,e,t)!==t-_1n$8;c++);if(l===1){const y=(t+_1n$8)/_4n$2;return function(w,k){const C=w.pow(k,y);if(!w.eql(w.sqr(C),k))throw new Error("Cannot find square root");return C}}const m=(r+_1n$8)/_2n$4;return function(_,w){if(_.pow(w,e)===_.neg(_.ONE))throw new Error("Cannot find square root");let k=l,C=_.pow(_.mul(_.ONE,c),r),R=_.pow(w,m),T=_.pow(w,r);for(;!_.eql(T,_.ONE);){if(_.eql(T,_.ZERO))return _.ZERO;let A=1;for(let B=_.sqr(T);A<k&&!_.eql(B,_.ONE);A++)B=_.sqr(B);const M=_.pow(C,_1n$8<<BigInt(k-A-1));C=_.sqr(M),R=_.mul(R,M),T=_.mul(T,C),k=A}return R}}function FpSqrt$1(t){if(t%_4n$2===_3n$3){const e=(t+_1n$8)/_4n$2;return function(l,c){const m=l.pow(c,e);if(!l.eql(l.sqr(m),c))throw new Error("Cannot find square root");return m}}if(t%_8n$1===_5n$1){const e=(t-_5n$1)/_8n$1;return function(l,c){const m=l.mul(c,_2n$4),y=l.pow(m,e),_=l.mul(c,y),w=l.mul(l.mul(_,_2n$4),y),k=l.mul(_,l.sub(w,l.ONE));if(!l.eql(l.sqr(k),c))throw new Error("Cannot find square root");return k}}return tonelliShanks$1(t)}const FIELD_FIELDS$1=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function validateField$1(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=FIELD_FIELDS$1.reduce((l,c)=>(l[c]="function",l),e);return validateObject(t,r)}function FpPow$1(t,e,r){if(r<_0n$8)throw new Error("Expected power > 0");if(r===_0n$8)return t.ONE;if(r===_1n$8)return e;let l=t.ONE,c=e;for(;r>_0n$8;)r&_1n$8&&(l=t.mul(l,c)),c=t.sqr(c),r>>=_1n$8;return l}function FpInvertBatch$1(t,e){const r=new Array(e.length),l=e.reduce((m,y,_)=>t.is0(y)?m:(r[_]=m,t.mul(m,y)),t.ONE),c=t.inv(l);return e.reduceRight((m,y,_)=>t.is0(y)?m:(r[_]=t.mul(m,r[_]),t.mul(m,y)),c),r}function nLength$1(t,e){const r=e!==void 0?e:t.toString(2).length,l=Math.ceil(r/8);return{nBitLength:r,nByteLength:l}}function Field$1(t,e,r=!1,l={}){if(t<=_0n$8)throw new Error(`Expected Field ORDER > 0, got ${t}`);const{nBitLength:c,nByteLength:m}=nLength$1(t,e);if(m>2048)throw new Error("Field lengths over 2048 bytes are not supported");const y=FpSqrt$1(t),_=Object.freeze({ORDER:t,BITS:c,BYTES:m,MASK:bitMask$1(c),ZERO:_0n$8,ONE:_1n$8,create:w=>mod$1(w,t),isValid:w=>{if(typeof w!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof w}`);return _0n$8<=w&&w<t},is0:w=>w===_0n$8,isOdd:w=>(w&_1n$8)===_1n$8,neg:w=>mod$1(-w,t),eql:(w,k)=>w===k,sqr:w=>mod$1(w*w,t),add:(w,k)=>mod$1(w+k,t),sub:(w,k)=>mod$1(w-k,t),mul:(w,k)=>mod$1(w*k,t),pow:(w,k)=>FpPow$1(_,w,k),div:(w,k)=>mod$1(w*invert$1(k,t),t),sqrN:w=>w*w,addN:(w,k)=>w+k,subN:(w,k)=>w-k,mulN:(w,k)=>w*k,inv:w=>invert$1(w,t),sqrt:l.sqrt||(w=>y(_,w)),invertBatch:w=>FpInvertBatch$1(_,w),cmov:(w,k,C)=>C?k:w,toBytes:w=>r?numberToBytesLE$1(w,m):numberToBytesBE$1(w,m),fromBytes:w=>{if(w.length!==m)throw new Error(`Fp.fromBytes: expected ${m}, got ${w.length}`);return r?bytesToNumberLE$1(w):bytesToNumberBE$1(w)}});return Object.freeze(_)}function getFieldBytesLength$1(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function getMinHashLength$1(t){const e=getFieldBytesLength$1(t);return e+Math.ceil(e/2)}function mapHashToField$1(t,e,r=!1){const l=t.length,c=getFieldBytesLength$1(e),m=getMinHashLength$1(e);if(l<16||l<m||l>1024)throw new Error(`expected ${m}-1024 bytes of input, got ${l}`);const y=r?bytesToNumberBE$1(t):bytesToNumberLE$1(t),_=mod$1(y,e-_1n$8)+_1n$8;return r?numberToBytesLE$1(_,c):numberToBytesBE$1(_,c)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _0n$7=BigInt(0),_1n$7=BigInt(1);function wNAF$1(t,e){const r=(c,m)=>{const y=m.negate();return c?y:m},l=c=>{const m=Math.ceil(e/c)+1,y=2**(c-1);return{windows:m,windowSize:y}};return{constTimeNegate:r,unsafeLadder(c,m){let y=t.ZERO,_=c;for(;m>_0n$7;)m&_1n$7&&(y=y.add(_)),_=_.double(),m>>=_1n$7;return y},precomputeWindow(c,m){const{windows:y,windowSize:_}=l(m),w=[];let k=c,C=k;for(let R=0;R<y;R++){C=k,w.push(C);for(let T=1;T<_;T++)C=C.add(k),w.push(C);k=C.double()}return w},wNAF(c,m,y){const{windows:_,windowSize:w}=l(c);let k=t.ZERO,C=t.BASE;const R=BigInt(2**c-1),T=2**c,A=BigInt(c);for(let M=0;M<_;M++){const B=M*w;let j=Number(y&R);y>>=A,j>w&&(j-=T,y+=_1n$7);const re=B,de=B+Math.abs(j)-1,se=M%2!==0,ye=j<0;j===0?C=C.add(r(se,m[re])):k=k.add(r(ye,m[de]))}return{p:k,f:C}},wNAFCached(c,m,y,_){const w=c._WINDOW_SIZE||1;let k=m.get(c);return k||(k=this.precomputeWindow(c,w),w!==1&&m.set(c,_(k))),this.wNAF(w,k,y)}}}function validateBasic(t){return validateField$1(t.Fp),validateObject(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...nLength$1(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function validatePointOpts(t){const e=validateBasic(t);validateObject(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:r,Fp:l,a:c}=e;if(r){if(!l.eql(c,l.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:b2n,hexToBytes:h2b}=ut,DER$1={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(t){const{Err:e}=DER$1;if(t.length<2||t[0]!==2)throw new e("Invalid signature integer tag");const r=t[1],l=t.subarray(2,r+2);if(!r||l.length!==r)throw new e("Invalid signature integer: wrong length");if(l[0]&128)throw new e("Invalid signature integer: negative");if(l[0]===0&&!(l[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:b2n(l),l:t.subarray(r+2)}},toSig(t){const{Err:e}=DER$1,r=typeof t=="string"?h2b(t):t;if(!(r instanceof Uint8Array))throw new Error("ui8a expected");let l=r.length;if(l<2||r[0]!=48)throw new e("Invalid signature tag");if(r[1]!==l-2)throw new e("Invalid signature: incorrect length");const{d:c,l:m}=DER$1._parseInt(r.subarray(2)),{d:y,l:_}=DER$1._parseInt(m);if(_.length)throw new e("Invalid signature: left bytes after parsing");return{r:c,s:y}},hexFromSig(t){const e=k=>Number.parseInt(k[0],16)&8?"00"+k:k,r=k=>{const C=k.toString(16);return C.length&1?`0${C}`:C},l=e(r(t.s)),c=e(r(t.r)),m=l.length/2,y=c.length/2,_=r(m),w=r(y);return`30${r(y+m+4)}02${w}${c}02${_}${l}`}},_0n$6=BigInt(0),_1n$6=BigInt(1);BigInt(2);const _3n$2=BigInt(3);BigInt(4);function weierstrassPoints(t){const e=validatePointOpts(t),{Fp:r}=e,l=e.toBytes||((M,B,j)=>{const re=B.toAffine();return concatBytes$2(Uint8Array.from([4]),r.toBytes(re.x),r.toBytes(re.y))}),c=e.fromBytes||(M=>{const B=M.subarray(1),j=r.fromBytes(B.subarray(0,r.BYTES)),re=r.fromBytes(B.subarray(r.BYTES,2*r.BYTES));return{x:j,y:re}});function m(M){const{a:B,b:j}=e,re=r.sqr(M),de=r.mul(re,M);return r.add(r.add(de,r.mul(M,B)),j)}if(!r.eql(r.sqr(e.Gy),m(e.Gx)))throw new Error("bad generator point: equation left != right");function y(M){return typeof M=="bigint"&&_0n$6<M&&M<e.n}function _(M){if(!y(M))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function w(M){const{allowedPrivateKeyLengths:B,nByteLength:j,wrapPrivateKey:re,n:de}=e;if(B&&typeof M!="bigint"){if(M instanceof Uint8Array&&(M=bytesToHex$2(M)),typeof M!="string"||!B.includes(M.length))throw new Error("Invalid key");M=M.padStart(j*2,"0")}let se;try{se=typeof M=="bigint"?M:bytesToNumberBE$1(ensureBytes$1("private key",M,j))}catch{throw new Error(`private key must be ${j} bytes, hex or bigint, not ${typeof M}`)}return re&&(se=mod$1(se,de)),_(se),se}const k=new Map;function C(M){if(!(M instanceof R))throw new Error("ProjectivePoint expected")}class R{constructor(B,j,re){if(this.px=B,this.py=j,this.pz=re,B==null||!r.isValid(B))throw new Error("x required");if(j==null||!r.isValid(j))throw new Error("y required");if(re==null||!r.isValid(re))throw new Error("z required")}static fromAffine(B){const{x:j,y:re}=B||{};if(!B||!r.isValid(j)||!r.isValid(re))throw new Error("invalid affine point");if(B instanceof R)throw new Error("projective point not allowed");const de=se=>r.eql(se,r.ZERO);return de(j)&&de(re)?R.ZERO:new R(j,re,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(B){const j=r.invertBatch(B.map(re=>re.pz));return B.map((re,de)=>re.toAffine(j[de])).map(R.fromAffine)}static fromHex(B){const j=R.fromAffine(c(ensureBytes$1("pointHex",B)));return j.assertValidity(),j}static fromPrivateKey(B){return R.BASE.multiply(w(B))}_setWindowSize(B){this._WINDOW_SIZE=B,k.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!r.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:B,y:j}=this.toAffine();if(!r.isValid(B)||!r.isValid(j))throw new Error("bad point: x or y not FE");const re=r.sqr(j),de=m(B);if(!r.eql(re,de))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:B}=this.toAffine();if(r.isOdd)return!r.isOdd(B);throw new Error("Field doesn't support isOdd")}equals(B){C(B);const{px:j,py:re,pz:de}=this,{px:se,py:ye,pz:z}=B,W=r.eql(r.mul(j,z),r.mul(se,de)),Q=r.eql(r.mul(re,z),r.mul(ye,de));return W&&Q}negate(){return new R(this.px,r.neg(this.py),this.pz)}double(){const{a:B,b:j}=e,re=r.mul(j,_3n$2),{px:de,py:se,pz:ye}=this;let z=r.ZERO,W=r.ZERO,Q=r.ZERO,te=r.mul(de,de),le=r.mul(se,se),me=r.mul(ye,ye),F=r.mul(de,se);return F=r.add(F,F),Q=r.mul(de,ye),Q=r.add(Q,Q),z=r.mul(B,Q),W=r.mul(re,me),W=r.add(z,W),z=r.sub(le,W),W=r.add(le,W),W=r.mul(z,W),z=r.mul(F,z),Q=r.mul(re,Q),me=r.mul(B,me),F=r.sub(te,me),F=r.mul(B,F),F=r.add(F,Q),Q=r.add(te,te),te=r.add(Q,te),te=r.add(te,me),te=r.mul(te,F),W=r.add(W,te),me=r.mul(se,ye),me=r.add(me,me),te=r.mul(me,F),z=r.sub(z,te),Q=r.mul(me,le),Q=r.add(Q,Q),Q=r.add(Q,Q),new R(z,W,Q)}add(B){C(B);const{px:j,py:re,pz:de}=this,{px:se,py:ye,pz:z}=B;let W=r.ZERO,Q=r.ZERO,te=r.ZERO;const le=e.a,me=r.mul(e.b,_3n$2);let F=r.mul(j,se),K=r.mul(re,ye),D=r.mul(de,z),Y=r.add(j,re),$=r.add(se,ye);Y=r.mul(Y,$),$=r.add(F,K),Y=r.sub(Y,$),$=r.add(j,de);let U=r.add(se,z);return $=r.mul($,U),U=r.add(F,D),$=r.sub($,U),U=r.add(re,de),W=r.add(ye,z),U=r.mul(U,W),W=r.add(K,D),U=r.sub(U,W),te=r.mul(le,$),W=r.mul(me,D),te=r.add(W,te),W=r.sub(K,te),te=r.add(K,te),Q=r.mul(W,te),K=r.add(F,F),K=r.add(K,F),D=r.mul(le,D),$=r.mul(me,$),K=r.add(K,D),D=r.sub(F,D),D=r.mul(le,D),$=r.add($,D),F=r.mul(K,$),Q=r.add(Q,F),F=r.mul(U,$),W=r.mul(Y,W),W=r.sub(W,F),F=r.mul(Y,K),te=r.mul(U,te),te=r.add(te,F),new R(W,Q,te)}subtract(B){return this.add(B.negate())}is0(){return this.equals(R.ZERO)}wNAF(B){return A.wNAFCached(this,k,B,j=>{const re=r.invertBatch(j.map(de=>de.pz));return j.map((de,se)=>de.toAffine(re[se])).map(R.fromAffine)})}multiplyUnsafe(B){const j=R.ZERO;if(B===_0n$6)return j;if(_(B),B===_1n$6)return this;const{endo:re}=e;if(!re)return A.unsafeLadder(this,B);let{k1neg:de,k1:se,k2neg:ye,k2:z}=re.splitScalar(B),W=j,Q=j,te=this;for(;se>_0n$6||z>_0n$6;)se&_1n$6&&(W=W.add(te)),z&_1n$6&&(Q=Q.add(te)),te=te.double(),se>>=_1n$6,z>>=_1n$6;return de&&(W=W.negate()),ye&&(Q=Q.negate()),Q=new R(r.mul(Q.px,re.beta),Q.py,Q.pz),W.add(Q)}multiply(B){_(B);let j=B,re,de;const{endo:se}=e;if(se){const{k1neg:ye,k1:z,k2neg:W,k2:Q}=se.splitScalar(j);let{p:te,f:le}=this.wNAF(z),{p:me,f:F}=this.wNAF(Q);te=A.constTimeNegate(ye,te),me=A.constTimeNegate(W,me),me=new R(r.mul(me.px,se.beta),me.py,me.pz),re=te.add(me),de=le.add(F)}else{const{p:ye,f:z}=this.wNAF(j);re=ye,de=z}return R.normalizeZ([re,de])[0]}multiplyAndAddUnsafe(B,j,re){const de=R.BASE,se=(z,W)=>W===_0n$6||W===_1n$6||!z.equals(de)?z.multiplyUnsafe(W):z.multiply(W),ye=se(this,j).add(se(B,re));return ye.is0()?void 0:ye}toAffine(B){const{px:j,py:re,pz:de}=this,se=this.is0();B==null&&(B=se?r.ONE:r.inv(de));const ye=r.mul(j,B),z=r.mul(re,B),W=r.mul(de,B);if(se)return{x:r.ZERO,y:r.ZERO};if(!r.eql(W,r.ONE))throw new Error("invZ was invalid");return{x:ye,y:z}}isTorsionFree(){const{h:B,isTorsionFree:j}=e;if(B===_1n$6)return!0;if(j)return j(R,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:B,clearCofactor:j}=e;return B===_1n$6?this:j?j(R,this):this.multiplyUnsafe(e.h)}toRawBytes(B=!0){return this.assertValidity(),l(R,this,B)}toHex(B=!0){return bytesToHex$2(this.toRawBytes(B))}}R.BASE=new R(e.Gx,e.Gy,r.ONE),R.ZERO=new R(r.ZERO,r.ONE,r.ZERO);const T=e.nBitLength,A=wNAF$1(R,e.endo?Math.ceil(T/2):T);return{CURVE:e,ProjectivePoint:R,normPrivateKeyToScalar:w,weierstrassEquation:m,isWithinCurveOrder:y}}function validateOpts(t){const e=validateBasic(t);return validateObject(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function weierstrass$1(t){const e=validateOpts(t),{Fp:r,n:l}=e,c=r.BYTES+1,m=2*r.BYTES+1;function y($){return _0n$6<$&&$<r.ORDER}function _($){return mod$1($,l)}function w($){return invert$1($,l)}const{ProjectivePoint:k,normPrivateKeyToScalar:C,weierstrassEquation:R,isWithinCurveOrder:T}=weierstrassPoints({...e,toBytes($,U,ne){const V=U.toAffine(),ae=r.toBytes(V.x),q=concatBytes$2;return ne?q(Uint8Array.from([U.hasEvenY()?2:3]),ae):q(Uint8Array.from([4]),ae,r.toBytes(V.y))},fromBytes($){const U=$.length,ne=$[0],V=$.subarray(1);if(U===c&&(ne===2||ne===3)){const ae=bytesToNumberBE$1(V);if(!y(ae))throw new Error("Point is not on curve");const q=R(ae);let I=r.sqrt(q);const G=(I&_1n$6)===_1n$6;return(ne&1)===1!==G&&(I=r.neg(I)),{x:ae,y:I}}else if(U===m&&ne===4){const ae=r.fromBytes(V.subarray(0,r.BYTES)),q=r.fromBytes(V.subarray(r.BYTES,2*r.BYTES));return{x:ae,y:q}}else throw new Error(`Point of length ${U} was invalid. Expected ${c} compressed bytes or ${m} uncompressed bytes`)}}),A=$=>bytesToHex$2(numberToBytesBE$1($,e.nByteLength));function M($){const U=l>>_1n$6;return $>U}function B($){return M($)?_(-$):$}const j=($,U,ne)=>bytesToNumberBE$1($.slice(U,ne));class re{constructor(U,ne,V){this.r=U,this.s=ne,this.recovery=V,this.assertValidity()}static fromCompact(U){const ne=e.nByteLength;return U=ensureBytes$1("compactSignature",U,ne*2),new re(j(U,0,ne),j(U,ne,2*ne))}static fromDER(U){const{r:ne,s:V}=DER$1.toSig(ensureBytes$1("DER",U));return new re(ne,V)}assertValidity(){if(!T(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!T(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(U){return new re(this.r,this.s,U)}recoverPublicKey(U){const{r:ne,s:V,recovery:ae}=this,q=Q(ensureBytes$1("msgHash",U));if(ae==null||![0,1,2,3].includes(ae))throw new Error("recovery id invalid");const I=ae===2||ae===3?ne+e.n:ne;if(I>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");const G=(ae&1)===0?"02":"03",Ee=k.fromHex(G+A(I)),we=w(I),pe=_(-q*we),_e=_(V*we),Re=k.BASE.multiplyAndAddUnsafe(Ee,pe,_e);if(!Re)throw new Error("point at infinify");return Re.assertValidity(),Re}hasHighS(){return M(this.s)}normalizeS(){return this.hasHighS()?new re(this.r,_(-this.s),this.recovery):this}toDERRawBytes(){return hexToBytes$2(this.toDERHex())}toDERHex(){return DER$1.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return hexToBytes$2(this.toCompactHex())}toCompactHex(){return A(this.r)+A(this.s)}}const de={isValidPrivateKey($){try{return C($),!0}catch{return!1}},normPrivateKeyToScalar:C,randomPrivateKey:()=>{const $=getMinHashLength$1(e.n);return mapHashToField$1(e.randomBytes($),e.n)},precompute($=8,U=k.BASE){return U._setWindowSize($),U.multiply(BigInt(3)),U}};function se($,U=!0){return k.fromPrivateKey($).toRawBytes(U)}function ye($){const U=$ instanceof Uint8Array,ne=typeof $=="string",V=(U||ne)&&$.length;return U?V===c||V===m:ne?V===2*c||V===2*m:$ instanceof k}function z($,U,ne=!0){if(ye($))throw new Error("first arg must be private key");if(!ye(U))throw new Error("second arg must be public key");return k.fromHex(U).multiply(C($)).toRawBytes(ne)}const W=e.bits2int||function($){const U=bytesToNumberBE$1($),ne=$.length*8-e.nBitLength;return ne>0?U>>BigInt(ne):U},Q=e.bits2int_modN||function($){return _(W($))},te=bitMask$1(e.nBitLength);function le($){if(typeof $!="bigint")throw new Error("bigint expected");if(!(_0n$6<=$&&$<te))throw new Error(`bigint expected < 2^${e.nBitLength}`);return numberToBytesBE$1($,e.nByteLength)}function me($,U,ne=F){if(["recovered","canonical"].some(Me=>Me in ne))throw new Error("sign() legacy options not supported");const{hash:V,randomBytes:ae}=e;let{lowS:q,prehash:I,extraEntropy:G}=ne;q==null&&(q=!0),$=ensureBytes$1("msgHash",$),I&&($=ensureBytes$1("prehashed msgHash",V($)));const Ee=Q($),we=C(U),pe=[le(we),le(Ee)];if(G!=null){const Me=G===!0?ae(r.BYTES):G;pe.push(ensureBytes$1("extraEntropy",Me))}const _e=concatBytes$2(...pe),Re=Ee;function Ie(Me){const Ke=W(Me);if(!T(Ke))return;const kt=w(Ke),at=k.BASE.multiply(Ke).toAffine(),vt=_(at.x);if(vt===_0n$6)return;const Cn=_(kt*_(Re+vt*we));if(Cn===_0n$6)return;let ur=(at.x===vt?0:2)|Number(at.y&_1n$6),cr=Cn;return q&&M(Cn)&&(cr=B(Cn),ur^=1),new re(vt,cr,ur)}return{seed:_e,k2sig:Ie}}const F={lowS:e.lowS,prehash:!1},K={lowS:e.lowS,prehash:!1};function D($,U,ne=F){const{seed:V,k2sig:ae}=me($,U,ne),q=e;return createHmacDrbg$1(q.hash.outputLen,q.nByteLength,q.hmac)(V,ae)}k.BASE._setWindowSize(8);function Y($,U,ne,V=K){const ae=$;if(U=ensureBytes$1("msgHash",U),ne=ensureBytes$1("publicKey",ne),"strict"in V)throw new Error("options.strict was renamed to lowS");const{lowS:q,prehash:I}=V;let G,Ee;try{if(typeof ae=="string"||ae instanceof Uint8Array)try{G=re.fromDER(ae)}catch(at){if(!(at instanceof DER$1.Err))throw at;G=re.fromCompact(ae)}else if(typeof ae=="object"&&typeof ae.r=="bigint"&&typeof ae.s=="bigint"){const{r:at,s:vt}=ae;G=new re(at,vt)}else throw new Error("PARSE");Ee=k.fromHex(ne)}catch(at){if(at.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(q&&G.hasHighS())return!1;I&&(U=e.hash(U));const{r:we,s:pe}=G,_e=Q(U),Re=w(pe),Ie=_(_e*Re),Me=_(we*Re),Ke=k.BASE.multiplyAndAddUnsafe(Ee,Ie,Me)?.toAffine();return Ke?_(Ke.x)===we:!1}return{CURVE:e,getPublicKey:se,getSharedSecret:z,sign:D,verify:Y,ProjectivePoint:k,Signature:re,utils:de}}let HMAC$2=class extends Hash$2{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,hash$1(e);const l=toBytes$2(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const c=this.blockLen,m=new Uint8Array(c);m.set(l.length>c?e.create().update(l).digest():l);for(let y=0;y<m.length;y++)m[y]^=54;this.iHash.update(m),this.oHash=e.create();for(let y=0;y<m.length;y++)m[y]^=106;this.oHash.update(m),m.fill(0)}update(e){return exists$1(this),this.iHash.update(e),this}digestInto(e){exists$1(this),bytes$2(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:r,iHash:l,finished:c,destroyed:m,blockLen:y,outputLen:_}=this;return e=e,e.finished=c,e.destroyed=m,e.blockLen=y,e.outputLen=_,e.oHash=r._cloneInto(e.oHash),e.iHash=l._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const hmac$2=(t,e,r)=>new HMAC$2(t,e).update(r).digest();hmac$2.create=(t,e)=>new HMAC$2(t,e);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function getHash(t){return{hash:t,hmac:(e,...r)=>hmac$2(t,e,concatBytes$3(...r)),randomBytes:randomBytes$2}}function createCurve$1(t,e){const r=l=>weierstrass$1({...t,...getHash(l)});return Object.freeze({...r(e),create:r})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const secp256k1P=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),secp256k1N=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),_1n$5=BigInt(1),_2n$3=BigInt(2),divNearest$1=(t,e)=>(t+e/_2n$3)/e;function sqrtMod$1(t){const e=secp256k1P,r=BigInt(3),l=BigInt(6),c=BigInt(11),m=BigInt(22),y=BigInt(23),_=BigInt(44),w=BigInt(88),k=t*t*t%e,C=k*k*t%e,R=pow2$1(C,r,e)*C%e,T=pow2$1(R,r,e)*C%e,A=pow2$1(T,_2n$3,e)*k%e,M=pow2$1(A,c,e)*A%e,B=pow2$1(M,m,e)*M%e,j=pow2$1(B,_,e)*B%e,re=pow2$1(j,w,e)*j%e,de=pow2$1(re,_,e)*B%e,se=pow2$1(de,r,e)*C%e,ye=pow2$1(se,y,e)*M%e,z=pow2$1(ye,l,e)*k%e,W=pow2$1(z,_2n$3,e);if(!Fp.eql(Fp.sqr(W),t))throw new Error("Cannot find square root");return W}const Fp=Field$1(secp256k1P,void 0,void 0,{sqrt:sqrtMod$1}),secp256k1$1=createCurve$1({a:BigInt(0),b:BigInt(7),Fp,n:secp256k1N,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=secp256k1N,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),l=-_1n$5*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),c=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),m=r,y=BigInt("0x100000000000000000000000000000000"),_=divNearest$1(m*t,e),w=divNearest$1(-l*t,e);let k=mod$1(t-_*r-w*c,e),C=mod$1(-_*l-w*m,e);const R=k>y,T=C>y;if(R&&(k=e-k),T&&(C=e-C),k>y||C>y)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:R,k1:k,k2neg:T,k2:C}}}},sha256$3),_0n$5=BigInt(0),fe=t=>typeof t=="bigint"&&_0n$5<t&&t<secp256k1P,ge=t=>typeof t=="bigint"&&_0n$5<t&&t<secp256k1N,TAGGED_HASH_PREFIXES$1={};function taggedHash$1(t,...e){let r=TAGGED_HASH_PREFIXES$1[t];if(r===void 0){const l=sha256$3(Uint8Array.from(t,c=>c.charCodeAt(0)));r=concatBytes$2(l,l),TAGGED_HASH_PREFIXES$1[t]=r}return sha256$3(concatBytes$2(r,...e))}const pointToBytes$1=t=>t.toRawBytes(!0).slice(1),numTo32b=t=>numberToBytesBE$1(t,32),modP=t=>mod$1(t,secp256k1P),modN=t=>mod$1(t,secp256k1N),Point=secp256k1$1.ProjectivePoint,GmulAdd=(t,e,r)=>Point.BASE.multiplyAndAddUnsafe(t,e,r);function schnorrGetExtPubKey$1(t){let e=secp256k1$1.utils.normPrivateKeyToScalar(t),r=Point.fromPrivateKey(e);return{scalar:r.hasEvenY()?e:modN(-e),bytes:pointToBytes$1(r)}}function lift_x$1(t){if(!fe(t))throw new Error("bad x: need 0 < x < p");const e=modP(t*t),r=modP(e*t+BigInt(7));let l=sqrtMod$1(r);l%_2n$3!==_0n$5&&(l=modP(-l));const c=new Point(t,l,_1n$5);return c.assertValidity(),c}function challenge$1(...t){return modN(bytesToNumberBE$1(taggedHash$1("BIP0340/challenge",...t)))}function schnorrGetPublicKey$1(t){return schnorrGetExtPubKey$1(t).bytes}function schnorrSign$1(t,e,r=randomBytes$2(32)){const l=ensureBytes$1("message",t),{bytes:c,scalar:m}=schnorrGetExtPubKey$1(e),y=ensureBytes$1("auxRand",r,32),_=numTo32b(m^bytesToNumberBE$1(taggedHash$1("BIP0340/aux",y))),w=taggedHash$1("BIP0340/nonce",_,c,l),k=modN(bytesToNumberBE$1(w));if(k===_0n$5)throw new Error("sign failed: k is zero");const{bytes:C,scalar:R}=schnorrGetExtPubKey$1(k),T=challenge$1(C,c,l),A=new Uint8Array(64);if(A.set(C,0),A.set(numTo32b(modN(R+T*m)),32),!schnorrVerify$1(A,l,c))throw new Error("sign: Invalid signature produced");return A}function schnorrVerify$1(t,e,r){const l=ensureBytes$1("signature",t,64),c=ensureBytes$1("message",e),m=ensureBytes$1("publicKey",r,32);try{const y=lift_x$1(bytesToNumberBE$1(m)),_=bytesToNumberBE$1(l.subarray(0,32));if(!fe(_))return!1;const w=bytesToNumberBE$1(l.subarray(32,64));if(!ge(w))return!1;const k=challenge$1(numTo32b(_),pointToBytes$1(y),c),C=GmulAdd(y,w,modN(-k));return!(!C||!C.hasEvenY()||C.toAffine().x!==_)}catch{return!1}}const schnorr$1={getPublicKey:schnorrGetPublicKey$1,sign:schnorrSign$1,verify:schnorrVerify$1,utils:{randomPrivateKey:secp256k1$1.utils.randomPrivateKey,lift_x:lift_x$1,pointToBytes:pointToBytes$1,numberToBytesBE:numberToBytesBE$1,bytesToNumberBE:bytesToNumberBE$1,taggedHash:taggedHash$1,mod:mod$1}},crypto$2=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const u8a=t=>t instanceof Uint8Array,createView$1=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),rotr$1=(t,e)=>t<<32-e|t>>>e,isLE$1=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!isLE$1)throw new Error("Non little-endian hardware is not supported");const hexes$1=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function bytesToHex$1(t){if(!u8a(t))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=hexes$1[t[r]];return e}function hexToBytes$1(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(e/2);for(let l=0;l<r.length;l++){const c=l*2,m=t.slice(c,c+2),y=Number.parseInt(m,16);if(Number.isNaN(y)||y<0)throw new Error("Invalid byte sequence");r[l]=y}return r}function utf8ToBytes$1(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function toBytes$1(t){if(typeof t=="string"&&(t=utf8ToBytes$1(t)),!u8a(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}function concatBytes$1(...t){const e=new Uint8Array(t.reduce((l,c)=>l+c.length,0));let r=0;return t.forEach(l=>{if(!u8a(l))throw new Error("Uint8Array expected");e.set(l,r),r+=l.length}),e}let Hash$1=class{clone(){return this._cloneInto()}};function wrapConstructor(t){const e=l=>t().update(toBytes$1(l)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function randomBytes$1(t=32){if(crypto$2&&typeof crypto$2.getRandomValues=="function")return crypto$2.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}function number$1(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function bool$1(t){if(typeof t!="boolean")throw new Error(`Expected boolean, not ${t}`)}function bytes$1(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function hash(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");number$1(t.outputLen),number$1(t.blockLen)}function exists(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function output(t,e){bytes$1(t);const r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}const assert={number:number$1,bool:bool$1,bytes:bytes$1,hash,exists,output};function setBigUint64$1(t,e,r,l){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,l);const c=BigInt(32),m=BigInt(4294967295),y=Number(r>>c&m),_=Number(r&m),w=l?4:0,k=l?0:4;t.setUint32(e+w,y,l),t.setUint32(e+k,_,l)}class SHA2 extends Hash$1{constructor(e,r,l,c){super(),this.blockLen=e,this.outputLen=r,this.padOffset=l,this.isLE=c,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=createView$1(this.buffer)}update(e){assert.exists(this);const{view:r,buffer:l,blockLen:c}=this;e=toBytes$1(e);const m=e.length;for(let y=0;y<m;){const _=Math.min(c-this.pos,m-y);if(_===c){const w=createView$1(e);for(;c<=m-y;y+=c)this.process(w,y);continue}l.set(e.subarray(y,y+_),this.pos),this.pos+=_,y+=_,this.pos===c&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){assert.exists(this),assert.output(e,this),this.finished=!0;const{buffer:r,view:l,blockLen:c,isLE:m}=this;let{pos:y}=this;r[y++]=128,this.buffer.subarray(y).fill(0),this.padOffset>c-y&&(this.process(l,0),y=0);for(let R=y;R<c;R++)r[R]=0;setBigUint64$1(l,c-8,BigInt(this.length*8),m),this.process(l,0);const _=createView$1(e),w=this.outputLen;if(w%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const k=w/4,C=this.get();if(k>C.length)throw new Error("_sha2: outputLen bigger than state");for(let R=0;R<k;R++)_.setUint32(4*R,C[R],m)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const l=e.slice(0,r);return this.destroy(),l}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:l,length:c,finished:m,destroyed:y,pos:_}=this;return e.length=c,e.pos=_,e.finished=m,e.destroyed=y,c%r&&e.buffer.set(l),e}}const Chi$1=(t,e,r)=>t&e^~t&r,Maj$1=(t,e,r)=>t&e^t&r^e&r,SHA256_K$1=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),IV=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),SHA256_W$1=new Uint32Array(64);let SHA256$1=class extends SHA2{constructor(){super(64,32,8,!1),this.A=IV[0]|0,this.B=IV[1]|0,this.C=IV[2]|0,this.D=IV[3]|0,this.E=IV[4]|0,this.F=IV[5]|0,this.G=IV[6]|0,this.H=IV[7]|0}get(){const{A:e,B:r,C:l,D:c,E:m,F:y,G:_,H:w}=this;return[e,r,l,c,m,y,_,w]}set(e,r,l,c,m,y,_,w){this.A=e|0,this.B=r|0,this.C=l|0,this.D=c|0,this.E=m|0,this.F=y|0,this.G=_|0,this.H=w|0}process(e,r){for(let R=0;R<16;R++,r+=4)SHA256_W$1[R]=e.getUint32(r,!1);for(let R=16;R<64;R++){const T=SHA256_W$1[R-15],A=SHA256_W$1[R-2],M=rotr$1(T,7)^rotr$1(T,18)^T>>>3,B=rotr$1(A,17)^rotr$1(A,19)^A>>>10;SHA256_W$1[R]=B+SHA256_W$1[R-7]+M+SHA256_W$1[R-16]|0}let{A:l,B:c,C:m,D:y,E:_,F:w,G:k,H:C}=this;for(let R=0;R<64;R++){const T=rotr$1(_,6)^rotr$1(_,11)^rotr$1(_,25),A=C+T+Chi$1(_,w,k)+SHA256_K$1[R]+SHA256_W$1[R]|0,B=(rotr$1(l,2)^rotr$1(l,13)^rotr$1(l,22))+Maj$1(l,c,m)|0;C=k,k=w,w=_,_=y+A|0,y=m,m=c,c=l,l=A+B|0}l=l+this.A|0,c=c+this.B|0,m=m+this.C|0,y=y+this.D|0,_=_+this.E|0,w=w+this.F|0,k=k+this.G|0,C=C+this.H|0,this.set(l,c,m,y,_,w,k,C)}roundClean(){SHA256_W$1.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};class SHA224 extends SHA256$1{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const sha256$2=wrapConstructor(()=>new SHA256$1);wrapConstructor(()=>new SHA224);/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */function assertNumber(t){if(!Number.isSafeInteger(t))throw new Error(`Wrong integer: ${t}`)}function chain(...t){const e=(c,m)=>y=>c(m(y)),r=Array.from(t).reverse().reduce((c,m)=>c?e(c,m.encode):m.encode,void 0),l=t.reduce((c,m)=>c?e(c,m.decode):m.decode,void 0);return{encode:r,decode:l}}function alphabet(t){return{encode:e=>{if(!Array.isArray(e)||e.length&&typeof e[0]!="number")throw new Error("alphabet.encode input should be an array of numbers");return e.map(r=>{if(assertNumber(r),r<0||r>=t.length)throw new Error(`Digit index outside alphabet: ${r} (alphabet: ${t.length})`);return t[r]})},decode:e=>{if(!Array.isArray(e)||e.length&&typeof e[0]!="string")throw new Error("alphabet.decode input should be array of strings");return e.map(r=>{if(typeof r!="string")throw new Error(`alphabet.decode: not string element=${r}`);const l=t.indexOf(r);if(l===-1)throw new Error(`Unknown letter: "${r}". Allowed: ${t}`);return l})}}}function join(t=""){if(typeof t!="string")throw new Error("join separator should be string");return{encode:e=>{if(!Array.isArray(e)||e.length&&typeof e[0]!="string")throw new Error("join.encode input should be array of strings");for(let r of e)if(typeof r!="string")throw new Error(`join.encode: non-string input=${r}`);return e.join(t)},decode:e=>{if(typeof e!="string")throw new Error("join.decode input should be string");return e.split(t)}}}function padding(t,e="="){if(assertNumber(t),typeof e!="string")throw new Error("padding chr should be string");return{encode(r){if(!Array.isArray(r)||r.length&&typeof r[0]!="string")throw new Error("padding.encode input should be array of strings");for(let l of r)if(typeof l!="string")throw new Error(`padding.encode: non-string input=${l}`);for(;r.length*t%8;)r.push(e);return r},decode(r){if(!Array.isArray(r)||r.length&&typeof r[0]!="string")throw new Error("padding.encode input should be array of strings");for(let c of r)if(typeof c!="string")throw new Error(`padding.decode: non-string input=${c}`);let l=r.length;if(l*t%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;l>0&&r[l-1]===e;l--)if(!((l-1)*t%8))throw new Error("Invalid padding: string has too much padding");return r.slice(0,l)}}}function normalize$1(t){if(typeof t!="function")throw new Error("normalize fn should be function");return{encode:e=>e,decode:e=>t(e)}}function convertRadix(t,e,r){if(e<2)throw new Error(`convertRadix: wrong from=${e}, base cannot be less than 2`);if(r<2)throw new Error(`convertRadix: wrong to=${r}, base cannot be less than 2`);if(!Array.isArray(t))throw new Error("convertRadix: data should be array");if(!t.length)return[];let l=0;const c=[],m=Array.from(t);for(m.forEach(y=>{if(assertNumber(y),y<0||y>=e)throw new Error(`Wrong integer: ${y}`)});;){let y=0,_=!0;for(let w=l;w<m.length;w++){const k=m[w],C=e*y+k;if(!Number.isSafeInteger(C)||e*y/e!==y||C-k!==e*y)throw new Error("convertRadix: carry overflow");if(y=C%r,m[w]=Math.floor(C/r),!Number.isSafeInteger(m[w])||m[w]*r+y!==C)throw new Error("convertRadix: carry overflow");if(_)m[w]?_=!1:l=w;else continue}if(c.push(y),_)break}for(let y=0;y<t.length-1&&t[y]===0;y++)c.push(0);return c.reverse()}const gcd=(t,e)=>e?gcd(e,t%e):t,radix2carry=(t,e)=>t+(e-gcd(t,e));function convertRadix2(t,e,r,l){if(!Array.isArray(t))throw new Error("convertRadix2: data should be array");if(e<=0||e>32)throw new Error(`convertRadix2: wrong from=${e}`);if(r<=0||r>32)throw new Error(`convertRadix2: wrong to=${r}`);if(radix2carry(e,r)>32)throw new Error(`convertRadix2: carry overflow from=${e} to=${r} carryBits=${radix2carry(e,r)}`);let c=0,m=0;const y=2**r-1,_=[];for(const w of t){if(assertNumber(w),w>=2**e)throw new Error(`convertRadix2: invalid data word=${w} from=${e}`);if(c=c<<e|w,m+e>32)throw new Error(`convertRadix2: carry overflow pos=${m} from=${e}`);for(m+=e;m>=r;m-=r)_.push((c>>m-r&y)>>>0);c&=2**m-1}if(c=c<<r-m&y,!l&&m>=e)throw new Error("Excess padding");if(!l&&c)throw new Error(`Non-zero padding: ${c}`);return l&&m>0&&_.push(c>>>0),_}function radix(t){return assertNumber(t),{encode:e=>{if(!(e instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return convertRadix(Array.from(e),2**8,t)},decode:e=>{if(!Array.isArray(e)||e.length&&typeof e[0]!="number")throw new Error("radix.decode input should be array of strings");return Uint8Array.from(convertRadix(e,t,2**8))}}}function radix2(t,e=!1){if(assertNumber(t),t<=0||t>32)throw new Error("radix2: bits should be in (0..32]");if(radix2carry(8,t)>32||radix2carry(t,8)>32)throw new Error("radix2: carry overflow");return{encode:r=>{if(!(r instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return convertRadix2(Array.from(r),8,t,!e)},decode:r=>{if(!Array.isArray(r)||r.length&&typeof r[0]!="number")throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(convertRadix2(r,t,8,e))}}}function unsafeWrapper(t){if(typeof t!="function")throw new Error("unsafeWrapper fn should be function");return function(...e){try{return t.apply(null,e)}catch{}}}const base16=chain(radix2(4),alphabet("0123456789ABCDEF"),join("")),base32$1=chain(radix2(5),alphabet("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),padding(5),join(""));chain(radix2(5),alphabet("0123456789ABCDEFGHIJKLMNOPQRSTUV"),padding(5),join(""));chain(radix2(5),alphabet("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),join(""),normalize$1(t=>t.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1")));const base64=chain(radix2(6),alphabet("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),padding(6),join("")),base64url=chain(radix2(6),alphabet("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),padding(6),join("")),genBase58=t=>chain(radix(58),alphabet(t),join("")),base58=genBase58("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz");genBase58("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ");genBase58("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz");const XMR_BLOCK_LEN=[0,2,3,5,6,7,9,10,11],base58xmr={encode(t){let e="";for(let r=0;r<t.length;r+=8){const l=t.subarray(r,r+8);e+=base58.encode(l).padStart(XMR_BLOCK_LEN[l.length],"1")}return e},decode(t){let e=[];for(let r=0;r<t.length;r+=11){const l=t.slice(r,r+11),c=XMR_BLOCK_LEN.indexOf(l.length),m=base58.decode(l);for(let y=0;y<m.length-c;y++)if(m[y]!==0)throw new Error("base58xmr: wrong padding");e=e.concat(Array.from(m.slice(m.length-c)))}return Uint8Array.from(e)}},BECH_ALPHABET=chain(alphabet("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),join("")),POLYMOD_GENERATORS=[996825010,642813549,513874426,1027748829,705979059];function bech32Polymod(t){const e=t>>25;let r=(t&33554431)<<5;for(let l=0;l<POLYMOD_GENERATORS.length;l++)(e>>l&1)===1&&(r^=POLYMOD_GENERATORS[l]);return r}function bechChecksum(t,e,r=1){const l=t.length;let c=1;for(let m=0;m<l;m++){const y=t.charCodeAt(m);if(y<33||y>126)throw new Error(`Invalid prefix (${t})`);c=bech32Polymod(c)^y>>5}c=bech32Polymod(c);for(let m=0;m<l;m++)c=bech32Polymod(c)^t.charCodeAt(m)&31;for(let m of e)c=bech32Polymod(c)^m;for(let m=0;m<6;m++)c=bech32Polymod(c);return c^=r,BECH_ALPHABET.encode(convertRadix2([c%2**30],30,5,!1))}function genBech32(t){const e=t==="bech32"?1:734539939,r=radix2(5),l=r.decode,c=r.encode,m=unsafeWrapper(l);function y(C,R,T=90){if(typeof C!="string")throw new Error(`bech32.encode prefix should be string, not ${typeof C}`);if(!Array.isArray(R)||R.length&&typeof R[0]!="number")throw new Error(`bech32.encode words should be array of numbers, not ${typeof R}`);const A=C.length+7+R.length;if(T!==!1&&A>T)throw new TypeError(`Length ${A} exceeds limit ${T}`);return C=C.toLowerCase(),`${C}1${BECH_ALPHABET.encode(R)}${bechChecksum(C,R,e)}`}function _(C,R=90){if(typeof C!="string")throw new Error(`bech32.decode input should be string, not ${typeof C}`);if(C.length<8||R!==!1&&C.length>R)throw new TypeError(`Wrong string length: ${C.length} (${C}). Expected (8..${R})`);const T=C.toLowerCase();if(C!==T&&C!==C.toUpperCase())throw new Error("String must be lowercase or uppercase");C=T;const A=C.lastIndexOf("1");if(A===0||A===-1)throw new Error('Letter "1" must be present between prefix and data only');const M=C.slice(0,A),B=C.slice(A+1);if(B.length<6)throw new Error("Data must be at least 6 characters long");const j=BECH_ALPHABET.decode(B).slice(0,-6),re=bechChecksum(M,j,e);if(!B.endsWith(re))throw new Error(`Invalid checksum in ${C}: expected "${re}"`);return{prefix:M,words:j}}const w=unsafeWrapper(_);function k(C){const{prefix:R,words:T}=_(C,!1);return{prefix:R,words:T,bytes:l(T)}}return{encode:y,decode:_,decodeToBytes:k,decodeUnsafe:w,fromWords:l,fromWordsUnsafe:m,toWords:c}}const bech32=genBech32("bech32");genBech32("bech32m");const utf8={encode:t=>new TextDecoder().decode(t),decode:t=>new TextEncoder().encode(t)},hex=chain(radix2(4),alphabet("0123456789abcdef"),join(""),normalize$1(t=>{if(typeof t!="string"||t.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof t} with length ${t.length}`);return t.toLowerCase()})),CODERS={utf8,hex,base16,base32:base32$1,base64,base64url,base58,base58xmr};`${Object.keys(CODERS).join(", ")}`;function number(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`positive integer expected, not ${t}`)}function bool(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}function isBytes$1(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function bytes(t,...e){if(!isBytes$1(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */const u32=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!isLE)throw new Error("Non little-endian hardware is not supported");function checkOpts(t,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(t,e)}function equalBytes(t,e){if(t.length!==e.length)return!1;let r=0;for(let l=0;l<t.length;l++)r|=t[l]^e[l];return r===0}const wrapCipher=(t,e)=>(Object.assign(e,t),e),BLOCK_SIZE=16,POLY=283;function mul2(t){return t<<1^POLY&-(t>>7)}function mul(t,e){let r=0;for(;e>0;e>>=1)r^=t&-(e&1),t=mul2(t);return r}const sbox=(()=>{let t=new Uint8Array(256);for(let r=0,l=1;r<256;r++,l^=mul2(l))t[r]=l;const e=new Uint8Array(256);e[0]=99;for(let r=0;r<255;r++){let l=t[255-r];l|=l<<8,e[t[r]]=(l^l>>4^l>>5^l>>6^l>>7^99)&255}return e})(),invSbox=sbox.map((t,e)=>sbox.indexOf(e)),rotr32_8=t=>t<<24|t>>>8,rotl32_8=t=>t<<8|t>>>24;function genTtable(t,e){if(t.length!==256)throw new Error("Wrong sbox length");const r=new Uint32Array(256).map((k,C)=>e(t[C])),l=r.map(rotl32_8),c=l.map(rotl32_8),m=c.map(rotl32_8),y=new Uint32Array(256*256),_=new Uint32Array(256*256),w=new Uint16Array(256*256);for(let k=0;k<256;k++)for(let C=0;C<256;C++){const R=k*256+C;y[R]=r[k]^l[C],_[R]=c[k]^m[C],w[R]=t[k]<<8|t[C]}return{sbox:t,sbox2:w,T0:r,T1:l,T2:c,T3:m,T01:y,T23:_}}const tableEncoding=genTtable(sbox,t=>mul(t,3)<<24|t<<16|t<<8|mul(t,2)),tableDecoding=genTtable(invSbox,t=>mul(t,11)<<24|mul(t,13)<<16|mul(t,9)<<8|mul(t,14)),xPowers=(()=>{const t=new Uint8Array(16);for(let e=0,r=1;e<16;e++,r=mul2(r))t[e]=r;return t})();function expandKeyLE(t){bytes(t);const e=t.length;if(![16,24,32].includes(e))throw new Error(`aes: wrong key size: should be 16, 24 or 32, got: ${e}`);const{sbox2:r}=tableEncoding,l=u32(t),c=l.length,m=_=>applySbox(r,_,_,_,_),y=new Uint32Array(e+28);y.set(l);for(let _=c;_<y.length;_++){let w=y[_-1];_%c===0?w=m(rotr32_8(w))^xPowers[_/c-1]:c>6&&_%c===4&&(w=m(w)),y[_]=y[_-c]^w}return y}function expandKeyDecLE(t){const e=expandKeyLE(t),r=e.slice(),l=e.length,{sbox2:c}=tableEncoding,{T0:m,T1:y,T2:_,T3:w}=tableDecoding;for(let k=0;k<l;k+=4)for(let C=0;C<4;C++)r[k+C]=e[l-k-4+C];e.fill(0);for(let k=4;k<l-4;k++){const C=r[k],R=applySbox(c,C,C,C,C);r[k]=m[R&255]^y[R>>>8&255]^_[R>>>16&255]^w[R>>>24]}return r}function apply0123(t,e,r,l,c,m){return t[r<<8&65280|l>>>8&255]^e[c>>>8&65280|m>>>24&255]}function applySbox(t,e,r,l,c){return t[e&255|r&65280]|t[l>>>16&255|c>>>16&65280]<<16}function encrypt$2(t,e,r,l,c){const{sbox2:m,T01:y,T23:_}=tableEncoding;let w=0;e^=t[w++],r^=t[w++],l^=t[w++],c^=t[w++];const k=t.length/4-2;for(let M=0;M<k;M++){const B=t[w++]^apply0123(y,_,e,r,l,c),j=t[w++]^apply0123(y,_,r,l,c,e),re=t[w++]^apply0123(y,_,l,c,e,r),de=t[w++]^apply0123(y,_,c,e,r,l);e=B,r=j,l=re,c=de}const C=t[w++]^applySbox(m,e,r,l,c),R=t[w++]^applySbox(m,r,l,c,e),T=t[w++]^applySbox(m,l,c,e,r),A=t[w++]^applySbox(m,c,e,r,l);return{s0:C,s1:R,s2:T,s3:A}}function decrypt$2(t,e,r,l,c){const{sbox2:m,T01:y,T23:_}=tableDecoding;let w=0;e^=t[w++],r^=t[w++],l^=t[w++],c^=t[w++];const k=t.length/4-2;for(let M=0;M<k;M++){const B=t[w++]^apply0123(y,_,e,c,l,r),j=t[w++]^apply0123(y,_,r,e,c,l),re=t[w++]^apply0123(y,_,l,r,e,c),de=t[w++]^apply0123(y,_,c,l,r,e);e=B,r=j,l=re,c=de}const C=t[w++]^applySbox(m,e,c,l,r),R=t[w++]^applySbox(m,r,e,c,l),T=t[w++]^applySbox(m,l,r,e,c),A=t[w++]^applySbox(m,c,l,r,e);return{s0:C,s1:R,s2:T,s3:A}}function getDst(t,e){if(!e)return new Uint8Array(t);if(bytes(e),e.length<t)throw new Error(`aes: wrong destination length, expected at least ${t}, got: ${e.length}`);return e}function validateBlockDecrypt(t){if(bytes(t),t.length%BLOCK_SIZE!==0)throw new Error(`aes/(cbc-ecb).decrypt ciphertext should consist of blocks with size ${BLOCK_SIZE}`)}function validateBlockEncrypt(t,e,r){let l=t.length;const c=l%BLOCK_SIZE;if(!e&&c!==0)throw new Error("aec/(cbc-ecb): unpadded plaintext with disabled padding");const m=u32(t);if(e){let w=BLOCK_SIZE-c;w||(w=BLOCK_SIZE),l=l+w}const y=getDst(l,r),_=u32(y);return{b:m,o:_,out:y}}function validatePCKS(t,e){if(!e)return t;const r=t.length;if(!r)throw new Error("aes/pcks5: empty ciphertext not allowed");const l=t[r-1];if(l<=0||l>16)throw new Error(`aes/pcks5: wrong padding byte: ${l}`);const c=t.subarray(0,-l);for(let m=0;m<l;m++)if(t[r-m-1]!==l)throw new Error("aes/pcks5: wrong padding");return c}function padPCKS(t){const e=new Uint8Array(16),r=u32(e);e.set(t);const l=BLOCK_SIZE-t.length;for(let c=BLOCK_SIZE-l;c<BLOCK_SIZE;c++)e[c]=l;return r}const cbc=wrapCipher({blockSize:16,nonceLength:16},function t(e,r,l={}){bytes(e),bytes(r,16);const c=!l.disablePadding;return{encrypt:(m,y)=>{const _=expandKeyLE(e),{b:w,o:k,out:C}=validateBlockEncrypt(m,c,y),R=u32(r);let T=R[0],A=R[1],M=R[2],B=R[3],j=0;for(;j+4<=w.length;)T^=w[j+0],A^=w[j+1],M^=w[j+2],B^=w[j+3],{s0:T,s1:A,s2:M,s3:B}=encrypt$2(_,T,A,M,B),k[j++]=T,k[j++]=A,k[j++]=M,k[j++]=B;if(c){const re=padPCKS(m.subarray(j*4));T^=re[0],A^=re[1],M^=re[2],B^=re[3],{s0:T,s1:A,s2:M,s3:B}=encrypt$2(_,T,A,M,B),k[j++]=T,k[j++]=A,k[j++]=M,k[j++]=B}return _.fill(0),C},decrypt:(m,y)=>{validateBlockDecrypt(m);const _=expandKeyDecLE(e),w=u32(r),k=getDst(m.length,y),C=u32(m),R=u32(k);let T=w[0],A=w[1],M=w[2],B=w[3];for(let j=0;j+4<=C.length;){const re=T,de=A,se=M,ye=B;T=C[j+0],A=C[j+1],M=C[j+2],B=C[j+3];const{s0:z,s1:W,s2:Q,s3:te}=decrypt$2(_,T,A,M,B);R[j++]=z^re,R[j++]=W^de,R[j++]=Q^se,R[j++]=te^ye}return _.fill(0),validatePCKS(k,c)}}}),_utf8ToBytes=t=>Uint8Array.from(t.split("").map(e=>e.charCodeAt(0))),sigma16=_utf8ToBytes("expand 16-byte k"),sigma32=_utf8ToBytes("expand 32-byte k"),sigma16_32=u32(sigma16),sigma32_32=u32(sigma32);sigma32_32.slice();function rotl(t,e){return t<<e|t>>>32-e}function isAligned32(t){return t.byteOffset%4===0}const BLOCK_LEN=64,BLOCK_LEN32=16,MAX_COUNTER=2**32-1,U32_EMPTY=new Uint32Array;function runCipher(t,e,r,l,c,m,y,_){const w=c.length,k=new Uint8Array(BLOCK_LEN),C=u32(k),R=isAligned32(c)&&isAligned32(m),T=R?u32(c):U32_EMPTY,A=R?u32(m):U32_EMPTY;for(let M=0;M<w;y++){if(t(e,r,l,C,y,_),y>=MAX_COUNTER)throw new Error("arx: counter overflow");const B=Math.min(BLOCK_LEN,w-M);if(R&&B===BLOCK_LEN){const j=M/4;if(M%4!==0)throw new Error("arx: invalid block position");for(let re=0,de;re<BLOCK_LEN32;re++)de=j+re,A[de]=T[de]^C[re];M+=BLOCK_LEN;continue}for(let j=0,re;j<B;j++)re=M+j,m[re]=c[re]^k[j];M+=B}}function createCipher(t,e){const{allowShortKeys:r,extendNonceFn:l,counterLength:c,counterRight:m,rounds:y}=checkOpts({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof t!="function")throw new Error("core must be a function");return number(c),number(y),bool(m),bool(r),(_,w,k,C,R=0)=>{bytes(_),bytes(w),bytes(k);const T=k.length;if(C||(C=new Uint8Array(T)),bytes(C),number(R),R<0||R>=MAX_COUNTER)throw new Error("arx: counter overflow");if(C.length<T)throw new Error(`arx: output (${C.length}) is shorter than data (${T})`);const A=[];let M=_.length,B,j;if(M===32)B=_.slice(),A.push(B),j=sigma32_32;else if(M===16&&r)B=new Uint8Array(32),B.set(_),B.set(_,16),j=sigma16_32,A.push(B);else throw new Error(`arx: invalid 32-byte key, got length=${M}`);isAligned32(w)||(w=w.slice(),A.push(w));const re=u32(B);if(l){if(w.length!==24)throw new Error("arx: extended nonce must be 24 bytes");l(j,re,u32(w.subarray(0,16)),re),w=w.subarray(16)}const de=16-c;if(de!==w.length)throw new Error(`arx: nonce must be ${de} or 16 bytes`);if(de!==12){const ye=new Uint8Array(12);ye.set(w,m?0:12-w.length),w=ye,A.push(w)}const se=u32(w);for(runCipher(t,j,re,se,k,C,R,y);A.length>0;)A.pop().fill(0);return C}}function chachaCore(t,e,r,l,c,m=20){let y=t[0],_=t[1],w=t[2],k=t[3],C=e[0],R=e[1],T=e[2],A=e[3],M=e[4],B=e[5],j=e[6],re=e[7],de=c,se=r[0],ye=r[1],z=r[2],W=y,Q=_,te=w,le=k,me=C,F=R,K=T,D=A,Y=M,$=B,U=j,ne=re,V=de,ae=se,q=ye,I=z;for(let Ee=0;Ee<m;Ee+=2)W=W+me|0,V=rotl(V^W,16),Y=Y+V|0,me=rotl(me^Y,12),W=W+me|0,V=rotl(V^W,8),Y=Y+V|0,me=rotl(me^Y,7),Q=Q+F|0,ae=rotl(ae^Q,16),$=$+ae|0,F=rotl(F^$,12),Q=Q+F|0,ae=rotl(ae^Q,8),$=$+ae|0,F=rotl(F^$,7),te=te+K|0,q=rotl(q^te,16),U=U+q|0,K=rotl(K^U,12),te=te+K|0,q=rotl(q^te,8),U=U+q|0,K=rotl(K^U,7),le=le+D|0,I=rotl(I^le,16),ne=ne+I|0,D=rotl(D^ne,12),le=le+D|0,I=rotl(I^le,8),ne=ne+I|0,D=rotl(D^ne,7),W=W+F|0,I=rotl(I^W,16),U=U+I|0,F=rotl(F^U,12),W=W+F|0,I=rotl(I^W,8),U=U+I|0,F=rotl(F^U,7),Q=Q+K|0,V=rotl(V^Q,16),ne=ne+V|0,K=rotl(K^ne,12),Q=Q+K|0,V=rotl(V^Q,8),ne=ne+V|0,K=rotl(K^ne,7),te=te+D|0,ae=rotl(ae^te,16),Y=Y+ae|0,D=rotl(D^Y,12),te=te+D|0,ae=rotl(ae^te,8),Y=Y+ae|0,D=rotl(D^Y,7),le=le+me|0,q=rotl(q^le,16),$=$+q|0,me=rotl(me^$,12),le=le+me|0,q=rotl(q^le,8),$=$+q|0,me=rotl(me^$,7);let G=0;l[G++]=y+W|0,l[G++]=_+Q|0,l[G++]=w+te|0,l[G++]=k+le|0,l[G++]=C+me|0,l[G++]=R+F|0,l[G++]=T+K|0,l[G++]=A+D|0,l[G++]=M+Y|0,l[G++]=B+$|0,l[G++]=j+U|0,l[G++]=re+ne|0,l[G++]=de+V|0,l[G++]=se+ae|0,l[G++]=ye+q|0,l[G++]=z+I|0}const chacha20=createCipher(chachaCore,{counterRight:!1,counterLength:4,allowShortKeys:!1});let HMAC$1=class extends Hash$1{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,assert.hash(e);const l=toBytes$1(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const c=this.blockLen,m=new Uint8Array(c);m.set(l.length>c?e.create().update(l).digest():l);for(let y=0;y<m.length;y++)m[y]^=54;this.iHash.update(m),this.oHash=e.create();for(let y=0;y<m.length;y++)m[y]^=106;this.oHash.update(m),m.fill(0)}update(e){return assert.exists(this),this.iHash.update(e),this}digestInto(e){assert.exists(this),assert.bytes(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:r,iHash:l,finished:c,destroyed:m,blockLen:y,outputLen:_}=this;return e=e,e.finished=c,e.destroyed=m,e.blockLen=y,e.outputLen=_,e.oHash=r._cloneInto(e.oHash),e.iHash=l._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const hmac$1=(t,e,r)=>new HMAC$1(t,e).update(r).digest();hmac$1.create=(t,e)=>new HMAC$1(t,e);function extract(t,e,r){return assert.hash(t),hmac$1(t,toBytes$1(r),toBytes$1(e))}const HKDF_COUNTER=new Uint8Array([0]),EMPTY_BUFFER=new Uint8Array;function expand(t,e,r,l=32){if(assert.hash(t),assert.number(l),l>255*t.outputLen)throw new Error("Length should be <= 255*HashLen");const c=Math.ceil(l/t.outputLen);r===void 0&&(r=EMPTY_BUFFER);const m=new Uint8Array(c*t.outputLen),y=hmac$1.create(t,e),_=y._cloneInto(),w=new Uint8Array(y.outputLen);for(let k=0;k<c;k++)HKDF_COUNTER[0]=k+1,_.update(k===0?EMPTY_BUFFER:w).update(r).update(HKDF_COUNTER).digestInto(w),m.set(w,t.outputLen*k),y._cloneInto(_);return y.destroy(),_.destroy(),w.fill(0),HKDF_COUNTER.fill(0),m.slice(0,l)}var __defProp=Object.defineProperty,__export=(t,e)=>{for(var r in e)__defProp(t,r,{get:e[r],enumerable:!0})},verifiedSymbol=Symbol("verified"),isRecord=t=>t instanceof Object;function validateEvent(t){if(!isRecord(t)||typeof t.kind!="number"||typeof t.content!="string"||typeof t.created_at!="number"||typeof t.pubkey!="string"||!t.pubkey.match(/^[a-f0-9]{64}$/)||!Array.isArray(t.tags))return!1;for(let e=0;e<t.tags.length;e++){let r=t.tags[e];if(!Array.isArray(r))return!1;for(let l=0;l<r.length;l++)if(typeof r[l]!="string")return!1}return!0}var utils_exports={};__export(utils_exports,{Queue:()=>Queue$1,QueueNode:()=>QueueNode,binarySearch:()=>binarySearch,bytesToHex:()=>bytesToHex$1,hexToBytes:()=>hexToBytes$1,insertEventIntoAscendingList:()=>insertEventIntoAscendingList,insertEventIntoDescendingList:()=>insertEventIntoDescendingList,normalizeURL:()=>normalizeURL,utf8Decoder:()=>utf8Decoder,utf8Encoder:()=>utf8Encoder});var utf8Decoder=new TextDecoder("utf-8"),utf8Encoder=new TextEncoder;function normalizeURL(t){try{t.indexOf("://")===-1&&(t="wss://"+t);let e=new URL(t);return e.pathname=e.pathname.replace(/\/+/g,"/"),e.pathname.endsWith("/")&&(e.pathname=e.pathname.slice(0,-1)),(e.port==="80"&&e.protocol==="ws:"||e.port==="443"&&e.protocol==="wss:")&&(e.port=""),e.searchParams.sort(),e.hash="",e.toString()}catch{throw new Error(`Invalid URL: ${t}`)}}function insertEventIntoDescendingList(t,e){const[r,l]=binarySearch(t,c=>e.id===c.id?0:e.created_at===c.created_at?-1:c.created_at-e.created_at);return l||t.splice(r,0,e),t}function insertEventIntoAscendingList(t,e){const[r,l]=binarySearch(t,c=>e.id===c.id?0:e.created_at===c.created_at?-1:e.created_at-c.created_at);return l||t.splice(r,0,e),t}function binarySearch(t,e){let r=0,l=t.length-1;for(;r<=l;){const c=Math.floor((r+l)/2),m=e(t[c]);if(m===0)return[c,!0];m<0?l=c-1:r=c+1}return[r,!1]}var QueueNode=class{value;next=null;prev=null;constructor(t){this.value=t}},Queue$1=class{first;last;constructor(){this.first=null,this.last=null}enqueue(e){const r=new QueueNode(e);return this.last?this.last===this.first?(this.last=r,this.last.prev=this.first,this.first.next=r):(r.prev=this.last,this.last.next=r,this.last=r):(this.first=r,this.last=r),!0}dequeue(){if(!this.first)return null;if(this.first===this.last){const r=this.first;return this.first=null,this.last=null,r.value}const e=this.first;return this.first=e.next,this.first&&(this.first.prev=null),e.value}},JS=class{generateSecretKey(){return schnorr$1.utils.randomPrivateKey()}getPublicKey(t){return bytesToHex$1(schnorr$1.getPublicKey(t))}finalizeEvent(t,e){const r=t;return r.pubkey=bytesToHex$1(schnorr$1.getPublicKey(e)),r.id=getEventHash$1(r),r.sig=bytesToHex$1(schnorr$1.sign(getEventHash$1(r),e)),r[verifiedSymbol]=!0,r}verifyEvent(t){if(typeof t[verifiedSymbol]=="boolean")return t[verifiedSymbol];const e=getEventHash$1(t);if(e!==t.id)return t[verifiedSymbol]=!1,!1;try{const r=schnorr$1.verify(t.sig,e,t.pubkey);return t[verifiedSymbol]=r,r}catch{return t[verifiedSymbol]=!1,!1}}};function serializeEvent(t){if(!validateEvent(t))throw new Error("can't serialize event with wrong or missing properties");return JSON.stringify([0,t.pubkey,t.created_at,t.kind,t.tags,t.content])}function getEventHash$1(t){let e=sha256$2(utf8Encoder.encode(serializeEvent(t)));return bytesToHex$1(e)}var i=new JS,generateSecretKey=i.generateSecretKey,getPublicKey=i.getPublicKey,finalizeEvent=i.finalizeEvent,verifyEvent=i.verifyEvent,kinds_exports={};__export(kinds_exports,{Application:()=>Application,BadgeAward:()=>BadgeAward,BadgeDefinition:()=>BadgeDefinition,BlockedRelaysList:()=>BlockedRelaysList,BookmarkList:()=>BookmarkList,Bookmarksets:()=>Bookmarksets,Calendar:()=>Calendar,CalendarEventRSVP:()=>CalendarEventRSVP,ChannelCreation:()=>ChannelCreation,ChannelHideMessage:()=>ChannelHideMessage,ChannelMessage:()=>ChannelMessage,ChannelMetadata:()=>ChannelMetadata,ChannelMuteUser:()=>ChannelMuteUser,ClassifiedListing:()=>ClassifiedListing,ClientAuth:()=>ClientAuth,CommunitiesList:()=>CommunitiesList,CommunityDefinition:()=>CommunityDefinition,CommunityPostApproval:()=>CommunityPostApproval,Contacts:()=>Contacts,CreateOrUpdateProduct:()=>CreateOrUpdateProduct,CreateOrUpdateStall:()=>CreateOrUpdateStall,Curationsets:()=>Curationsets,Date:()=>Date2,DirectMessageRelaysList:()=>DirectMessageRelaysList,DraftClassifiedListing:()=>DraftClassifiedListing,DraftLong:()=>DraftLong,Emojisets:()=>Emojisets,EncryptedDirectMessage:()=>EncryptedDirectMessage,EventDeletion:()=>EventDeletion,FileMetadata:()=>FileMetadata,FileServerPreference:()=>FileServerPreference,Followsets:()=>Followsets,GenericRepost:()=>GenericRepost,Genericlists:()=>Genericlists,GiftWrap:()=>GiftWrap,HTTPAuth:()=>HTTPAuth,Handlerinformation:()=>Handlerinformation,Handlerrecommendation:()=>Handlerrecommendation,Highlights:()=>Highlights,InterestsList:()=>InterestsList,Interestsets:()=>Interestsets,JobFeedback:()=>JobFeedback,JobRequest:()=>JobRequest,JobResult:()=>JobResult,Label:()=>Label,LightningPubRPC:()=>LightningPubRPC,LiveChatMessage:()=>LiveChatMessage,LiveEvent:()=>LiveEvent,LongFormArticle:()=>LongFormArticle,Metadata:()=>Metadata,Mutelist:()=>Mutelist,NWCWalletInfo:()=>NWCWalletInfo,NWCWalletRequest:()=>NWCWalletRequest,NWCWalletResponse:()=>NWCWalletResponse,NostrConnect:()=>NostrConnect,OpenTimestamps:()=>OpenTimestamps,Pinlist:()=>Pinlist,PrivateDirectMessage:()=>PrivateDirectMessage,ProblemTracker:()=>ProblemTracker,ProfileBadges:()=>ProfileBadges,PublicChatsList:()=>PublicChatsList,Reaction:()=>Reaction,RecommendRelay:()=>RecommendRelay,RelayList:()=>RelayList,Relaysets:()=>Relaysets,Report:()=>Report,Reporting:()=>Reporting,Repost:()=>Repost,Seal:()=>Seal,SearchRelaysList:()=>SearchRelaysList,ShortTextNote:()=>ShortTextNote,Time:()=>Time,UserEmojiList:()=>UserEmojiList,UserStatuses:()=>UserStatuses,Zap:()=>Zap,ZapGoal:()=>ZapGoal,ZapRequest:()=>ZapRequest,classifyKind:()=>classifyKind,isAddressableKind:()=>isAddressableKind,isEphemeralKind:()=>isEphemeralKind,isKind:()=>isKind,isRegularKind:()=>isRegularKind,isReplaceableKind:()=>isReplaceableKind});function isRegularKind(t){return 1e3<=t&&t<1e4||[1,2,4,5,6,7,8,16,40,41,42,43,44].includes(t)}function isReplaceableKind(t){return[0,3].includes(t)||1e4<=t&&t<2e4}function isEphemeralKind(t){return 2e4<=t&&t<3e4}function isAddressableKind(t){return 3e4<=t&&t<4e4}function classifyKind(t){return isRegularKind(t)?"regular":isReplaceableKind(t)?"replaceable":isEphemeralKind(t)?"ephemeral":isAddressableKind(t)?"parameterized":"unknown"}function isKind(t,e){const r=e instanceof Array?e:[e];return validateEvent(t)&&r.includes(t.kind)||!1}var Metadata=0,ShortTextNote=1,RecommendRelay=2,Contacts=3,EncryptedDirectMessage=4,EventDeletion=5,Repost=6,Reaction=7,BadgeAward=8,Seal=13,PrivateDirectMessage=14,GenericRepost=16,ChannelCreation=40,ChannelMetadata=41,ChannelMessage=42,ChannelHideMessage=43,ChannelMuteUser=44,OpenTimestamps=1040,GiftWrap=1059,FileMetadata=1063,LiveChatMessage=1311,ProblemTracker=1971,Report=1984,Reporting=1984,Label=1985,CommunityPostApproval=4550,JobRequest=5999,JobResult=6999,JobFeedback=7e3,ZapGoal=9041,ZapRequest=9734,Zap=9735,Highlights=9802,Mutelist=1e4,Pinlist=10001,RelayList=10002,BookmarkList=10003,CommunitiesList=10004,PublicChatsList=10005,BlockedRelaysList=10006,SearchRelaysList=10007,InterestsList=10015,UserEmojiList=10030,DirectMessageRelaysList=10050,FileServerPreference=10096,NWCWalletInfo=13194,LightningPubRPC=21e3,ClientAuth=22242,NWCWalletRequest=23194,NWCWalletResponse=23195,NostrConnect=24133,HTTPAuth=27235,Followsets=3e4,Genericlists=30001,Relaysets=30002,Bookmarksets=30003,Curationsets=30004,ProfileBadges=30008,BadgeDefinition=30009,Interestsets=30015,CreateOrUpdateStall=30017,CreateOrUpdateProduct=30018,LongFormArticle=30023,DraftLong=30024,Emojisets=30030,Application=30078,LiveEvent=30311,UserStatuses=30315,ClassifiedListing=30402,DraftClassifiedListing=30403,Date2=31922,Time=31923,Calendar=31924,CalendarEventRSVP=31925,Handlerrecommendation=31989,Handlerinformation=31990,CommunityDefinition=34550;function matchFilter(t,e){if(t.ids&&t.ids.indexOf(e.id)===-1||t.kinds&&t.kinds.indexOf(e.kind)===-1||t.authors&&t.authors.indexOf(e.pubkey)===-1)return!1;for(let r in t)if(r[0]==="#"){let l=r.slice(1),c=t[`#${l}`];if(c&&!e.tags.find(([m,y])=>m===r.slice(1)&&c.indexOf(y)!==-1))return!1}return!(t.since&&e.created_at<t.since||t.until&&e.created_at>t.until)}function matchFilters(t,e){for(let r=0;r<t.length;r++)if(matchFilter(t[r],e))return!0;return!1}var fakejson_exports={};__export(fakejson_exports,{getHex64:()=>getHex64,getInt:()=>getInt,getSubscriptionId:()=>getSubscriptionId,matchEventId:()=>matchEventId,matchEventKind:()=>matchEventKind,matchEventPubkey:()=>matchEventPubkey});function getHex64(t,e){let r=e.length+3,l=t.indexOf(`"${e}":`)+r,c=t.slice(l).indexOf('"')+l+1;return t.slice(c,c+64)}function getInt(t,e){let r=e.length,l=t.indexOf(`"${e}":`)+r+3,c=t.slice(l),m=Math.min(c.indexOf(","),c.indexOf("}"));return parseInt(c.slice(0,m),10)}function getSubscriptionId(t){let e=t.slice(0,22).indexOf('"EVENT"');if(e===-1)return null;let r=t.slice(e+7+1).indexOf('"');if(r===-1)return null;let l=e+7+1+r,c=t.slice(l+1,80).indexOf('"');if(c===-1)return null;let m=l+1+c;return t.slice(l+1,m)}function matchEventId(t,e){return e===getHex64(t,"id")}function matchEventPubkey(t,e){return e===getHex64(t,"pubkey")}function matchEventKind(t,e){return e===getInt(t,"kind")}var nip42_exports={};__export(nip42_exports,{makeAuthEvent:()=>makeAuthEvent});function makeAuthEvent(t,e){return{kind:ClientAuth,created_at:Math.floor(Date.now()/1e3),tags:[["relay",t],["challenge",e]],content:""}}var _WebSocket;try{_WebSocket=WebSocket}catch{}var _WebSocket2;try{_WebSocket2=WebSocket}catch{}var nip19_exports={};__export(nip19_exports,{BECH32_REGEX:()=>BECH32_REGEX$1,Bech32MaxSize:()=>Bech32MaxSize,NostrTypeGuard:()=>NostrTypeGuard,decode:()=>decode$1,decodeNostrURI:()=>decodeNostrURI,encodeBytes:()=>encodeBytes,naddrEncode:()=>naddrEncode,neventEncode:()=>neventEncode,noteEncode:()=>noteEncode,nprofileEncode:()=>nprofileEncode,npubEncode:()=>npubEncode,nsecEncode:()=>nsecEncode});var NostrTypeGuard={isNProfile:t=>/^nprofile1[a-z\d]+$/.test(t||""),isNEvent:t=>/^nevent1[a-z\d]+$/.test(t||""),isNAddr:t=>/^naddr1[a-z\d]+$/.test(t||""),isNSec:t=>/^nsec1[a-z\d]{58}$/.test(t||""),isNPub:t=>/^npub1[a-z\d]{58}$/.test(t||""),isNote:t=>/^note1[a-z\d]+$/.test(t||""),isNcryptsec:t=>/^ncryptsec1[a-z\d]+$/.test(t||"")},Bech32MaxSize=5e3,BECH32_REGEX$1=/[\x21-\x7E]{1,83}1[023456789acdefghjklmnpqrstuvwxyz]{6,}/;function integerToUint8Array(t){const e=new Uint8Array(4);return e[0]=t>>24&255,e[1]=t>>16&255,e[2]=t>>8&255,e[3]=t&255,e}function decodeNostrURI(t){try{return t.startsWith("nostr:")&&(t=t.substring(6)),decode$1(t)}catch{return{type:"invalid",data:null}}}function decode$1(t){let{prefix:e,words:r}=bech32.decode(t,Bech32MaxSize),l=new Uint8Array(bech32.fromWords(r));switch(e){case"nprofile":{let c=parseTLV(l);if(!c[0]?.[0])throw new Error("missing TLV 0 for nprofile");if(c[0][0].length!==32)throw new Error("TLV 0 should be 32 bytes");return{type:"nprofile",data:{pubkey:bytesToHex$1(c[0][0]),relays:c[1]?c[1].map(m=>utf8Decoder.decode(m)):[]}}}case"nevent":{let c=parseTLV(l);if(!c[0]?.[0])throw new Error("missing TLV 0 for nevent");if(c[0][0].length!==32)throw new Error("TLV 0 should be 32 bytes");if(c[2]&&c[2][0].length!==32)throw new Error("TLV 2 should be 32 bytes");if(c[3]&&c[3][0].length!==4)throw new Error("TLV 3 should be 4 bytes");return{type:"nevent",data:{id:bytesToHex$1(c[0][0]),relays:c[1]?c[1].map(m=>utf8Decoder.decode(m)):[],author:c[2]?.[0]?bytesToHex$1(c[2][0]):void 0,kind:c[3]?.[0]?parseInt(bytesToHex$1(c[3][0]),16):void 0}}}case"naddr":{let c=parseTLV(l);if(!c[0]?.[0])throw new Error("missing TLV 0 for naddr");if(!c[2]?.[0])throw new Error("missing TLV 2 for naddr");if(c[2][0].length!==32)throw new Error("TLV 2 should be 32 bytes");if(!c[3]?.[0])throw new Error("missing TLV 3 for naddr");if(c[3][0].length!==4)throw new Error("TLV 3 should be 4 bytes");return{type:"naddr",data:{identifier:utf8Decoder.decode(c[0][0]),pubkey:bytesToHex$1(c[2][0]),kind:parseInt(bytesToHex$1(c[3][0]),16),relays:c[1]?c[1].map(m=>utf8Decoder.decode(m)):[]}}}case"nsec":return{type:e,data:l};case"npub":case"note":return{type:e,data:bytesToHex$1(l)};default:throw new Error(`unknown prefix ${e}`)}}function parseTLV(t){let e={},r=t;for(;r.length>0;){let l=r[0],c=r[1],m=r.slice(2,2+c);if(r=r.slice(2+c),m.length<c)throw new Error(`not enough data to read on TLV ${l}`);e[l]=e[l]||[],e[l].push(m)}return e}function nsecEncode(t){return encodeBytes("nsec",t)}function npubEncode(t){return encodeBytes("npub",hexToBytes$1(t))}function noteEncode(t){return encodeBytes("note",hexToBytes$1(t))}function encodeBech32(t,e){let r=bech32.toWords(e);return bech32.encode(t,r,Bech32MaxSize)}function encodeBytes(t,e){return encodeBech32(t,e)}function nprofileEncode(t){let e=encodeTLV({0:[hexToBytes$1(t.pubkey)],1:(t.relays||[]).map(r=>utf8Encoder.encode(r))});return encodeBech32("nprofile",e)}function neventEncode(t){let e;t.kind!==void 0&&(e=integerToUint8Array(t.kind));let r=encodeTLV({0:[hexToBytes$1(t.id)],1:(t.relays||[]).map(l=>utf8Encoder.encode(l)),2:t.author?[hexToBytes$1(t.author)]:[],3:e?[new Uint8Array(e)]:[]});return encodeBech32("nevent",r)}function naddrEncode(t){let e=new ArrayBuffer(4);new DataView(e).setUint32(0,t.kind,!1);let r=encodeTLV({0:[utf8Encoder.encode(t.identifier)],1:(t.relays||[]).map(l=>utf8Encoder.encode(l)),2:[hexToBytes$1(t.pubkey)],3:[new Uint8Array(e)]});return encodeBech32("naddr",r)}function encodeTLV(t){let e=[];return Object.entries(t).reverse().forEach(([r,l])=>{l.forEach(c=>{let m=new Uint8Array(c.length+2);m.set([parseInt(r)],0),m.set([c.length],1),m.set(c,2),e.push(m)})}),concatBytes$1(...e)}var nip04_exports={};__export(nip04_exports,{decrypt:()=>decrypt$1,encrypt:()=>encrypt$1});function encrypt$1(t,e,r){const l=t instanceof Uint8Array?bytesToHex$1(t):t,c=secp256k1$1.getSharedSecret(l,"02"+e),m=getNormalizedX(c);let y=Uint8Array.from(randomBytes$1(16)),_=utf8Encoder.encode(r),w=cbc(m,y).encrypt(_),k=base64.encode(new Uint8Array(w)),C=base64.encode(new Uint8Array(y.buffer));return`${k}?iv=${C}`}function decrypt$1(t,e,r){const l=t instanceof Uint8Array?bytesToHex$1(t):t;let[c,m]=r.split("?iv="),y=secp256k1$1.getSharedSecret(l,"02"+e),_=getNormalizedX(y),w=base64.decode(m),k=base64.decode(c),C=cbc(_,w).decrypt(k);return utf8Decoder.decode(C)}function getNormalizedX(t){return t.slice(1,33)}var nip05_exports={};__export(nip05_exports,{NIP05_REGEX:()=>NIP05_REGEX$1,isNip05:()=>isNip05,isValid:()=>isValid,queryProfile:()=>queryProfile,searchDomain:()=>searchDomain,useFetchImplementation:()=>useFetchImplementation});var NIP05_REGEX$1=/^(?:([\w.+-]+)@)?([\w_-]+(\.[\w_-]+)+)$/,isNip05=t=>NIP05_REGEX$1.test(t||""),_fetch;try{_fetch=fetch}catch(t){}function useFetchImplementation(t){_fetch=t}async function searchDomain(t,e=""){try{const r=`https://${t}/.well-known/nostr.json?name=${e}`,l=await _fetch(r,{redirect:"manual"});if(l.status!==200)throw Error("Wrong response code");return(await l.json()).names}catch{return{}}}async function queryProfile(t){const e=t.match(NIP05_REGEX$1);if(!e)return null;const[,r="_",l]=e;try{const c=`https://${l}/.well-known/nostr.json?name=${r}`,m=await _fetch(c,{redirect:"manual"});if(m.status!==200)throw Error("Wrong response code");const y=await m.json(),_=y.names[r];return _?{pubkey:_,relays:y.relays?.[_]}:null}catch{return null}}async function isValid(t,e){const r=await queryProfile(e);return r?r.pubkey===t:!1}var nip10_exports={};__export(nip10_exports,{parse:()=>parse});function parse(t){const e={reply:void 0,root:void 0,mentions:[],profiles:[],quotes:[]};let r,l;for(let c=t.tags.length-1;c>=0;c--){const m=t.tags[c];if(m[0]==="e"&&m[1]){const[y,_,w,k,C]=m,R={id:_,relays:w?[w]:[],author:C};if(k==="root"){e.root=R;continue}if(k==="reply"){e.reply=R;continue}if(k==="mention"){e.mentions.push(R);continue}r?l=R:r=R,e.mentions.push(R);continue}if(m[0]==="q"&&m[1]){const[y,_,w]=m;e.quotes.push({id:_,relays:w?[w]:[]})}if(m[0]==="p"&&m[1]){e.profiles.push({pubkey:m[1],relays:m[2]?[m[2]]:[]});continue}}return e.root||(e.root=l||r||e.reply),e.reply||(e.reply=r||e.root),[e.reply,e.root].forEach(c=>{if(!c)return;let m=e.mentions.indexOf(c);if(m!==-1&&e.mentions.splice(m,1),c.author){let y=e.profiles.find(_=>_.pubkey===c.author);y&&y.relays&&(c.relays||(c.relays=[]),y.relays.forEach(_=>{c.relays?.indexOf(_)===-1&&c.relays.push(_)}),y.relays=c.relays)}}),e.mentions.forEach(c=>{if(c.author){let m=e.profiles.find(y=>y.pubkey===c.author);m&&m.relays&&(c.relays||(c.relays=[]),m.relays.forEach(y=>{c.relays.indexOf(y)===-1&&c.relays.push(y)}),m.relays=c.relays)}}),e}var nip11_exports={};__export(nip11_exports,{fetchRelayInformation:()=>fetchRelayInformation,useFetchImplementation:()=>useFetchImplementation2});var _fetch2;try{_fetch2=fetch}catch{}function useFetchImplementation2(t){_fetch2=t}async function fetchRelayInformation(t){return await(await fetch(t.replace("ws://","http://").replace("wss://","https://"),{headers:{Accept:"application/nostr+json"}})).json()}var nip13_exports={};__export(nip13_exports,{fastEventHash:()=>fastEventHash,getPow:()=>getPow,minePow:()=>minePow});function getPow(t){let e=0;for(let r=0;r<64;r+=8){const l=parseInt(t.substring(r,r+8),16);if(l===0)e+=32;else{e+=Math.clz32(l);break}}return e}function minePow(t,e){let r=0;const l=t,c=["nonce",r.toString(),e.toString()];for(l.tags.push(c);;){const m=Math.floor(new Date().getTime()/1e3);if(m!==l.created_at&&(r=0,l.created_at=m),c[1]=(++r).toString(),l.id=fastEventHash(l),getPow(l.id)>=e)break}return l}function fastEventHash(t){return bytesToHex$1(sha256$2(utf8Encoder.encode(JSON.stringify([0,t.pubkey,t.created_at,t.kind,t.tags,t.content]))))}var nip17_exports={};__export(nip17_exports,{unwrapEvent:()=>unwrapEvent2,unwrapManyEvents:()=>unwrapManyEvents2,wrapEvent:()=>wrapEvent2,wrapManyEvents:()=>wrapManyEvents2});var nip59_exports={};__export(nip59_exports,{createRumor:()=>createRumor,createSeal:()=>createSeal,createWrap:()=>createWrap,unwrapEvent:()=>unwrapEvent,unwrapManyEvents:()=>unwrapManyEvents,wrapEvent:()=>wrapEvent$1,wrapManyEvents:()=>wrapManyEvents});var nip44_exports={};__export(nip44_exports,{decrypt:()=>decrypt2,encrypt:()=>encrypt2,getConversationKey:()=>getConversationKey,v2:()=>v2});var minPlaintextSize=1,maxPlaintextSize=65535;function getConversationKey(t,e){const r=secp256k1$1.getSharedSecret(t,"02"+e).subarray(1,33);return extract(sha256$2,r,"nip44-v2")}function getMessageKeys(t,e){const r=expand(sha256$2,t,e,76);return{chacha_key:r.subarray(0,32),chacha_nonce:r.subarray(32,44),hmac_key:r.subarray(44,76)}}function calcPaddedLen(t){if(!Number.isSafeInteger(t)||t<1)throw new Error("expected positive integer");if(t<=32)return 32;const e=1<<Math.floor(Math.log2(t-1))+1,r=e<=256?32:e/8;return r*(Math.floor((t-1)/r)+1)}function writeU16BE(t){if(!Number.isSafeInteger(t)||t<minPlaintextSize||t>maxPlaintextSize)throw new Error("invalid plaintext size: must be between 1 and 65535 bytes");const e=new Uint8Array(2);return new DataView(e.buffer).setUint16(0,t,!1),e}function pad(t){const e=utf8Encoder.encode(t),r=e.length,l=writeU16BE(r),c=new Uint8Array(calcPaddedLen(r)-r);return concatBytes$1(l,e,c)}function unpad(t){const e=new DataView(t.buffer).getUint16(0),r=t.subarray(2,2+e);if(e<minPlaintextSize||e>maxPlaintextSize||r.length!==e||t.length!==2+calcPaddedLen(e))throw new Error("invalid padding");return utf8Decoder.decode(r)}function hmacAad(t,e,r){if(r.length!==32)throw new Error("AAD associated data must be 32 bytes");const l=concatBytes$1(r,e);return hmac$1(sha256$2,t,l)}function decodePayload(t){if(typeof t!="string")throw new Error("payload must be a valid string");const e=t.length;if(e<132||e>87472)throw new Error("invalid payload length: "+e);if(t[0]==="#")throw new Error("unknown encryption version");let r;try{r=base64.decode(t)}catch(m){throw new Error("invalid base64: "+m.message)}const l=r.length;if(l<99||l>65603)throw new Error("invalid data length: "+l);const c=r[0];if(c!==2)throw new Error("unknown encryption version "+c);return{nonce:r.subarray(1,33),ciphertext:r.subarray(33,-32),mac:r.subarray(-32)}}function encrypt2(t,e,r=randomBytes$1(32)){const{chacha_key:l,chacha_nonce:c,hmac_key:m}=getMessageKeys(e,r),y=pad(t),_=chacha20(l,c,y),w=hmacAad(m,_,r);return base64.encode(concatBytes$1(new Uint8Array([2]),r,_,w))}function decrypt2(t,e){const{nonce:r,ciphertext:l,mac:c}=decodePayload(t),{chacha_key:m,chacha_nonce:y,hmac_key:_}=getMessageKeys(e,r),w=hmacAad(_,l,r);if(!equalBytes(w,c))throw new Error("invalid MAC");const k=chacha20(m,y,l);return unpad(k)}var v2={utils:{getConversationKey,calcPaddedLen},encrypt:encrypt2,decrypt:decrypt2},TWO_DAYS=2880*60,now=()=>Math.round(Date.now()/1e3),randomNow=()=>Math.round(now()-Math.random()*TWO_DAYS),nip44ConversationKey=(t,e)=>getConversationKey(t,e),nip44Encrypt=(t,e,r)=>encrypt2(JSON.stringify(t),nip44ConversationKey(e,r)),nip44Decrypt=(t,e)=>JSON.parse(decrypt2(t.content,nip44ConversationKey(e,t.pubkey)));function createRumor(t,e){const r={created_at:now(),content:"",tags:[],...t,pubkey:getPublicKey(e)};return r.id=getEventHash$1(r),r}function createSeal(t,e,r){return finalizeEvent({kind:Seal,content:nip44Encrypt(t,e,r),created_at:randomNow(),tags:[]},e)}function createWrap(t,e){const r=generateSecretKey();return finalizeEvent({kind:GiftWrap,content:nip44Encrypt(t,r,e),created_at:randomNow(),tags:[["p",e]]},r)}function wrapEvent$1(t,e,r){const l=createRumor(t,e),c=createSeal(l,e,r);return createWrap(c,r)}function wrapManyEvents(t,e,r){if(!r||r.length===0)throw new Error("At least one recipient is required.");const l=getPublicKey(e),c=[wrapEvent$1(t,e,l)];return r.forEach(m=>{c.push(wrapEvent$1(t,e,m))}),c}function unwrapEvent(t,e){const r=nip44Decrypt(t,e);return nip44Decrypt(r,e)}function unwrapManyEvents(t,e){let r=[];return t.forEach(l=>{r.push(unwrapEvent(l,e))}),r.sort((l,c)=>l.created_at-c.created_at),r}function createEvent(t,e,r,l){const c={created_at:Math.ceil(Date.now()/1e3),kind:PrivateDirectMessage,tags:[],content:e};return(Array.isArray(t)?t:[t]).forEach(({publicKey:y,relayUrl:_})=>{c.tags.push(_?["p",y,_]:["p",y])}),l&&c.tags.push(["e",l.eventId,l.relayUrl||"","reply"]),r&&c.tags.push(["subject",r]),c}function wrapEvent2(t,e,r,l,c){const m=createEvent(e,r,l,c);return wrapEvent$1(m,t,e.publicKey)}function wrapManyEvents2(t,e,r,l,c){if(!e||e.length===0)throw new Error("At least one recipient is required.");return[{publicKey:getPublicKey(t)},...e].map(y=>wrapEvent2(t,y,r,l,c))}var unwrapEvent2=unwrapEvent,unwrapManyEvents2=unwrapManyEvents,nip18_exports={};__export(nip18_exports,{finishRepostEvent:()=>finishRepostEvent,getRepostedEvent:()=>getRepostedEvent,getRepostedEventPointer:()=>getRepostedEventPointer});function finishRepostEvent(t,e,r,l){let c;const m=[...t.tags??[],["e",e.id,r],["p",e.pubkey]];return e.kind===ShortTextNote?c=Repost:(c=GenericRepost,m.push(["k",String(e.kind)])),finalizeEvent({kind:c,tags:m,content:t.content===""||e.tags?.find(y=>y[0]==="-")?"":JSON.stringify(e),created_at:t.created_at},l)}function getRepostedEventPointer(t){if(![Repost,GenericRepost].includes(t.kind))return;let e,r;for(let l=t.tags.length-1;l>=0&&(e===void 0||r===void 0);l--){const c=t.tags[l];c.length>=2&&(c[0]==="e"&&e===void 0?e=c:c[0]==="p"&&r===void 0&&(r=c))}if(e!==void 0)return{id:e[1],relays:[e[2],r?.[2]].filter(l=>typeof l=="string"),author:r?.[1]}}function getRepostedEvent(t,{skipVerification:e}={}){const r=getRepostedEventPointer(t);if(r===void 0||t.content==="")return;let l;try{l=JSON.parse(t.content)}catch{return}if(l.id===r.id&&!(!e&&!verifyEvent(l)))return l}var nip21_exports={};__export(nip21_exports,{NOSTR_URI_REGEX:()=>NOSTR_URI_REGEX,parse:()=>parse2,test:()=>test});var NOSTR_URI_REGEX=new RegExp(`nostr:(${BECH32_REGEX$1.source})`);function test(t){return typeof t=="string"&&new RegExp(`^${NOSTR_URI_REGEX.source}$`).test(t)}function parse2(t){const e=t.match(new RegExp(`^${NOSTR_URI_REGEX.source}$`));if(!e)throw new Error(`Invalid Nostr URI: ${t}`);return{uri:e[0],value:e[1],decoded:decode$1(e[1])}}var nip25_exports={};__export(nip25_exports,{finishReactionEvent:()=>finishReactionEvent,getReactedEventPointer:()=>getReactedEventPointer});function finishReactionEvent(t,e,r){const l=e.tags.filter(c=>c.length>=2&&(c[0]==="e"||c[0]==="p"));return finalizeEvent({...t,kind:Reaction,tags:[...t.tags??[],...l,["e",e.id],["p",e.pubkey]],content:t.content??"+"},r)}function getReactedEventPointer(t){if(t.kind!==Reaction)return;let e,r;for(let l=t.tags.length-1;l>=0&&(e===void 0||r===void 0);l--){const c=t.tags[l];c.length>=2&&(c[0]==="e"&&e===void 0?e=c:c[0]==="p"&&r===void 0&&(r=c))}if(!(e===void 0||r===void 0))return{id:e[1],relays:[e[2],r[2]].filter(l=>l!==void 0),author:r[1]}}var nip27_exports={};__export(nip27_exports,{parse:()=>parse3});var noCharacter=/\W/m,noURLCharacter=/\W |\W$|$|,| /m;function*parse3(t){const e=t.length;let r=0,l=0;for(;l<e;){let c=t.indexOf(":",l);if(c===-1)break;if(t.substring(c-5,c)==="nostr"){const m=t.substring(c+60).match(noCharacter),y=m?c+60+m.index:e;try{let _,{data:w,type:k}=decode$1(t.substring(c+1,y));switch(k){case"npub":_={pubkey:w};break;case"nsec":case"note":l=y+1;continue;default:_=w}r!==c-5&&(yield{type:"text",text:t.substring(r,c-5)}),yield{type:"reference",pointer:_},l=y,r=l;continue}catch{l=c+1;continue}}else if(t.substring(c-5,c)==="https"||t.substring(c-4,c)==="http"){const m=t.substring(c+4).match(noURLCharacter),y=m?c+4+m.index:e,_=t[c-1]==="s"?5:4;try{let w=new URL(t.substring(c-_,y));if(w.hostname.indexOf(".")===-1)throw new Error("invalid url");if(r!==c-_&&(yield{type:"text",text:t.substring(r,c-_)}),w.pathname.endsWith(".png")||w.pathname.endsWith(".jpg")||w.pathname.endsWith(".jpeg")||w.pathname.endsWith(".gif")||w.pathname.endsWith(".webp")){yield{type:"image",url:w.toString()},l=y,r=l;continue}if(w.pathname.endsWith(".mp4")||w.pathname.endsWith(".avi")||w.pathname.endsWith(".webm")||w.pathname.endsWith(".mkv")){yield{type:"video",url:w.toString()},l=y,r=l;continue}if(w.pathname.endsWith(".mp3")||w.pathname.endsWith(".aac")||w.pathname.endsWith(".ogg")||w.pathname.endsWith(".opus")){yield{type:"audio",url:w.toString()},l=y,r=l;continue}yield{type:"url",url:w.toString()},l=y,r=l;continue}catch{l=y+1;continue}}else if(t.substring(c-3,c)==="wss"||t.substring(c-2,c)==="ws"){const m=t.substring(c+4).match(noURLCharacter),y=m?c+4+m.index:e,_=t[c-1]==="s"?3:2;try{let w=new URL(t.substring(c-_,y));if(w.hostname.indexOf(".")===-1)throw new Error("invalid ws url");r!==c-_&&(yield{type:"text",text:t.substring(r,c-_)}),yield{type:"relay",url:w.toString()},l=y,r=l;continue}catch{l=y+1;continue}}else{l=c+1;continue}}r!==e&&(yield{type:"text",text:t.substring(r)})}var nip28_exports={};__export(nip28_exports,{channelCreateEvent:()=>channelCreateEvent,channelHideMessageEvent:()=>channelHideMessageEvent,channelMessageEvent:()=>channelMessageEvent,channelMetadataEvent:()=>channelMetadataEvent,channelMuteUserEvent:()=>channelMuteUserEvent});var channelCreateEvent=(t,e)=>{let r;if(typeof t.content=="object")r=JSON.stringify(t.content);else if(typeof t.content=="string")r=t.content;else return;return finalizeEvent({kind:ChannelCreation,tags:[...t.tags??[]],content:r,created_at:t.created_at},e)},channelMetadataEvent=(t,e)=>{let r;if(typeof t.content=="object")r=JSON.stringify(t.content);else if(typeof t.content=="string")r=t.content;else return;return finalizeEvent({kind:ChannelMetadata,tags:[["e",t.channel_create_event_id],...t.tags??[]],content:r,created_at:t.created_at},e)},channelMessageEvent=(t,e)=>{const r=[["e",t.channel_create_event_id,t.relay_url,"root"]];return t.reply_to_channel_message_event_id&&r.push(["e",t.reply_to_channel_message_event_id,t.relay_url,"reply"]),finalizeEvent({kind:ChannelMessage,tags:[...r,...t.tags??[]],content:t.content,created_at:t.created_at},e)},channelHideMessageEvent=(t,e)=>{let r;if(typeof t.content=="object")r=JSON.stringify(t.content);else if(typeof t.content=="string")r=t.content;else return;return finalizeEvent({kind:ChannelHideMessage,tags:[["e",t.channel_message_event_id],...t.tags??[]],content:r,created_at:t.created_at},e)},channelMuteUserEvent=(t,e)=>{let r;if(typeof t.content=="object")r=JSON.stringify(t.content);else if(typeof t.content=="string")r=t.content;else return;return finalizeEvent({kind:ChannelMuteUser,tags:[["p",t.pubkey_to_mute],...t.tags??[]],content:r,created_at:t.created_at},e)},nip30_exports={};__export(nip30_exports,{EMOJI_SHORTCODE_REGEX:()=>EMOJI_SHORTCODE_REGEX,matchAll:()=>matchAll,regex:()=>regex,replaceAll:()=>replaceAll});var EMOJI_SHORTCODE_REGEX=/:(\w+):/,regex=()=>new RegExp(`\\B${EMOJI_SHORTCODE_REGEX.source}\\B`,"g");function*matchAll(t){const e=t.matchAll(regex());for(const r of e)try{const[l,c]=r;yield{shortcode:l,name:c,start:r.index,end:r.index+l.length}}catch{}}function replaceAll(t,e){return t.replaceAll(regex(),(r,l)=>e({shortcode:r,name:l}))}var nip39_exports={};__export(nip39_exports,{useFetchImplementation:()=>useFetchImplementation3,validateGithub:()=>validateGithub});var _fetch3;try{_fetch3=fetch}catch{}function useFetchImplementation3(t){_fetch3=t}async function validateGithub(t,e,r){try{return await(await _fetch3(`https://gist.github.com/${e}/${r}/raw`)).text()===`Verifying that I control the following Nostr public key: ${t}`}catch{return!1}}var nip47_exports={};__export(nip47_exports,{makeNwcRequestEvent:()=>makeNwcRequestEvent,parseConnectionString:()=>parseConnectionString});function parseConnectionString(t){const{host:e,pathname:r,searchParams:l}=new URL(t),c=r||e,m=l.get("relay"),y=l.get("secret");if(!c||!m||!y)throw new Error("invalid connection string");return{pubkey:c,relay:m,secret:y}}async function makeNwcRequestEvent(t,e,r){const c=encrypt$1(e,t,JSON.stringify({method:"pay_invoice",params:{invoice:r}})),m={kind:NWCWalletRequest,created_at:Math.round(Date.now()/1e3),content:c,tags:[["p",t]]};return finalizeEvent(m,e)}var nip54_exports={};__export(nip54_exports,{normalizeIdentifier:()=>normalizeIdentifier});function normalizeIdentifier(t){return t=t.trim().toLowerCase(),t=t.normalize("NFKC"),Array.from(t).map(e=>new RegExp("\\p{Letter}","u").test(e)||new RegExp("\\p{Number}","u").test(e)?e:"-").join("")}var nip57_exports={};__export(nip57_exports,{getSatoshisAmountFromBolt11:()=>getSatoshisAmountFromBolt11,getZapEndpoint:()=>getZapEndpoint,makeZapReceipt:()=>makeZapReceipt,makeZapRequest:()=>makeZapRequest,useFetchImplementation:()=>useFetchImplementation4,validateZapRequest:()=>validateZapRequest});var _fetch4;try{_fetch4=fetch}catch{}function useFetchImplementation4(t){_fetch4=t}async function getZapEndpoint(t){try{let e="",{lud06:r,lud16:l}=JSON.parse(t.content);if(r){let{words:y}=bech32.decode(r,1e3),_=bech32.fromWords(y);e=utf8Decoder.decode(_)}else if(l){let[y,_]=l.split("@");e=new URL(`/.well-known/lnurlp/${y}`,`https://${_}`).toString()}else return null;let m=await(await _fetch4(e)).json();if(m.allowsNostr&&m.nostrPubkey)return m.callback}catch{}return null}function makeZapRequest(t){let e={kind:9734,created_at:Math.round(Date.now()/1e3),content:t.comment||"",tags:[["p","pubkey"in t?t.pubkey:t.event.pubkey],["amount",t.amount.toString()],["relays",...t.relays]]};if("event"in t){if(e.tags.push(["e",t.event.id]),isReplaceableKind(t.event.kind)){const r=["a",`${t.event.kind}:${t.event.pubkey}:`];e.tags.push(r)}else if(isAddressableKind(t.event.kind)){let r=t.event.tags.find(([c,m])=>c==="d"&&m);if(!r)throw new Error("d tag not found or is empty");const l=["a",`${t.event.kind}:${t.event.pubkey}:${r[1]}`];e.tags.push(l)}e.tags.push(["k",t.event.kind.toString()])}return e}function validateZapRequest(t){let e;try{e=JSON.parse(t)}catch{return"Invalid zap request JSON."}if(!validateEvent(e))return"Zap request is not a valid Nostr event.";if(!verifyEvent(e))return"Invalid signature on zap request.";let r=e.tags.find(([m,y])=>m==="p"&&y);if(!r)return"Zap request doesn't have a 'p' tag.";if(!r[1].match(/^[a-f0-9]{64}$/))return"Zap request 'p' tag is not valid hex.";let l=e.tags.find(([m,y])=>m==="e"&&y);return l&&!l[1].match(/^[a-f0-9]{64}$/)?"Zap request 'e' tag is not valid hex.":e.tags.find(([m,y])=>m==="relays"&&y)?null:"Zap request doesn't have a 'relays' tag."}function makeZapReceipt({zapRequest:t,preimage:e,bolt11:r,paidAt:l}){let c=JSON.parse(t),m=c.tags.filter(([_])=>_==="e"||_==="p"||_==="a"),y={kind:9735,created_at:Math.round(l.getTime()/1e3),content:"",tags:[...m,["P",c.pubkey],["bolt11",r],["description",t]]};return e&&y.tags.push(["preimage",e]),y}function getSatoshisAmountFromBolt11(t){if(t.length<50)return 0;t=t.substring(0,50);const e=t.lastIndexOf("1");if(e===-1)return 0;const r=t.substring(0,e);if(!r.startsWith("lnbc"))return 0;const l=r.substring(4);if(l.length<1)return 0;const c=l[l.length-1],m=c.charCodeAt(0)-48,y=m>=0&&m<=9;let _=l.length-1;if(y&&_++,_<1)return 0;const w=parseInt(l.substring(0,_));switch(c){case"m":return w*1e5;case"u":return w*100;case"n":return w/10;case"p":return w/1e4;default:return w*1e8}}var nip98_exports={};__export(nip98_exports,{getToken:()=>getToken,hashPayload:()=>hashPayload,unpackEventFromToken:()=>unpackEventFromToken,validateEvent:()=>validateEvent2,validateEventKind:()=>validateEventKind,validateEventMethodTag:()=>validateEventMethodTag,validateEventPayloadTag:()=>validateEventPayloadTag,validateEventTimestamp:()=>validateEventTimestamp,validateEventUrlTag:()=>validateEventUrlTag,validateToken:()=>validateToken});var _authorizationScheme="Nostr ";async function getToken(t,e,r,l=!1,c){const m={kind:HTTPAuth,tags:[["u",t],["method",e]],created_at:Math.round(new Date().getTime()/1e3),content:""};c&&m.tags.push(["payload",hashPayload(c)]);const y=await r(m);return(l?_authorizationScheme:"")+base64.encode(utf8Encoder.encode(JSON.stringify(y)))}async function validateToken(t,e,r){const l=await unpackEventFromToken(t).catch(m=>{throw m});return await validateEvent2(l,e,r).catch(m=>{throw m})}async function unpackEventFromToken(t){if(!t)throw new Error("Missing token");t=t.replace(_authorizationScheme,"");const e=utf8Decoder.decode(base64.decode(t));if(!e||e.length===0||!e.startsWith("{"))throw new Error("Invalid token");return JSON.parse(e)}function validateEventTimestamp(t){return t.created_at?Math.round(new Date().getTime()/1e3)-t.created_at<60:!1}function validateEventKind(t){return t.kind===HTTPAuth}function validateEventUrlTag(t,e){const r=t.tags.find(l=>l[0]==="u");return r?r.length>0&&r[1]===e:!1}function validateEventMethodTag(t,e){const r=t.tags.find(l=>l[0]==="method");return r?r.length>0&&r[1].toLowerCase()===e.toLowerCase():!1}function hashPayload(t){const e=sha256$2(utf8Encoder.encode(JSON.stringify(t)));return bytesToHex$1(e)}function validateEventPayloadTag(t,e){const r=t.tags.find(c=>c[0]==="payload");if(!r)return!1;const l=hashPayload(e);return r.length>0&&r[1]===l}async function validateEvent2(t,e,r,l){if(!verifyEvent(t))throw new Error("Invalid nostr event, signature invalid");if(!validateEventKind(t))throw new Error("Invalid nostr event, kind invalid");if(!validateEventTimestamp(t))throw new Error("Invalid nostr event, created_at timestamp invalid");if(!validateEventUrlTag(t,e))throw new Error("Invalid nostr event, url tag invalid");if(!validateEventMethodTag(t,r))throw new Error("Invalid nostr event, method tag invalid");if(l&&typeof l=="object"&&Object.keys(l).length>0&&!validateEventPayloadTag(t,l))throw new Error("Invalid nostr event, payload tag does not match request body hash");return!0}const crypto$1=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function isBytes(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function anumber(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function abytes(t,...e){if(!isBytes(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function ahash(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");anumber(t.outputLen),anumber(t.blockLen)}function aexists(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function aoutput(t,e){abytes(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function clean(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function createView(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function rotr(t,e){return t<<32-e|t>>>e}const hasHexBuiltin=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",hexes=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function bytesToHex(t){if(abytes(t),hasHexBuiltin)return t.toHex();let e="";for(let r=0;r<t.length;r++)e+=hexes[t[r]];return e}const asciis={_0:48,_9:57,A:65,F:70,a:97,f:102};function asciiToBase16(t){if(t>=asciis._0&&t<=asciis._9)return t-asciis._0;if(t>=asciis.A&&t<=asciis.F)return t-(asciis.A-10);if(t>=asciis.a&&t<=asciis.f)return t-(asciis.a-10)}function hexToBytes(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);if(hasHexBuiltin)return Uint8Array.fromHex(t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const l=new Uint8Array(r);for(let c=0,m=0;c<r;c++,m+=2){const y=asciiToBase16(t.charCodeAt(m)),_=asciiToBase16(t.charCodeAt(m+1));if(y===void 0||_===void 0){const w=t[m]+t[m+1];throw new Error('hex string expected, got non-hex character "'+w+'" at index '+m)}l[c]=y*16+_}return l}function utf8ToBytes(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function toBytes(t){return typeof t=="string"&&(t=utf8ToBytes(t)),abytes(t),t}function concatBytes(...t){let e=0;for(let l=0;l<t.length;l++){const c=t[l];abytes(c),e+=c.length}const r=new Uint8Array(e);for(let l=0,c=0;l<t.length;l++){const m=t[l];r.set(m,c),c+=m.length}return r}class Hash{}function createHasher(t){const e=l=>t().update(toBytes(l)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function randomBytes(t=32){if(crypto$1&&typeof crypto$1.getRandomValues=="function")return crypto$1.getRandomValues(new Uint8Array(t));if(crypto$1&&typeof crypto$1.randomBytes=="function")return Uint8Array.from(crypto$1.randomBytes(t));throw new Error("crypto.getRandomValues must be defined")}function setBigUint64(t,e,r,l){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,l);const c=BigInt(32),m=BigInt(4294967295),y=Number(r>>c&m),_=Number(r&m),w=l?4:0,k=l?0:4;t.setUint32(e+w,y,l),t.setUint32(e+k,_,l)}function Chi(t,e,r){return t&e^~t&r}function Maj(t,e,r){return t&e^t&r^e&r}class HashMD extends Hash{constructor(e,r,l,c){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=r,this.padOffset=l,this.isLE=c,this.buffer=new Uint8Array(e),this.view=createView(this.buffer)}update(e){aexists(this),e=toBytes(e),abytes(e);const{view:r,buffer:l,blockLen:c}=this,m=e.length;for(let y=0;y<m;){const _=Math.min(c-this.pos,m-y);if(_===c){const w=createView(e);for(;c<=m-y;y+=c)this.process(w,y);continue}l.set(e.subarray(y,y+_),this.pos),this.pos+=_,y+=_,this.pos===c&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){aexists(this),aoutput(e,this),this.finished=!0;const{buffer:r,view:l,blockLen:c,isLE:m}=this;let{pos:y}=this;r[y++]=128,clean(this.buffer.subarray(y)),this.padOffset>c-y&&(this.process(l,0),y=0);for(let R=y;R<c;R++)r[R]=0;setBigUint64(l,c-8,BigInt(this.length*8),m),this.process(l,0);const _=createView(e),w=this.outputLen;if(w%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const k=w/4,C=this.get();if(k>C.length)throw new Error("_sha2: outputLen bigger than state");for(let R=0;R<k;R++)_.setUint32(4*R,C[R],m)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const l=e.slice(0,r);return this.destroy(),l}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:l,length:c,finished:m,destroyed:y,pos:_}=this;return e.destroyed=y,e.finished=m,e.length=c,e.pos=_,c%r&&e.buffer.set(l),e}clone(){return this._cloneInto()}}const SHA256_IV=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),SHA256_K=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),SHA256_W=new Uint32Array(64);class SHA256 extends HashMD{constructor(e=32){super(64,e,8,!1),this.A=SHA256_IV[0]|0,this.B=SHA256_IV[1]|0,this.C=SHA256_IV[2]|0,this.D=SHA256_IV[3]|0,this.E=SHA256_IV[4]|0,this.F=SHA256_IV[5]|0,this.G=SHA256_IV[6]|0,this.H=SHA256_IV[7]|0}get(){const{A:e,B:r,C:l,D:c,E:m,F:y,G:_,H:w}=this;return[e,r,l,c,m,y,_,w]}set(e,r,l,c,m,y,_,w){this.A=e|0,this.B=r|0,this.C=l|0,this.D=c|0,this.E=m|0,this.F=y|0,this.G=_|0,this.H=w|0}process(e,r){for(let R=0;R<16;R++,r+=4)SHA256_W[R]=e.getUint32(r,!1);for(let R=16;R<64;R++){const T=SHA256_W[R-15],A=SHA256_W[R-2],M=rotr(T,7)^rotr(T,18)^T>>>3,B=rotr(A,17)^rotr(A,19)^A>>>10;SHA256_W[R]=B+SHA256_W[R-7]+M+SHA256_W[R-16]|0}let{A:l,B:c,C:m,D:y,E:_,F:w,G:k,H:C}=this;for(let R=0;R<64;R++){const T=rotr(_,6)^rotr(_,11)^rotr(_,25),A=C+T+Chi(_,w,k)+SHA256_K[R]+SHA256_W[R]|0,B=(rotr(l,2)^rotr(l,13)^rotr(l,22))+Maj(l,c,m)|0;C=k,k=w,w=_,_=y+A|0,y=m,m=c,c=l,l=A+B|0}l=l+this.A|0,c=c+this.B|0,m=m+this.C|0,y=y+this.D|0,_=_+this.E|0,w=w+this.F|0,k=k+this.G|0,C=C+this.H|0,this.set(l,c,m,y,_,w,k,C)}roundClean(){clean(SHA256_W)}destroy(){this.set(0,0,0,0,0,0,0,0),clean(this.buffer)}}const sha256$1=createHasher(()=>new SHA256);class HMAC extends Hash{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,ahash(e);const l=toBytes(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const c=this.blockLen,m=new Uint8Array(c);m.set(l.length>c?e.create().update(l).digest():l);for(let y=0;y<m.length;y++)m[y]^=54;this.iHash.update(m),this.oHash=e.create();for(let y=0;y<m.length;y++)m[y]^=106;this.oHash.update(m),clean(m)}update(e){return aexists(this),this.iHash.update(e),this}digestInto(e){aexists(this),abytes(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:r,iHash:l,finished:c,destroyed:m,blockLen:y,outputLen:_}=this;return e=e,e.finished=c,e.destroyed=m,e.blockLen=y,e.outputLen=_,e.oHash=r._cloneInto(e.oHash),e.iHash=l._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const hmac=(t,e,r)=>new HMAC(t,e).update(r).digest();hmac.create=(t,e)=>new HMAC(t,e);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _0n$4=BigInt(0),_1n$4=BigInt(1);function _abool2(t,e=""){if(typeof t!="boolean"){const r=e&&`"${e}"`;throw new Error(r+"expected boolean, got type="+typeof t)}return t}function _abytes2(t,e,r=""){const l=isBytes(t),c=t?.length,m=e!==void 0;if(!l||m&&c!==e){const y=r&&`"${r}" `,_=m?` of length ${e}`:"",w=l?`length=${c}`:`type=${typeof t}`;throw new Error(y+"expected Uint8Array"+_+", got "+w)}return t}function numberToHexUnpadded(t){const e=t.toString(16);return e.length&1?"0"+e:e}function hexToNumber(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?_0n$4:BigInt("0x"+t)}function bytesToNumberBE(t){return hexToNumber(bytesToHex(t))}function bytesToNumberLE(t){return abytes(t),hexToNumber(bytesToHex(Uint8Array.from(t).reverse()))}function numberToBytesBE(t,e){return hexToBytes(t.toString(16).padStart(e*2,"0"))}function numberToBytesLE(t,e){return numberToBytesBE(t,e).reverse()}function ensureBytes(t,e,r){let l;if(typeof e=="string")try{l=hexToBytes(e)}catch(m){throw new Error(t+" must be hex string or Uint8Array, cause: "+m)}else if(isBytes(e))l=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const c=l.length;if(typeof r=="number"&&c!==r)throw new Error(t+" of length "+r+" expected, got "+c);return l}const isPosBig=t=>typeof t=="bigint"&&_0n$4<=t;function inRange(t,e,r){return isPosBig(t)&&isPosBig(e)&&isPosBig(r)&&e<=t&&t<r}function aInRange(t,e,r,l){if(!inRange(e,r,l))throw new Error("expected valid "+t+": "+r+" <= n < "+l+", got "+e)}function bitLen(t){let e;for(e=0;t>_0n$4;t>>=_1n$4,e+=1);return e}const bitMask=t=>(_1n$4<<BigInt(t))-_1n$4;function createHmacDrbg(t,e,r){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");const l=A=>new Uint8Array(A),c=A=>Uint8Array.of(A);let m=l(t),y=l(t),_=0;const w=()=>{m.fill(1),y.fill(0),_=0},k=(...A)=>r(y,m,...A),C=(A=l(0))=>{y=k(c(0),A),m=k(),A.length!==0&&(y=k(c(1),A),m=k())},R=()=>{if(_++>=1e3)throw new Error("drbg: tried 1000 values");let A=0;const M=[];for(;A<e;){m=k();const B=m.slice();M.push(B),A+=m.length}return concatBytes(...M)};return(A,M)=>{w(),C(A);let B;for(;!(B=M(R()));)C();return w(),B}}function _validateObject(t,e,r={}){if(!t||typeof t!="object")throw new Error("expected valid options object");function l(c,m,y){const _=t[c];if(y&&_===void 0)return;const w=typeof _;if(w!==m||_===null)throw new Error(`param "${c}" is invalid: expected ${m}, got ${w}`)}Object.entries(e).forEach(([c,m])=>l(c,m,!1)),Object.entries(r).forEach(([c,m])=>l(c,m,!0))}function memoized(t){const e=new WeakMap;return(r,...l)=>{const c=e.get(r);if(c!==void 0)return c;const m=t(r,...l);return e.set(r,m),m}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _0n$3=BigInt(0),_1n$3=BigInt(1),_2n$2=BigInt(2),_3n$1=BigInt(3),_4n$1=BigInt(4),_5n=BigInt(5),_7n=BigInt(7),_8n=BigInt(8),_9n=BigInt(9),_16n=BigInt(16);function mod(t,e){const r=t%e;return r>=_0n$3?r:e+r}function pow2(t,e,r){let l=t;for(;e-- >_0n$3;)l*=l,l%=r;return l}function invert(t,e){if(t===_0n$3)throw new Error("invert: expected non-zero number");if(e<=_0n$3)throw new Error("invert: expected positive modulus, got "+e);let r=mod(t,e),l=e,c=_0n$3,m=_1n$3;for(;r!==_0n$3;){const _=l/r,w=l%r,k=c-m*_;l=r,r=w,c=m,m=k}if(l!==_1n$3)throw new Error("invert: does not exist");return mod(c,e)}function assertIsSquare(t,e,r){if(!t.eql(t.sqr(e),r))throw new Error("Cannot find square root")}function sqrt3mod4(t,e){const r=(t.ORDER+_1n$3)/_4n$1,l=t.pow(e,r);return assertIsSquare(t,l,e),l}function sqrt5mod8(t,e){const r=(t.ORDER-_5n)/_8n,l=t.mul(e,_2n$2),c=t.pow(l,r),m=t.mul(e,c),y=t.mul(t.mul(m,_2n$2),c),_=t.mul(m,t.sub(y,t.ONE));return assertIsSquare(t,_,e),_}function sqrt9mod16(t){const e=Field(t),r=tonelliShanks(t),l=r(e,e.neg(e.ONE)),c=r(e,l),m=r(e,e.neg(l)),y=(t+_7n)/_16n;return(_,w)=>{let k=_.pow(w,y),C=_.mul(k,l);const R=_.mul(k,c),T=_.mul(k,m),A=_.eql(_.sqr(C),w),M=_.eql(_.sqr(R),w);k=_.cmov(k,C,A),C=_.cmov(T,R,M);const B=_.eql(_.sqr(C),w),j=_.cmov(k,C,B);return assertIsSquare(_,j,w),j}}function tonelliShanks(t){if(t<_3n$1)throw new Error("sqrt is not defined for small field");let e=t-_1n$3,r=0;for(;e%_2n$2===_0n$3;)e/=_2n$2,r++;let l=_2n$2;const c=Field(t);for(;FpLegendre(c,l)===1;)if(l++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(r===1)return sqrt3mod4;let m=c.pow(l,e);const y=(e+_1n$3)/_2n$2;return function(w,k){if(w.is0(k))return k;if(FpLegendre(w,k)!==1)throw new Error("Cannot find square root");let C=r,R=w.mul(w.ONE,m),T=w.pow(k,e),A=w.pow(k,y);for(;!w.eql(T,w.ONE);){if(w.is0(T))return w.ZERO;let M=1,B=w.sqr(T);for(;!w.eql(B,w.ONE);)if(M++,B=w.sqr(B),M===C)throw new Error("Cannot find square root");const j=_1n$3<<BigInt(C-M-1),re=w.pow(R,j);C=M,R=w.sqr(re),T=w.mul(T,R),A=w.mul(A,re)}return A}}function FpSqrt(t){return t%_4n$1===_3n$1?sqrt3mod4:t%_8n===_5n?sqrt5mod8:t%_16n===_9n?sqrt9mod16(t):tonelliShanks(t)}const FIELD_FIELDS=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function validateField(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},r=FIELD_FIELDS.reduce((l,c)=>(l[c]="function",l),e);return _validateObject(t,r),t}function FpPow(t,e,r){if(r<_0n$3)throw new Error("invalid exponent, negatives unsupported");if(r===_0n$3)return t.ONE;if(r===_1n$3)return e;let l=t.ONE,c=e;for(;r>_0n$3;)r&_1n$3&&(l=t.mul(l,c)),c=t.sqr(c),r>>=_1n$3;return l}function FpInvertBatch(t,e,r=!1){const l=new Array(e.length).fill(r?t.ZERO:void 0),c=e.reduce((y,_,w)=>t.is0(_)?y:(l[w]=y,t.mul(y,_)),t.ONE),m=t.inv(c);return e.reduceRight((y,_,w)=>t.is0(_)?y:(l[w]=t.mul(y,l[w]),t.mul(y,_)),m),l}function FpLegendre(t,e){const r=(t.ORDER-_1n$3)/_2n$2,l=t.pow(e,r),c=t.eql(l,t.ONE),m=t.eql(l,t.ZERO),y=t.eql(l,t.neg(t.ONE));if(!c&&!m&&!y)throw new Error("invalid Legendre symbol result");return c?1:m?0:-1}function nLength(t,e){e!==void 0&&anumber(e);const r=e!==void 0?e:t.toString(2).length,l=Math.ceil(r/8);return{nBitLength:r,nByteLength:l}}function Field(t,e,r=!1,l={}){if(t<=_0n$3)throw new Error("invalid field: expected ORDER > 0, got "+t);let c,m,y=!1,_;if(typeof e=="object"&&e!=null){if(l.sqrt||r)throw new Error("cannot specify opts in two arguments");const T=e;T.BITS&&(c=T.BITS),T.sqrt&&(m=T.sqrt),typeof T.isLE=="boolean"&&(r=T.isLE),typeof T.modFromBytes=="boolean"&&(y=T.modFromBytes),_=T.allowedLengths}else typeof e=="number"&&(c=e),l.sqrt&&(m=l.sqrt);const{nBitLength:w,nByteLength:k}=nLength(t,c);if(k>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let C;const R=Object.freeze({ORDER:t,isLE:r,BITS:w,BYTES:k,MASK:bitMask(w),ZERO:_0n$3,ONE:_1n$3,allowedLengths:_,create:T=>mod(T,t),isValid:T=>{if(typeof T!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof T);return _0n$3<=T&&T<t},is0:T=>T===_0n$3,isValidNot0:T=>!R.is0(T)&&R.isValid(T),isOdd:T=>(T&_1n$3)===_1n$3,neg:T=>mod(-T,t),eql:(T,A)=>T===A,sqr:T=>mod(T*T,t),add:(T,A)=>mod(T+A,t),sub:(T,A)=>mod(T-A,t),mul:(T,A)=>mod(T*A,t),pow:(T,A)=>FpPow(R,T,A),div:(T,A)=>mod(T*invert(A,t),t),sqrN:T=>T*T,addN:(T,A)=>T+A,subN:(T,A)=>T-A,mulN:(T,A)=>T*A,inv:T=>invert(T,t),sqrt:m||(T=>(C||(C=FpSqrt(t)),C(R,T))),toBytes:T=>r?numberToBytesLE(T,k):numberToBytesBE(T,k),fromBytes:(T,A=!0)=>{if(_){if(!_.includes(T.length)||T.length>k)throw new Error("Field.fromBytes: expected "+_+" bytes, got "+T.length);const B=new Uint8Array(k);B.set(T,r?0:B.length-T.length),T=B}if(T.length!==k)throw new Error("Field.fromBytes: expected "+k+" bytes, got "+T.length);let M=r?bytesToNumberLE(T):bytesToNumberBE(T);if(y&&(M=mod(M,t)),!A&&!R.isValid(M))throw new Error("invalid field element: outside of range 0..ORDER");return M},invertBatch:T=>FpInvertBatch(R,T),cmov:(T,A,M)=>M?A:T});return Object.freeze(R)}function getFieldBytesLength(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function getMinHashLength(t){const e=getFieldBytesLength(t);return e+Math.ceil(e/2)}function mapHashToField(t,e,r=!1){const l=t.length,c=getFieldBytesLength(e),m=getMinHashLength(e);if(l<16||l<m||l>1024)throw new Error("expected "+m+"-1024 bytes of input, got "+l);const y=r?bytesToNumberLE(t):bytesToNumberBE(t),_=mod(y,e-_1n$3)+_1n$3;return r?numberToBytesLE(_,c):numberToBytesBE(_,c)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _0n$2=BigInt(0),_1n$2=BigInt(1);function negateCt(t,e){const r=e.negate();return t?r:e}function normalizeZ(t,e){const r=FpInvertBatch(t.Fp,e.map(l=>l.Z));return e.map((l,c)=>t.fromAffine(l.toAffine(r[c])))}function validateW(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function calcWOpts(t,e){validateW(t,e);const r=Math.ceil(e/t)+1,l=2**(t-1),c=2**t,m=bitMask(t),y=BigInt(t);return{windows:r,windowSize:l,mask:m,maxNumber:c,shiftBy:y}}function calcOffsets(t,e,r){const{windowSize:l,mask:c,maxNumber:m,shiftBy:y}=r;let _=Number(t&c),w=t>>y;_>l&&(_-=m,w+=_1n$2);const k=e*l,C=k+Math.abs(_)-1,R=_===0,T=_<0,A=e%2!==0;return{nextN:w,offset:C,isZero:R,isNeg:T,isNegF:A,offsetF:k}}function validateMSMPoints(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((r,l)=>{if(!(r instanceof e))throw new Error("invalid point at index "+l)})}function validateMSMScalars(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((r,l)=>{if(!e.isValid(r))throw new Error("invalid scalar at index "+l)})}const pointPrecomputes=new WeakMap,pointWindowSizes=new WeakMap;function getW(t){return pointWindowSizes.get(t)||1}function assert0(t){if(t!==_0n$2)throw new Error("invalid wNAF")}class wNAF{constructor(e,r){this.BASE=e.BASE,this.ZERO=e.ZERO,this.Fn=e.Fn,this.bits=r}_unsafeLadder(e,r,l=this.ZERO){let c=e;for(;r>_0n$2;)r&_1n$2&&(l=l.add(c)),c=c.double(),r>>=_1n$2;return l}precomputeWindow(e,r){const{windows:l,windowSize:c}=calcWOpts(r,this.bits),m=[];let y=e,_=y;for(let w=0;w<l;w++){_=y,m.push(_);for(let k=1;k<c;k++)_=_.add(y),m.push(_);y=_.double()}return m}wNAF(e,r,l){if(!this.Fn.isValid(l))throw new Error("invalid scalar");let c=this.ZERO,m=this.BASE;const y=calcWOpts(e,this.bits);for(let _=0;_<y.windows;_++){const{nextN:w,offset:k,isZero:C,isNeg:R,isNegF:T,offsetF:A}=calcOffsets(l,_,y);l=w,C?m=m.add(negateCt(T,r[A])):c=c.add(negateCt(R,r[k]))}return assert0(l),{p:c,f:m}}wNAFUnsafe(e,r,l,c=this.ZERO){const m=calcWOpts(e,this.bits);for(let y=0;y<m.windows&&l!==_0n$2;y++){const{nextN:_,offset:w,isZero:k,isNeg:C}=calcOffsets(l,y,m);if(l=_,!k){const R=r[w];c=c.add(C?R.negate():R)}}return assert0(l),c}getPrecomputes(e,r,l){let c=pointPrecomputes.get(r);return c||(c=this.precomputeWindow(r,e),e!==1&&(typeof l=="function"&&(c=l(c)),pointPrecomputes.set(r,c))),c}cached(e,r,l){const c=getW(e);return this.wNAF(c,this.getPrecomputes(c,e,l),r)}unsafe(e,r,l,c){const m=getW(e);return m===1?this._unsafeLadder(e,r,c):this.wNAFUnsafe(m,this.getPrecomputes(m,e,l),r,c)}createCache(e,r){validateW(r,this.bits),pointWindowSizes.set(e,r),pointPrecomputes.delete(e)}hasCache(e){return getW(e)!==1}}function mulEndoUnsafe(t,e,r,l){let c=e,m=t.ZERO,y=t.ZERO;for(;r>_0n$2||l>_0n$2;)r&_1n$2&&(m=m.add(c)),l&_1n$2&&(y=y.add(c)),c=c.double(),r>>=_1n$2,l>>=_1n$2;return{p1:m,p2:y}}function pippenger(t,e,r,l){validateMSMPoints(r,t),validateMSMScalars(l,e);const c=r.length,m=l.length;if(c!==m)throw new Error("arrays of points and scalars must have equal length");const y=t.ZERO,_=bitLen(BigInt(c));let w=1;_>12?w=_-3:_>4?w=_-2:_>0&&(w=2);const k=bitMask(w),C=new Array(Number(k)+1).fill(y),R=Math.floor((e.BITS-1)/w)*w;let T=y;for(let A=R;A>=0;A-=w){C.fill(y);for(let B=0;B<m;B++){const j=l[B],re=Number(j>>BigInt(A)&k);C[re]=C[re].add(r[B])}let M=y;for(let B=C.length-1,j=y;B>0;B--)j=j.add(C[B]),M=M.add(j);if(T=T.add(M),A!==0)for(let B=0;B<w;B++)T=T.double()}return T}function createField(t,e,r){if(e){if(e.ORDER!==t)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return validateField(e),e}else return Field(t,{isLE:r})}function _createCurveFields(t,e,r={},l){if(l===void 0&&(l=t==="edwards"),!e||typeof e!="object")throw new Error(`expected valid ${t} CURVE object`);for(const w of["p","n","h"]){const k=e[w];if(!(typeof k=="bigint"&&k>_0n$2))throw new Error(`CURVE.${w} must be positive bigint`)}const c=createField(e.p,r.Fp,l),m=createField(e.n,r.Fn,l),_=["Gx","Gy","a","b"];for(const w of _)if(!c.isValid(e[w]))throw new Error(`CURVE.${w} must be valid field element of CURVE.Fp`);return e=Object.freeze(Object.assign({},e)),{CURVE:e,Fp:c,Fn:m}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const divNearest=(t,e)=>(t+(t>=0?e:-e)/_2n$1)/e;function _splitEndoScalar(t,e,r){const[[l,c],[m,y]]=e,_=divNearest(y*t,r),w=divNearest(-c*t,r);let k=t-_*l-w*m,C=-_*c-w*y;const R=k<_0n$1,T=C<_0n$1;R&&(k=-k),T&&(C=-C);const A=bitMask(Math.ceil(bitLen(r)/2))+_1n$1;if(k<_0n$1||k>=A||C<_0n$1||C>=A)throw new Error("splitScalar (endomorphism): failed, k="+t);return{k1neg:R,k1:k,k2neg:T,k2:C}}function validateSigFormat(t){if(!["compact","recovered","der"].includes(t))throw new Error('Signature format must be "compact", "recovered", or "der"');return t}function validateSigOpts(t,e){const r={};for(let l of Object.keys(e))r[l]=t[l]===void 0?e[l]:t[l];return _abool2(r.lowS,"lowS"),_abool2(r.prehash,"prehash"),r.format!==void 0&&validateSigFormat(r.format),r}class DERErr extends Error{constructor(e=""){super(e)}}const DER={Err:DERErr,_tlv:{encode:(t,e)=>{const{Err:r}=DER;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length&1)throw new r("tlv.encode: unpadded data");const l=e.length/2,c=numberToHexUnpadded(l);if(c.length/2&128)throw new r("tlv.encode: long form length too big");const m=l>127?numberToHexUnpadded(c.length/2|128):"";return numberToHexUnpadded(t)+m+c+e},decode(t,e){const{Err:r}=DER;let l=0;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length<2||e[l++]!==t)throw new r("tlv.decode: wrong tlv");const c=e[l++],m=!!(c&128);let y=0;if(!m)y=c;else{const w=c&127;if(!w)throw new r("tlv.decode(long): indefinite length not supported");if(w>4)throw new r("tlv.decode(long): byte length is too big");const k=e.subarray(l,l+w);if(k.length!==w)throw new r("tlv.decode: length bytes not complete");if(k[0]===0)throw new r("tlv.decode(long): zero leftmost byte");for(const C of k)y=y<<8|C;if(l+=w,y<128)throw new r("tlv.decode(long): not minimal encoding")}const _=e.subarray(l,l+y);if(_.length!==y)throw new r("tlv.decode: wrong value length");return{v:_,l:e.subarray(l+y)}}},_int:{encode(t){const{Err:e}=DER;if(t<_0n$1)throw new e("integer: negative integers are not allowed");let r=numberToHexUnpadded(t);if(Number.parseInt(r[0],16)&8&&(r="00"+r),r.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return r},decode(t){const{Err:e}=DER;if(t[0]&128)throw new e("invalid signature integer: negative");if(t[0]===0&&!(t[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return bytesToNumberBE(t)}},toSig(t){const{Err:e,_int:r,_tlv:l}=DER,c=ensureBytes("signature",t),{v:m,l:y}=l.decode(48,c);if(y.length)throw new e("invalid signature: left bytes after parsing");const{v:_,l:w}=l.decode(2,m),{v:k,l:C}=l.decode(2,w);if(C.length)throw new e("invalid signature: left bytes after parsing");return{r:r.decode(_),s:r.decode(k)}},hexFromSig(t){const{_tlv:e,_int:r}=DER,l=e.encode(2,r.encode(t.r)),c=e.encode(2,r.encode(t.s)),m=l+c;return e.encode(48,m)}},_0n$1=BigInt(0),_1n$1=BigInt(1),_2n$1=BigInt(2),_3n=BigInt(3),_4n=BigInt(4);function _normFnElement(t,e){const{BYTES:r}=t;let l;if(typeof e=="bigint")l=e;else{let c=ensureBytes("private key",e);try{l=t.fromBytes(c)}catch{throw new Error(`invalid private key: expected ui8a of size ${r}, got ${typeof e}`)}}if(!t.isValidNot0(l))throw new Error("invalid private key: out of range [1..N-1]");return l}function weierstrassN(t,e={}){const r=_createCurveFields("weierstrass",t,e),{Fp:l,Fn:c}=r;let m=r.CURVE;const{h:y,n:_}=m;_validateObject(e,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:w}=e;if(w&&(!l.is0(m.a)||typeof w.beta!="bigint"||!Array.isArray(w.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');const k=getWLengths(l,c);function C(){if(!l.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function R(K,D,Y){const{x:$,y:U}=D.toAffine(),ne=l.toBytes($);if(_abool2(Y,"isCompressed"),Y){C();const V=!l.isOdd(U);return concatBytes(pprefix(V),ne)}else return concatBytes(Uint8Array.of(4),ne,l.toBytes(U))}function T(K){_abytes2(K,void 0,"Point");const{publicKey:D,publicKeyUncompressed:Y}=k,$=K.length,U=K[0],ne=K.subarray(1);if($===D&&(U===2||U===3)){const V=l.fromBytes(ne);if(!l.isValid(V))throw new Error("bad point: is not on curve, wrong x");const ae=B(V);let q;try{q=l.sqrt(ae)}catch(Ee){const we=Ee instanceof Error?": "+Ee.message:"";throw new Error("bad point: is not on curve, sqrt error"+we)}C();const I=l.isOdd(q);return(U&1)===1!==I&&(q=l.neg(q)),{x:V,y:q}}else if($===Y&&U===4){const V=l.BYTES,ae=l.fromBytes(ne.subarray(0,V)),q=l.fromBytes(ne.subarray(V,V*2));if(!j(ae,q))throw new Error("bad point: is not on curve");return{x:ae,y:q}}else throw new Error(`bad point: got length ${$}, expected compressed=${D} or uncompressed=${Y}`)}const A=e.toBytes||R,M=e.fromBytes||T;function B(K){const D=l.sqr(K),Y=l.mul(D,K);return l.add(l.add(Y,l.mul(K,m.a)),m.b)}function j(K,D){const Y=l.sqr(D),$=B(K);return l.eql(Y,$)}if(!j(m.Gx,m.Gy))throw new Error("bad curve params: generator point");const re=l.mul(l.pow(m.a,_3n),_4n),de=l.mul(l.sqr(m.b),BigInt(27));if(l.is0(l.add(re,de)))throw new Error("bad curve params: a or b");function se(K,D,Y=!1){if(!l.isValid(D)||Y&&l.is0(D))throw new Error(`bad point coordinate ${K}`);return D}function ye(K){if(!(K instanceof le))throw new Error("ProjectivePoint expected")}function z(K){if(!w||!w.basises)throw new Error("no endo");return _splitEndoScalar(K,w.basises,c.ORDER)}const W=memoized((K,D)=>{const{X:Y,Y:$,Z:U}=K;if(l.eql(U,l.ONE))return{x:Y,y:$};const ne=K.is0();D==null&&(D=ne?l.ONE:l.inv(U));const V=l.mul(Y,D),ae=l.mul($,D),q=l.mul(U,D);if(ne)return{x:l.ZERO,y:l.ZERO};if(!l.eql(q,l.ONE))throw new Error("invZ was invalid");return{x:V,y:ae}}),Q=memoized(K=>{if(K.is0()){if(e.allowInfinityPoint&&!l.is0(K.Y))return;throw new Error("bad point: ZERO")}const{x:D,y:Y}=K.toAffine();if(!l.isValid(D)||!l.isValid(Y))throw new Error("bad point: x or y not field elements");if(!j(D,Y))throw new Error("bad point: equation left != right");if(!K.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function te(K,D,Y,$,U){return Y=new le(l.mul(Y.X,K),Y.Y,Y.Z),D=negateCt($,D),Y=negateCt(U,Y),D.add(Y)}class le{constructor(D,Y,$){this.X=se("x",D),this.Y=se("y",Y,!0),this.Z=se("z",$),Object.freeze(this)}static CURVE(){return m}static fromAffine(D){const{x:Y,y:$}=D||{};if(!D||!l.isValid(Y)||!l.isValid($))throw new Error("invalid affine point");if(D instanceof le)throw new Error("projective point not allowed");return l.is0(Y)&&l.is0($)?le.ZERO:new le(Y,$,l.ONE)}static fromBytes(D){const Y=le.fromAffine(M(_abytes2(D,void 0,"point")));return Y.assertValidity(),Y}static fromHex(D){return le.fromBytes(ensureBytes("pointHex",D))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(D=8,Y=!0){return F.createCache(this,D),Y||this.multiply(_3n),this}assertValidity(){Q(this)}hasEvenY(){const{y:D}=this.toAffine();if(!l.isOdd)throw new Error("Field doesn't support isOdd");return!l.isOdd(D)}equals(D){ye(D);const{X:Y,Y:$,Z:U}=this,{X:ne,Y:V,Z:ae}=D,q=l.eql(l.mul(Y,ae),l.mul(ne,U)),I=l.eql(l.mul($,ae),l.mul(V,U));return q&&I}negate(){return new le(this.X,l.neg(this.Y),this.Z)}double(){const{a:D,b:Y}=m,$=l.mul(Y,_3n),{X:U,Y:ne,Z:V}=this;let ae=l.ZERO,q=l.ZERO,I=l.ZERO,G=l.mul(U,U),Ee=l.mul(ne,ne),we=l.mul(V,V),pe=l.mul(U,ne);return pe=l.add(pe,pe),I=l.mul(U,V),I=l.add(I,I),ae=l.mul(D,I),q=l.mul($,we),q=l.add(ae,q),ae=l.sub(Ee,q),q=l.add(Ee,q),q=l.mul(ae,q),ae=l.mul(pe,ae),I=l.mul($,I),we=l.mul(D,we),pe=l.sub(G,we),pe=l.mul(D,pe),pe=l.add(pe,I),I=l.add(G,G),G=l.add(I,G),G=l.add(G,we),G=l.mul(G,pe),q=l.add(q,G),we=l.mul(ne,V),we=l.add(we,we),G=l.mul(we,pe),ae=l.sub(ae,G),I=l.mul(we,Ee),I=l.add(I,I),I=l.add(I,I),new le(ae,q,I)}add(D){ye(D);const{X:Y,Y:$,Z:U}=this,{X:ne,Y:V,Z:ae}=D;let q=l.ZERO,I=l.ZERO,G=l.ZERO;const Ee=m.a,we=l.mul(m.b,_3n);let pe=l.mul(Y,ne),_e=l.mul($,V),Re=l.mul(U,ae),Ie=l.add(Y,$),Me=l.add(ne,V);Ie=l.mul(Ie,Me),Me=l.add(pe,_e),Ie=l.sub(Ie,Me),Me=l.add(Y,U);let Ke=l.add(ne,ae);return Me=l.mul(Me,Ke),Ke=l.add(pe,Re),Me=l.sub(Me,Ke),Ke=l.add($,U),q=l.add(V,ae),Ke=l.mul(Ke,q),q=l.add(_e,Re),Ke=l.sub(Ke,q),G=l.mul(Ee,Me),q=l.mul(we,Re),G=l.add(q,G),q=l.sub(_e,G),G=l.add(_e,G),I=l.mul(q,G),_e=l.add(pe,pe),_e=l.add(_e,pe),Re=l.mul(Ee,Re),Me=l.mul(we,Me),_e=l.add(_e,Re),Re=l.sub(pe,Re),Re=l.mul(Ee,Re),Me=l.add(Me,Re),pe=l.mul(_e,Me),I=l.add(I,pe),pe=l.mul(Ke,Me),q=l.mul(Ie,q),q=l.sub(q,pe),pe=l.mul(Ie,_e),G=l.mul(Ke,G),G=l.add(G,pe),new le(q,I,G)}subtract(D){return this.add(D.negate())}is0(){return this.equals(le.ZERO)}multiply(D){const{endo:Y}=e;if(!c.isValidNot0(D))throw new Error("invalid scalar: out of range");let $,U;const ne=V=>F.cached(this,V,ae=>normalizeZ(le,ae));if(Y){const{k1neg:V,k1:ae,k2neg:q,k2:I}=z(D),{p:G,f:Ee}=ne(ae),{p:we,f:pe}=ne(I);U=Ee.add(pe),$=te(Y.beta,G,we,V,q)}else{const{p:V,f:ae}=ne(D);$=V,U=ae}return normalizeZ(le,[$,U])[0]}multiplyUnsafe(D){const{endo:Y}=e,$=this;if(!c.isValid(D))throw new Error("invalid scalar: out of range");if(D===_0n$1||$.is0())return le.ZERO;if(D===_1n$1)return $;if(F.hasCache(this))return this.multiply(D);if(Y){const{k1neg:U,k1:ne,k2neg:V,k2:ae}=z(D),{p1:q,p2:I}=mulEndoUnsafe(le,$,ne,ae);return te(Y.beta,q,I,U,V)}else return F.unsafe($,D)}multiplyAndAddUnsafe(D,Y,$){const U=this.multiplyUnsafe(Y).add(D.multiplyUnsafe($));return U.is0()?void 0:U}toAffine(D){return W(this,D)}isTorsionFree(){const{isTorsionFree:D}=e;return y===_1n$1?!0:D?D(le,this):F.unsafe(this,_).is0()}clearCofactor(){const{clearCofactor:D}=e;return y===_1n$1?this:D?D(le,this):this.multiplyUnsafe(y)}isSmallOrder(){return this.multiplyUnsafe(y).is0()}toBytes(D=!0){return _abool2(D,"isCompressed"),this.assertValidity(),A(le,this,D)}toHex(D=!0){return bytesToHex(this.toBytes(D))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(D=!0){return this.toBytes(D)}_setWindowSize(D){this.precompute(D)}static normalizeZ(D){return normalizeZ(le,D)}static msm(D,Y){return pippenger(le,c,D,Y)}static fromPrivateKey(D){return le.BASE.multiply(_normFnElement(c,D))}}le.BASE=new le(m.Gx,m.Gy,l.ONE),le.ZERO=new le(l.ZERO,l.ONE,l.ZERO),le.Fp=l,le.Fn=c;const me=c.BITS,F=new wNAF(le,e.endo?Math.ceil(me/2):me);return le.BASE.precompute(8),le}function pprefix(t){return Uint8Array.of(t?2:3)}function getWLengths(t,e){return{secretKey:e.BYTES,publicKey:1+t.BYTES,publicKeyUncompressed:1+2*t.BYTES,publicKeyHasPrefix:!0,signature:2*e.BYTES}}function ecdh(t,e={}){const{Fn:r}=t,l=e.randomBytes||randomBytes,c=Object.assign(getWLengths(t.Fp,r),{seed:getMinHashLength(r.ORDER)});function m(A){try{return!!_normFnElement(r,A)}catch{return!1}}function y(A,M){const{publicKey:B,publicKeyUncompressed:j}=c;try{const re=A.length;return M===!0&&re!==B||M===!1&&re!==j?!1:!!t.fromBytes(A)}catch{return!1}}function _(A=l(c.seed)){return mapHashToField(_abytes2(A,c.seed,"seed"),r.ORDER)}function w(A,M=!0){return t.BASE.multiply(_normFnElement(r,A)).toBytes(M)}function k(A){const M=_(A);return{secretKey:M,publicKey:w(M)}}function C(A){if(typeof A=="bigint")return!1;if(A instanceof t)return!0;const{secretKey:M,publicKey:B,publicKeyUncompressed:j}=c;if(r.allowedLengths||M===B)return;const re=ensureBytes("key",A).length;return re===B||re===j}function R(A,M,B=!0){if(C(A)===!0)throw new Error("first arg must be private key");if(C(M)===!1)throw new Error("second arg must be public key");const j=_normFnElement(r,A);return t.fromHex(M).multiply(j).toBytes(B)}return Object.freeze({getPublicKey:w,getSharedSecret:R,keygen:k,Point:t,utils:{isValidSecretKey:m,isValidPublicKey:y,randomSecretKey:_,isValidPrivateKey:m,randomPrivateKey:_,normPrivateKeyToScalar:A=>_normFnElement(r,A),precompute(A=8,M=t.BASE){return M.precompute(A,!1)}},lengths:c})}function ecdsa(t,e,r={}){ahash(e),_validateObject(r,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const l=r.randomBytes||randomBytes,c=r.hmac||((Y,...$)=>hmac(e,Y,concatBytes(...$))),{Fp:m,Fn:y}=t,{ORDER:_,BITS:w}=y,{keygen:k,getPublicKey:C,getSharedSecret:R,utils:T,lengths:A}=ecdh(t,r),M={prehash:!1,lowS:typeof r.lowS=="boolean"?r.lowS:!1,format:void 0,extraEntropy:!1},B="compact";function j(Y){const $=_>>_1n$1;return Y>$}function re(Y,$){if(!y.isValidNot0($))throw new Error(`invalid signature ${Y}: out of range 1..Point.Fn.ORDER`);return $}function de(Y,$){validateSigFormat($);const U=A.signature,ne=$==="compact"?U:$==="recovered"?U+1:void 0;return _abytes2(Y,ne,`${$} signature`)}class se{constructor($,U,ne){this.r=re("r",$),this.s=re("s",U),ne!=null&&(this.recovery=ne),Object.freeze(this)}static fromBytes($,U=B){de($,U);let ne;if(U==="der"){const{r:I,s:G}=DER.toSig(_abytes2($));return new se(I,G)}U==="recovered"&&(ne=$[0],U="compact",$=$.subarray(1));const V=y.BYTES,ae=$.subarray(0,V),q=$.subarray(V,V*2);return new se(y.fromBytes(ae),y.fromBytes(q),ne)}static fromHex($,U){return this.fromBytes(hexToBytes($),U)}addRecoveryBit($){return new se(this.r,this.s,$)}recoverPublicKey($){const U=m.ORDER,{r:ne,s:V,recovery:ae}=this;if(ae==null||![0,1,2,3].includes(ae))throw new Error("recovery id invalid");if(_*_2n$1<U&&ae>1)throw new Error("recovery id is ambiguous for h>1 curve");const I=ae===2||ae===3?ne+_:ne;if(!m.isValid(I))throw new Error("recovery id 2 or 3 invalid");const G=m.toBytes(I),Ee=t.fromBytes(concatBytes(pprefix((ae&1)===0),G)),we=y.inv(I),pe=z(ensureBytes("msgHash",$)),_e=y.create(-pe*we),Re=y.create(V*we),Ie=t.BASE.multiplyUnsafe(_e).add(Ee.multiplyUnsafe(Re));if(Ie.is0())throw new Error("point at infinify");return Ie.assertValidity(),Ie}hasHighS(){return j(this.s)}toBytes($=B){if(validateSigFormat($),$==="der")return hexToBytes(DER.hexFromSig(this));const U=y.toBytes(this.r),ne=y.toBytes(this.s);if($==="recovered"){if(this.recovery==null)throw new Error("recovery bit must be present");return concatBytes(Uint8Array.of(this.recovery),U,ne)}return concatBytes(U,ne)}toHex($){return bytesToHex(this.toBytes($))}assertValidity(){}static fromCompact($){return se.fromBytes(ensureBytes("sig",$),"compact")}static fromDER($){return se.fromBytes(ensureBytes("sig",$),"der")}normalizeS(){return this.hasHighS()?new se(this.r,y.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return bytesToHex(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return bytesToHex(this.toBytes("compact"))}}const ye=r.bits2int||function($){if($.length>8192)throw new Error("input is too large");const U=bytesToNumberBE($),ne=$.length*8-w;return ne>0?U>>BigInt(ne):U},z=r.bits2int_modN||function($){return y.create(ye($))},W=bitMask(w);function Q(Y){return aInRange("num < 2^"+w,Y,_0n$1,W),y.toBytes(Y)}function te(Y,$){return _abytes2(Y,void 0,"message"),$?_abytes2(e(Y),void 0,"prehashed message"):Y}function le(Y,$,U){if(["recovered","canonical"].some(_e=>_e in U))throw new Error("sign() legacy options not supported");const{lowS:ne,prehash:V,extraEntropy:ae}=validateSigOpts(U,M);Y=te(Y,V);const q=z(Y),I=_normFnElement(y,$),G=[Q(I),Q(q)];if(ae!=null&&ae!==!1){const _e=ae===!0?l(A.secretKey):ae;G.push(ensureBytes("extraEntropy",_e))}const Ee=concatBytes(...G),we=q;function pe(_e){const Re=ye(_e);if(!y.isValidNot0(Re))return;const Ie=y.inv(Re),Me=t.BASE.multiply(Re).toAffine(),Ke=y.create(Me.x);if(Ke===_0n$1)return;const kt=y.create(Ie*y.create(we+Ke*I));if(kt===_0n$1)return;let at=(Me.x===Ke?0:2)|Number(Me.y&_1n$1),vt=kt;return ne&&j(kt)&&(vt=y.neg(kt),at^=1),new se(Ke,vt,at)}return{seed:Ee,k2sig:pe}}function me(Y,$,U={}){Y=ensureBytes("message",Y);const{seed:ne,k2sig:V}=le(Y,$,U);return createHmacDrbg(e.outputLen,y.BYTES,c)(ne,V)}function F(Y){let $;const U=typeof Y=="string"||isBytes(Y),ne=!U&&Y!==null&&typeof Y=="object"&&typeof Y.r=="bigint"&&typeof Y.s=="bigint";if(!U&&!ne)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(ne)$=new se(Y.r,Y.s);else if(U){try{$=se.fromBytes(ensureBytes("sig",Y),"der")}catch(V){if(!(V instanceof DER.Err))throw V}if(!$)try{$=se.fromBytes(ensureBytes("sig",Y),"compact")}catch{return!1}}return $||!1}function K(Y,$,U,ne={}){const{lowS:V,prehash:ae,format:q}=validateSigOpts(ne,M);if(U=ensureBytes("publicKey",U),$=te(ensureBytes("message",$),ae),"strict"in ne)throw new Error("options.strict was renamed to lowS");const I=q===void 0?F(Y):se.fromBytes(ensureBytes("sig",Y),q);if(I===!1)return!1;try{const G=t.fromBytes(U);if(V&&I.hasHighS())return!1;const{r:Ee,s:we}=I,pe=z($),_e=y.inv(we),Re=y.create(pe*_e),Ie=y.create(Ee*_e),Me=t.BASE.multiplyUnsafe(Re).add(G.multiplyUnsafe(Ie));return Me.is0()?!1:y.create(Me.x)===Ee}catch{return!1}}function D(Y,$,U={}){const{prehash:ne}=validateSigOpts(U,M);return $=te($,ne),se.fromBytes(Y,"recovered").recoverPublicKey($).toBytes()}return Object.freeze({keygen:k,getPublicKey:C,getSharedSecret:R,utils:T,lengths:A,Point:t,sign:me,verify:K,recoverPublicKey:D,Signature:se,hash:e})}function _weierstrass_legacy_opts_to_new(t){const e={a:t.a,b:t.b,p:t.Fp.ORDER,n:t.n,h:t.h,Gx:t.Gx,Gy:t.Gy},r=t.Fp;let l=t.allowedPrivateKeyLengths?Array.from(new Set(t.allowedPrivateKeyLengths.map(y=>Math.ceil(y/2)))):void 0;const c=Field(e.n,{BITS:t.nBitLength,allowedLengths:l,modFromBytes:t.wrapPrivateKey}),m={Fp:r,Fn:c,allowInfinityPoint:t.allowInfinityPoint,endo:t.endo,isTorsionFree:t.isTorsionFree,clearCofactor:t.clearCofactor,fromBytes:t.fromBytes,toBytes:t.toBytes};return{CURVE:e,curveOpts:m}}function _ecdsa_legacy_opts_to_new(t){const{CURVE:e,curveOpts:r}=_weierstrass_legacy_opts_to_new(t),l={hmac:t.hmac,randomBytes:t.randomBytes,lowS:t.lowS,bits2int:t.bits2int,bits2int_modN:t.bits2int_modN};return{CURVE:e,curveOpts:r,hash:t.hash,ecdsaOpts:l}}function _ecdsa_new_output_to_legacy(t,e){const r=e.Point;return Object.assign({},e,{ProjectivePoint:r,CURVE:Object.assign({},t,nLength(r.Fn.ORDER,r.Fn.BITS))})}function weierstrass(t){const{CURVE:e,curveOpts:r,hash:l,ecdsaOpts:c}=_ecdsa_legacy_opts_to_new(t),m=weierstrassN(e,r),y=ecdsa(m,l,c);return _ecdsa_new_output_to_legacy(t,y)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function createCurve(t,e){const r=l=>weierstrass({...t,hash:l});return{...r(e),create:r}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const secp256k1_CURVE={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},secp256k1_ENDO={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),basises:[[BigInt("0x3086d221a7d46bcde86c90e49284eb15"),-BigInt("0xe4437ed6010e88286f547fa90abfe4c3")],[BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),BigInt("0x3086d221a7d46bcde86c90e49284eb15")]]},_0n=BigInt(0),_1n=BigInt(1),_2n=BigInt(2);function sqrtMod(t){const e=secp256k1_CURVE.p,r=BigInt(3),l=BigInt(6),c=BigInt(11),m=BigInt(22),y=BigInt(23),_=BigInt(44),w=BigInt(88),k=t*t*t%e,C=k*k*t%e,R=pow2(C,r,e)*C%e,T=pow2(R,r,e)*C%e,A=pow2(T,_2n,e)*k%e,M=pow2(A,c,e)*A%e,B=pow2(M,m,e)*M%e,j=pow2(B,_,e)*B%e,re=pow2(j,w,e)*j%e,de=pow2(re,_,e)*B%e,se=pow2(de,r,e)*C%e,ye=pow2(se,y,e)*M%e,z=pow2(ye,l,e)*k%e,W=pow2(z,_2n,e);if(!Fpk1.eql(Fpk1.sqr(W),t))throw new Error("Cannot find square root");return W}const Fpk1=Field(secp256k1_CURVE.p,{sqrt:sqrtMod}),secp256k1=createCurve({...secp256k1_CURVE,Fp:Fpk1,lowS:!0,endo:secp256k1_ENDO},sha256$1),TAGGED_HASH_PREFIXES={};function taggedHash(t,...e){let r=TAGGED_HASH_PREFIXES[t];if(r===void 0){const l=sha256$1(utf8ToBytes(t));r=concatBytes(l,l),TAGGED_HASH_PREFIXES[t]=r}return sha256$1(concatBytes(r,...e))}const pointToBytes=t=>t.toBytes(!0).slice(1),Pointk1=secp256k1.Point,hasEven=t=>t%_2n===_0n;function schnorrGetExtPubKey(t){const{Fn:e,BASE:r}=Pointk1,l=_normFnElement(e,t),c=r.multiply(l);return{scalar:hasEven(c.y)?l:e.neg(l),bytes:pointToBytes(c)}}function lift_x(t){const e=Fpk1;if(!e.isValidNot0(t))throw new Error("invalid x: Fail if x  p");const r=e.create(t*t),l=e.create(r*t+BigInt(7));let c=e.sqrt(l);hasEven(c)||(c=e.neg(c));const m=Pointk1.fromAffine({x:t,y:c});return m.assertValidity(),m}const num=bytesToNumberBE;function challenge(...t){return Pointk1.Fn.create(num(taggedHash("BIP0340/challenge",...t)))}function schnorrGetPublicKey(t){return schnorrGetExtPubKey(t).bytes}function schnorrSign(t,e,r=randomBytes(32)){const{Fn:l}=Pointk1,c=ensureBytes("message",t),{bytes:m,scalar:y}=schnorrGetExtPubKey(e),_=ensureBytes("auxRand",r,32),w=l.toBytes(y^num(taggedHash("BIP0340/aux",_))),k=taggedHash("BIP0340/nonce",w,m,c),{bytes:C,scalar:R}=schnorrGetExtPubKey(k),T=challenge(C,m,c),A=new Uint8Array(64);if(A.set(C,0),A.set(l.toBytes(l.create(R+T*y)),32),!schnorrVerify(A,c,m))throw new Error("sign: Invalid signature produced");return A}function schnorrVerify(t,e,r){const{Fn:l,BASE:c}=Pointk1,m=ensureBytes("signature",t,64),y=ensureBytes("message",e),_=ensureBytes("publicKey",r,32);try{const w=lift_x(num(_)),k=num(m.subarray(0,32));if(!inRange(k,_1n,secp256k1_CURVE.p))return!1;const C=num(m.subarray(32,64));if(!inRange(C,_1n,secp256k1_CURVE.n))return!1;const R=challenge(l.toBytes(k),pointToBytes(w),y),T=c.multiplyUnsafe(C).add(w.multiplyUnsafe(l.neg(R))),{x:A,y:M}=T.toAffine();return!(T.is0()||!hasEven(M)||A!==k)}catch{return!1}}const schnorr=(()=>{const r=(c=randomBytes(48))=>mapHashToField(c,secp256k1_CURVE.n);secp256k1.utils.randomSecretKey;function l(c){const m=r(c);return{secretKey:m,publicKey:schnorrGetPublicKey(m)}}return{keygen:l,getPublicKey:schnorrGetPublicKey,sign:schnorrSign,verify:schnorrVerify,Point:Pointk1,utils:{randomSecretKey:r,randomPrivateKey:r,taggedHash,lift_x,pointToBytes,numberToBytesBE,bytesToNumberBE,mod},lengths:{secretKey:32,publicKey:32,publicKeyHasPrefix:!1,signature:64,seed:48}}})(),sha256=sha256$1;var dist={},LRUCache={},LRUCacheNode={},hasRequiredLRUCacheNode;function requireLRUCacheNode(){if(hasRequiredLRUCacheNode)return LRUCacheNode;hasRequiredLRUCacheNode=1,Object.defineProperty(LRUCacheNode,"__esModule",{value:!0}),LRUCacheNode.LRUCacheNode=void 0;let t=class{constructor(r,l,c){const{entryExpirationTimeInMS:m=null,next:y=null,prev:_=null,onEntryEvicted:w,onEntryMarkedAsMostRecentlyUsed:k,clone:C,cloneFn:R}=c??{};if(typeof m=="number"&&(m<=0||Number.isNaN(m)))throw new Error("entryExpirationTimeInMS must either be null (no expiry) or greater than 0");this.clone=C??!1,this.cloneFn=R??this.defaultClone,this.key=r,this.internalValue=this.clone?this.cloneFn(l):l,this.created=Date.now(),this.entryExpirationTimeInMS=m,this.next=y,this.prev=_,this.onEntryEvicted=w,this.onEntryMarkedAsMostRecentlyUsed=k}get value(){return this.clone?this.cloneFn(this.internalValue):this.internalValue}get isExpired(){return typeof this.entryExpirationTimeInMS=="number"&&Date.now()-this.created>this.entryExpirationTimeInMS}invokeOnEvicted(){if(this.onEntryEvicted){const{key:r,value:l,isExpired:c}=this;this.onEntryEvicted({key:r,value:l,isExpired:c})}}invokeOnEntryMarkedAsMostRecentlyUsed(){if(this.onEntryMarkedAsMostRecentlyUsed){const{key:r,value:l}=this;this.onEntryMarkedAsMostRecentlyUsed({key:r,value:l})}}defaultClone(r){return typeof r=="boolean"||typeof r=="string"||typeof r=="number"?r:JSON.parse(JSON.stringify(r))}};return LRUCacheNode.LRUCacheNode=t,LRUCacheNode}var hasRequiredLRUCache;function requireLRUCache(){if(hasRequiredLRUCache)return LRUCache;hasRequiredLRUCache=1,Object.defineProperty(LRUCache,"__esModule",{value:!0}),LRUCache.LRUCache=void 0;const t=requireLRUCacheNode();let e=class{constructor(l){this.lookupTable=new Map,this.head=null,this.tail=null;const{maxSize:c=25,entryExpirationTimeInMS:m=null,onEntryEvicted:y,onEntryMarkedAsMostRecentlyUsed:_,cloneFn:w,clone:k}=l??{};if(Number.isNaN(c)||c<=0)throw new Error("maxSize must be greater than 0.");if(typeof m=="number"&&(m<=0||Number.isNaN(m)))throw new Error("entryExpirationTimeInMS must either be null (no expiry) or greater than 0");this.maxSizeInternal=c,this.entryExpirationTimeInMS=m,this.onEntryEvicted=y,this.onEntryMarkedAsMostRecentlyUsed=_,this.clone=k,this.cloneFn=w}get size(){return this.cleanCache(),this.lookupTable.size}get remainingSize(){return this.maxSizeInternal-this.size}get newest(){return this.head?this.head.isExpired?(this.removeNodeFromListAndLookupTable(this.head),this.newest):this.mapNodeToEntry(this.head):null}get oldest(){return this.tail?this.tail.isExpired?(this.removeNodeFromListAndLookupTable(this.tail),this.oldest):this.mapNodeToEntry(this.tail):null}get maxSize(){return this.maxSizeInternal}set maxSize(l){if(Number.isNaN(l)||l<=0)throw new Error("maxSize must be greater than 0.");this.maxSizeInternal=l,this.enforceSizeLimit()}set(l,c,m){const y=this.lookupTable.get(l);y&&this.removeNodeFromListAndLookupTable(y);const _=new t.LRUCacheNode(l,c,{entryExpirationTimeInMS:this.entryExpirationTimeInMS,onEntryEvicted:this.onEntryEvicted,onEntryMarkedAsMostRecentlyUsed:this.onEntryMarkedAsMostRecentlyUsed,clone:this.clone,cloneFn:this.cloneFn,...m});return this.setNodeAsHead(_),this.lookupTable.set(l,_),this.enforceSizeLimit(),this}get(l){const c=this.lookupTable.get(l);return c?c.isExpired?(this.removeNodeFromListAndLookupTable(c),null):(this.setNodeAsHead(c),c.value):null}peek(l){const c=this.lookupTable.get(l);return c?c.isExpired?(this.removeNodeFromListAndLookupTable(c),null):c.value:null}delete(l){const c=this.lookupTable.get(l);return c?this.removeNodeFromListAndLookupTable(c):!1}has(l){const c=this.lookupTable.get(l);return c?c.isExpired?(this.removeNodeFromListAndLookupTable(c),!1):!0:!1}clear(){this.head=null,this.tail=null,this.lookupTable.clear()}find(l){let c=this.head;for(;c;){if(c.isExpired){const y=c.next;this.removeNodeFromListAndLookupTable(c),c=y;continue}const m=this.mapNodeToEntry(c);if(l(m))return this.setNodeAsHead(c),m;c=c.next}return null}forEach(l){let c=this.head,m=0;for(;c;){if(c.isExpired){const y=c.next;this.removeNodeFromListAndLookupTable(c),c=y;continue}l(c.value,c.key,m),c=c.next,m++}}*values(){let l=this.head;for(;l;){if(l.isExpired){const c=l.next;this.removeNodeFromListAndLookupTable(l),l=c;continue}yield l.value,l=l.next}}*keys(){let l=this.head;for(;l;){if(l.isExpired){const c=l.next;this.removeNodeFromListAndLookupTable(l),l=c;continue}yield l.key,l=l.next}}*entries(){let l=this.head;for(;l;){if(l.isExpired){const c=l.next;this.removeNodeFromListAndLookupTable(l),l=c;continue}yield this.mapNodeToEntry(l),l=l.next}}*[Symbol.iterator](){let l=this.head;for(;l;){if(l.isExpired){const c=l.next;this.removeNodeFromListAndLookupTable(l),l=c;continue}yield this.mapNodeToEntry(l),l=l.next}}enforceSizeLimit(){let l=this.tail;for(;l!==null&&this.size>this.maxSizeInternal;){const c=l.prev;this.removeNodeFromListAndLookupTable(l),l=c}}mapNodeToEntry({key:l,value:c}){return{key:l,value:c}}setNodeAsHead(l){this.removeNodeFromList(l),this.head?(l.next=this.head,this.head.prev=l,this.head=l):(this.head=l,this.tail=l),l.invokeOnEntryMarkedAsMostRecentlyUsed()}removeNodeFromList(l){l.prev!==null&&(l.prev.next=l.next),l.next!==null&&(l.next.prev=l.prev),this.head===l&&(this.head=l.next),this.tail===l&&(this.tail=l.prev),l.next=null,l.prev=null}removeNodeFromListAndLookupTable(l){return l.invokeOnEvicted(),this.removeNodeFromList(l),this.lookupTable.delete(l.key)}cleanCache(){if(!this.entryExpirationTimeInMS)return;const l=[];for(const c of this.lookupTable.values())c.isExpired&&l.push(c);l.forEach(c=>this.removeNodeFromListAndLookupTable(c))}};return LRUCache.LRUCache=e,LRUCache}var hasRequiredDist;function requireDist(){return hasRequiredDist||(hasRequiredDist=1,(function(t){var e=dist&&dist.__createBinding||(Object.create?(function(l,c,m,y){y===void 0&&(y=m);var _=Object.getOwnPropertyDescriptor(c,m);(!_||("get"in _?!c.__esModule:_.writable||_.configurable))&&(_={enumerable:!0,get:function(){return c[m]}}),Object.defineProperty(l,y,_)}):(function(l,c,m,y){y===void 0&&(y=m),l[y]=c[m]})),r=dist&&dist.__exportStar||function(l,c){for(var m in l)m!=="default"&&!Object.prototype.hasOwnProperty.call(c,m)&&e(c,l,m)};Object.defineProperty(t,"__esModule",{value:!0}),r(requireLRUCache(),t)})(dist)),dist}var distExports=requireDist(),lib={},hasRequiredLib;function requireLib(){return hasRequiredLib||(hasRequiredLib=1,(function(t){/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */Object.defineProperty(t,"__esModule",{value:!0}),t.bytes=t.stringToBytes=t.str=t.bytesToString=t.hex=t.utf8=t.bech32m=t.bech32=t.base58check=t.base58xmr=t.base58xrp=t.base58flickr=t.base58=t.base64url=t.base64=t.base32crockford=t.base32hex=t.base32=t.base16=t.utils=t.assertNumber=void 0;function e(F){if(!Number.isSafeInteger(F))throw new Error(`Wrong integer: ${F}`)}t.assertNumber=e;function r(...F){const K=($,U)=>ne=>$(U(ne)),D=Array.from(F).reverse().reduce(($,U)=>$?K($,U.encode):U.encode,void 0),Y=F.reduce(($,U)=>$?K($,U.decode):U.decode,void 0);return{encode:D,decode:Y}}function l(F){return{encode:K=>{if(!Array.isArray(K)||K.length&&typeof K[0]!="number")throw new Error("alphabet.encode input should be an array of numbers");return K.map(D=>{if(e(D),D<0||D>=F.length)throw new Error(`Digit index outside alphabet: ${D} (alphabet: ${F.length})`);return F[D]})},decode:K=>{if(!Array.isArray(K)||K.length&&typeof K[0]!="string")throw new Error("alphabet.decode input should be array of strings");return K.map(D=>{if(typeof D!="string")throw new Error(`alphabet.decode: not string element=${D}`);const Y=F.indexOf(D);if(Y===-1)throw new Error(`Unknown letter: "${D}". Allowed: ${F}`);return Y})}}}function c(F=""){if(typeof F!="string")throw new Error("join separator should be string");return{encode:K=>{if(!Array.isArray(K)||K.length&&typeof K[0]!="string")throw new Error("join.encode input should be array of strings");for(let D of K)if(typeof D!="string")throw new Error(`join.encode: non-string input=${D}`);return K.join(F)},decode:K=>{if(typeof K!="string")throw new Error("join.decode input should be string");return K.split(F)}}}function m(F,K="="){if(e(F),typeof K!="string")throw new Error("padding chr should be string");return{encode(D){if(!Array.isArray(D)||D.length&&typeof D[0]!="string")throw new Error("padding.encode input should be array of strings");for(let Y of D)if(typeof Y!="string")throw new Error(`padding.encode: non-string input=${Y}`);for(;D.length*F%8;)D.push(K);return D},decode(D){if(!Array.isArray(D)||D.length&&typeof D[0]!="string")throw new Error("padding.encode input should be array of strings");for(let $ of D)if(typeof $!="string")throw new Error(`padding.decode: non-string input=${$}`);let Y=D.length;if(Y*F%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;Y>0&&D[Y-1]===K;Y--)if(!((Y-1)*F%8))throw new Error("Invalid padding: string has too much padding");return D.slice(0,Y)}}}function y(F){if(typeof F!="function")throw new Error("normalize fn should be function");return{encode:K=>K,decode:K=>F(K)}}function _(F,K,D){if(K<2)throw new Error(`convertRadix: wrong from=${K}, base cannot be less than 2`);if(D<2)throw new Error(`convertRadix: wrong to=${D}, base cannot be less than 2`);if(!Array.isArray(F))throw new Error("convertRadix: data should be array");if(!F.length)return[];let Y=0;const $=[],U=Array.from(F);for(U.forEach(ne=>{if(e(ne),ne<0||ne>=K)throw new Error(`Wrong integer: ${ne}`)});;){let ne=0,V=!0;for(let ae=Y;ae<U.length;ae++){const q=U[ae],I=K*ne+q;if(!Number.isSafeInteger(I)||K*ne/K!==ne||I-q!==K*ne)throw new Error("convertRadix: carry overflow");if(ne=I%D,U[ae]=Math.floor(I/D),!Number.isSafeInteger(U[ae])||U[ae]*D+ne!==I)throw new Error("convertRadix: carry overflow");if(V)U[ae]?V=!1:Y=ae;else continue}if($.push(ne),V)break}for(let ne=0;ne<F.length-1&&F[ne]===0;ne++)$.push(0);return $.reverse()}const w=(F,K)=>K?w(K,F%K):F,k=(F,K)=>F+(K-w(F,K));function C(F,K,D,Y){if(!Array.isArray(F))throw new Error("convertRadix2: data should be array");if(K<=0||K>32)throw new Error(`convertRadix2: wrong from=${K}`);if(D<=0||D>32)throw new Error(`convertRadix2: wrong to=${D}`);if(k(K,D)>32)throw new Error(`convertRadix2: carry overflow from=${K} to=${D} carryBits=${k(K,D)}`);let $=0,U=0;const ne=2**D-1,V=[];for(const ae of F){if(e(ae),ae>=2**K)throw new Error(`convertRadix2: invalid data word=${ae} from=${K}`);if($=$<<K|ae,U+K>32)throw new Error(`convertRadix2: carry overflow pos=${U} from=${K}`);for(U+=K;U>=D;U-=D)V.push(($>>U-D&ne)>>>0);$&=2**U-1}if($=$<<D-U&ne,!Y&&U>=K)throw new Error("Excess padding");if(!Y&&$)throw new Error(`Non-zero padding: ${$}`);return Y&&U>0&&V.push($>>>0),V}function R(F){return e(F),{encode:K=>{if(!(K instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return _(Array.from(K),2**8,F)},decode:K=>{if(!Array.isArray(K)||K.length&&typeof K[0]!="number")throw new Error("radix.decode input should be array of strings");return Uint8Array.from(_(K,F,2**8))}}}function T(F,K=!1){if(e(F),F<=0||F>32)throw new Error("radix2: bits should be in (0..32]");if(k(8,F)>32||k(F,8)>32)throw new Error("radix2: carry overflow");return{encode:D=>{if(!(D instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return C(Array.from(D),8,F,!K)},decode:D=>{if(!Array.isArray(D)||D.length&&typeof D[0]!="number")throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(C(D,F,8,K))}}}function A(F){if(typeof F!="function")throw new Error("unsafeWrapper fn should be function");return function(...K){try{return F.apply(null,K)}catch{}}}function M(F,K){if(e(F),typeof K!="function")throw new Error("checksum fn should be function");return{encode(D){if(!(D instanceof Uint8Array))throw new Error("checksum.encode: input should be Uint8Array");const Y=K(D).slice(0,F),$=new Uint8Array(D.length+F);return $.set(D),$.set(Y,D.length),$},decode(D){if(!(D instanceof Uint8Array))throw new Error("checksum.decode: input should be Uint8Array");const Y=D.slice(0,-F),$=K(Y).slice(0,F),U=D.slice(-F);for(let ne=0;ne<F;ne++)if($[ne]!==U[ne])throw new Error("Invalid checksum");return Y}}}t.utils={alphabet:l,chain:r,checksum:M,radix:R,radix2:T,join:c,padding:m},t.base16=r(T(4),l("0123456789ABCDEF"),c("")),t.base32=r(T(5),l("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),m(5),c("")),t.base32hex=r(T(5),l("0123456789ABCDEFGHIJKLMNOPQRSTUV"),m(5),c("")),t.base32crockford=r(T(5),l("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),c(""),y(F=>F.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1"))),t.base64=r(T(6),l("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),m(6),c("")),t.base64url=r(T(6),l("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),m(6),c(""));const B=F=>r(R(58),l(F),c(""));t.base58=B("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),t.base58flickr=B("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"),t.base58xrp=B("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz");const j=[0,2,3,5,6,7,9,10,11];t.base58xmr={encode(F){let K="";for(let D=0;D<F.length;D+=8){const Y=F.subarray(D,D+8);K+=t.base58.encode(Y).padStart(j[Y.length],"1")}return K},decode(F){let K=[];for(let D=0;D<F.length;D+=11){const Y=F.slice(D,D+11),$=j.indexOf(Y.length),U=t.base58.decode(Y);for(let ne=0;ne<U.length-$;ne++)if(U[ne]!==0)throw new Error("base58xmr: wrong padding");K=K.concat(Array.from(U.slice(U.length-$)))}return Uint8Array.from(K)}};const re=F=>r(M(4,K=>F(F(K))),t.base58);t.base58check=re;const de=r(l("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),c("")),se=[996825010,642813549,513874426,1027748829,705979059];function ye(F){const K=F>>25;let D=(F&33554431)<<5;for(let Y=0;Y<se.length;Y++)(K>>Y&1)===1&&(D^=se[Y]);return D}function z(F,K,D=1){const Y=F.length;let $=1;for(let U=0;U<Y;U++){const ne=F.charCodeAt(U);if(ne<33||ne>126)throw new Error(`Invalid prefix (${F})`);$=ye($)^ne>>5}$=ye($);for(let U=0;U<Y;U++)$=ye($)^F.charCodeAt(U)&31;for(let U of K)$=ye($)^U;for(let U=0;U<6;U++)$=ye($);return $^=D,de.encode(C([$%2**30],30,5,!1))}function W(F){const K=F==="bech32"?1:734539939,D=T(5),Y=D.decode,$=D.encode,U=A(Y);function ne(I,G,Ee=90){if(typeof I!="string")throw new Error(`bech32.encode prefix should be string, not ${typeof I}`);if(!Array.isArray(G)||G.length&&typeof G[0]!="number")throw new Error(`bech32.encode words should be array of numbers, not ${typeof G}`);const we=I.length+7+G.length;if(Ee!==!1&&we>Ee)throw new TypeError(`Length ${we} exceeds limit ${Ee}`);return I=I.toLowerCase(),`${I}1${de.encode(G)}${z(I,G,K)}`}function V(I,G=90){if(typeof I!="string")throw new Error(`bech32.decode input should be string, not ${typeof I}`);if(I.length<8||G!==!1&&I.length>G)throw new TypeError(`Wrong string length: ${I.length} (${I}). Expected (8..${G})`);const Ee=I.toLowerCase();if(I!==Ee&&I!==I.toUpperCase())throw new Error("String must be lowercase or uppercase");I=Ee;const we=I.lastIndexOf("1");if(we===0||we===-1)throw new Error('Letter "1" must be present between prefix and data only');const pe=I.slice(0,we),_e=I.slice(we+1);if(_e.length<6)throw new Error("Data must be at least 6 characters long");const Re=de.decode(_e).slice(0,-6),Ie=z(pe,Re,K);if(!_e.endsWith(Ie))throw new Error(`Invalid checksum in ${I}: expected "${Ie}"`);return{prefix:pe,words:Re}}const ae=A(V);function q(I){const{prefix:G,words:Ee}=V(I,!1);return{prefix:G,words:Ee,bytes:Y(Ee)}}return{encode:ne,decode:V,decodeToBytes:q,decodeUnsafe:ae,fromWords:Y,fromWordsUnsafe:U,toWords:$}}t.bech32=W("bech32"),t.bech32m=W("bech32m"),t.utf8={encode:F=>new TextDecoder().decode(F),decode:F=>new TextEncoder().encode(F)},t.hex=r(T(4),l("0123456789abcdef"),c(""),y(F=>{if(typeof F!="string"||F.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof F} with length ${F.length}`);return F.toLowerCase()}));const Q={utf8:t.utf8,hex:t.hex,base16:t.base16,base32:t.base32,base64:t.base64,base64url:t.base64url,base58:t.base58,base58xmr:t.base58xmr},te=`Invalid encoding type. Available types: ${Object.keys(Q).join(", ")}`,le=(F,K)=>{if(typeof F!="string"||!Q.hasOwnProperty(F))throw new TypeError(te);if(!(K instanceof Uint8Array))throw new TypeError("bytesToString() expects Uint8Array");return Q[F].encode(K)};t.bytesToString=le,t.str=t.bytesToString;const me=(F,K)=>{if(!Q.hasOwnProperty(F))throw new TypeError(te);if(typeof K!="string")throw new TypeError("stringToBytes() expects string");return Q[F].decode(K)};t.stringToBytes=me,t.bytes=t.stringToBytes})(lib)),lib}var bolt11,hasRequiredBolt11;function requireBolt11(){if(hasRequiredBolt11)return bolt11;hasRequiredBolt11=1;const{bech32:t,hex:e,utf8:r}=requireLib(),l={bech32:"bc",pubKeyHash:0,scriptHash:5,validWitnessVersions:[0]},c={bech32:"tb",pubKeyHash:111,scriptHash:196,validWitnessVersions:[0]},m={bech32:"tbs",pubKeyHash:111,scriptHash:196,validWitnessVersions:[0]},y={bech32:"bcrt",pubKeyHash:111,scriptHash:196,validWitnessVersions:[0]},_={bech32:"sb",pubKeyHash:63,scriptHash:123,validWitnessVersions:[0]},w=["option_data_loss_protect","initial_routing_sync","option_upfront_shutdown_script","gossip_queries","var_onion_optin","gossip_queries_ex","option_static_remotekey","payment_secret","basic_mpp","option_support_large_channel"],k={m:BigInt(1e3),u:BigInt(1e6),n:BigInt(1e9),p:BigInt(1e12)},C=BigInt("2100000000000000000"),R=BigInt(1e11),T={payment_hash:1,payment_secret:16,description:13,payee:19,description_hash:23,expiry:6,min_final_cltv_expiry:24,fallback_address:9,route_hint:3,feature_bits:5,metadata:27},A={};for(let z=0,W=Object.keys(T);z<W.length;z++){const Q=W[z],te=T[W[z]].toString();A[te]=Q}const M={1:z=>e.encode(t.fromWordsUnsafe(z)),16:z=>e.encode(t.fromWordsUnsafe(z)),13:z=>r.encode(t.fromWordsUnsafe(z)),19:z=>e.encode(t.fromWordsUnsafe(z)),23:z=>e.encode(t.fromWordsUnsafe(z)),27:z=>e.encode(t.fromWordsUnsafe(z)),6:j,24:j,3:re,5:de};function B(z){return W=>({tagCode:parseInt(z),words:t.encode("unknown",W,Number.MAX_SAFE_INTEGER)})}function j(z){return z.reverse().reduce((W,Q,te)=>W+Q*Math.pow(32,te),0)}function re(z){const W=[];let Q,te,le,me,F,K=t.fromWordsUnsafe(z);for(;K.length>0;)Q=e.encode(K.slice(0,33)),te=e.encode(K.slice(33,41)),le=parseInt(e.encode(K.slice(41,45)),16),me=parseInt(e.encode(K.slice(45,49)),16),F=parseInt(e.encode(K.slice(49,51)),16),K=K.slice(51),W.push({pubkey:Q,short_channel_id:te,fee_base_msat:le,fee_proportional_millionths:me,cltv_expiry_delta:F});return W}function de(z){const W=z.slice().reverse().map(le=>[!!(le&1),!!(le&2),!!(le&4),!!(le&8),!!(le&16)]).reduce((le,me)=>le.concat(me),[]);for(;W.length<w.length*2;)W.push(!1);const Q={};w.forEach((le,me)=>{let F;W[me*2]?F="required":W[me*2+1]?F="supported":F="unsupported",Q[le]=F});const te=W.slice(w.length*2);return Q.extra_bits={start_bit:w.length*2,bits:te,has_required:te.reduce((le,me,F)=>F%2!==0?le||!1:le||me,!1)},Q}function se(z,W){let Q,te;if(z.slice(-1).match(/^[munp]$/))Q=z.slice(-1),te=z.slice(0,-1);else{if(z.slice(-1).match(/^[^munp0-9]$/))throw new Error("Not a valid multiplier for the amount");te=z}if(!te.match(/^\d+$/))throw new Error("Not a valid human readable amount");const le=BigInt(te),me=Q?le*R/k[Q]:le*R;if(Q==="p"&&le%BigInt(10)!==BigInt(0)||me>C)throw new Error("Amount is outside of valid range");return W?me.toString():me}function ye(z,W){if(typeof z!="string")throw new Error("Lightning Payment Request must be string");if(z.slice(0,2).toLowerCase()!=="ln")throw new Error("Not a proper lightning payment request");const Q=[],te=t.decode(z,Number.MAX_SAFE_INTEGER);z=z.toLowerCase();const le=te.prefix;let me=te.words,F=z.slice(le.length+1),K=me.slice(-104);me=me.slice(0,-104);let D=le.match(/^ln(\S+?)(\d*)([a-zA-Z]?)$/);if(D&&!D[2]&&(D=le.match(/^ln(\S+)$/)),!D)throw new Error("Not a proper lightning payment request");Q.push({name:"lightning_network",letters:"ln"});const Y=D[1];let $;if(W){if(W.bech32===void 0||W.pubKeyHash===void 0||W.scriptHash===void 0||!Array.isArray(W.validWitnessVersions))throw new Error("Invalid network");$=W}else switch(Y){case l.bech32:$=l;break;case c.bech32:$=c;break;case m.bech32:$=m;break;case y.bech32:$=y;break;case _.bech32:$=_;break}if(!$||$.bech32!==Y)throw new Error("Unknown coin bech32 prefix");Q.push({name:"coin_network",letters:Y,value:$});const U=D[2];let ne;if(U){const pe=D[3];ne=se(U+pe,!0),Q.push({name:"amount",letters:D[2]+D[3],value:ne})}else ne=null;Q.push({name:"separator",letters:"1"});const V=j(me.slice(0,7));me=me.slice(7),Q.push({name:"timestamp",letters:F.slice(0,7),value:V}),F=F.slice(7);let ae,q,I,G;for(;me.length>0;){const pe=me[0].toString();ae=A[pe]||"unknown_tag",q=M[pe]||B(pe),me=me.slice(1),I=j(me.slice(0,2)),me=me.slice(2),G=me.slice(0,I),me=me.slice(I),Q.push({name:ae,tag:F[0],letters:F.slice(0,3+I),value:q(G)}),F=F.slice(3+I)}Q.push({name:"signature",letters:F.slice(0,104),value:e.encode(t.fromWordsUnsafe(K))}),F=F.slice(104),Q.push({name:"checksum",letters:F});let Ee={paymentRequest:z,sections:Q,get expiry(){let pe=Q.find(_e=>_e.name==="expiry");if(pe)return we("timestamp")+pe.value},get route_hints(){return Q.filter(pe=>pe.name==="route_hint").map(pe=>pe.value)}};for(let pe in T)pe!=="route_hint"&&Object.defineProperty(Ee,pe,{get(){return we(pe)}});return Ee;function we(pe){let _e=Q.find(Re=>Re.name===pe);return _e?_e.value:void 0}}return bolt11={decode:ye,hrpToMillisat:se},bolt11}requireBolt11();function getRelaysForSync(t,e,r="write"){if(!t.outboxTracker)return;const l=t.outboxTracker.data.get(e);if(l)return r==="write"?l.writeRelays:l.readRelays}async function getWriteRelaysFor(t,e,r="write"){if(t.outboxTracker)return t.outboxTracker.data.has(e)||await t.outboxTracker.trackUsers([e]),getRelaysForSync(t,e,r)}function getTopRelaysForAuthors(t,e){const r=new Map;return e.forEach(c=>{const m=getRelaysForSync(t,c);m&&m.forEach(y=>{const _=r.get(y)||0;r.set(y,_+1)})}),Array.from(r.entries()).sort((c,m)=>m[1]-c[1]).map(c=>c[0])}function getAllRelaysForAllPubkeys(t,e,r="read"){const l=new Map,c=new Set;return e.forEach(m=>{const y=getRelaysForSync(t,m,r);y&&y.size>0?(y.forEach(_=>{(l.get(_)||new Set).add(m)}),l.set(m,y)):c.add(m)}),{pubkeysToRelays:l,authorsMissingRelays:c}}function chooseRelayCombinationForPubkeys(t,e,r,{count:l,preferredRelays:c}={}){l??=2,c??=new Set;const m=t.pool,y=m.connectedRelays();y.forEach(T=>{c?.add(T.url)});const _=new Map,{pubkeysToRelays:w,authorsMissingRelays:k}=getAllRelaysForAllPubkeys(t,e,r),C=getTopRelaysForAuthors(t,e),R=(T,A)=>{const M=_.get(A)||[];M.push(T),_.set(A,M)};for(const[T,A]of w.entries()){let M=l;for(const B of y)A.has(B.url)&&(R(T,B.url),M--);for(const B of A)_.has(B)&&(R(T,B),M--);if(!(M<=0))for(const B of C){if(M<=0)break;A.has(B)&&(R(T,B),M--)}}for(const T of k)m.permanentAndConnectedRelays().forEach(A=>{const M=_.get(A.url)||[];M.push(T),_.set(A.url,M)});return _}function getRelaysForFilterWithAuthors(t,e,r=2){return chooseRelayCombinationForPubkeys(t,e,"write",{count:r})}function tryNormalizeRelayUrl(t){try{return normalizeRelayUrl(t)}catch{return}}function normalizeRelayUrl(t){let e=normalizeUrl(t,{stripAuthentication:!1,stripWWW:!1,stripHash:!0});return e.endsWith("/")||(e+="/"),e}function normalize(t){const e=new Set;for(const r of t)try{e.add(normalizeRelayUrl(r))}catch{}return Array.from(e)}var DATA_URL_DEFAULT_MIME_TYPE="text/plain",DATA_URL_DEFAULT_CHARSET="us-ascii",testParameter=(t,e)=>e.some(r=>r instanceof RegExp?r.test(t):r===t),supportedProtocols=new Set(["https:","http:","file:"]),hasCustomProtocol=t=>{try{const{protocol:e}=new URL(t);return e.endsWith(":")&&!e.includes(".")&&!supportedProtocols.has(e)}catch{return!1}},normalizeDataURL=(t,{stripHash:e})=>{const r=/^data:(?<type>[^,]*?),(?<data>[^#]*?)(?:#(?<hash>.*))?$/.exec(t);if(!r)throw new Error(`Invalid URL: ${t}`);const l=r.groups?.type??"",c=r.groups?.data??"";let m=r.groups?.hash??"";const y=l.split(";");m=e?"":m;let _=!1;y[y.length-1]==="base64"&&(y.pop(),_=!0);const w=y.shift()?.toLowerCase()??"",C=[...y.map(R=>{let[T,A=""]=R.split("=").map(M=>M.trim());return T==="charset"&&(A=A.toLowerCase(),A===DATA_URL_DEFAULT_CHARSET)?"":`${T}${A?`=${A}`:""}`}).filter(Boolean)];return _&&C.push("base64"),(C.length>0||w&&w!==DATA_URL_DEFAULT_MIME_TYPE)&&C.unshift(w),`data:${C.join(";")},${_?c.trim():c}${m?`#${m}`:""}`};function normalizeUrl(t,e={}){if(e={defaultProtocol:"http",normalizeProtocol:!0,forceHttp:!1,forceHttps:!1,stripAuthentication:!0,stripHash:!1,stripTextFragment:!0,stripWWW:!0,removeQueryParameters:[/^utm_\w+/i],removeTrailingSlash:!0,removeSingleSlash:!0,removeDirectoryIndex:!1,removeExplicitPort:!1,sortQueryParameters:!0,...e},typeof e.defaultProtocol=="string"&&!e.defaultProtocol.endsWith(":")&&(e.defaultProtocol=`${e.defaultProtocol}:`),t=t.trim(),/^data:/i.test(t))return normalizeDataURL(t,e);if(hasCustomProtocol(t))return t;const r=t.startsWith("//");!r&&/^\.*\//.test(t)||(t=t.replace(/^(?!(?:\w+:)?\/\/)|^\/\//,e.defaultProtocol));const c=new URL(t);if(c.hostname=c.hostname.toLowerCase(),e.forceHttp&&e.forceHttps)throw new Error("The `forceHttp` and `forceHttps` options cannot be used together");if(e.forceHttp&&c.protocol==="https:"&&(c.protocol="http:"),e.forceHttps&&c.protocol==="http:"&&(c.protocol="https:"),e.stripAuthentication&&(c.username="",c.password=""),e.stripHash?c.hash="":e.stripTextFragment&&(c.hash=c.hash.replace(/#?:~:text.*?$/i,"")),c.pathname){const y=/\b[a-z][a-z\d+\-.]{1,50}:\/\//g;let _=0,w="";for(;;){const C=y.exec(c.pathname);if(!C)break;const R=C[0],T=C.index,A=c.pathname.slice(_,T);w+=A.replace(/\/{2,}/g,"/"),w+=R,_=T+R.length}const k=c.pathname.slice(_,c.pathname.length);w+=k.replace(/\/{2,}/g,"/"),c.pathname=w}if(c.pathname)try{c.pathname=decodeURI(c.pathname)}catch{}if(e.removeDirectoryIndex===!0&&(e.removeDirectoryIndex=[/^index\.[a-z]+$/]),Array.isArray(e.removeDirectoryIndex)&&e.removeDirectoryIndex.length>0){let y=c.pathname.split("/");const _=y[y.length-1];testParameter(_,e.removeDirectoryIndex)&&(y=y.slice(0,-1),c.pathname=`${y.slice(1).join("/")}/`)}if(c.hostname&&(c.hostname=c.hostname.replace(/\.$/,""),e.stripWWW&&/^www\.(?!www\.)[a-z\-\d]{1,63}\.[a-z.\-\d]{2,63}$/.test(c.hostname)&&(c.hostname=c.hostname.replace(/^www\./,""))),Array.isArray(e.removeQueryParameters))for(const y of[...c.searchParams.keys()])testParameter(y,e.removeQueryParameters)&&c.searchParams.delete(y);if(!Array.isArray(e.keepQueryParameters)&&e.removeQueryParameters===!0&&(c.search=""),Array.isArray(e.keepQueryParameters)&&e.keepQueryParameters.length>0)for(const y of[...c.searchParams.keys()])testParameter(y,e.keepQueryParameters)||c.searchParams.delete(y);if(e.sortQueryParameters){c.searchParams.sort();try{c.search=decodeURIComponent(c.search)}catch{}}e.removeTrailingSlash&&(c.pathname=c.pathname.replace(/\/$/,"")),e.removeExplicitPort&&c.port&&(c.port="");const m=t;return t=c.toString(),!e.removeSingleSlash&&c.pathname==="/"&&!m.endsWith("/")&&c.hash===""&&(t=t.replace(/\/$/,"")),(e.removeTrailingSlash||c.pathname==="/")&&c.hash===""&&e.removeSingleSlash&&(t=t.replace(/\/$/,"")),r&&!e.normalizeProtocol&&(t=t.replace(/^http:\/\//,"//")),e.stripProtocol&&(t=t.replace(/^(?:https?:)?\/\//,"")),t}var MAX_RECONNECT_ATTEMPTS=5,FLAPPING_THRESHOLD_MS=1e3,NDKRelayConnectivity=class{ndkRelay;ws;_status;timeoutMs;connectedAt;_connectionStats={attempts:0,success:0,durations:[]};debug;netDebug;connectTimeout;reconnectTimeout;ndk;openSubs=new Map;openCountRequests=new Map;openEventPublishes=new Map;serial=0;baseEoseTimeout=4400;constructor(t,e){this.ndkRelay=t,this._status=1;const r=Math.floor(Math.random()*1e3);this.debug=this.ndkRelay.debug.extend(`connectivity${r}`),this.ndk=e}async connect(t,e=!0){if(this.ws&&this.ws.readyState!==WebSocket.OPEN&&this.ws.readyState!==WebSocket.CONNECTING){this.debug("Cleaning up stale WebSocket connection");try{this.ws.close()}catch{}this.ws=void 0,this._status=1}if(this._status!==2&&this._status!==1||this.reconnectTimeout){this.debug("Relay requested to be connected but was in state %s or it had a reconnect timeout",this._status);return}this.reconnectTimeout&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=void 0),this.connectTimeout&&(clearTimeout(this.connectTimeout),this.connectTimeout=void 0),t??=this.timeoutMs,!this.timeoutMs&&t&&(this.timeoutMs=t),this.timeoutMs&&(this.connectTimeout=setTimeout(()=>this.onConnectionError(e),this.timeoutMs));try{this.updateConnectionStats.attempt(),this._status===1?this._status=4:this._status=2,this.ws=new WebSocket(this.ndkRelay.url),this.ws.onopen=this.onConnect.bind(this),this.ws.onclose=this.onDisconnect.bind(this),this.ws.onmessage=this.onMessage.bind(this),this.ws.onerror=this.onError.bind(this)}catch(r){throw this.debug(`Failed to connect to ${this.ndkRelay.url}`,r),this._status=1,e?this.handleReconnection():this.ndkRelay.emit("delayed-connect",2880*60*1e3),r}}disconnect(){this._status=0;try{this.ws?.close()}catch(t){this.debug("Failed to disconnect",t),this._status=1}}onConnectionError(t){this.debug(`Error connecting to ${this.ndkRelay.url}`,this.timeoutMs),t&&!this.reconnectTimeout&&this.handleReconnection()}onConnect(){this.netDebug?.("connected",this.ndkRelay),this.reconnectTimeout&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=void 0),this.connectTimeout&&(clearTimeout(this.connectTimeout),this.connectTimeout=void 0),this.updateConnectionStats.connected(),this._status=5,this.ndkRelay.emit("connect"),this.ndkRelay.emit("ready")}onDisconnect(){this.netDebug?.("disconnected",this.ndkRelay),this.updateConnectionStats.disconnected(),this._status===5&&this.handleReconnection(),this._status=1,this.ndkRelay.emit("disconnect")}onMessage(t){this.netDebug?.(t.data,this.ndkRelay,"recv");try{const e=JSON.parse(t.data),[r,l,...c]=e;switch(r){case"EVENT":{const m=this.openSubs.get(l),y=e[2];if(!m){this.debug(`Received event for unknown subscription ${l}`);return}m.onevent(y);return}case"COUNT":{const m=e[2],y=this.openCountRequests.get(l);y&&(y.resolve(m.count),this.openCountRequests.delete(l));return}case"EOSE":{const m=this.openSubs.get(l);if(!m)return;m.oneose(l);return}case"OK":{const m=e[2],y=e[3],_=this.openEventPublishes.get(l),w=_?.pop();if(!_||!w){this.debug("Received OK for unknown event publish",l);return}m?w.resolve(y):w.reject(new Error(y)),_.length===0?this.openEventPublishes.delete(l):this.openEventPublishes.set(l,_);return}case"CLOSED":{const m=this.openSubs.get(l);if(!m)return;m.onclosed(e[2]);return}case"NOTICE":this.onNotice(e[1]);return;case"AUTH":{this.onAuthRequested(e[1]);return}}}catch(e){this.debug(`Error parsing message from ${this.ndkRelay.url}: ${e.message}`,e?.stack);return}}async onAuthRequested(t){const e=this.ndkRelay.authPolicy??this.ndk?.relayAuthDefaultPolicy;if(this.debug("Relay requested authentication",{havePolicy:!!e}),this._status===7){this.debug("Already authenticating, ignoring");return}if(this._status=6,e){if(this._status>=5){this._status=7;let r;try{r=await e(this.ndkRelay,t)}catch(l){this.debug("Authentication policy threw an error",l),r=!1}if(this.debug("Authentication policy returned",!!r),r instanceof NDKEvent||r===!0){r instanceof NDKEvent&&await this.auth(r);const l=async()=>{if(this._status>=5&&this._status<8){const c=new NDKEvent(this.ndk);c.kind=22242,c.tags=[["relay",this.ndkRelay.url],["challenge",t]],await c.sign(),this.auth(c).then(()=>{this._status=8,this.ndkRelay.emit("authed"),this.debug("Authentication successful")}).catch(m=>{this._status=6,this.ndkRelay.emit("auth:failed",m),this.debug("Authentication failed",m)})}else this.debug("Authentication failed, it changed status, status is %d",this._status)};r===!0&&(this.ndk?.signer?l().catch(c=>{console.error("Error authenticating",c)}):(this.debug("No signer available for authentication localhost"),this.ndk?.once("signer:ready",l))),this._status=5,this.ndkRelay.emit("authed")}}}else this.ndkRelay.emit("auth",t)}onError(t){this.debug(`WebSocket error on ${this.ndkRelay.url}:`,t)}get status(){return this._status}isAvailable(){return this._status===5}isFlapping(){const t=this._connectionStats.durations;if(t.length%3!==0)return!1;const r=t.reduce((y,_)=>y+_,0)/t.length,l=t.map(y=>(y-r)**2).reduce((y,_)=>y+_,0)/t.length;return Math.sqrt(l)<FLAPPING_THRESHOLD_MS}async onNotice(t){this.ndkRelay.emit("notice",t)}handleReconnection(t=0){if(this.reconnectTimeout)return;if(this.isFlapping()){this.ndkRelay.emit("flapping",this._connectionStats),this._status=3;return}const e=this.connectedAt?Math.max(0,6e4-(Date.now()-this.connectedAt)):5e3*(this._connectionStats.attempts+1);this.reconnectTimeout=setTimeout(()=>{this.reconnectTimeout=void 0,this._status=2,this.connect().catch(r=>{t<MAX_RECONNECT_ATTEMPTS?setTimeout(()=>{this.handleReconnection(t+1)},Math.pow(1e3*(t+1),2)):this.debug("Reconnect failed")})},e),this.ndkRelay.emit("delayed-connect",e),this.debug("Reconnecting in",e),this._connectionStats.nextReconnectAt=Date.now()+e}async send(t){this._status>=5&&this.ws?.readyState===WebSocket.OPEN?(this.ws?.send(t),this.netDebug?.(t,this.ndkRelay,"send")):(this.debug(`Not connected to ${this.ndkRelay.url} (%d), not sending message ${t}`,this._status),this._status>=5&&this.ws?.readyState!==WebSocket.OPEN&&(this.debug(`Stale connection detected, WebSocket state: ${this.ws?.readyState}`),this.onDisconnect()))}async auth(t){const e=new Promise((r,l)=>{const c=this.openEventPublishes.get(t.id)??[];c.push({resolve:r,reject:l}),this.openEventPublishes.set(t.id,c)});return this.send(`["AUTH",${JSON.stringify(t.rawEvent())}]`),e}async publish(t){const e=new Promise((r,l)=>{const c=this.openEventPublishes.get(t.id)??[];c.length>0&&console.warn(`Duplicate event publishing detected, you are publishing event ${t.id} twice`),c.push({resolve:r,reject:l}),this.openEventPublishes.set(t.id,c)});return this.send(`["EVENT",${JSON.stringify(t)}]`),e}async count(t,e){this.serial++;const r=e?.id||`count:${this.serial}`,l=new Promise((c,m)=>{this.openCountRequests.set(r,{resolve:c,reject:m})});return this.send(`["COUNT","${r}",${JSON.stringify(t).substring(1)}`),l}close(t,e){this.send(`["CLOSE","${t}"]`);const r=this.openSubs.get(t);this.openSubs.delete(t),r&&r.onclose(e)}req(t){`${this.send(`["REQ","${t.subId}",${JSON.stringify(t.executeFilters).substring(1)}`)}`,this.openSubs.set(t.subId,t)}updateConnectionStats={connected:()=>{this._connectionStats.success++,this._connectionStats.connectedAt=Date.now()},disconnected:()=>{this._connectionStats.connectedAt&&(this._connectionStats.durations.push(Date.now()-this._connectionStats.connectedAt),this._connectionStats.durations.length>100&&this._connectionStats.durations.shift()),this._connectionStats.connectedAt=void 0},attempt:()=>{this._connectionStats.attempts++,this._connectionStats.connectedAt=Date.now()}};get connectionStats(){return this._connectionStats}get url(){return this.ndkRelay.url}get connected(){return this._status>=5&&this.ws?.readyState===WebSocket.OPEN}},NDKRelayPublisher=class{ndkRelay;debug;constructor(t){this.ndkRelay=t,this.debug=t.debug.extend("publisher")}async publish(t,e=2500){let r;const l=()=>new Promise((C,R)=>{try{this.publishEvent(t).then(T=>{this.ndkRelay.emit("published",t),t.emit("relay:published",this.ndkRelay),C(!0)}).catch(R)}catch(T){R(T)}}),c=new Promise((C,R)=>{r=setTimeout(()=>{r=void 0,R(new Error(`Timeout: ${e}ms`))},e)}),m=()=>{l().then(C=>y(C)).catch(C=>_(C))};let y,_;const w=C=>{throw this.ndkRelay.debug("Publish failed",C,t.id),this.ndkRelay.emit("publish:failed",t,C),t.emit("relay:publish:failed",this.ndkRelay,C),C},k=()=>{r&&clearTimeout(r),this.ndkRelay.removeListener("connect",m)};return this.ndkRelay.status>=5?Promise.race([l(),c]).catch(w).finally(k):(this.ndkRelay.status<=1?(console.warn("Relay is disconnected, trying to connect to publish an event",this.ndkRelay.url),this.ndkRelay.connect()):console.warn("Relay not connected, waiting for connection to publish an event",this.ndkRelay.url),Promise.race([new Promise((C,R)=>{y=C,_=R,this.ndkRelay.on("connect",m)}),c]).catch(w).finally(k))}async publishEvent(t){return this.ndkRelay.connectivity.publish(t.rawEvent())}};function filterFingerprint(t,e){const r=[];for(const c of t){const m=Object.entries(c||{}).map(([y,_])=>["since","until"].includes(y)?`${y}:${_}`:y).sort().join("-");r.push(m)}let l=e?"+":"";return l+=r.join("|"),l}function mergeFilters(t){const e=[],r={};return t.filter(l=>!!l.limit).forEach(l=>e.push(l)),t=t.filter(l=>!l.limit),t.length===0?e:(t.forEach(l=>{Object.entries(l).forEach(([c,m])=>{Array.isArray(m)?r[c]===void 0?r[c]=[...m]:r[c]=Array.from(new Set([...r[c],...m])):r[c]=m})}),[...e,r])}var NDKRelaySubscription=class{fingerprint;items=new Map;topSubManager;debug;status=0;onClose;relay;eosed=!1;executionTimer;fireTime;delayType;executeFilters;id=Math.random().toString(36).substring(7);constructor(t,e,r){this.relay=t,this.topSubManager=r,this.debug=t.debug.extend(`sub[${this.id}]`),this.fingerprint=e||Math.random().toString(36).substring(7)}_subId;get subId(){return this._subId?this._subId:(this._subId=this.fingerprint.slice(0,15),this._subId)}subIdParts=new Set;addSubIdPart(t){this.subIdParts.add(t)}addItem(t,e){if(this.debug("Adding item",{filters:e,internalId:t.internalId,status:this.status,fingerprint:this.fingerprint,id:this.subId,items:this.items,itemsSize:this.items.size}),!this.items.has(t.internalId))switch(t.on("close",this.removeItem.bind(this,t)),this.items.set(t.internalId,{subscription:t,filters:e}),this.status!==3&&t.subId&&(!this._subId||this._subId.length<48)&&(this.status===0||this.status===1)&&this.addSubIdPart(t.subId),this.status){case 0:this.evaluateExecutionPlan(t);break;case 3:break;case 1:this.evaluateExecutionPlan(t);break;case 4:throw this.debug("Subscription is closed, cannot add new items %o (%o)",t,e),new Error("Cannot add new items to a closed subscription")}}removeItem(t){if(this.items.delete(t.internalId),this.items.size===0){if(!this.eosed)return;this.close(),this.cleanup()}}close(){if(this.status===4)return;const t=this.status;if(this.status=4,t===3)try{this.relay.close(this.subId)}catch(e){this.debug("Error closing subscription",e,this)}else this.debug("Subscription wanted to close but it wasn't running, this is probably ok",{subId:this.subId,prevStatus:t,sub:this});this.cleanup()}cleanup(){this.executionTimer&&clearTimeout(this.executionTimer),this.relay.off("ready",this.executeOnRelayReady),this.relay.off("authed",this.reExecuteAfterAuth),this.onClose&&this.onClose(this)}evaluateExecutionPlan(t){if(!t.isGroupable()){this.status=1,this.execute();return}if(t.filters.find(l=>!!l.limit)&&(this.executeFilters=this.compileFilters(),this.executeFilters.length>=10)){this.status=1,this.execute();return}const e=t.groupableDelay,r=t.groupableDelayType;if(!e)throw new Error("Cannot group a subscription without a delay");if(this.status===0)this.schedule(e,r);else{const l=this.delayType,c=this.fireTime-Date.now();if(l==="at-least"&&r==="at-least")c<e&&(this.executionTimer&&clearTimeout(this.executionTimer),this.schedule(e,r));else if(l==="at-least"&&r==="at-most")c>e&&(this.executionTimer&&clearTimeout(this.executionTimer),this.schedule(e,r));else if(l==="at-most"&&r==="at-most")c>e&&(this.executionTimer&&clearTimeout(this.executionTimer),this.schedule(e,r));else if(l==="at-most"&&r==="at-least")c>e&&(this.executionTimer&&clearTimeout(this.executionTimer),this.schedule(e,r));else throw new Error(`Unknown delay type combination ${l} ${r}`)}}schedule(t,e){this.status=1;const r=Date.now();this.fireTime=r+t,this.delayType=e;const l=setTimeout(this.execute.bind(this),t);e==="at-least"&&(this.executionTimer=l)}executeOnRelayReady=()=>{if(this.status===2){if(this.items.size===0){this.debug("No items to execute; this relay was probably too slow to respond and the caller gave up",{status:this.status,fingerprint:this.fingerprint,items:this.items,itemsSize:this.items.size,id:this.id,subId:this.subId}),this.cleanup();return}this.debug("Executing on relay ready",{status:this.status,fingerprint:this.fingerprint,items:this.items,itemsSize:this.items.size}),this.status=1,this.execute()}};finalizeSubId(){this.subIdParts.size>0?this._subId=Array.from(this.subIdParts).join("-"):this._subId=this.fingerprint.slice(0,15),this._subId+=`-${Math.random().toString(36).substring(2,7)}`}reExecuteAfterAuth=(()=>{const t=this.subId;this.debug("Re-executing after auth",this.items.size),this.eosed?this.relay.close(this.subId):this.debug("We are abandoning an opened subscription, once it EOSE's, the handler will close it",{oldSubId:t}),this._subId=void 0,this.status=1,this.execute(),this.debug("Re-executed after auth %s  %s",t,this.subId)}).bind(this);execute(){if(this.status===1){if(!this.relay.connected){this.status=2,this.debug("Waiting for relay to be ready",{status:this.status,id:this.subId,fingerprint:this.fingerprint,items:this.items,itemsSize:this.items.size}),this.relay.once("ready",this.executeOnRelayReady);return}this.relay.status<8&&this.relay.once("authed",this.reExecuteAfterAuth),this.status=3,this.finalizeSubId(),this.executeFilters=this.compileFilters(),this.relay.req(this)}}onstart(){}onevent(t){this.topSubManager.dispatchEvent(t,this.relay)}oneose(t){if(this.eosed=!0,t!==this.subId){this.debug("Received EOSE for an abandoned subscription",t,this.subId),this.relay.close(t);return}this.items.size===0&&this.close();for(const{subscription:e}of this.items.values())e.eoseReceived(this.relay),e.closeOnEose&&(this.debug("Removing item because of EOSE",{filters:e.filters,internalId:e.internalId,status:this.status,fingerprint:this.fingerprint,items:this.items,itemsSize:this.items.size}),this.removeItem(e))}onclose(t){this.status=4}onclosed(t){if(t)for(const{subscription:e}of this.items.values())e.closedReceived(this.relay,t)}compileFilters(){const t=[],e=Array.from(this.items.values()).map(l=>l.filters);if(!e[0])return this.debug(" No filters to merge",this.items),console.error("BUG: No filters to merge!",this.items),[];const r=e[0].length;for(let l=0;l<r;l++){const c=e.map(m=>m[l]);t.push(...mergeFilters(c))}return t}},NDKRelaySubscriptionManager=class{relay;subscriptions;generalSubManager;constructor(t,e){this.relay=t,this.subscriptions=new Map,this.generalSubManager=e}addSubscription(t,e){let r;if(!t.isGroupable())r=this.createSubscription(t,e);else{const l=filterFingerprint(e,t.closeOnEose);l&&(r=(this.subscriptions.get(l)||[]).find(m=>m.status<3)),r??=this.createSubscription(t,e,l)}r.addItem(t,e)}createSubscription(t,e,r){const l=new NDKRelaySubscription(this.relay,r||null,this.generalSubManager);l.onClose=this.onRelaySubscriptionClose.bind(this);const c=this.subscriptions.get(l.fingerprint)??[];return this.subscriptions.set(l.fingerprint,[...c,l]),l}onRelaySubscriptionClose(t){let e=this.subscriptions.get(t.fingerprint)??[];e?e.length===1?this.subscriptions.delete(t.fingerprint):(e=e.filter(r=>r.id!==t.id),this.subscriptions.set(t.fingerprint,e)):console.warn("Unexpectedly did not find a subscription with fingerprint",t.fingerprint)}},NDKRelay=class Vc extends libExports.EventEmitter{url;scores;connectivity;subs;publisher;authPolicy;lowestValidationRatio;targetValidationRatio;validationRatioFn;validatedEventCount=0;nonValidatedEventCount=0;trusted=!1;complaining=!1;debug;static defaultValidationRatioUpdateFn=(e,r,l)=>{if(e.lowestValidationRatio===void 0||e.targetValidationRatio===void 0)return 1;let c=e.validationRatio;if(e.validationRatio>e.targetValidationRatio){const m=r/100;c=Math.max(e.lowestValidationRatio,e.validationRatio-m)}return c<e.validationRatio?c:e.validationRatio};constructor(e,r,l){super(),this.url=normalizeRelayUrl(e),this.scores=new Map,this.debug=createDebug5(`ndk:relay:${e}`),this.connectivity=new NDKRelayConnectivity(this,l),this.connectivity.netDebug=l?.netDebug,this.req=this.connectivity.req.bind(this.connectivity),this.close=this.connectivity.close.bind(this.connectivity),this.subs=new NDKRelaySubscriptionManager(this,l.subManager),this.publisher=new NDKRelayPublisher(this),this.authPolicy=r,this.targetValidationRatio=l?.initialValidationRatio,this.lowestValidationRatio=l?.lowestValidationRatio,this.validationRatioFn=(l?.validationRatioFn??Vc.defaultValidationRatioUpdateFn).bind(this),this.updateValidationRatio(),l||console.trace("relay created without ndk")}updateValidationRatio(){if(this.validationRatioFn&&this.validatedEventCount>0){const e=this.validationRatioFn(this,this.validatedEventCount,this.nonValidatedEventCount);this.targetValidationRatio=e}setTimeout(()=>{this.updateValidationRatio()},3e4)}get status(){return this.connectivity.status}get connectionStats(){return this.connectivity.connectionStats}async connect(e,r=!0){return this.connectivity.connect(e,r)}disconnect(){this.status!==1&&this.connectivity.disconnect()}subscribe(e,r){this.subs.addSubscription(e,r)}async publish(e,r=2500){return this.publisher.publish(e,r)}referenceTags(){return[["r",this.url]]}addValidatedEvent(){this.validatedEventCount++}addNonValidatedEvent(){this.nonValidatedEventCount++}get validationRatio(){return this.nonValidatedEventCount===0?1:this.validatedEventCount/(this.validatedEventCount+this.nonValidatedEventCount)}shouldValidateEvent(){return this.trusted?!1:this.targetValidationRatio===void 0||this.targetValidationRatio>=1?!0:Math.random()<this.targetValidationRatio}get connected(){return this.connectivity.connected}req;close},NDKPublishError=class extends Error{errors;publishedToRelays;intendedRelaySet;constructor(t,e,r,l){super(t),this.errors=e,this.publishedToRelays=r,this.intendedRelaySet=l}get relayErrors(){const t=[];for(const[e,r]of this.errors)t.push(`${e.url}: ${r}`);return t.join(`
`)}},NDKRelaySet=class Zc{relays;debug;ndk;pool;constructor(e,r,l){this.relays=e,this.ndk=r,this.pool=l??r.pool,this.debug=r.debug.extend("relayset")}addRelay(e){this.relays.add(e)}get relayUrls(){return Array.from(this.relays).map(e=>e.url)}static fromRelayUrls(e,r,l=!0,c){if(c=c??r.pool,!c)throw new Error("No pool provided");const m=new Set;for(const y of e){const _=c.relays.get(normalizeRelayUrl(y));if(_)_.status<5&&l&&_.connect(),m.add(_);else{const w=new NDKRelay(normalizeRelayUrl(y),r?.relayAuthDefaultPolicy,r);c.useTemporaryRelay(w,void 0,`requested from fromRelayUrls ${e}`),m.add(w)}}return new Zc(new Set(m),r,c)}async publish(e,r,l=1){const c=new Set,m=new Map,y=e.isEphemeral();e.publishStatus="pending";const _=w=>{c.add(w)};e.on("relay:published",_);try{const w=Array.from(this.relays).map(k=>new Promise(C=>{const R=r?setTimeout(()=>{c.has(k)||(m.set(k,new Error(`Publish timeout after ${r}ms`)),C(!1))},r):null;k.publish(e,r).then(T=>{R&&clearTimeout(R),T?(c.add(k),C(!0)):C(!1)}).catch(T=>{R&&clearTimeout(R),y||m.set(k,T),C(!1)})}));if(await Promise.all(w),c.size<l){if(!y){const k=new NDKPublishError("Not enough relays received the event ("+c.size+" published, "+l+" required)",m,c,this);throw e.publishStatus="error",e.publishError=k,this.ndk?.emit("event:publish-failed",e,k,this.relayUrls),k}}else e.publishStatus="success",e.emit("published",{relaySet:this,publishedToRelays:c});return c}finally{e.off("relay:published",_)}}get size(){return this.relays.size}},d=createDebug5("ndk:outbox:calculate");async function calculateRelaySetFromEvent(t,e,r){const l=new Set,c=await getWriteRelaysFor(t,e.pubkey);c&&c.forEach(_=>{const w=t.pool?.getRelay(_);w&&l.add(w)});let m=e.tags.filter(_=>["a","e"].includes(_[0])).map(_=>_[2]).filter(_=>_?.startsWith("wss://")).filter(_=>{try{return new URL(_),!0}catch{return!1}}).map(_=>normalizeRelayUrl(_));m=Array.from(new Set(m)).slice(0,5),m.forEach(_=>{const w=t.pool?.getRelay(_,!0,!0);w&&(d("Adding relay hint %s",_),l.add(w))});const y=e.getMatchingTags("p").map(_=>_[1]);return y.length<5?Array.from(chooseRelayCombinationForPubkeys(t,y,"read",{preferredRelays:new Set(c)}).keys()).forEach(w=>{const k=t.pool?.getRelay(w,!1,!0);k&&(d("Adding p-tagged relay %s",w),l.add(k))}):d("Too many p-tags to consider %d",y.length),t.pool?.permanentAndConnectedRelays().forEach(_=>l.add(_)),r&&l.size<r&&t.explicitRelayUrls?.filter(w=>!Array.from(l).some(k=>k.url===w)).slice(0,r-l.size)?.forEach(w=>{const k=t.pool?.getRelay(w,!1,!0);k&&(d("Adding explicit relay %s",w),l.add(k))}),new NDKRelaySet(l,t)}function calculateRelaySetsFromFilter(t,e,r){const l=new Map,c=new Set;if(e.forEach(m=>{m.authors&&m.authors.forEach(y=>c.add(y))}),c.size>0){const m=getRelaysForFilterWithAuthors(t,Array.from(c));for(const y of m.keys())l.set(y,[]);for(const y of e)if(y.authors)for(const[_,w]of m.entries()){const k=y.authors.filter(C=>w.includes(C));l.set(_,[...l.get(_),{...y,authors:k}])}else for(const _ of m.keys())l.set(_,[...l.get(_),y])}else t.explicitRelayUrls&&t.explicitRelayUrls.forEach(m=>{l.set(m,e)});return l.size===0&&r.permanentAndConnectedRelays().slice(0,5).forEach(m=>{l.set(m.url,e)}),l}function calculateRelaySetsFromFilters(t,e,r){return calculateRelaySetsFromFilter(t,e,r)}function mergeTags(t,e){const r=new Map,l=y=>y.join(","),c=(y,_)=>y.every((w,k)=>w===_[k]),m=y=>{for(const[_,w]of r)if(c(w,y)||c(y,w)){y.length>=w.length&&r.set(_,y);return}r.set(l(y),y)};return t.concat(e).forEach(m),Array.from(r.values())}var hashtagRegex=new RegExp(`(?<=\\s|^)(#[^\\s!@#$%^&*()=+./,[{\\]};:'"?><]+)`,"g");function generateHashtags(t){const e=t.match(hashtagRegex),r=new Set,l=new Set;if(e)for(const c of e)r.has(c.slice(1))||(l.add(c.slice(1)),r.add(c.slice(1)));return Array.from(l)}async function generateContentTags(t,e=[]){const r=/(@|nostr:)(npub|nprofile|note|nevent|naddr)[a-zA-Z0-9]+/g,l=[],c=y=>{e.find(_=>["q",y[0]].includes(_[0])&&_[1]===y[1])||e.push(y)};t=t.replace(r,y=>{try{const _=y.split(/(@|nostr:)/)[2],{type:w,data:k}=nip19_exports.decode(_);let C;switch(w){case"npub":C=["p",k];break;case"nprofile":C=["p",k.pubkey];break;case"note":l.push(new Promise(async R=>{c(["q",k,await maybeGetEventRelayUrl(_)]),R()}));break;case"nevent":l.push(new Promise(async R=>{const{id:T,author:A}=k;let{relays:M}=k;(!M||M.length===0)&&(M=[await maybeGetEventRelayUrl(_)]),c(["q",T,M[0]]),A&&c(["p",A]),R()}));break;case"naddr":l.push(new Promise(async R=>{const T=[k.kind,k.pubkey,k.identifier].join(":");let A=k.relays??[];A.length===0&&(A=[await maybeGetEventRelayUrl(_)]),c(["q",T,A[0]]),c(["p",k.pubkey]),R()}));break;default:return y}return C&&c(C),`nostr:${_}`}catch{return y}}),await Promise.all(l);const m=generateHashtags(t).map(y=>["t",y]);return e=mergeTags(e,m),{content:t,tags:e}}async function maybeGetEventRelayUrl(t){return""}async function encrypt(t,e,r="nip44"){let l;if(!this.ndk)throw new Error("No NDK instance found!");let c=e;if(c||(this.ndk.assertSigner(),c=this.ndk.signer),!c)throw new Error("no NDK signer");const m=t||(()=>{const y=this.getMatchingTags("p");if(y.length!==1)throw new Error("No recipient could be determined and no explicit recipient was provided");return this.ndk.getUser({pubkey:y[0][1]})})();if(r==="nip44"&&await isEncryptionEnabled(c,"nip44")&&(l=await c.encrypt(m,this.content,"nip44")),(!l||r==="nip04")&&await isEncryptionEnabled(c,"nip04")&&(l=await c.encrypt(m,this.content,"nip04")),!l)throw new Error("Failed to encrypt event.");this.content=l}async function decrypt(t,e,r){if(this.ndk?.cacheAdapter?.getDecryptedEvent){let _=null;if(typeof this.ndk.cacheAdapter.getDecryptedEvent=="function"&&(_=this.ndk.cacheAdapter.getDecryptedEvent(this.id)),_){this.content=_.content;return}}let l;if(!this.ndk)throw new Error("No NDK instance found!");let c=e;if(c||(this.ndk.assertSigner(),c=this.ndk.signer),!c)throw new Error("no NDK signer");const m=t||this.author;if(!m)throw new Error("No sender provided and no author available");const y=r||(this.content.match(/\\?iv=/)?"nip04":"nip44");if((y==="nip04"||this.kind===4)&&await isEncryptionEnabled(c,"nip04")&&this.content.search("\\?iv=")&&(l=await c.decrypt(m,this.content,"nip04")),!l&&y==="nip44"&&await isEncryptionEnabled(c,"nip44")&&(l=await c.decrypt(m,this.content,"nip44")),!l)throw new Error("Failed to decrypt event.");this.content=l,this.ndk?.cacheAdapter?.addDecryptedEvent&&this.ndk.cacheAdapter.addDecryptedEvent(this)}async function isEncryptionEnabled(t,e){return t.encryptionEnabled?e?!!await t.encryptionEnabled(e):!0:!1}function eventHasETagMarkers(t){for(const e of t.tags)if(e[0]==="e"&&(e[3]??"").length>0)return!0;return!1}function getRootTag(t,e){e??=t.tagType();const r=t.tags.find(isTagRootTag);if(!r){if(eventHasETagMarkers(t))return;const l=t.getMatchingTags(e);if(l.length<3)return l[0]}return r}var nip22RootTags=new Set(["A","E","I"]),nip22ReplyTags=new Set(["a","e","i"]);function getReplyTag(t,e){if(t.kind===1111){let c;for(const m of t.tags)if(nip22RootTags.has(m[0]))c=m;else if(nip22ReplyTags.has(m[0])){c=m;break}return c}e??=t.tagType();let r=!1,l;for(const c of t.tags)if(c[0]===e){if((c[3]??"").length>0&&(r=!0),r&&c[3]==="reply")return c;r&&c[3]==="root"&&(l=c),r||(l=c)}return l}function isTagRootTag(t){return t[0]==="E"||t[3]==="root"}async function fetchTaggedEvent(t,e){if(!this.ndk)throw new Error("NDK instance not found");const r=this.getMatchingTags(t,e);if(r.length===0)return;const[l,c,m]=r[0];let y=m!==""?this.ndk.pool.getRelay(m):void 0;return await this.ndk.fetchEvent(c,{},y)}async function fetchRootEvent(t){if(!this.ndk)throw new Error("NDK instance not found");const e=getRootTag(this);if(e)return this.ndk.fetchEventFromTag(e,this,t)}async function fetchReplyEvent(t){if(!this.ndk)throw new Error("NDK instance not found");const e=getReplyTag(this);if(e)return this.ndk.fetchEventFromTag(e,this,t)}function isReplaceable(){if(this.kind===void 0)throw new Error("Kind not set");return[0,3].includes(this.kind)||this.kind>=1e4&&this.kind<2e4||this.kind>=3e4&&this.kind<4e4}function isEphemeral(){if(this.kind===void 0)throw new Error("Kind not set");return this.kind>=2e4&&this.kind<3e4}function isParamReplaceable(){if(this.kind===void 0)throw new Error("Kind not set");return this.kind>=3e4&&this.kind<4e4}var DEFAULT_RELAY_COUNT=2;function encode$1(t=DEFAULT_RELAY_COUNT){let e=[];return this.onRelays.length>0?e=this.onRelays.map(r=>r.url):this.relay&&(e=[this.relay.url]),e.length>t&&(e=e.slice(0,t)),this.isParamReplaceable()?nip19_exports.naddrEncode({kind:this.kind,pubkey:this.pubkey,identifier:this.replaceableDTag(),relays:e}):e.length>0?nip19_exports.neventEncode({id:this.tagId(),relays:e,author:this.pubkey}):nip19_exports.noteEncode(this.tagId())}async function repost(t=!0,e){if(!e&&t){if(!this.ndk)throw new Error("No NDK instance found");this.ndk.assertSigner(),e=this.ndk.signer}const r=new NDKEvent(this.ndk,{kind:getKind(this)});return this.isProtected||(r.content=JSON.stringify(this.rawEvent())),r.tag(this),this.kind!==1&&r.tags.push(["k",`${this.kind}`]),e&&await r.sign(e),t&&await r.publish(),r}function getKind(t){return t.kind===1?6:16}function serialize(t=!1,e=!1){const r=[0,this.pubkey,this.created_at,this.kind,this.tags,this.content];return t&&r.push(this.sig),e&&r.push(this.id),JSON.stringify(r)}function deserialize(t){const e=JSON.parse(t),r={pubkey:e[1],created_at:e[2],kind:e[3],tags:e[4],content:e[5]};if(e.length>=7){const l=e[6],c=e[7];l&&l.length===128?(r.sig=l,c&&c.length===64&&(r.id=c)):l&&l.length===64&&(r.id=l,c&&c.length===128&&(r.sig=c))}return r}var worker,processingQueue={};function signatureVerificationInit(t){worker=t,worker.onmessage=e=>{const[r,l]=e.data,c=processingQueue[r];if(!c){console.error("No record found for event",r);return}delete processingQueue[r];for(const m of c.resolves)m(l)}}async function verifySignatureAsync(t,e,r){const l=t.ndk,c=Date.now();let m;return l.signatureVerificationFunction?(console.log("[NDK-CORE] Using custom signature verification function async"),m=await l.signatureVerificationFunction(t),console.log("Custom signature verification result",t.id,{result:m})):(console.log("Using worker-based signature verification async"),m=await new Promise(y=>{const _=t.serialize();let w=!1;processingQueue[t.id]||(processingQueue[t.id]={event:t,resolves:[],relay:r},w=!0),processingQueue[t.id].resolves.push(y),w&&worker?.postMessage({serialized:_,id:t.id,sig:t.sig,pubkey:t.pubkey})})),l.signatureVerificationTimeMs+=Date.now()-c,m}var PUBKEY_REGEX=/^[a-f0-9]{64}$/;function validate(){if(typeof this.kind!="number"||typeof this.content!="string"||typeof this.created_at!="number"||typeof this.pubkey!="string"||!this.pubkey.match(PUBKEY_REGEX)||!Array.isArray(this.tags))return!1;for(let t=0;t<this.tags.length;t++){const e=this.tags[t];if(!Array.isArray(e))return!1;for(let r=0;r<e.length;r++)if(typeof e[r]=="object")return!1}return!0}var verifiedSignatures=new distExports.LRUCache({maxSize:1e3,entryExpirationTimeInMS:6e4});function verifySignature(t){if(typeof this.signatureVerified=="boolean")return this.signatureVerified;const e=verifiedSignatures.get(this.id);if(e!==null)return this.signatureVerified=!!e,this.signatureVerified;try{if(this.ndk?.asyncSigVerification)verifySignatureAsync(this,t,this.relay).then(r=>{t&&(this.signatureVerified=r,r&&verifiedSignatures.set(this.id,this.sig)),r||(this.relay?this.ndk?.reportInvalidSignature(this,this.relay):this.ndk?.reportInvalidSignature(this),verifiedSignatures.set(this.id,!1))}).catch(r=>{console.error("signature verification error",this.id,r)});else{const r=sha256(new TextEncoder().encode(this.serialize())),l=schnorr.verify(this.sig,r,this.pubkey);return l?verifiedSignatures.set(this.id,this.sig):verifiedSignatures.set(this.id,!1),this.signatureVerified=l,l}}catch{return this.signatureVerified=!1,!1}}function getEventHash(){return getEventHashFromSerializedEvent(this.serialize())}function getEventHashFromSerializedEvent(t){const e=sha256(new TextEncoder().encode(t));return bytesToHex(e)}var skipClientTagOnKinds=new Set([0,4,1059,13,3,9734,5]),NDKEvent=class ki extends libExports.EventEmitter{ndk;created_at;content="";tags=[];kind;id="";sig;pubkey="";signatureVerified;_author=void 0;relay;get onRelays(){let e=[];return this.ndk?e=this.ndk.subManager.seenEvents.get(this.id)||[]:this.relay&&e.push(this.relay),e}publishStatus="success";publishError;constructor(e,r){super(),this.ndk=e,this.created_at=r?.created_at,this.content=r?.content||"",this.tags=r?.tags||[],this.id=r?.id||"",this.sig=r?.sig,this.pubkey=r?.pubkey||"",this.kind=r?.kind,r instanceof ki&&(this.relay&&(this.relay=r.relay,this.ndk?.subManager.seenEvent(r.id,this.relay)),this.publishStatus=r.publishStatus,this.publishError=r.publishError)}static deserialize(e,r){return new ki(e,deserialize(r))}rawEvent(){return{created_at:this.created_at,content:this.content,tags:this.tags,kind:this.kind,pubkey:this.pubkey,id:this.id,sig:this.sig}}set author(e){this.pubkey=e.pubkey,this._author=e,this._author.ndk??=this.ndk}get author(){if(this._author)return this._author;if(!this.ndk)throw new Error("No NDK instance found");const e=this.ndk.getUser({pubkey:this.pubkey});return this._author=e,e}tagExternal(e,r,l){const c=["i"],m=["k"];switch(r){case"url":{const y=new URL(e);y.hash="",c.push(y.toString()),m.push(`${y.protocol}//${y.host}`);break}case"hashtag":c.push(`#${e.toLowerCase()}`),m.push("#");break;case"geohash":c.push(`geo:${e.toLowerCase()}`),m.push("geo");break;case"isbn":c.push(`isbn:${e.replace(/-/g,"")}`),m.push("isbn");break;case"podcast:guid":c.push(`podcast:guid:${e}`),m.push("podcast:guid");break;case"podcast:item:guid":c.push(`podcast:item:guid:${e}`),m.push("podcast:item:guid");break;case"podcast:publisher:guid":c.push(`podcast:publisher:guid:${e}`),m.push("podcast:publisher:guid");break;case"isan":c.push(`isan:${e.split("-").slice(0,4).join("-")}`),m.push("isan");break;case"doi":c.push(`doi:${e.toLowerCase()}`),m.push("doi");break;default:throw new Error(`Unsupported NIP-73 entity type: ${r}`)}l&&c.push(l),this.tags.push(c),this.tags.push(m)}tag(e,r,l,c){let m=[];if(e.fetchProfile!==void 0){c??="p";const _=[c,e.pubkey];r&&_.push("",r),m.push(_)}else if(e instanceof ki){const _=e;l??=_?.pubkey===this.pubkey,m=_.referenceTags(r,l,c);for(const w of _.getMatchingTags("p"))w[1]!==this.pubkey&&(this.tags.find(k=>k[0]==="p"&&k[1]===w[1])||this.tags.push(["p",w[1]]))}else if(Array.isArray(e))m=[e];else throw new Error("Invalid argument",e);this.tags=mergeTags(this.tags,m)}async toNostrEvent(e){if(!e&&this.pubkey===""){const c=await this.ndk?.signer?.user();this.pubkey=c?.pubkey||""}this.created_at||(this.created_at=Math.floor(Date.now()/1e3));const{content:r,tags:l}=await this.generateTags();this.content=r||"",this.tags=l;try{this.id=this.getEventHash()}catch{}return this.rawEvent()}serialize=serialize.bind(this);getEventHash=getEventHash.bind(this);validate=validate.bind(this);verifySignature=verifySignature.bind(this);isReplaceable=isReplaceable.bind(this);isEphemeral=isEphemeral.bind(this);isDvm=()=>this.kind&&this.kind>=5e3&&this.kind<=7e3;isParamReplaceable=isParamReplaceable.bind(this);encode=encode$1.bind(this);encrypt=encrypt.bind(this);decrypt=decrypt.bind(this);getMatchingTags(e,r){const l=this.tags.filter(c=>c[0]===e);return r===void 0?l:l.filter(c=>c[3]===r)}hasTag(e,r){return this.tags.some(l=>l[0]===e&&(!r||l[3]===r))}tagValue(e,r){const l=this.getMatchingTags(e,r);if(l.length!==0)return l[0][1]}get alt(){return this.tagValue("alt")}set alt(e){this.removeTag("alt"),e&&this.tags.push(["alt",e])}get dTag(){return this.tagValue("d")}set dTag(e){this.removeTag("d"),e&&this.tags.push(["d",e])}removeTag(e,r){const l=Array.isArray(e)?e:[e];this.tags=this.tags.filter(c=>{const m=l.includes(c[0]),y=r?c[3]===r:!0;return!(m&&y)})}replaceTag(e){this.removeTag(e[0]),this.tags.push(e)}async sign(e){e?this.author=await e.user():(this.ndk?.assertSigner(),e=this.ndk?.signer);const r=await this.toNostrEvent();return this.sig=await e.sign(r),this.sig}async publishReplaceable(e,r,l){return this.id="",this.created_at=Math.floor(Date.now()/1e3),this.sig="",this.publish(e,r,l)}async publish(e,r,l){if(l||(l=1),this.sig||await this.sign(),!this.ndk)throw new Error("NDKEvent must be associated with an NDK instance to publish");if((!e||e.size===0)&&(e=this.ndk.devWriteRelaySet||await calculateRelaySetFromEvent(this.ndk,this,l)),this.kind===5&&this.ndk.cacheAdapter?.deleteEventIds){const y=this.getMatchingTags("e").map(_=>_[1]);this.ndk.cacheAdapter.deleteEventIds(y)}const c=this.rawEvent();if(this.ndk.cacheAdapter?.addUnpublishedEvent&&shouldTrackUnpublishedEvent(this))try{this.ndk.cacheAdapter.addUnpublishedEvent(this,e.relayUrls)}catch(y){console.error("Error adding unpublished event to cache",y)}this.kind===5&&this.ndk.cacheAdapter?.deleteEventIds&&this.ndk.cacheAdapter.deleteEventIds(this.getMatchingTags("e").map(y=>y[1])),this.ndk.subManager.dispatchEvent(c,void 0,!0);const m=await e.publish(this,r,l);return m.forEach(y=>this.ndk?.subManager.seenEvent(this.id,y)),m}async generateTags(){let e=[];const r=await generateContentTags(this.content,this.tags),l=r.content;if(e=r.tags,this.kind&&this.isParamReplaceable()&&!this.getMatchingTags("d")[0]){const m=this.tagValue("title");let _=[...Array(m?6:16)].map(()=>Math.random().toString(36)[2]).join("");m&&m.length>0&&(_=`${m.replace(/[^a-z0-9]+/gi,"-").replace(/^-|-$/g,"")}-${_}`),e.push(["d",_])}if(this.shouldAddClientTag){const c=["client",this.ndk?.clientName??""];this.ndk?.clientNip89&&c.push(this.ndk?.clientNip89),e.push(c)}else this.shouldStripClientTag&&(e=e.filter(c=>c[0]!=="client"));return{content:l||"",tags:e}}get shouldAddClientTag(){return!(!this.ndk?.clientName&&!this.ndk?.clientNip89||skipClientTagOnKinds.has(this.kind)||this.isEphemeral()||this.isReplaceable()&&!this.isParamReplaceable()||this.isDvm()||this.hasTag("client"))}get shouldStripClientTag(){return skipClientTagOnKinds.has(this.kind)}muted(){const e=this.ndk?.mutedIds.get(this.pubkey);if(e&&e==="p")return"author";const r=this.tagReference(),l=this.ndk?.mutedIds.get(r[1]);return l&&l===r[0]?"event":null}replaceableDTag(){if(this.kind&&this.kind>=3e4&&this.kind<=4e4){const e=this.getMatchingTags("d")[0];return e?e[1]:""}throw new Error("Event is not a parameterized replaceable event")}deduplicationKey(){return this.kind===0||this.kind===3||this.kind&&this.kind>=1e4&&this.kind<2e4?`${this.kind}:${this.pubkey}`:this.tagId()}tagId(){return this.isParamReplaceable()?this.tagAddress():this.id}tagAddress(){if(this.isParamReplaceable()){const e=this.dTag??"";return`${this.kind}:${this.pubkey}:${e}`}if(this.isReplaceable())return`${this.kind}:${this.pubkey}:`;throw new Error("Event is not a replaceable event")}tagType(){return this.isParamReplaceable()?"a":"e"}tagReference(e){let r;return this.isParamReplaceable()?r=["a",this.tagAddress()]:r=["e",this.tagId()],this.relay?r.push(this.relay.url):r.push(""),r.push(e??""),this.isParamReplaceable()||r.push(this.pubkey),r}referenceTags(e,r,l){let c=[];return this.isParamReplaceable()?c=[[l??"a",this.tagAddress()],[l??"e",this.id]]:c=[[l??"e",this.id]],c=c.map(m=>(m[0]==="e"||e?m.push(this.relay?.url??""):this.relay?.url&&m.push(this.relay?.url),m)),c.forEach(m=>{m[0]==="e"?(m.push(e??""),m.push(this.pubkey)):e&&m.push(e)}),c=[...c,...this.getMatchingTags("h")],r||c.push(...this.author.referenceTags()),c}filter(){return this.isParamReplaceable()?{"#a":[this.tagId()]}:{"#e":[this.tagId()]}}nip22Filter(){return this.isParamReplaceable()?{"#A":[this.tagId()]}:{"#E":[this.tagId()]}}async delete(e,r=!0){if(!this.ndk)throw new Error("No NDK instance found");this.ndk.assertSigner();const l=new ki(this.ndk,{kind:5,content:e||""});return l.tag(this,void 0,!0),l.tags.push(["k",this.kind?.toString()]),r&&(this.emit("deleted"),await l.publish()),l}set isProtected(e){this.removeTag("-"),e&&this.tags.push(["-"])}get isProtected(){return this.hasTag("-")}fetchTaggedEvent=fetchTaggedEvent.bind(this);fetchRootEvent=fetchRootEvent.bind(this);fetchReplyEvent=fetchReplyEvent.bind(this);repost=repost.bind(this);async react(e,r=!0){if(!this.ndk)throw new Error("No NDK instance found");this.ndk.assertSigner();const l=new ki(this.ndk,{kind:7,content:e});return l.tag(this),this.kind!==1&&l.tags.push(["k",`${this.kind}`]),r&&await l.publish(),l}get isValid(){return this.validate()}get inspect(){return JSON.stringify(this.rawEvent(),null,4)}dump(){console.debug(JSON.stringify(this.rawEvent(),null,4)),console.debug("Event on relays:",this.onRelays.map(e=>e.url).join(", "))}reply(e){const r=new ki(this.ndk);if(this.kind===1&&!e)r.kind=1,this.hasTag("e")?r.tags=[...r.tags,...this.getMatchingTags("e"),...this.getMatchingTags("p"),...this.getMatchingTags("a"),...this.referenceTags("reply")]:r.tag(this,"root");else{r.kind=1111;const l=["A","E","I","P"],c=this.tags.filter(m=>l.includes(m[0]));if(c.length>0){const m=this.tagValue("K");r.tags.push(...c),m&&r.tags.push(["K",m]);const[y,_,w,...k]=this.tagReference(),C=[y,_,...k];r.tags.push(C)}else{const[m,y,_,w]=this.tagReference(),k=[m,y,w??""];m==="e"&&k.push(this.pubkey),r.tags.push(k);const C=[...k];C[0]=C[0].toUpperCase(),r.tags.push(C),r.tags.push(["K",this.kind?.toString()]),r.tags.push(["P",this.pubkey])}r.tags.push(["k",this.kind?.toString()]),r.tags.push(...this.getMatchingTags("p")),r.tags.push(["p",this.pubkey])}return r}},untrackedUnpublishedEvents=new Set([24133,13194,23194,23195]);function shouldTrackUnpublishedEvent(t){return!untrackedUnpublishedEvents.has(t.kind)}var NDKPool=class extends libExports.EventEmitter{_relays=new Map;status="idle";autoConnectRelays=new Set;poolBlacklistRelayUrls=new Set;debug;temporaryRelayTimers=new Map;flappingRelays=new Set;backoffTimes=new Map;ndk;get blacklistRelayUrls(){const t=new Set(this.ndk.blacklistRelayUrls);return this.poolBlacklistRelayUrls.forEach(e=>t.add(e)),t}constructor(t,e,r,{debug:l,name:c}={}){super(),this.debug=l??r.debug.extend("pool"),c&&(this._name=c),this.ndk=r,this.relayUrls=t,this.poolBlacklistRelayUrls=new Set(e),this.ndk.pools.push(this)}get relays(){return this._relays}set relayUrls(t){this._relays.clear();for(const e of t){const r=new NDKRelay(e,void 0,this.ndk);r.connectivity.netDebug=this.ndk.netDebug,this.addRelay(r)}}_name="unnamed";get name(){return this._name}set name(t){this._name=t,this.debug=this.debug.extend(t)}useTemporaryRelay(t,e=3e4,r){const l=this.relays.has(t.url);l||(this.addRelay(t),this.debug("Adding temporary relay %s for filters %o",t.url,r));const c=this.temporaryRelayTimers.get(t.url);if(c&&clearTimeout(c),!l||c){const m=setTimeout(()=>{this.ndk.explicitRelayUrls?.includes(t.url)||this.removeRelay(t.url)},e);this.temporaryRelayTimers.set(t.url,m)}}addRelay(t,e=!0){const r=this.relays.has(t.url),l=this.blacklistRelayUrls?.has(t.url),c=t.url.includes("/npub1");let m=!0;const y=t.url;if(r)return;if(l){this.debug(`Refusing to add relay ${y}: blacklisted`);return}if(c){this.debug(`Refusing to add relay ${y}: is a filter relay`);return}if(this.ndk.cacheAdapter?.getRelayStatus){const M=this.ndk.cacheAdapter.getRelayStatus(y);if(M?.dontConnectBefore){if(M.dontConnectBefore>Date.now()){const B=M.dontConnectBefore-Date.now();this.debug(`Refusing to add relay ${y}: delayed connect for ${B}ms`),setTimeout(()=>{this.addRelay(t,e)},B);return}m=!1}}const _=M=>this.emit("notice",t,M),w=()=>this.handleRelayConnect(y),k=()=>this.handleRelayReady(t),C=()=>this.emit("relay:disconnect",t),R=()=>this.handleFlapping(t),T=M=>this.emit("relay:auth",t,M),A=()=>this.emit("relay:authed",t);t.off("notice",_),t.off("connect",w),t.off("ready",k),t.off("disconnect",C),t.off("flapping",R),t.off("auth",T),t.off("authed",A),t.on("notice",_),t.on("connect",w),t.on("ready",k),t.on("disconnect",C),t.on("flapping",R),t.on("auth",T),t.on("authed",A),t.on("delayed-connect",M=>{this.ndk.cacheAdapter?.updateRelayStatus&&this.ndk.cacheAdapter.updateRelayStatus(t.url,{dontConnectBefore:Date.now()+M})}),this._relays.set(y,t),e&&this.autoConnectRelays.add(y),e&&this.status==="active"&&(this.emit("relay:connecting",t),t.connect(void 0,m).catch(M=>{this.debug(`Failed to connect to relay ${y}`,M)}))}removeRelay(t){const e=this.relays.get(t);if(e)return e.disconnect(),this.relays.delete(t),this.autoConnectRelays.delete(t),this.emit("relay:disconnect",e),!0;const r=this.temporaryRelayTimers.get(t);return r&&(clearTimeout(r),this.temporaryRelayTimers.delete(t)),!1}isRelayConnected(t){const e=normalizeRelayUrl(t),r=this.relays.get(e);return r?r.status===5:!1}getRelay(t,e=!0,r=!1,l){let c=this.relays.get(normalizeRelayUrl(t));return c||(c=new NDKRelay(t,void 0,this.ndk),c.connectivity.netDebug=this.ndk.netDebug,r?this.useTemporaryRelay(c,3e4,l):this.addRelay(c,e)),c}handleRelayConnect(t){const e=this.relays.get(t);if(!e){console.error("NDK BUG: relay not found in pool",{relayUrl:t});return}this.emit("relay:connect",e),this.stats().connected===this.relays.size&&this.emit("connect")}handleRelayReady(t){this.emit("relay:ready",t)}async connect(t){this.status="active",this.debug(`Connecting to ${this.relays.size} relays${t?`, timeout ${t}ms`:""}...`);const e=Array.from(this.autoConnectRelays.keys()).map(m=>this.relays.get(m)).filter(m=>!!m);for(const m of e)m.status!==5&&m.status!==4&&(this.emit("relay:connecting",m),m.connect().catch(y=>{this.debug(`Failed to connect to relay ${m.url}: ${y??"No reason specified"}`)}));const r=()=>e.every(m=>m.status===5),l=new Promise(m=>{if(r()){m();return}const y=[];for(const _ of e){const w=()=>{if(r()){for(let k=0;k<e.length;k++)e[k].off("connect",y[k]);m()}};y.push(w),_.on("connect",w)}}),c=typeof t=="number"?new Promise(m=>setTimeout(m,t)):new Promise(()=>{});await Promise.race([l,c])}checkOnFlappingRelays(){const t=this.flappingRelays.size,e=this.relays.size;if(t/e>=.8)for(const r of this.flappingRelays)this.backoffTimes.set(r,0)}handleFlapping(t){this.debug(`Relay ${t.url} is flapping`);let e=this.backoffTimes.get(t.url)||5e3;e=e*2,this.backoffTimes.set(t.url,e),this.debug(`Backoff time for ${t.url} is ${e}ms`),setTimeout(()=>{this.debug(`Attempting to reconnect to ${t.url}`),this.emit("relay:connecting",t),t.connect(),this.checkOnFlappingRelays()},e),t.disconnect(),this.emit("flapping",t)}size(){return this.relays.size}stats(){const t={total:0,connected:0,disconnected:0,connecting:0};for(const e of this.relays.values())t.total++,e.status===5?t.connected++:e.status===1?t.disconnected++:e.status===4&&t.connecting++;return t}connectedRelays(){return Array.from(this.relays.values()).filter(t=>t.status>=5)}permanentAndConnectedRelays(){return Array.from(this.relays.values()).filter(t=>t.status>=5&&!this.temporaryRelayTimers.has(t.url))}urls(){return Array.from(this.relays.keys())}},NDKCashuMintList=class Wc extends NDKEvent{static kind=10019;static kinds=[10019];_p2pk;constructor(e,r){super(e,r),this.kind??=10019}static from(e){return new Wc(e.ndk,e)}set relays(e){this.tags=this.tags.filter(r=>r[0]!=="relay");for(const r of e)this.tags.push(["relay",r])}get relays(){const e=[];for(const r of this.tags)r[0]==="relay"&&e.push(r[1]);return e}set mints(e){this.tags=this.tags.filter(r=>r[0]!=="mint");for(const r of e)this.tags.push(["mint",r])}get mints(){const e=[];for(const r of this.tags)r[0]==="mint"&&e.push(r[1]);return Array.from(new Set(e))}get p2pk(){return this._p2pk?this._p2pk:(this._p2pk=this.tagValue("pubkey")??this.pubkey,this._p2pk)}set p2pk(e){this._p2pk=e,this.removeTag("pubkey"),e&&this.tags.push(["pubkey",e])}get relaySet(){return NDKRelaySet.fromRelayUrls(this.relays,this.ndk)}},NDKArticle=class qc extends NDKEvent{static kind=30023;static kinds=[30023];constructor(e,r){super(e,r),this.kind??=30023}static from(e){return new qc(e.ndk,e)}get title(){return this.tagValue("title")}set title(e){this.removeTag("title"),e&&this.tags.push(["title",e])}get image(){return this.tagValue("image")}set image(e){this.removeTag("image"),e&&this.tags.push(["image",e])}get summary(){return this.tagValue("summary")}set summary(e){this.removeTag("summary"),e&&this.tags.push(["summary",e])}get published_at(){const e=this.tagValue("published_at");if(e){let r=Number.parseInt(e);return r>1e12&&(r=Math.floor(r/1e3)),r}}set published_at(e){this.removeTag("published_at"),e!==void 0&&this.tags.push(["published_at",e.toString()])}async generateTags(){return super.generateTags(),this.published_at||(this.published_at=this.created_at),super.generateTags()}get url(){return this.tagValue("url")}set url(e){e?this.tags.push(["url",e]):this.removeTag("url")}};function proofsTotalBalance(t){return t.reduce((e,r)=>{if(r.amount<0)throw new Error("proof amount is negative");return e+r.amount},0)}var NDKCashuToken=class Gc extends NDKEvent{_proofs=[];_mint;static kind=7375;static kinds=[7375];_deletes=[];original;constructor(e,r){super(e,r),this.kind??=7375}static async from(e){const r=new Gc(e.ndk,e);r.original=e;try{await r.decrypt()}catch{r.content=r.original.content}try{const l=JSON.parse(r.content);if(r.proofs=l.proofs,r.mint=l.mint??r.tagValue("mint"),r.deletedTokens=l.del??[],!Array.isArray(r.proofs))return}catch{return}return r}get proofs(){return this._proofs}set proofs(e){const r=new Set;this._proofs=e.filter(l=>r.has(l.C)?(console.warn("Passed in proofs had duplicates, ignoring",l.C),!1):l.amount<0?(console.warn("Invalid proof with negative amount",l),!1):(r.add(l.C),!0)).map(this.cleanProof)}cleanProof(e){return{id:e.id,amount:e.amount,C:e.C,secret:e.secret}}async toNostrEvent(e){if(!this.ndk)throw new Error("no ndk");if(!this.ndk.signer)throw new Error("no signer");const r={proofs:this.proofs.map(this.cleanProof),mint:this.mint,del:this.deletedTokens??[]};this.content=JSON.stringify(r);const l=await this.ndk.signer.user();return await this.encrypt(l,void 0,"nip44"),super.toNostrEvent(e)}set mint(e){this._mint=e}get mint(){return this._mint}get deletedTokens(){return this._deletes}set deletedTokens(e){this._deletes=e}get amount(){return proofsTotalBalance(this.proofs)}async publish(e,r,l){return this.original?this.original.publish(e,r,l):super.publish(e,r,l)}},NDKHighlight=class Yc extends NDKEvent{_article;static kind=9802;static kinds=[9802];constructor(e,r){super(e,r),this.kind??=9802}static from(e){return new Yc(e.ndk,e)}get url(){return this.tagValue("r")}set context(e){e===void 0?this.tags=this.tags.filter(([r,l])=>r!=="context"):(this.tags=this.tags.filter(([r,l])=>r!=="context"),this.tags.push(["context",e]))}get context(){return this.tags.find(([e,r])=>e==="context")?.[1]??void 0}get article(){return this._article}set article(e){this._article=e,typeof e=="string"?this.tags.push(["r",e]):this.tag(e)}getArticleTag(){return this.getMatchingTags("a")[0]||this.getMatchingTags("e")[0]||this.getMatchingTags("r")[0]}async getArticle(){if(this._article!==void 0)return this._article;let e;const r=this.getArticleTag();if(r){switch(r[0]){case"a":{const[l,c,m]=r[1].split(":");e=nip19_exports.naddrEncode({kind:Number.parseInt(l),pubkey:c,identifier:m});break}case"e":e=nip19_exports.noteEncode(r[1]);break;case"r":this._article=r[1];break}if(e){let l=await this.ndk?.fetchEvent(e);l&&(l.kind===30023&&(l=NDKArticle.from(l)),this._article=l)}return this._article}}};function mapImetaTag(t){const e={};if(t.length===2){const l=t[1].split(" ");for(let c=0;c<l.length;c+=2){const m=l[c],y=l[c+1];m==="fallback"?(e.fallback||(e.fallback=[]),e.fallback.push(y)):e[m]=y}return e}const r=t.slice(1);for(const l of r){const c=l.split(" "),m=c[0],y=c.slice(1).join(" ");m==="fallback"?(e.fallback||(e.fallback=[]),e.fallback.push(y)):e[m]=y}return e}function imetaTagToTag(t){const e=["imeta"];for(const[r,l]of Object.entries(t))if(Array.isArray(l))for(const c of l)e.push(`${r} ${c}`);else l&&e.push(`${r} ${l}`);return e}var NDKImage=class Jc extends NDKEvent{static kind=20;static kinds=[20];_imetas;constructor(e,r){super(e,r),this.kind??=20}static from(e){return new Jc(e.ndk,e.rawEvent())}get isValid(){return this.imetas.length>0}get imetas(){return this._imetas?this._imetas:(this._imetas=this.tags.filter(e=>e[0]==="imeta").map(mapImetaTag).filter(e=>!!e.url),this._imetas)}set imetas(e){this._imetas=e,this.tags=this.tags.filter(r=>r[0]!=="imeta"),this.tags.push(...e.map(imetaTagToTag))}},NDKList=class Xc extends NDKEvent{_encryptedTags;static kinds=[10063,30001,10004,10050,10030,10015,10001,10002,10007,10006,10003];encryptedTagsLength;constructor(e,r){super(e,r),this.kind??=30001}static from(e){return new Xc(e.ndk,e)}get title(){const e=this.tagValue("title")||this.tagValue("name");return e||(this.kind===3?"Contacts":this.kind===1e4?"Mute":this.kind===10001?"Pinned Notes":this.kind===10002?"Relay Metadata":this.kind===10003?"Bookmarks":this.kind===10004?"Communities":this.kind===10005?"Public Chats":this.kind===10006?"Blocked Relays":this.kind===10007?"Search Relays":this.kind===10050?"Direct Message Receive Relays":this.kind===10015?"Interests":this.kind===10030?"Emojis":this.tagValue("d"))}set title(e){this.removeTag(["title","name"]),e&&this.tags.push(["title",e])}get name(){return this.title}set name(e){this.title=e}get description(){return this.tagValue("description")}set description(e){this.removeTag("description"),e&&this.tags.push(["description",e])}get image(){return this.tagValue("image")}set image(e){this.removeTag("image"),e&&this.tags.push(["image",e])}isEncryptedTagsCacheValid(){return!!(this._encryptedTags&&this.encryptedTagsLength===this.content.length)}async encryptedTags(e=!0){if(e&&this.isEncryptedTagsCacheValid())return this._encryptedTags;if(!this.ndk)throw new Error("NDK instance not set");if(!this.ndk.signer)throw new Error("NDK signer not set");const r=await this.ndk.signer.user();try{if(this.content.length>0)try{const l=await this.ndk.signer.decrypt(r,this.content),c=JSON.parse(l);return c?.[0]?(this.encryptedTagsLength=this.content.length,this._encryptedTags=c):(this.encryptedTagsLength=this.content.length,this._encryptedTags=[])}catch{}}catch{}return[]}validateTag(e){return!0}getItems(e){return this.tags.filter(r=>r[0]===e)}get items(){return this.tags.filter(e=>!["d","L","l","title","name","description","published_at","summary","image","thumb","alt","expiration","subject","client"].includes(e[0]))}async addItem(e,r=void 0,l=!1,c="bottom"){if(!this.ndk)throw new Error("NDK instance not set");if(!this.ndk.signer)throw new Error("NDK signer not set");let m;if(e instanceof NDKEvent)m=[e.tagReference(r)];else if(e instanceof NDKUser)m=e.referenceTags();else if(e instanceof NDKRelay)m=e.referenceTags();else if(Array.isArray(e))m=[e];else throw new Error("Invalid object type");if(r&&m[0].push(r),l){const y=await this.ndk.signer.user(),_=await this.encryptedTags();c==="top"?_.unshift(...m):_.push(...m),this._encryptedTags=_,this.encryptedTagsLength=this.content.length,this.content=JSON.stringify(_),await this.encrypt(y)}else c==="top"?this.tags.unshift(...m):this.tags.push(...m);this.created_at=Math.floor(Date.now()/1e3),this.emit("change")}async removeItemByValue(e,r=!0){if(!this.ndk)throw new Error("NDK instance not set");if(!this.ndk.signer)throw new Error("NDK signer not set");const l=this.tags.findIndex(_=>_[1]===e);l>=0&&this.tags.splice(l,1);const c=await this.ndk.signer.user(),m=await this.encryptedTags(),y=m.findIndex(_=>_[1]===e);if(y>=0&&(m.splice(y,1),this._encryptedTags=m,this.encryptedTagsLength=this.content.length,this.content=JSON.stringify(m),await this.encrypt(c)),r)return this.publishReplaceable();this.created_at=Math.floor(Date.now()/1e3),this.emit("change")}async removeItem(e,r){if(!this.ndk)throw new Error("NDK instance not set");if(!this.ndk.signer)throw new Error("NDK signer not set");if(r){const l=await this.ndk.signer.user(),c=await this.encryptedTags();c.splice(e,1),this._encryptedTags=c,this.encryptedTagsLength=this.content.length,this.content=JSON.stringify(c),await this.encrypt(l)}else this.tags.splice(e,1);return this.created_at=Math.floor(Date.now()/1e3),this.emit("change"),this}has(e){return this.items.some(r=>r[1]===e)}filterForItems(){const e=new Set,r=new Map,l=[];for(const c of this.items)if(c[0]==="e"&&c[1])e.add(c[1]);else if(c[0]==="a"&&c[1]){const[m,y,_]=c[1].split(":");if(!m||!y)continue;const w=`${m}:${y}`,k=r.get(w)||[];k.push(_||""),r.set(w,k)}if(e.size>0&&l.push({ids:Array.from(e)}),r.size>0)for(const[c,m]of r.entries()){const[y,_]=c.split(":");l.push({kinds:[Number.parseInt(y)],authors:[_],"#d":m})}return l}},lists_default=NDKList,NDKNutzap=class cu extends NDKEvent{debug;_proofs=[];static kind=9321;static kinds=[cu.kind];constructor(e,r){super(e,r),this.kind??=9321,this.debug=e?.debug.extend("nutzap")??createDebug5("ndk:nutzap"),this.alt||(this.alt="This is a nutzap");try{const l=this.getMatchingTags("proof");l.length?this._proofs=l.map(c=>JSON.parse(c[1])):this._proofs=JSON.parse(this.content)}catch{return}}static from(e){const r=new cu(e.ndk,e);if(!(!r._proofs||!r._proofs.length))return r}set comment(e){this.content=e??""}get comment(){const e=this.tagValue("comment");return e||this.content}set proofs(e){this._proofs=e,this.tags=this.tags.filter(r=>r[0]!=="proof");for(const r of e)this.tags.push(["proof",JSON.stringify(r)])}get proofs(){return this._proofs}get rawP2pk(){const e=this.proofs[0];try{const r=JSON.parse(e.secret);let l;if(typeof r=="string"?(l=JSON.parse(r),this.debug("stringified payload",e.secret)):typeof r=="object"&&(l=r),Array.isArray(l)&&l[0]==="P2PK"&&l.length>1&&typeof l[1]=="object"&&l[1]!==null||typeof l=="object"&&l!==null&&typeof l[1]?.data=="string")return l[1].data}catch(r){this.debug("error parsing p2pk pubkey",r,this.proofs[0])}}get p2pk(){const e=this.rawP2pk;if(e)return e.startsWith("02")?e.slice(2):e}get mint(){return this.tagValue("u")}set mint(e){this.replaceTag(["u",e])}get unit(){let e=this.tagValue("unit")??"sat";return e?.startsWith("msat")&&(e="sat"),e}set unit(e){if(this.removeTag("unit"),e?.startsWith("msat"))throw new Error("msat is not allowed, use sat denomination instead");e&&this.tag(["unit",e])}get amount(){return this.proofs.reduce((r,l)=>r+l.amount,0)}sender=this.author;set target(e){this.tags=this.tags.filter(r=>r[0]!=="p"),e instanceof NDKEvent&&this.tags.push(e.tagReference())}set recipientPubkey(e){this.removeTag("p"),this.tag(["p",e])}get recipientPubkey(){return this.tagValue("p")}get recipient(){const e=this.recipientPubkey;return this.ndk?this.ndk.getUser({pubkey:e}):new NDKUser({pubkey:e})}async toNostrEvent(){this.unit==="msat"&&(this.unit="sat"),this.removeTag("amount"),this.tags.push(["amount",this.amount.toString()]);const e=await super.toNostrEvent();return e.content=this.comment,e}get isValid(){let e=0,r=0,l=0;for(const c of this.tags)c[0]==="e"&&e++,c[0]==="p"&&r++,c[0]==="u"&&l++;return r===1&&l===1&&e<=1&&this.proofs.length>0}},NDKSimpleGroupMemberList=class Qc extends NDKEvent{relaySet;memberSet=new Set;static kind=39002;static kinds=[39002];constructor(e,r){super(e,r),this.kind??=39002,this.memberSet=new Set(this.members)}static from(e){return new Qc(e.ndk,e)}get members(){return this.getMatchingTags("p").map(e=>e[1])}hasMember(e){return this.memberSet.has(e)}async publish(e,r,l){return e??=this.relaySet,super.publishReplaceable(e,r,l)}},NDKSimpleGroupMetadata=class eh extends NDKEvent{static kind=39e3;static kinds=[39e3];constructor(e,r){super(e,r),this.kind??=39e3}static from(e){return new eh(e.ndk,e)}get name(){return this.tagValue("name")}get picture(){return this.tagValue("picture")}get about(){return this.tagValue("about")}get scope(){if(this.getMatchingTags("public").length>0)return"public";if(this.getMatchingTags("public").length>0)return"private"}set scope(e){this.removeTag("public"),this.removeTag("private"),e==="public"?this.tags.push(["public",""]):e==="private"&&this.tags.push(["private",""])}get access(){if(this.getMatchingTags("open").length>0)return"open";if(this.getMatchingTags("closed").length>0)return"closed"}set access(e){this.removeTag("open"),this.removeTag("closed"),e==="open"?this.tags.push(["open",""]):e==="closed"&&this.tags.push(["closed",""])}};function strToPosition(t){const[e,r]=t.split(",").map(Number);return{x:e,y:r}}function strToDimension(t){const[e,r]=t.split("x").map(Number);return{width:e,height:r}}var NDKStorySticker=class th{static Text="text";static Pubkey="pubkey";static Event="event";static Prompt="prompt";static Countdown="countdown";type;value;position;dimension;properties;constructor(e){if(Array.isArray(e)){const r=e;if(r[0]!=="sticker"||r.length<5)throw new Error("Invalid sticker tag");this.type=r[1],this.value=r[2],this.position=strToPosition(r[3]),this.dimension=strToDimension(r[4]);const l={};for(let c=5;c<r.length;c++){const[m,...y]=r[c].split(" ");l[m]=y.join(" ")}Object.keys(l).length>0&&(this.properties=l)}else this.type=e,this.value=void 0,this.position={x:0,y:0},this.dimension={width:0,height:0}}static fromTag(e){try{return new th(e)}catch{return null}}get style(){return this.properties?.style}set style(e){e?this.properties={...this.properties,style:e}:delete this.properties?.style}get rotation(){return this.properties?.rot?Number.parseFloat(this.properties.rot):void 0}set rotation(e){e!==void 0?this.properties={...this.properties,rot:e.toString()}:delete this.properties?.rot}get isValid(){return this.hasValidDimensions()&&this.hasValidPosition()}hasValidDimensions=()=>typeof this.dimension.width=="number"&&typeof this.dimension.height=="number"&&!Number.isNaN(this.dimension.width)&&!Number.isNaN(this.dimension.height);hasValidPosition=()=>typeof this.position.x=="number"&&typeof this.position.y=="number"&&!Number.isNaN(this.position.x)&&!Number.isNaN(this.position.y);toTag(){if(!this.isValid){const l=[this.hasValidDimensions()?void 0:"dimensions is invalid",this.hasValidPosition()?void 0:"position is invalid"].filter(Boolean);throw new Error(`Invalid sticker: ${l.join(", ")}`)}let e;switch(this.type){case"event":e=this.value.tagId();break;case"pubkey":e=this.value.pubkey;break;default:e=this.value}const r=["sticker",this.type,e,coordinates(this.position),dimension(this.dimension)];if(this.properties)for(const[l,c]of Object.entries(this.properties))r.push(`${l} ${c}`);return r}},NDKStory=class nh extends NDKEvent{static kind=23;static kinds=[23];_imeta;_dimensions;constructor(e,r){if(super(e,r),this.kind??=23,r)for(const l of r.tags)switch(l[0]){case"imeta":this._imeta=mapImetaTag(l);break;case"dim":this.dimensions=strToDimension(l[1]);break}}static from(e){return new nh(e.ndk,e)}get isValid(){return!!this.imeta}get imeta(){return this._imeta}set imeta(e){this._imeta=e,this.tags=this.tags.filter(r=>r[0]!=="imeta"),e&&this.tags.push(imetaTagToTag(e))}get dimensions(){const e=this.tagValue("dim");if(e)return strToDimension(e)}set dimensions(e){this.removeTag("dim"),e&&this.tags.push(["dim",`${e.width}x${e.height}`])}get duration(){const e=this.tagValue("dur");if(e)return Number.parseInt(e)}set duration(e){this.removeTag("dur"),e!==void 0&&this.tags.push(["dur",e.toString()])}get stickers(){const e=[];for(const r of this.tags){if(r[0]!=="sticker"||r.length<5)continue;const l=NDKStorySticker.fromTag(r);l&&e.push(l)}return e}addSticker(e){let r;if(e instanceof NDKStorySticker)r=e;else{const l=["sticker",e.type,typeof e.value=="string"?e.value:"",coordinates(e.position),dimension(e.dimension)];if(e.properties)for(const[c,m]of Object.entries(e.properties))l.push(`${c} ${m}`);r=new NDKStorySticker(l),r.value=e.value}r.type==="pubkey"?this.tag(r.value):r.type==="event"&&this.tag(r.value),this.tags.push(r.toTag())}removeSticker(e){const r=this.stickers;if(e<0||e>=r.length)return;let l=0;for(let c=0;c<this.tags.length;c++)if(this.tags[c][0]==="sticker"){if(l===e){this.tags.splice(c,1);break}l++}}},coordinates=t=>`${t.x},${t.y}`,dimension=t=>`${t.width}x${t.height}`,possibleIntervalFrequencies=["daily","weekly","monthly","quarterly","yearly"];function newAmount(t,e,r){return["amount",t.toString(),e,r]}function parseTagToSubscriptionAmount(t){const e=Number.parseInt(t[1]);if(Number.isNaN(e)||e===void 0||e===null||e<=0)return;const r=t[2];if(r===void 0||r==="")return;const l=t[3];if(l!==void 0&&possibleIntervalFrequencies.includes(l))return{amount:e,currency:r,term:l}}var NDKSubscriptionTier=class rh extends NDKArticle{static kind=37001;static kinds=[37001];constructor(e,r){const l=r?.kind??37001;super(e,r),this.kind=l}static from(e){return new rh(e.ndk,e)}get perks(){return this.getMatchingTags("perk").map(e=>e[1]).filter(e=>e!==void 0)}addPerk(e){this.tags.push(["perk",e])}get amounts(){return this.getMatchingTags("amount").map(e=>parseTagToSubscriptionAmount(e)).filter(e=>e!==void 0)}addAmount(e,r,l){this.tags.push(newAmount(e,r,l))}set relayUrl(e){this.tags.push(["r",e])}get relayUrls(){return this.getMatchingTags("r").map(e=>e[1]).filter(e=>e!==void 0)}get verifierPubkey(){return this.tagValue("p")}set verifierPubkey(e){this.removeTag("p"),e&&this.tags.push(["p",e])}get isValid(){return this.title!==void 0&&this.amounts.length>0}},NDKVideo=class ih extends NDKEvent{static kind=21;static kinds=[34235,34236,22,21];_imetas;static from(e){return new ih(e.ndk,e.rawEvent())}get title(){return this.tagValue("title")}set title(e){this.removeTag("title"),e&&this.tags.push(["title",e])}get thumbnail(){let e;return this.imetas&&this.imetas.length>0&&(e=this.imetas[0].image?.[0]),e??this.tagValue("thumb")}get imetas(){return this._imetas?this._imetas:(this._imetas=this.tags.filter(e=>e[0]==="imeta").map(mapImetaTag),this._imetas)}set imetas(e){this._imetas=e,this.tags=this.tags.filter(r=>r[0]!=="imeta"),this.tags.push(...e.map(imetaTagToTag))}get url(){return this.imetas&&this.imetas.length>0?this.imetas[0].url:this.tagValue("url")}get published_at(){const e=this.tagValue("published_at");if(e)return Number.parseInt(e)}async generateTags(){if(super.generateTags(),!this.kind&&this.imetas?.[0]?.dim){const[e,r]=this.imetas[0].dim.split("x"),l=e&&r&&Number.parseInt(e)<Number.parseInt(r);this.duration&&this.duration<120&&l?this.kind=22:this.kind=21}return super.generateTags()}get duration(){const e=this.tagValue("duration");if(e)return Number.parseInt(e)}set duration(e){this.removeTag("duration"),e!==void 0&&this.tags.push(["duration",Math.floor(e).toString()])}},NDKWiki=class sh extends NDKArticle{static kind=30818;static kinds=[30818];static from(e){return new sh(e.ndk,e.rawEvent())}get isDefered(){return this.hasTag("a","defer")}get deferedId(){return this.tagValue("a","defer")}set defer(e){this.removeTag("a","defer"),this.tag(e,"defer")}},NDKBlossomList=class oh extends NDKEvent{static kinds=[10063];constructor(e,r){super(e,r),this.kind??=10063}static from(e){return new oh(e.ndk,e.rawEvent())}get servers(){return this.tags.filter(e=>e[0]==="server").map(e=>e[1])}set servers(e){this.tags=this.tags.filter(r=>r[0]!=="server");for(const r of e)this.tags.push(["server",r])}get default(){const e=this.servers;return e.length>0?e[0]:void 0}set default(e){if(!e)return;const l=this.servers.filter(c=>c!==e);this.servers=[e,...l]}addServer(e){if(!e)return;const r=this.servers;r.includes(e)||(this.servers=[...r,e])}removeServer(e){if(!e)return;const r=this.servers;this.servers=r.filter(l=>l!==e)}},NDKFollowPack=class ah extends NDKEvent{static kind=39089;static kinds=[39089,39092];constructor(e,r){super(e,r),this.kind??=39089}static from(e){return new ah(e.ndk,e)}get title(){return this.tagValue("title")}set title(e){this.removeTag("title"),e&&this.tags.push(["title",e])}get image(){const e=this.tags.find(r=>r[0]==="imeta");if(e){const r=mapImetaTag(e);if(r.url)return r.url}return this.tagValue("image")}set image(e){this.tags=this.tags.filter(r=>r[0]!=="imeta"&&r[0]!=="image"),typeof e=="string"?e!==void 0&&this.tags.push(["image",e]):e&&typeof e=="object"&&(this.tags.push(imetaTagToTag(e)),e.url&&this.tags.push(["image",e.url]))}get pubkeys(){return Array.from(new Set(this.tags.filter(e=>e[0]==="p").map(e=>e[1])))}set pubkeys(e){this.tags=this.tags.filter(r=>r[0]!=="p");for(const r of e)this.tags.push(["p",r])}get description(){return this.tagValue("description")}set description(e){this.removeTag("description"),e&&this.tags.push(["description",e])}},signerRegistry=new Map;function registerSigner(t,e){signerRegistry.set(t,e)}var NDKPrivateKeySigner=class hu{_user;_privateKey;_pubkey;constructor(e,r){if(typeof e=="string")if(e.startsWith("nsec1")){const{type:l,data:c}=nip19_exports.decode(e);if(l==="nsec")this._privateKey=c;else throw new Error("Invalid private key provided.")}else if(e.length===64)this._privateKey=hexToBytes(e);else throw new Error("Invalid private key provided.");else this._privateKey=e;this._pubkey=getPublicKey(this._privateKey),r&&(this._user=r.getUser({pubkey:this._pubkey})),this._user??=new NDKUser({pubkey:this._pubkey})}get privateKey(){if(!this._privateKey)throw new Error("Not ready");return bytesToHex(this._privateKey)}get pubkey(){if(!this._pubkey)throw new Error("Not ready");return this._pubkey}get nsec(){if(!this._privateKey)throw new Error("Not ready");return nip19_exports.nsecEncode(this._privateKey)}get npub(){if(!this._pubkey)throw new Error("Not ready");return nip19_exports.npubEncode(this._pubkey)}static generate(){const e=generateSecretKey();return new hu(e)}async blockUntilReady(){return this._user}async user(){return this._user}get userSync(){return this._user}async sign(e){if(!this._privateKey)throw Error("Attempted to sign without a private key");return finalizeEvent(e,this._privateKey).sig}async encryptionEnabled(e){const r=[];return(!e||e==="nip04")&&r.push("nip04"),(!e||e==="nip44")&&r.push("nip44"),r}async encrypt(e,r,l){if(!this._privateKey||!this.privateKey)throw Error("Attempted to encrypt without a private key");const c=e.pubkey;if(l==="nip44"){const m=nip44_exports.v2.utils.getConversationKey(this._privateKey,c);return await nip44_exports.v2.encrypt(r,m)}return await nip04_exports.encrypt(this._privateKey,c,r)}async decrypt(e,r,l){if(!this._privateKey||!this.privateKey)throw Error("Attempted to decrypt without a private key");const c=e.pubkey;if(l==="nip44"){const m=nip44_exports.v2.utils.getConversationKey(this._privateKey,c);return await nip44_exports.v2.decrypt(r,m)}return await nip04_exports.decrypt(this._privateKey,c,r)}toPayload(){if(!this._privateKey)throw new Error("Private key not available");const e={type:"private-key",payload:this.privateKey};return JSON.stringify(e)}static async fromPayload(e,r){const l=JSON.parse(e);if(l.type!=="private-key")throw new Error(`Invalid payload type: expected 'private-key', got ${l.type}`);if(!l.payload||typeof l.payload!="string")throw new Error("Invalid payload content for private-key signer");return new hu(l.payload,r)}};registerSigner("private-key",NDKPrivateKeySigner);var NDKProject=class du extends NDKEvent{static kind=31933;static kinds=[du.kind];_signer;constructor(e,r){super(e,r),this.kind=31933}static from(e){return new du(e.ndk,e.rawEvent())}set repo(e){this.removeTag("repo"),e&&this.tags.push(["repo",e])}set hashtags(e){this.removeTag("hashtags"),e.filter(r=>r.length>0).length&&this.tags.push(["hashtags",...e])}get hashtags(){const e=this.tags.find(r=>r[0]==="hashtags");return e?e.slice(1):[]}get repo(){return this.tagValue("repo")}get title(){return this.tagValue("title")}set title(e){this.removeTag("title"),e&&this.tags.push(["title",e])}get picture(){return this.tagValue("picture")}set picture(e){this.removeTag("picture"),e&&this.tags.push(["picture",e])}set description(e){this.content=e}get description(){return this.content}get slug(){return this.dTag??"empty-dtag"}async getSigner(){if(this._signer)return this._signer;const e=this.tagValue("key");if(!e)this._signer=NDKPrivateKeySigner.generate(),await this.encryptAndSaveNsec();else{const r=await this.ndk?.signer?.decrypt(this.ndk.activeUser,e);if(!r)throw new Error("Failed to decrypt project key or missing signer context.");this._signer=new NDKPrivateKeySigner(r)}return this._signer}async getNsec(){return(await this.getSigner()).privateKey}async setNsec(e){this._signer=new NDKPrivateKeySigner(e),await this.encryptAndSaveNsec()}async encryptAndSaveNsec(){if(!this._signer)throw new Error("Signer is not set.");const e=this._signer.privateKey,r=await this.ndk?.signer?.encrypt(this.ndk.activeUser,e);r&&(this.removeTag("key"),this.tags.push(["key",r]))}},NDKThread=class lh extends NDKEvent{static kind=11;static kinds=[11];constructor(e,r){super(e,r),this.kind??=11}static from(e){return new lh(e.ndk,e)}get title(){return this.tagValue("title")}set title(e){this.removeTag("title"),e&&this.tags.push(["title",e])}},NDKDraft=class uh extends NDKEvent{_event;static kind=31234;static kinds=[31234,1234];counterparty;constructor(e,r){super(e,r),this.kind??=31234}static from(e){return new uh(e.ndk,e)}set identifier(e){this.removeTag("d"),this.tags.push(["d",e])}get identifier(){return this.dTag}set event(e){e instanceof NDKEvent?this._event=e:this._event=new NDKEvent(void 0,e),this.prepareEvent()}set checkpoint(e){e?(this.tags.push(e.tagReference()),this.kind=1234):(this.removeTag("a"),this.kind=31234)}get isCheckpoint(){return this.kind===1234}get isProposal(){const e=this.tagValue("p");return!!e&&e!==this.pubkey}async getEvent(e){if(this._event)return this._event;if(e??=this.ndk?.signer,!e)throw new Error("No signer available");if(this.content&&this.content.length>0)try{const r=e.pubkey,c=[this.tagValue("p"),this.pubkey].filter(Boolean).find(_=>_!==r);let m;m=new NDKUser({pubkey:c??r}),await this.decrypt(m,e);const y=JSON.parse(this.content);return this._event=await wrapEvent(new NDKEvent(this.ndk,y)),this._event}catch(r){console.error(r);return}else return null}prepareEvent(){if(!this._event)throw new Error("No event has been provided");this.removeTag("k"),this._event.kind&&this.tags.push(["k",this._event.kind.toString()]),this.content=JSON.stringify(this._event.rawEvent())}async save({signer:e,publish:r,relaySet:l}){if(e??=this.ndk?.signer,!e)throw new Error("No signer available");const c=this.counterparty||await e.user();if(await this.encrypt(c,e),this.counterparty){const m=this.counterparty.pubkey;this.removeTag("p"),this.tags.push(["p",m])}if(r!==!1)return this.publishReplaceable(l)}},NDKTask=class ch extends NDKEvent{static kind=1934;static kinds=[1934];constructor(e,r){super(e,r),this.kind=1934}static from(e){return new ch(e.ndk,e.rawEvent())}set title(e){this.removeTag("title"),e&&this.tags.push(["title",e])}get title(){return this.tagValue("title")}set project(e){this.removeTag("a"),this.tags.push(e.tagReference())}get projectSlug(){const e=this.getMatchingTags("a")[0];return e?e[1].split(/:/)?.[2]:void 0}},NDKProjectTemplate=class hh extends NDKEvent{static kind=30717;static kinds=[30717];constructor(e,r){super(e,r),this.kind=30717}static from(e){return new hh(e.ndk,e.rawEvent())}get templateId(){return this.dTag??""}set templateId(e){this.dTag=e}get name(){return this.tagValue("title")??""}set name(e){this.removeTag("title"),e&&this.tags.push(["title",e])}get description(){return this.tagValue("description")??""}set description(e){this.removeTag("description"),e&&this.tags.push(["description",e])}get repoUrl(){return this.tagValue("uri")??""}set repoUrl(e){this.removeTag("uri"),e&&this.tags.push(["uri",e])}get image(){return this.tagValue("image")}set image(e){this.removeTag("image"),e&&this.tags.push(["image",e])}get command(){return this.tagValue("command")}set command(e){this.removeTag("command"),e&&this.tags.push(["command",e])}get agentConfig(){const e=this.tagValue("agent");if(e)try{return JSON.parse(e)}catch{return}}set agentConfig(e){this.removeTag("agent"),e&&this.tags.push(["agent",JSON.stringify(e)])}get templateTags(){return this.getMatchingTags("t").map(e=>e[1]).filter(Boolean)}set templateTags(e){this.tags=this.tags.filter(r=>r[0]!=="t"),e.forEach(r=>{r&&this.tags.push(["t",r])})}},registeredEventClasses=new Set;function wrapEvent(t){const e=new Map,l=[...[NDKImage,NDKVideo,NDKCashuMintList,NDKArticle,NDKHighlight,NDKDraft,NDKWiki,NDKNutzap,NDKProject,NDKTask,NDKProjectTemplate,NDKSimpleGroupMemberList,NDKSimpleGroupMetadata,NDKSubscriptionTier,NDKCashuToken,NDKList,NDKStory,NDKBlossomList,NDKFollowPack,NDKThread],...registeredEventClasses];for(const m of l)for(const y of m.kinds)e.set(y,m);const c=e.get(t.kind);return c?c.from(t):t}function queryFullyFilled(t){return!!(filterIncludesIds(t.filter)&&resultHasAllRequestedIds(t))}function filterIncludesIds(t){return!!t.ids}function resultHasAllRequestedIds(t){const e=t.filter.ids;return!!e&&e.length===t.eventFirstSeen.size}function filterFromId(t){let e;if(t.match(NIP33_A_REGEX)){const[r,l,c]=t.split(":"),m={authors:[l],kinds:[Number.parseInt(r)]};return c&&(m["#d"]=[c]),m}if(t.match(BECH32_REGEX))try{switch(e=nip19_exports.decode(t),e.type){case"nevent":{const r={ids:[e.data.id]};return e.data.author&&(r.authors=[e.data.author]),e.data.kind&&(r.kinds=[e.data.kind]),r}case"note":return{ids:[e.data]};case"naddr":{const r={authors:[e.data.pubkey],kinds:[e.data.kind]};return e.data.identifier&&(r["#d"]=[e.data.identifier]),r}}}catch(r){console.error("Error decoding",t,r)}return{ids:[t]}}function isNip33AValue(t){return t.match(NIP33_A_REGEX)!==null}var NIP33_A_REGEX=/^(\d+):([0-9A-Fa-f]+)(?::(.*))?$/,BECH32_REGEX=/^n(event|ote|profile|pub|addr)1[\d\w]+$/;function relaysFromBech32(t,e){try{const r=nip19_exports.decode(t);if(["naddr","nevent"].includes(r?.type)){const l=r.data;if(l?.relays)return l.relays.map(c=>new NDKRelay(c,e.relayAuthDefaultPolicy,e))}}catch{}return[]}var defaultOpts={closeOnEose:!1,cacheUsage:"CACHE_FIRST",dontSaveToCache:!1,groupable:!0,groupableDelay:100,groupableDelayType:"at-most",cacheUnconstrainFilter:["limit","since","until"]},NDKSubscription=class extends libExports.EventEmitter{subId;filters;opts;pool;skipVerification=!1;skipValidation=!1;relayFilters;relaySet;ndk;debug;eventFirstSeen=new Map;eosesSeen=new Set;lastEventReceivedAt;mostRecentCacheEventTimestamp;internalId;closeOnEose;poolMonitor;skipOptimisticPublishEvent=!1;cacheUnconstrainFilter;constructor(t,e,r,l){super(),this.ndk=t,this.opts={...defaultOpts,...r||{}},this.pool=this.opts.pool||t.pool,this.filters=Array.isArray(e)?e:[e],this.subId=l||this.opts.subId,this.internalId=Math.random().toString(36).substring(7),this.debug=t.debug.extend(`subscription[${this.opts.subId??this.internalId}]`),this.opts.relaySet?this.relaySet=this.opts.relaySet:this.opts.relayUrls&&(this.relaySet=NDKRelaySet.fromRelayUrls(this.opts.relayUrls,this.ndk)),this.skipVerification=this.opts.skipVerification||!1,this.skipValidation=this.opts.skipValidation||!1,this.closeOnEose=this.opts.closeOnEose||!1,this.skipOptimisticPublishEvent=this.opts.skipOptimisticPublishEvent||!1,this.cacheUnconstrainFilter=this.opts.cacheUnconstrainFilter}relaysMissingEose(){return this.relayFilters?Array.from(this.relayFilters?.keys()).filter(e=>!this.eosesSeen.has(this.pool.getRelay(e,!1,!1))):[]}get filter(){return this.filters[0]}get groupableDelay(){if(this.isGroupable())return this.opts?.groupableDelay}get groupableDelayType(){return this.opts?.groupableDelayType||"at-most"}isGroupable(){return this.opts?.groupable||!1}shouldQueryCache(){return this.opts.addSinceFromCache?!0:this.opts?.cacheUsage==="ONLY_RELAY"?!1:(this.filters.some(e=>e.kinds?.some(r=>kindIsEphemeral(r))),!0)}shouldQueryRelays(){return this.opts?.cacheUsage!=="ONLY_CACHE"}shouldWaitForCache(){return this.opts.addSinceFromCache?!0:!!this.opts.closeOnEose&&!!this.ndk.cacheAdapter?.locking&&this.opts.cacheUsage!=="PARALLEL"}start(t=!0){let e;const r=c=>{if(t)for(const m of c)m.created_at&&(!this.mostRecentCacheEventTimestamp||m.created_at>this.mostRecentCacheEventTimestamp)&&(this.mostRecentCacheEventTimestamp=m.created_at),this.eventReceived(m,void 0,!0,!1);else{e=[];for(const m of c){m.created_at&&(!this.mostRecentCacheEventTimestamp||m.created_at>this.mostRecentCacheEventTimestamp)&&(this.mostRecentCacheEventTimestamp=m.created_at),m.ndk=this.ndk;const y=this.opts.wrap?wrapEvent(m):m;if(!y)break;if(y instanceof Promise){y.then(_=>{this.emitEvent(!1,_,void 0,!0,!1)});break}this.eventFirstSeen.set(y.id,Date.now()),e.push(y)}}},l=()=>{this.shouldQueryRelays()?(this.startWithRelays(),this.startPoolMonitor()):this.emit("eose",this)};return this.shouldQueryCache()?(e=this.startWithCache(),e instanceof Promise?this.shouldWaitForCache()?(e.then(c=>{if(r(c),queryFullyFilled(this)){this.emit("eose",this);return}l()}),null):(e.then(c=>{r(c)}),l(),null):(r(e),queryFullyFilled(this)?this.emit("eose",this):l(),e)):(l(),null)}startPoolMonitor(){this.debug.extend("pool-monitor"),this.poolMonitor=t=>{if(this.relayFilters?.has(t.url))return;calculateRelaySetsFromFilters(this.ndk,this.filters,this.pool).get(t.url)&&(this.relayFilters?.set(t.url,this.filters),t.subscribe(this,this.filters))},this.pool.on("relay:connect",this.poolMonitor)}onStopped;stop(){this.emit("close",this),this.poolMonitor&&this.pool.off("relay:connect",this.poolMonitor),this.onStopped?.()}hasAuthorsFilter(){return this.filters.some(t=>t.authors?.length)}startWithCache(){return this.ndk.cacheAdapter?.query?this.ndk.cacheAdapter.query(this):[]}startWithRelays(){let t=this.filters;if(this.opts.addSinceFromCache&&this.mostRecentCacheEventTimestamp){const e=this.mostRecentCacheEventTimestamp+1;t=t.map(r=>({...r,since:Math.max(r.since||0,e)}))}if(!this.relaySet||this.relaySet.relays.size===0)this.relayFilters=calculateRelaySetsFromFilters(this.ndk,t,this.pool);else{this.relayFilters=new Map;for(const e of this.relaySet.relays)this.relayFilters.set(e.url,t)}for(const[e,r]of this.relayFilters)this.pool.getRelay(e,!0,!0,r).subscribe(this,r)}eventReceived(t,e,r=!1,l=!1){const c=t.id,m=this.eventFirstSeen.has(c);let y;if(t instanceof NDKEvent&&(y=t),m){const _=Date.now()-(this.eventFirstSeen.get(c)||0);if(this.emit("event:dup",t,e,_,this,r,l),e){const w=verifiedSignatures.get(c);if(w&&typeof w=="string")if(t.sig===w)e.addValidatedEvent();else{const k=t instanceof NDKEvent?t:new NDKEvent(this.ndk,t);this.ndk.reportInvalidSignature(k,e)}}}else{if(y??=new NDKEvent(this.ndk,t),y.ndk=this.ndk,y.relay=e,!r&&!l){if(!this.skipValidation&&!y.isValid){this.debug("Event failed validation %s from relay %s",c,e?.url);return}if(e)if(e.shouldValidateEvent()&&!this.skipVerification){if(y.relay=e,!this.ndk.asyncSigVerification){if(!y.verifySignature(!0)){this.debug("Event failed signature validation",t),this.ndk.reportInvalidSignature(y,e);return}e.addValidatedEvent()}}else e.addNonValidatedEvent();this.ndk.cacheAdapter&&!this.opts.dontSaveToCache&&this.ndk.cacheAdapter.setEvent(y,this.filters,e)}(!l||this.skipOptimisticPublishEvent!==!0)&&(this.emitEvent(this.opts?.wrap??!1,y,e,r,l),this.eventFirstSeen.set(c,Date.now()))}this.lastEventReceivedAt=Date.now()}emitEvent(t,e,r,l,c){const m=t?wrapEvent(e):e;m instanceof Promise?m.then(y=>this.emitEvent(!1,y,r,l,c)):m&&this.emit("event",m,r,this,l,c)}closedReceived(t,e){this.emit("closed",t,e)}eoseTimeout;eosed=!1;eoseReceived(t){this.debug("EOSE received from %s",t.url),this.eosesSeen.add(t);let e=this.lastEventReceivedAt?Date.now()-this.lastEventReceivedAt:void 0;const r=this.eosesSeen.size===this.relayFilters?.size,l=queryFullyFilled(this),c=m=>{this.debug("Performing EOSE: %s %d",m,this.eosed),!this.eosed&&(this.eoseTimeout&&clearTimeout(this.eoseTimeout),this.emit("eose",this),this.eosed=!0,this.opts?.closeOnEose&&this.stop())};if(l||r)c("query filled or seen all");else if(this.relayFilters){let m=1e3;const y=new Set(this.pool.connectedRelays().map(k=>k.url)),_=Array.from(this.relayFilters.keys()).filter(k=>y.has(k));if(_.length===0){this.debug("No connected relays, waiting for all relays to connect",Array.from(this.relayFilters.keys()).join(", "));return}const w=this.eosesSeen.size/_.length;if(this.debug("Percentage of relays that have sent EOSE",{subId:this.subId,percentageOfRelaysThatHaveSentEose:w,seen:this.eosesSeen.size,total:_.length}),this.eosesSeen.size>=2&&w>=.5){if(m=m*(1-w),m===0){c("time to wait was 0");return}this.eoseTimeout&&clearTimeout(this.eoseTimeout);const k=()=>{e=this.lastEventReceivedAt?Date.now()-this.lastEventReceivedAt:void 0,e!==void 0&&e<20?this.eoseTimeout=setTimeout(k,m):c(`send eose timeout: ${m}`)};this.eoseTimeout=setTimeout(k,m)}}}},kindIsEphemeral=t=>t>=2e4&&t<3e4;async function follows(t,e,r=3){if(!this.ndk)throw new Error("NDK not set");const l=await this.ndk.fetchEvent({kinds:[r],authors:[this.pubkey]},t||{groupable:!1});if(l){const c=new Set;return l.tags.forEach(m=>{m[0]==="p"&&c.add(m[1])}),e&&this.ndk?.outboxTracker?.trackUsers(Array.from(c)),[...c].reduce((m,y)=>{const _=new NDKUser({pubkey:y});return _.ndk=this.ndk,m.add(_),m},new Set)}return new Set}var NIP05_REGEX=/^(?:([\w.+-]+)@)?([\w.-]+)$/;async function getNip05For(t,e,r=fetch,l={}){return await t.queuesNip05.add({id:e,func:async()=>{if(t.cacheAdapter?.loadNip05){const w=await t.cacheAdapter.loadNip05(e);if(w!=="missing"){if(w){const k=new NDKUser({pubkey:w.pubkey,relayUrls:w.relays,nip46Urls:w.nip46});return k.ndk=t,k}if(l.cache!=="no-cache")return null}}const c=e.match(NIP05_REGEX);if(!c)return null;const[m,y="_",_]=c;try{const w=await r(`https://${_}/.well-known/nostr.json?name=${y}`,l),{names:k,relays:C,nip46:R}=parseNIP05Result(await w.json()),T=k[y.toLowerCase()];let A=null;return T&&(A={pubkey:T,relays:C?.[T],nip46:R?.[T]}),t?.cacheAdapter?.saveNip05&&t.cacheAdapter.saveNip05(e,A),A}catch(w){return t?.cacheAdapter?.saveNip05&&t?.cacheAdapter.saveNip05(e,null),console.error("Failed to fetch NIP05 for",e,w),null}}})}function parseNIP05Result(t){const e={names:{}};for(const[r,l]of Object.entries(t.names))typeof r=="string"&&typeof l=="string"&&(e.names[r.toLowerCase()]=l);if(t.relays){e.relays={};for(const[r,l]of Object.entries(t.relays))typeof r=="string"&&Array.isArray(l)&&(e.relays[r]=l.filter(c=>typeof c=="string"))}if(t.nip46){e.nip46={};for(const[r,l]of Object.entries(t.nip46))typeof r=="string"&&Array.isArray(l)&&(e.nip46[r]=l.filter(c=>typeof c=="string"))}return e}function profileFromEvent(t){const e={};let r;try{r=JSON.parse(t.content)}catch(l){throw new Error(`Failed to parse profile event: ${l}`)}e.profileEvent=JSON.stringify(t.rawEvent());for(const l of Object.keys(r))switch(l){case"name":e.name=r.name;break;case"display_name":e.displayName=r.display_name;break;case"image":case"picture":e.picture=r.picture||r.image,e.image=e.picture;break;case"banner":e.banner=r.banner;break;case"bio":e.bio=r.bio;break;case"nip05":e.nip05=r.nip05;break;case"lud06":e.lud06=r.lud06;break;case"lud16":e.lud16=r.lud16;break;case"about":e.about=r.about;break;case"website":e.website=r.website;break;default:e[l]=r[l];break}return e.created_at=t.created_at,e}function serializeProfile(t){const e={};for(const[r,l]of Object.entries(t))switch(r){case"username":case"name":e.name=l;break;case"displayName":e.display_name=l;break;case"image":case"picture":e.picture=l;break;case"bio":case"about":e.about=l;break;default:e[r]=l;break}return JSON.stringify(e)}var NDKUser=class dh{ndk;profile;profileEvent;_npub;_pubkey;relayUrls=[];nip46Urls=[];constructor(e){if(e.npub&&(this._npub=e.npub),e.hexpubkey&&(this._pubkey=e.hexpubkey),e.pubkey&&(this._pubkey=e.pubkey),e.relayUrls&&(this.relayUrls=e.relayUrls),e.nip46Urls&&(this.nip46Urls=e.nip46Urls),e.nprofile)try{const r=nip19_exports.decode(e.nprofile);r.type==="nprofile"&&(this._pubkey=r.data.pubkey,r.data.relays&&r.data.relays.length>0&&this.relayUrls.push(...r.data.relays))}catch(r){console.error("Failed to decode nprofile",r)}}get npub(){if(!this._npub){if(!this._pubkey)throw new Error("pubkey not set");this._npub=nip19_exports.npubEncode(this.pubkey)}return this._npub}get nprofile(){const e=this.profileEvent?.onRelays?.map(r=>r.url);return nip19_exports.nprofileEncode({pubkey:this.pubkey,relays:e})}set npub(e){this._npub=e}get pubkey(){if(!this._pubkey){if(!this._npub)throw new Error("npub not set");this._pubkey=nip19_exports.decode(this.npub).data}return this._pubkey}set pubkey(e){this._pubkey=e}filter(){return{"#p":[this.pubkey]}}async getZapInfo(e){if(!this.ndk)throw new Error("No NDK instance found");const r=async y=>{if(!e)return y;let _;const w=new Promise((k,C)=>{_=setTimeout(()=>C(new Error("Timeout")),e)});try{const k=await Promise.race([y,w]);return _&&clearTimeout(_),k}catch(k){if(k instanceof Error&&k.message==="Timeout")try{return await y}catch{return}return}},[l,c]=await Promise.all([r(this.fetchProfile()),r(this.ndk.fetchEvent({kinds:[10019],authors:[this.pubkey]}))]),m=new Map;if(c){const y=NDKCashuMintList.from(c);y.mints.length>0&&m.set("nip61",{mints:y.mints,relays:y.relays,p2pk:y.p2pk})}if(l){const{lud06:y,lud16:_}=l;m.set("nip57",{lud06:y,lud16:_})}return m}static async fromNip05(e,r,l=!1){if(!r)throw new Error("No NDK instance found");const c={};l&&(c.cache="no-cache");const m=await getNip05For(r,e,r?.httpFetch,c);if(m){const y=new dh({pubkey:m.pubkey,relayUrls:m.relays,nip46Urls:m.nip46});return y.ndk=r,y}}async fetchProfile(e,r=!1){if(!this.ndk)throw new Error("NDK not set");let l=null;if(this.ndk.cacheAdapter&&(this.ndk.cacheAdapter.fetchProfile||this.ndk.cacheAdapter.fetchProfileSync)&&e?.cacheUsage!=="ONLY_RELAY"){let c=null;if(this.ndk.cacheAdapter.fetchProfileSync?c=this.ndk.cacheAdapter.fetchProfileSync(this.pubkey):this.ndk.cacheAdapter.fetchProfile&&(c=await this.ndk.cacheAdapter.fetchProfile(this.pubkey)),c)return this.profile=c,c}return e??={},e.cacheUsage??="ONLY_RELAY",e.closeOnEose??=!0,e.groupable??=!0,e.groupableDelay??=250,l||(l=await this.ndk.fetchEvent({kinds:[0],authors:[this.pubkey]},e)),l?(this.profile=profileFromEvent(l),r&&this.profile&&this.ndk.cacheAdapter&&this.ndk.cacheAdapter.saveProfile&&this.ndk.cacheAdapter.saveProfile(this.pubkey,this.profile),this.profile):null}follows=follows.bind(this);async followSet(e,r,l=3){const c=await this.follows(e,r,l);return new Set(Array.from(c).map(m=>m.pubkey))}tagReference(){return["p",this.pubkey]}referenceTags(e){const r=[["p",this.pubkey]];return e&&r[0].push("",e),r}async publish(){if(!this.ndk)throw new Error("No NDK instance found");if(!this.profile)throw new Error("No profile available");this.ndk.assertSigner(),await new NDKEvent(this.ndk,{kind:0,content:serializeProfile(this.profile)}).publish()}async follow(e,r,l=3){if(!this.ndk)throw new Error("No NDK instance found");if(this.ndk.assertSigner(),r||(r=await this.follows(void 0,void 0,l)),r.has(e))return!1;r.add(e);const c=new NDKEvent(this.ndk,{kind:l});for(const m of r)c.tag(m);return await c.publish(),!0}async unfollow(e,r,l=3){if(!this.ndk)throw new Error("No NDK instance found");this.ndk.assertSigner(),r||(r=await this.follows(void 0,void 0,l));const c=new Set;let m=!1;for(const _ of r)_.pubkey!==e.pubkey?c.add(_):m=!0;if(!m)return!1;const y=new NDKEvent(this.ndk,{kind:l});for(const _ of c)y.tag(_);return await y.publish()}async validateNip05(e){if(!this.ndk)throw new Error("No NDK instance found");const r=await getNip05For(this.ndk,e);return r===null?null:r.pubkey===this.pubkey}},READ_MARKER="read",WRITE_MARKER="write",NDKRelayList=class fh extends NDKEvent{constructor(e,r){super(e,r),this.kind??=10002}static from(e){return new fh(e.ndk,e.rawEvent())}get readRelayUrls(){return this.tags.filter(e=>e[0]==="r"||e[0]==="relay").filter(e=>!e[2]||e[2]&&e[2]===READ_MARKER).map(e=>tryNormalizeRelayUrl(e[1])).filter(e=>!!e)}set readRelayUrls(e){for(const r of e)this.tags.push(["r",r,READ_MARKER])}get writeRelayUrls(){return this.tags.filter(e=>e[0]==="r"||e[0]==="relay").filter(e=>!e[2]||e[2]&&e[2]===WRITE_MARKER).map(e=>tryNormalizeRelayUrl(e[1])).filter(e=>!!e)}set writeRelayUrls(e){for(const r of e)this.tags.push(["r",r,WRITE_MARKER])}get bothRelayUrls(){return this.tags.filter(e=>e[0]==="r"||e[0]==="relay").filter(e=>!e[2]).map(e=>e[1])}set bothRelayUrls(e){for(const r of e)this.tags.push(["r",r])}get relays(){return this.tags.filter(e=>e[0]==="r"||e[0]==="relay").map(e=>e[1])}get relaySet(){if(!this.ndk)throw new Error("NDKRelayList has no NDK instance");return new NDKRelaySet(new Set(this.relays.map(e=>this.ndk?.pool.getRelay(e)).filter(e=>!!e)),this.ndk)}};function relayListFromKind3(t,e){try{const r=JSON.parse(e.content),l=new NDKRelayList(t),c=new Set,m=new Set;for(let[y,_]of Object.entries(r)){try{y=normalizeRelayUrl(y)}catch{continue}if(!_)c.add(y),m.add(y);else{const w=_;w.write&&m.add(y),w.read&&c.add(y)}}return l.readRelayUrls=Array.from(c),l.writeRelayUrls=Array.from(m),l}catch{}}function disconnect(t,e){return e??=createDebug5("ndk:relay:auth-policies:disconnect"),async r=>{e?.(`Relay ${r.url} requested authentication, disconnecting`),t.removeRelay(r.url)}}async function signAndAuth(t,e,r,l,c,m){try{await t.sign(r),c(t)}catch(y){l?.(`Failed to publish auth event to relay ${e.url}`,y),m(t)}}function signIn({ndk:t,signer:e,debug:r}={}){return r??=createDebug5("ndk:auth-policies:signIn"),async(l,c)=>{r?.(`Relay ${l.url} requested authentication, signing in`);const m=new NDKEvent(t);return m.kind=22242,m.tags=[["relay",l.url],["challenge",c]],e??=t?.signer,new Promise(async(y,_)=>{e?await signAndAuth(m,l,e,r,y,_):t?.once("signer:ready",async w=>{await signAndAuth(m,l,w,r,y,_)})})}}var NDKRelayAuthPolicies={disconnect,signIn},NDKNip07Signer=class ph{_userPromise;encryptionQueue=[];encryptionProcessing=!1;debug;waitTimeout;_pubkey;ndk;_user;constructor(e=1e3,r){this.debug=createDebug5("ndk:nip07"),this.waitTimeout=e,this.ndk=r}get pubkey(){if(!this._pubkey)throw new Error("Not ready");return this._pubkey}async blockUntilReady(){await this.waitForExtension();const e=await window.nostr?.getPublicKey();if(!e)throw new Error("User rejected access");this._pubkey=e;let r;return this.ndk?r=this.ndk.getUser({pubkey:e}):r=new NDKUser({pubkey:e}),this._user=r,r}async user(){return this._userPromise||(this._userPromise=this.blockUntilReady()),this._userPromise}get userSync(){if(!this._user)throw new Error("User not ready");return this._user}async sign(e){await this.waitForExtension();const r=await window.nostr?.signEvent(e);if(!r)throw new Error("Failed to sign event");return r.sig}async relays(e){await this.waitForExtension();const r=await window.nostr?.getRelays?.()||{},l=[];for(const c of Object.keys(r))r[c].read&&r[c].write&&l.push(c);return l.map(c=>new NDKRelay(c,e?.relayAuthDefaultPolicy,e))}async encryptionEnabled(e){const r=[];return(!e||e==="nip04")&&window.nostr?.nip04&&r.push("nip04"),(!e||e==="nip44")&&window.nostr?.nip44&&r.push("nip44"),r}async encrypt(e,r,l="nip04"){if(!await this.encryptionEnabled(l))throw new Error(`${l}encryption is not available from your browser extension`);await this.waitForExtension();const c=e.pubkey;return this.queueEncryption(l,"encrypt",c,r)}async decrypt(e,r,l="nip04"){if(!await this.encryptionEnabled(l))throw new Error(`${l}encryption is not available from your browser extension`);await this.waitForExtension();const c=e.pubkey;return this.queueEncryption(l,"decrypt",c,r)}async queueEncryption(e,r,l,c){return new Promise((m,y)=>{this.encryptionQueue.push({scheme:e,method:r,counterpartyHexpubkey:l,value:c,resolve:m,reject:y}),this.encryptionProcessing||this.processEncryptionQueue()})}async processEncryptionQueue(e,r=0){if(!e&&this.encryptionQueue.length===0){this.encryptionProcessing=!1;return}this.encryptionProcessing=!0;const l=e||this.encryptionQueue.shift();if(!l){this.encryptionProcessing=!1;return}const{scheme:c,method:m,counterpartyHexpubkey:y,value:_,resolve:w,reject:k}=l;this.debug("Processing encryption queue item",{method:m,counterpartyHexpubkey:y,value:_});try{const C=await window.nostr?.[c]?.[m](y,_);if(!C)throw new Error("Failed to encrypt/decrypt");w(C)}catch(C){const R=C instanceof Error?C.message:String(C);if(R.includes("call already executing")&&r<5){this.debug("Retrying encryption queue item",{method:m,counterpartyHexpubkey:y,value:_,retries:r}),setTimeout(()=>{this.processEncryptionQueue(l,r+1)},50*r);return}k(C instanceof Error?C:new Error(R))}this.processEncryptionQueue()}waitForExtension(){return new Promise((e,r)=>{if(window.nostr){e();return}let l;const c=setInterval(()=>{window.nostr&&(clearTimeout(l),clearInterval(c),e())},100);l=setTimeout(()=>{clearInterval(c),r(new Error("NIP-07 extension not available"))},this.waitTimeout)})}toPayload(){return JSON.stringify({type:"nip07",payload:""})}static async fromPayload(e,r){const l=JSON.parse(e);if(l.type!=="nip07")throw new Error(`Invalid payload type: expected 'nip07', got ${l.type}`);return new ph(void 0,r)}};registerSigner("nip07",NDKNip07Signer);var NDKNostrRpc=class extends libExports.EventEmitter{ndk;signer;relaySet;debug;encryptionType="nip04";pool;constructor(t,e,r,l){if(super(),this.ndk=t,this.signer=e,l){this.pool=new NDKPool(l,[],t,{debug:r.extend("rpc-pool"),name:"Nostr RPC"}),this.relaySet=new NDKRelaySet(new Set,t,this.pool);for(const c of l){const m=this.pool.getRelay(c,!1,!1);m.authPolicy=NDKRelayAuthPolicies.signIn({ndk:t,signer:e,debug:r}),this.relaySet.addRelay(m),m.connect()}}this.debug=r.extend("rpc")}subscribe(t){const e=this.ndk.subscribe(t,{closeOnEose:!1,groupable:!1,cacheUsage:"ONLY_RELAY",pool:this.pool,relaySet:this.relaySet},!1);return e.on("event",async r=>{try{const l=await this.parseEvent(r);l.method?this.emit("request",l):(this.emit(`response-${l.id}`,l),this.emit("response",l))}catch(l){this.debug("error parsing event",l,r.rawEvent())}}),new Promise(r=>{e.on("eose",()=>{this.debug("eosed"),r(e)}),e.start()})}async parseEvent(t){this.encryptionType==="nip44"&&t.content.includes("?iv=")?this.encryptionType="nip04":this.encryptionType==="nip04"&&!t.content.includes("?iv=")&&(this.encryptionType="nip44");const e=this.ndk.getUser({pubkey:t.pubkey});e.ndk=this.ndk;let r;try{r=await this.signer.decrypt(e,t.content,this.encryptionType)}catch{const C=this.encryptionType==="nip04"?"nip44":"nip04";r=await this.signer.decrypt(e,t.content,C),this.encryptionType=C}const l=JSON.parse(r),{id:c,method:m,params:y,result:_,error:w}=l;return m?{id:c,pubkey:t.pubkey,method:m,params:y,event:t}:{id:c,result:_,error:w,event:t}}async sendResponse(t,e,r,l=24133,c){const m={id:t,result:r};c&&(m.error=c);const y=await this.signer.user(),_=this.ndk.getUser({pubkey:e}),w=new NDKEvent(this.ndk,{kind:l,content:JSON.stringify(m),tags:[["p",e]],pubkey:y.pubkey});w.content=await this.signer.encrypt(_,w.content,this.encryptionType),await w.sign(this.signer),await w.publish(this.relaySet)}async sendRequest(t,e,r=[],l=24133,c){const m=Math.random().toString(36).substring(7),y=await this.signer.user(),_=this.ndk.getUser({pubkey:t}),w={id:m,method:e,params:r},k=new Promise(()=>{const R=T=>{T.result==="auth_url"?(this.once(`response-${m}`,R),this.emit("authUrl",T.error)):c&&c(T)};this.once(`response-${m}`,R)}),C=new NDKEvent(this.ndk,{kind:l,content:JSON.stringify(w),tags:[["p",t]],pubkey:y.pubkey});return C.content=await this.signer.encrypt(_,C.content,this.encryptionType),await C.sign(this.signer),await C.publish(this.relaySet),k}};async function ndkSignerFromPayload(t,e){let r;try{r=JSON.parse(t)}catch(c){console.error("Failed to parse signer payload string",t,c);return}if(!r||typeof r.type!="string"){console.error("Failed to parse signer payload string",t,new Error("Missing type field"));return}const l=signerRegistry.get(r.type);if(!l)throw new Error(`Unknown signer type: ${r.type}`);try{return await l.fromPayload(t,e)}catch(c){const m=c instanceof Error?c.message:String(c);throw new Error(`Failed to deserialize signer type ${r.type}: ${m}`)}}function nostrConnectGenerateSecret(){return Math.random().toString(36).substring(2,15)}function generateNostrConnectUri(t,e,r,l){const c={name:l?.name?encodeURIComponent(l.name):"",url:l?.url?encodeURIComponent(l.url):"",image:l?.image?encodeURIComponent(l.image):"",perms:l?.perms?encodeURIComponent(l.perms):""};let m=`nostrconnect://${t}?image=${c.image}&url=${c.url}&name=${c.name}&perms=${c.perms}&secret=${encodeURIComponent(e)}`;return r&&(m+=`&relay=${encodeURIComponent(r)}`),m}var NDKNip46Signer=class za extends libExports.EventEmitter{ndk;_user;bunkerPubkey;userPubkey;get pubkey(){if(!this.userPubkey)throw new Error("Not ready");return this.userPubkey}secret;localSigner;nip05;rpc;debug;relayUrls;subscription;nostrConnectUri;nostrConnectSecret;constructor(e,r,l,c,m){super(),this.ndk=e,this.debug=e.debug.extend("nip46:signer"),this.relayUrls=c,l?typeof l=="string"?this.localSigner=new NDKPrivateKeySigner(l):this.localSigner=l:this.localSigner=NDKPrivateKeySigner.generate(),r===!1||(r?r.startsWith("bunker://")?this.bunkerFlowInit(r):this.nip05Init(r):this.nostrconnectFlowInit(m)),this.rpc=new NDKNostrRpc(this.ndk,this.localSigner,this.debug,this.relayUrls)}static bunker(e,r,l){return new za(e,r,l)}static nostrconnect(e,r,l,c){return new za(e,void 0,l,[r],c)}nostrconnectFlowInit(e){this.nostrConnectSecret=nostrConnectGenerateSecret();const r=this.localSigner.pubkey;this.nostrConnectUri=generateNostrConnectUri(r,this.nostrConnectSecret,this.relayUrls?.[0],e)}bunkerFlowInit(e){const r=new URL(e),l=r.hostname||r.pathname.replace(/^\/\//,""),c=r.searchParams.get("pubkey"),m=r.searchParams.getAll("relay"),y=r.searchParams.get("secret");this.bunkerPubkey=l,this.userPubkey=c,this.relayUrls=m,this.secret=y}nip05Init(e){this.nip05=e}async startListening(){if(this.subscription)return;const e=await this.localSigner.user();if(!e)throw new Error("Local signer not ready");this.subscription=await this.rpc.subscribe({kinds:[24133],"#p":[e.pubkey]})}async user(){return this._user?this._user:this.blockUntilReady()}get userSync(){if(!this._user)throw new Error("Remote user not ready synchronously");return this._user}async blockUntilReadyNostrConnect(){return new Promise((e,r)=>{const l=c=>{c.result===this.nostrConnectSecret&&(this._user=c.event.author,this.userPubkey=c.event.pubkey,this.bunkerPubkey=c.event.pubkey,this.rpc.off("response",l),e(this._user))};this.startListening(),this.rpc.on("response",l)})}async blockUntilReady(){if(!this.bunkerPubkey&&!this.nostrConnectSecret&&!this.nip05)throw new Error("Bunker pubkey not set");if(this.nostrConnectSecret)return this.blockUntilReadyNostrConnect();if(this.nip05&&!this.userPubkey){const e=await NDKUser.fromNip05(this.nip05,this.ndk);e&&(this._user=e,this.userPubkey=e.pubkey,this.relayUrls=e.nip46Urls,this.rpc=new NDKNostrRpc(this.ndk,this.localSigner,this.debug,this.relayUrls))}if(!this.bunkerPubkey&&this.userPubkey)this.bunkerPubkey=this.userPubkey;else if(!this.bunkerPubkey)throw new Error("Bunker pubkey not set");return await this.startListening(),this.rpc.on("authUrl",(...e)=>{this.emit("authUrl",...e)}),new Promise((e,r)=>{const l=[this.userPubkey??""];if(this.secret&&l.push(this.secret),!this.bunkerPubkey)throw new Error("Bunker pubkey not set");this.rpc.sendRequest(this.bunkerPubkey,"connect",l,24133,c=>{c.result==="ack"?this.getPublicKey().then(m=>{this.userPubkey=m,this._user=this.ndk.getUser({pubkey:m}),e(this._user)}):r(c.error)})})}stop(){this.subscription?.stop(),this.subscription=void 0}async getPublicKey(){return this.userPubkey?this.userPubkey:new Promise((e,r)=>{if(!this.bunkerPubkey)throw new Error("Bunker pubkey not set");this.rpc.sendRequest(this.bunkerPubkey,"get_public_key",[],24133,l=>{e(l.result)})})}async encryptionEnabled(e){return e?[e]:Promise.resolve(["nip04","nip44"])}async encrypt(e,r,l="nip04"){return this.encryption(e,r,l,"encrypt")}async decrypt(e,r,l="nip04"){return this.encryption(e,r,l,"decrypt")}async encryption(e,r,l,c){return new Promise((y,_)=>{if(!this.bunkerPubkey)throw new Error("Bunker pubkey not set");this.rpc.sendRequest(this.bunkerPubkey,`${l}_${c}`,[e.pubkey,r],24133,w=>{w.error?_(w.error):y(w.result)})})}async sign(e){return new Promise((l,c)=>{if(!this.bunkerPubkey)throw new Error("Bunker pubkey not set");this.rpc.sendRequest(this.bunkerPubkey,"sign_event",[JSON.stringify(e)],24133,m=>{if(m.error)c(m.error);else{const y=JSON.parse(m.result);l(y.sig)}})})}async createAccount(e,r,l){await this.startListening();const c=[];return e&&c.push(e),r&&c.push(r),l&&c.push(l),new Promise((m,y)=>{if(!this.bunkerPubkey)throw new Error("Bunker pubkey not set");this.rpc.sendRequest(this.bunkerPubkey,"create_account",c,24133,_=>{if(_.error)y(_.error);else{const w=_.result;m(w)}})})}toPayload(){if(!this.bunkerPubkey||!this.userPubkey)throw new Error("NIP-46 signer is not fully initialized for serialization");const e={type:"nip46",payload:{bunkerPubkey:this.bunkerPubkey,userPubkey:this.userPubkey,relayUrls:this.relayUrls,secret:this.secret,localSignerPayload:this.localSigner.toPayload(),nip05:this.nip05||null}};return JSON.stringify(e)}static async fromPayload(e,r){if(!r)throw new Error("NDK instance is required to deserialize NIP-46 signer");const l=JSON.parse(e);if(l.type!=="nip46")throw new Error(`Invalid payload type: expected 'nip46', got ${l.type}`);const c=l.payload;if(!c||typeof c!="object"||!c.localSignerPayload)throw new Error("Invalid payload content for nip46 signer");const m=await ndkSignerFromPayload(c.localSignerPayload,r);if(!m)throw new Error("Failed to deserialize local signer for NIP-46");if(!(m instanceof NDKPrivateKeySigner))throw new Error("Local signer must be an instance of NDKPrivateKeySigner");let y;return y=new za(r,!1,m,c.relayUrls),y.userPubkey=c.userPubkey,y.bunkerPubkey=c.bunkerPubkey,y.relayUrls=c.relayUrls,y.secret=c.secret,c.userPubkey&&(y._user=new NDKUser({pubkey:c.userPubkey}),y._user&&(y._user.ndk=r)),y}};registerSigner("nip46",NDKNip46Signer);function dedup(t,e){return t.created_at>e.created_at?t:e}async function getRelayListForUser(t,e){return(await getRelayListForUsers([t],e)).get(t)}async function getRelayListForUsers(t,e,r=!1,l=1e3){const c=e.outboxPool||e.pool,m=new Set;for(const R of c.relays.values())m.add(R);const y=new Map,_=new Map,w=new NDKRelaySet(m,e);if(e.cacheAdapter?.locking&&!r){const R=await e.fetchEvents({kinds:[3,10002],authors:Array.from(new Set(t))},{cacheUsage:"ONLY_CACHE",subId:"ndk-relay-list-fetch"});for(const T of R)T.kind===10002&&y.set(T.pubkey,NDKRelayList.from(T));for(const T of R)if(T.kind===3){if(y.has(T.pubkey))continue;const A=relayListFromKind3(e,T);A&&_.set(T.pubkey,A)}t=t.filter(T=>!y.has(T)&&!_.has(T))}if(t.length===0)return y;const k=new Map,C=new Map;return new Promise(R=>{(async()=>{const A={closeOnEose:!0,pool:c,groupable:!0,subId:"ndk-relay-list-fetch",addSinceFromCache:!0,relaySet:w};w&&(A.relaySet=w),e.subscribe({kinds:[3,10002],authors:t},A,{onEvent:M=>{if(M.kind===10002){const B=k.get(M.pubkey);if(B&&B.created_at>M.created_at)return;k.set(M.pubkey,M)}else if(M.kind===3){const B=C.get(M.pubkey);if(B&&B.created_at>M.created_at)return;C.set(M.pubkey,M)}},onEose:()=>{for(const M of k.values())y.set(M.pubkey,NDKRelayList.from(M));for(const M of t){if(y.has(M))continue;const B=C.get(M);if(!B)continue;const j=relayListFromKind3(e,B);j&&y.set(M,j)}R(y)}}),setTimeout(()=>{R(y)},l)})()})}var OutboxItem=class{type;relayUrlScores;readRelays;writeRelays;constructor(t){this.type=t,this.relayUrlScores=new Map,this.readRelays=new Set,this.writeRelays=new Set}},OutboxTracker=class extends libExports.EventEmitter{data;ndk;debug;constructor(t){super(),this.ndk=t,this.debug=t.debug.extend("outbox-tracker"),this.data=new distExports.LRUCache({maxSize:1e5,entryExpirationTimeInMS:120*1e3})}async trackUsers(t,e=!1){const r=[];for(let l=0;l<t.length;l+=400){const m=t.slice(l,l+400).map(y=>getKeyFromItem(y)).filter(y=>!this.data.has(y));if(m.length!==0){for(const y of m)this.data.set(y,new OutboxItem("user"));r.push(new Promise(y=>{getRelayListForUsers(m,this.ndk,e).then(_=>{for(const[w,k]of _){let C=this.data.get(w);if(C??=new OutboxItem("user"),k){C.readRelays=new Set(normalize(k.readRelayUrls)),C.writeRelays=new Set(normalize(k.writeRelayUrls));for(const R of C.readRelays)this.ndk.pool.blacklistRelayUrls.has(R)&&C.readRelays.delete(R);for(const R of C.writeRelays)this.ndk.pool.blacklistRelayUrls.has(R)&&C.writeRelays.delete(R);this.data.set(w,C)}}}).finally(y)}))}}return Promise.all(r)}track(t,e,r=!0){const l=getKeyFromItem(t);e??=getTypeFromItem(t);let c=this.data.get(l);return c||(c=new OutboxItem(e),t instanceof NDKUser&&this.trackUsers([t])),c}};function getKeyFromItem(t){return t instanceof NDKUser?t.pubkey:t}function getTypeFromItem(t){return t instanceof NDKUser?"user":"kind"}function correctRelaySet(t,e){const r=e.connectedRelays();if(!Array.from(t.relays).some(c=>r.map(m=>m.url).includes(c.url)))for(const c of r)t.addRelay(c);if(r.length===0)for(const c of e.relays.values())t.addRelay(c);return t}var NDKSubscriptionManager=class{subscriptions;seenEvents=new Map;constructor(){this.subscriptions=new Map}add(t){this.subscriptions.set(t.internalId,t),t.onStopped,t.onStopped=()=>{this.subscriptions.delete(t.internalId)},t.on("close",()=>{this.subscriptions.delete(t.internalId)})}seenEvent(t,e){const r=this.seenEvents.get(t)||[];r.push(e),this.seenEvents.set(t,r)}dispatchEvent(t,e,r=!1){e&&this.seenEvent(t.id,e);const l=this.subscriptions.values(),c=[];for(const m of l)matchFilters(m.filters,t)&&c.push(m);for(const m of c)m.eventReceived(t,e,!1,r)}},debug7=createDebug5("ndk:active-user");async function getUserRelayList(t){if(!this.autoConnectUserRelays)return;const e=await getRelayListForUser(t.pubkey,this);if(e){for(const r of e.relays){let l=this.pool.relays.get(r);l||(l=new NDKRelay(r,this.relayAuthDefaultPolicy,this),this.pool.addRelay(l))}return e}}async function setActiveUser(t){const e=this.outboxPool||this.pool;e.connectedRelays.length>0?setActiveUserConnected.call(this,t):e.once("connect",()=>{setActiveUserConnected.call(this,t)})}async function setActiveUserConnected(t){const e=await getUserRelayList.call(this,t),r=[{kinds:[10006],authors:[t.pubkey]}];this.autoFetchUserMutelist&&r[0].kinds?.push(1e4);const l=new Map,c=e?e.relaySet:void 0;this.subscribe(r,{subId:"active-user-settings",closeOnEose:!0,relaySet:c},{onEvent:m=>{const y=l.get(m.kind);y&&y.created_at>=m.created_at||l.set(m.kind,m)},onEose:()=>{for(const m of l.values())processEvent.call(this,m)}})}async function processEvent(t){t.kind===10006?processBlockRelayList.call(this,t):t.kind===1e4&&processMuteList.call(this,t)}function processBlockRelayList(t){const e=lists_default.from(t);for(const r of e.items)this.pool.blacklistRelayUrls.add(r[0]);debug7("Added %d relays to relay blacklist",e.items.length)}function processMuteList(t){const e=lists_default.from(t);for(const r of e.items)this.mutedIds.set(r[1],r[0]);debug7("Added %d users to mute list",e.items.length)}function getEntity(t){try{const e=nip19_exports.decode(t);return e.type==="npub"?npub(this,e.data):e.type==="nprofile"?nprofile(this,e.data):e}catch{return null}}function npub(t,e){return t.getUser({pubkey:e})}function nprofile(t,e){const r=t.getUser({pubkey:e.pubkey});return e.relays&&(r.relayUrls=e.relays),r}function isValidHint(t){if(!t||t==="")return!1;try{return new URL(t),!0}catch{return!1}}async function fetchEventFromTag(t,e,r,l={type:"timeout"}){const c=this.debug.extend("fetch-event-from-tag"),[m,y,_]=t;r={},c("fetching event from tag",t,r,l);const w=getRelaysForSync(this,e.pubkey);if(w&&w.size>0){c("fetching event from author relays %o",Array.from(w));const B=NDKRelaySet.fromRelayUrls(Array.from(w),this),j=await this.fetchEvent(y,r,B);if(j)return j}else c("no author relays found for %s",e.pubkey,e);const k=calculateRelaySetsFromFilters(this,[{ids:[y]}],this.pool);c("fetching event without relay hint",k);const C=await this.fetchEvent(y,r);if(C)return C;if(_&&_!==""){const B=await this.fetchEvent(y,r,this.pool.getRelay(_,!0,!0,[{ids:[y]}]));if(B)return B}let R;const T=isValidHint(_)?this.pool.getRelay(_,!1,!0,[{ids:[y]}]):void 0,A=new Promise(B=>{this.fetchEvent(y,r,T).then(B)});if(!isValidHint(_)||l.type==="none")return A;const M=new Promise(async B=>{const j=l.relaySet,re=l.timeout??1500,de=new Promise(se=>setTimeout(se,re));if(l.type==="timeout"&&await de,R)B(R);else{c("fallback fetch triggered");const se=await this.fetchEvent(y,r,j);B(se)}});switch(l.type){case"timeout":return Promise.race([A,M]);case"eose":return R=await A,R||M}}var Queue=class{queue=[];maxConcurrency;processing=new Set;promises=new Map;constructor(t,e){this.maxConcurrency=e}add(t){if(this.promises.has(t.id))return this.promises.get(t.id);const e=new Promise((r,l)=>{this.queue.push({...t,func:()=>t.func().then(c=>(r(c),c),c=>{throw l(c),c})}),this.process()});return this.promises.set(t.id,e),e.finally(()=>{this.promises.delete(t.id),this.processing.delete(t.id),this.process()}),e}process(){if(this.processing.size>=this.maxConcurrency||this.queue.length===0)return;const t=this.queue.shift();!t||this.processing.has(t.id)||(this.processing.add(t.id),t.func())}clear(){this.queue=[]}clearProcessing(){this.processing.clear()}clearAll(){this.clear(),this.clearProcessing()}length(){return this.queue.length}},DEFAULT_OUTBOX_RELAYS=["wss://purplepag.es/","wss://nos.lol/"],DEFAULT_BLACKLISTED_RELAYS=["wss://brb.io/","wss://nostr.mutinywallet.com/"],NDK=class extends libExports.EventEmitter{_explicitRelayUrls;blacklistRelayUrls;pool;outboxPool;_signer;_activeUser;cacheAdapter;debug;devWriteRelaySet;outboxTracker;mutedIds;clientName;clientNip89;queuesZapConfig;queuesNip05;asyncSigVerification=!1;initialValidationRatio=1;lowestValidationRatio=.1;validationRatioFn;autoBlacklistInvalidRelays=!1;subManager;_signatureVerificationFunction;_signatureVerificationWorker;signatureVerificationTimeMs=0;publishingFailureHandled=!1;pools=[];relayAuthDefaultPolicy;httpFetch;netDebug;autoConnectUserRelays=!0;autoFetchUserMutelist=!0;walletConfig;constructor(t={}){super(),this.debug=t.debug||createDebug5("ndk"),this.netDebug=t.netDebug,this._explicitRelayUrls=t.explicitRelayUrls||[],this.blacklistRelayUrls=t.blacklistRelayUrls||DEFAULT_BLACKLISTED_RELAYS,this.subManager=new NDKSubscriptionManager,this.pool=new NDKPool(t.explicitRelayUrls||[],[],this),this.pool.name="Main",this.pool.on("relay:auth",async(e,r)=>{this.relayAuthDefaultPolicy&&await this.relayAuthDefaultPolicy(e,r)}),this.autoConnectUserRelays=t.autoConnectUserRelays??!0,this.autoFetchUserMutelist=t.autoFetchUserMutelist??!0,this.clientName=t.clientName,this.clientNip89=t.clientNip89,this.relayAuthDefaultPolicy=t.relayAuthDefaultPolicy,t.enableOutboxModel&&(this.outboxPool=new NDKPool(t.outboxRelayUrls||DEFAULT_OUTBOX_RELAYS,[],this,{debug:this.debug.extend("outbox-pool"),name:"Outbox Pool"}),this.outboxTracker=new OutboxTracker(this)),this.signer=t.signer,this.cacheAdapter=t.cacheAdapter,this.mutedIds=t.mutedIds||new Map,t.devWriteRelayUrls&&(this.devWriteRelaySet=NDKRelaySet.fromRelayUrls(t.devWriteRelayUrls,this)),this.queuesZapConfig=new Queue("zaps",3),this.queuesNip05=new Queue("nip05",10),t.signatureVerificationWorker&&(this.signatureVerificationWorker=t.signatureVerificationWorker),t.signatureVerificationFunction&&(this.signatureVerificationFunction=t.signatureVerificationFunction),this.initialValidationRatio=t.initialValidationRatio||1,this.lowestValidationRatio=t.lowestValidationRatio||.1,this.autoBlacklistInvalidRelays=t.autoBlacklistInvalidRelays||!1,this.validationRatioFn=t.validationRatioFn||this.defaultValidationRatioFn;try{this.httpFetch=fetch}catch{}}set explicitRelayUrls(t){this._explicitRelayUrls=t.map(normalizeRelayUrl),this.pool.relayUrls=t}get explicitRelayUrls(){return this._explicitRelayUrls||[]}set signatureVerificationWorker(t){this._signatureVerificationWorker=t,t?(signatureVerificationInit(t),this.asyncSigVerification=!0):this.asyncSigVerification=!1}set signatureVerificationFunction(t){this._signatureVerificationFunction=t,this.asyncSigVerification=!!t}get signatureVerificationFunction(){return this._signatureVerificationFunction}addExplicitRelay(t,e,r=!0){let l;return typeof t=="string"?l=new NDKRelay(t,e,this):l=t,this.pool.addRelay(l,r),this.explicitRelayUrls?.push(l.url),l}toJSON(){return{relayCount:this.pool.relays.size}.toString()}get activeUser(){return this._activeUser}set activeUser(t){const e=this._activeUser?.pubkey!==t?.pubkey;this._activeUser=t,t&&e?setActiveUser.call(this,t):t||(this.mutedIds=new Map)}get signer(){return this._signer}set signer(t){this._signer=t,t&&this.emit("signer:ready",t),t?.user().then(e=>{e.ndk=this,this.activeUser=e})}async connect(t){this._signer&&this.autoConnectUserRelays&&(this.debug("Attempting to connect to user relays specified by signer %o",await this._signer.relays?.(this)),this._signer.relays&&(await this._signer.relays(this)).forEach(l=>this.pool.addRelay(l)));const e=[this.pool.connect(t)];return this.outboxPool&&e.push(this.outboxPool.connect(t)),Promise.allSettled(e).then(()=>{})}reportInvalidSignature(t,e){this.debug(`Invalid signature detected for event ${t.id}${e?` from relay ${e.url}`:""}`),this.emit("event:invalid-sig",t,e),this.autoBlacklistInvalidRelays&&e&&this.blacklistRelay(e.url)}blacklistRelay(t){if(this.blacklistRelayUrls||(this.blacklistRelayUrls=[]),!this.blacklistRelayUrls.includes(t)){this.blacklistRelayUrls.push(t),this.debug(`Added relay to blacklist: ${t}`);const e=this.pool.getRelay(t,!1,!1);e&&(e.disconnect(),this.debug(`Disconnected from blacklisted relay: ${t}`))}}defaultValidationRatioFn(t,e,r){if(e<10)return this.initialValidationRatio;const l=Math.min(e/100,1),c=this.initialValidationRatio*(1-l)+this.lowestValidationRatio*l;return Math.max(c,this.lowestValidationRatio)}getUser(t){const e=new NDKUser(t);return e.ndk=this,e}async getUserFromNip05(t,e=!1){return NDKUser.fromNip05(t,this,e)}subscribe(t,e,r=!0,l=!0){let c=e?.relaySet,m=l;r instanceof NDKRelaySet?(console.warn("relaySet is deprecated, use opts.relaySet instead. This will be removed in version v2.14.0"),c=r,m=l):(typeof r=="boolean"||typeof r=="object")&&(m=r);const y=new NDKSubscription(this,t,{relaySet:c,...e});this.subManager.add(y);const _=y.pool;if(y.relaySet)for(const w of y.relaySet.relays)_.useTemporaryRelay(w,void 0,y.filters);if(this.outboxPool&&y.hasAuthorsFilter()){const w=y.filters.filter(k=>k.authors&&k.authors?.length>0).flatMap(k=>k.authors);this.outboxTracker?.trackUsers(w)}if(m){let w;typeof m=="object"&&(m.onEvent&&y.on("event",m.onEvent),m.onEose&&y.on("eose",m.onEose),m.onEvents&&(w=m.onEvents)),setTimeout(()=>{const k=y.start(!w);k&&k.length>0&&w&&w(k)},0)}return y}fetchEventFromTag=fetchEventFromTag.bind(this);fetchEventSync(t){if(!this.cacheAdapter)throw new Error("Cache adapter not set");let e;typeof t=="string"?e=[filterFromId(t)]:e=t;const r=new NDKSubscription(this,e),l=this.cacheAdapter.query(r);if(l instanceof Promise)throw new Error("Cache adapter is async");return l.map(c=>(c.ndk=this,c))}async fetchEvent(t,e,r){let l,c;if(r instanceof NDKRelay?c=new NDKRelaySet(new Set([r]),this):r instanceof NDKRelaySet&&(c=r),!r&&typeof t=="string"&&!isNip33AValue(t)){const m=relaysFromBech32(t,this);m.length>0&&(c=new NDKRelaySet(new Set(m),this),c=correctRelaySet(c,this.pool))}if(typeof t=="string"?l=[filterFromId(t)]:Array.isArray(t)?l=t:l=[t],l.length===0)throw new Error(`Invalid filter: ${JSON.stringify(t)}`);return new Promise(m=>{let y=null;const _={...e||{},closeOnEose:!0};c&&(_.relaySet=c);const w=this.subscribe(l,_,!1),k=setTimeout(()=>{w.stop(),m(y)},1e4);w.on("event",C=>{C.ndk=this,C.isReplaceable()?(!y||y.created_at<C.created_at)&&(y=C):(clearTimeout(k),m(C))}),w.on("eose",()=>{clearTimeout(k),m(y)}),w.start()})}async fetchEvents(t,e,r){return new Promise(l=>{const c=new Map,m={...e||{},closeOnEose:!0};r&&(m.relaySet=r);const y=this.subscribe(t,m,!1),_=w=>{let k;w instanceof NDKEvent?k=w:k=new NDKEvent(void 0,w);const C=k.deduplicationKey(),R=c.get(C);R&&(k=dedup(R,k)),k.ndk=this,c.set(C,k)};y.on("event",_),y.on("eose",()=>{l(new Set(c.values()))}),y.start()})}assertSigner(){if(!this.signer)throw this.emit("signer:required"),new Error("Signer required")}getEntity=getEntity.bind(this);set wallet(t){if(!t){this.walletConfig=void 0;return}this.walletConfig??={},this.walletConfig.lnPay=t?.lnPay?.bind(t),this.walletConfig.cashuPay=t?.cashuPay?.bind(t)}};createDebug5("ndk:zapper:ln");createDebug5("ndk:zapper");const NDKContext=reactExports.createContext(null),NostrProvider=({children:t})=>{const[e,r]=reactExports.useState(null),[l]=reactExports.useState(()=>new NDK({explicitRelayUrls:["wss://relay.damus.io","wss://relay.primal.net","wss://nos.lol"]})),[c]=reactExports.useState(()=>NDKPrivateKeySigner.generate());reactExports.useEffect(()=>{l.connect()},[l]);const m=async k=>{l.signer=k;const C=await k.user();r(C)},y=async()=>{if(window.nostr)try{const k=new NDKNip07Signer;await m(k)}catch(k){console.error("Failed to get NIP-07 signer",k)}else console.log("Nostr extension not found, modal should open.")},_=k=>{const C=new NDKPrivateKeySigner(k);m(C)},w=()=>{l.signer=void 0,r(null)};return jsxRuntimeExports.jsx(NDKContext.Provider,{value:{ndk:l,login:y,loginWithNsec:_,logout:w,user:e,tempSigner:c,setSigner:m},children:t})},useNDK=()=>{const t=reactExports.useContext(NDKContext);if(!t)throw new Error("useNDK must be used within a NostrProvider");return t};function useAttribution(t,e){const r=reactExports.useRef(e);reactExports.useEffect(function(){e!==r.current&&t.attributionControl!=null&&(r.current!=null&&t.attributionControl.removeAttribution(r.current),e!=null&&t.attributionControl.addAttribution(e)),r.current=e},[t,e])}function updateCircle(t,e,r){e.center!==r.center&&t.setLatLng(e.center),e.radius!=null&&e.radius!==r.radius&&t.setRadius(e.radius)}var reactDomExports=requireReactDom();const CONTEXT_VERSION=1;function createLeafletContext(t){return Object.freeze({__version:CONTEXT_VERSION,map:t})}function extendContext(t,e){return Object.freeze({...t,...e})}const LeafletContext=reactExports.createContext(null),LeafletProvider=LeafletContext.Provider;function useLeafletContext(){const t=reactExports.useContext(LeafletContext);if(t==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return t}function createContainerComponent(t){function e(r,l){const{instance:c,context:m}=t(r).current;return reactExports.useImperativeHandle(l,()=>c),r.children==null?null:React.createElement(LeafletProvider,{value:m},r.children)}return reactExports.forwardRef(e)}function createDivOverlayComponent(t){function e(r,l){const[c,m]=reactExports.useState(!1),{instance:y}=t(r,m).current;reactExports.useImperativeHandle(l,()=>y),reactExports.useEffect(function(){c&&y.update()},[y,c,r.children]);const _=y._contentNode;return _?reactDomExports.createPortal(r.children,_):null}return reactExports.forwardRef(e)}function createLeafComponent(t){function e(r,l){const{instance:c}=t(r).current;return reactExports.useImperativeHandle(l,()=>c),null}return reactExports.forwardRef(e)}function useEventHandlers(t,e){const r=reactExports.useRef();reactExports.useEffect(function(){return e!=null&&t.instance.on(e),r.current=e,function(){r.current!=null&&t.instance.off(r.current),r.current=null}},[t,e])}function withPane(t,e){const r=t.pane??e.pane;return r?{...t,pane:r}:t}function createDivOverlayHook(t,e){return function(l,c){const m=useLeafletContext(),y=t(withPane(l,m),m);return useAttribution(m.map,l.attribution),useEventHandlers(y.current,l.eventHandlers),e(y.current,m,l,c),y}}var leafletSrc$1={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */var leafletSrc=leafletSrc$1.exports,hasRequiredLeafletSrc;function requireLeafletSrc(){return hasRequiredLeafletSrc||(hasRequiredLeafletSrc=1,(function(t,e){(function(r,l){l(e)})(leafletSrc,(function(r){var l="1.9.4";function c(o){var h,g,x,S;for(g=1,x=arguments.length;g<x;g++){S=arguments[g];for(h in S)o[h]=S[h]}return o}var m=Object.create||(function(){function o(){}return function(h){return o.prototype=h,new o}})();function y(o,h){var g=Array.prototype.slice;if(o.bind)return o.bind.apply(o,g.call(arguments,1));var x=g.call(arguments,2);return function(){return o.apply(h,x.length?x.concat(g.call(arguments)):arguments)}}var _=0;function w(o){return"_leaflet_id"in o||(o._leaflet_id=++_),o._leaflet_id}function k(o,h,g){var x,S,N,H;return H=function(){x=!1,S&&(N.apply(g,S),S=!1)},N=function(){x?S=arguments:(o.apply(g,arguments),setTimeout(H,h),x=!0)},N}function C(o,h,g){var x=h[1],S=h[0],N=x-S;return o===x&&g?o:((o-S)%N+N)%N+S}function R(){return!1}function T(o,h){if(h===!1)return o;var g=Math.pow(10,h===void 0?6:h);return Math.round(o*g)/g}function A(o){return o.trim?o.trim():o.replace(/^\s+|\s+$/g,"")}function M(o){return A(o).split(/\s+/)}function B(o,h){Object.prototype.hasOwnProperty.call(o,"options")||(o.options=o.options?m(o.options):{});for(var g in h)o.options[g]=h[g];return o.options}function j(o,h,g){var x=[];for(var S in o)x.push(encodeURIComponent(g?S.toUpperCase():S)+"="+encodeURIComponent(o[S]));return(!h||h.indexOf("?")===-1?"?":"&")+x.join("&")}var re=/\{ *([\w_ -]+) *\}/g;function de(o,h){return o.replace(re,function(g,x){var S=h[x];if(S===void 0)throw new Error("No value provided for variable "+g);return typeof S=="function"&&(S=S(h)),S})}var se=Array.isArray||function(o){return Object.prototype.toString.call(o)==="[object Array]"};function ye(o,h){for(var g=0;g<o.length;g++)if(o[g]===h)return g;return-1}var z="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function W(o){return window["webkit"+o]||window["moz"+o]||window["ms"+o]}var Q=0;function te(o){var h=+new Date,g=Math.max(0,16-(h-Q));return Q=h+g,window.setTimeout(o,g)}var le=window.requestAnimationFrame||W("RequestAnimationFrame")||te,me=window.cancelAnimationFrame||W("CancelAnimationFrame")||W("CancelRequestAnimationFrame")||function(o){window.clearTimeout(o)};function F(o,h,g){if(g&&le===te)o.call(h);else return le.call(window,y(o,h))}function K(o){o&&me.call(window,o)}var D={__proto__:null,extend:c,create:m,bind:y,get lastId(){return _},stamp:w,throttle:k,wrapNum:C,falseFn:R,formatNum:T,trim:A,splitWords:M,setOptions:B,getParamString:j,template:de,isArray:se,indexOf:ye,emptyImageUrl:z,requestFn:le,cancelFn:me,requestAnimFrame:F,cancelAnimFrame:K};function Y(){}Y.extend=function(o){var h=function(){B(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},g=h.__super__=this.prototype,x=m(g);x.constructor=h,h.prototype=x;for(var S in this)Object.prototype.hasOwnProperty.call(this,S)&&S!=="prototype"&&S!=="__super__"&&(h[S]=this[S]);return o.statics&&c(h,o.statics),o.includes&&($(o.includes),c.apply(null,[x].concat(o.includes))),c(x,o),delete x.statics,delete x.includes,x.options&&(x.options=g.options?m(g.options):{},c(x.options,o.options)),x._initHooks=[],x.callInitHooks=function(){if(!this._initHooksCalled){g.callInitHooks&&g.callInitHooks.call(this),this._initHooksCalled=!0;for(var N=0,H=x._initHooks.length;N<H;N++)x._initHooks[N].call(this)}},h},Y.include=function(o){var h=this.prototype.options;return c(this.prototype,o),o.options&&(this.prototype.options=h,this.mergeOptions(o.options)),this},Y.mergeOptions=function(o){return c(this.prototype.options,o),this},Y.addInitHook=function(o){var h=Array.prototype.slice.call(arguments,1),g=typeof o=="function"?o:function(){this[o].apply(this,h)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(g),this};function $(o){if(!(typeof L>"u"||!L||!L.Mixin)){o=se(o)?o:[o];for(var h=0;h<o.length;h++)o[h]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var U={on:function(o,h,g){if(typeof o=="object")for(var x in o)this._on(x,o[x],h);else{o=M(o);for(var S=0,N=o.length;S<N;S++)this._on(o[S],h,g)}return this},off:function(o,h,g){if(!arguments.length)delete this._events;else if(typeof o=="object")for(var x in o)this._off(x,o[x],h);else{o=M(o);for(var S=arguments.length===1,N=0,H=o.length;N<H;N++)S?this._off(o[N]):this._off(o[N],h,g)}return this},_on:function(o,h,g,x){if(typeof h!="function"){console.warn("wrong listener type: "+typeof h);return}if(this._listens(o,h,g)===!1){g===this&&(g=void 0);var S={fn:h,ctx:g};x&&(S.once=!0),this._events=this._events||{},this._events[o]=this._events[o]||[],this._events[o].push(S)}},_off:function(o,h,g){var x,S,N;if(this._events&&(x=this._events[o],!!x)){if(arguments.length===1){if(this._firingCount)for(S=0,N=x.length;S<N;S++)x[S].fn=R;delete this._events[o];return}if(typeof h!="function"){console.warn("wrong listener type: "+typeof h);return}var H=this._listens(o,h,g);if(H!==!1){var ie=x[H];this._firingCount&&(ie.fn=R,this._events[o]=x=x.slice()),x.splice(H,1)}}},fire:function(o,h,g){if(!this.listens(o,g))return this;var x=c({},h,{type:o,target:this,sourceTarget:h&&h.sourceTarget||this});if(this._events){var S=this._events[o];if(S){this._firingCount=this._firingCount+1||1;for(var N=0,H=S.length;N<H;N++){var ie=S[N],ce=ie.fn;ie.once&&this.off(o,ce,ie.ctx),ce.call(ie.ctx||this,x)}this._firingCount--}}return g&&this._propagateEvent(x),this},listens:function(o,h,g,x){typeof o!="string"&&console.warn('"string" type argument expected');var S=h;typeof h!="function"&&(x=!!h,S=void 0,g=void 0);var N=this._events&&this._events[o];if(N&&N.length&&this._listens(o,S,g)!==!1)return!0;if(x){for(var H in this._eventParents)if(this._eventParents[H].listens(o,h,g,x))return!0}return!1},_listens:function(o,h,g){if(!this._events)return!1;var x=this._events[o]||[];if(!h)return!!x.length;g===this&&(g=void 0);for(var S=0,N=x.length;S<N;S++)if(x[S].fn===h&&x[S].ctx===g)return S;return!1},once:function(o,h,g){if(typeof o=="object")for(var x in o)this._on(x,o[x],h,!0);else{o=M(o);for(var S=0,N=o.length;S<N;S++)this._on(o[S],h,g,!0)}return this},addEventParent:function(o){return this._eventParents=this._eventParents||{},this._eventParents[w(o)]=o,this},removeEventParent:function(o){return this._eventParents&&delete this._eventParents[w(o)],this},_propagateEvent:function(o){for(var h in this._eventParents)this._eventParents[h].fire(o.type,c({layer:o.target,propagatedFrom:o.target},o),!0)}};U.addEventListener=U.on,U.removeEventListener=U.clearAllEventListeners=U.off,U.addOneTimeEventListener=U.once,U.fireEvent=U.fire,U.hasEventListeners=U.listens;var ne=Y.extend(U);function V(o,h,g){this.x=g?Math.round(o):o,this.y=g?Math.round(h):h}var ae=Math.trunc||function(o){return o>0?Math.floor(o):Math.ceil(o)};V.prototype={clone:function(){return new V(this.x,this.y)},add:function(o){return this.clone()._add(q(o))},_add:function(o){return this.x+=o.x,this.y+=o.y,this},subtract:function(o){return this.clone()._subtract(q(o))},_subtract:function(o){return this.x-=o.x,this.y-=o.y,this},divideBy:function(o){return this.clone()._divideBy(o)},_divideBy:function(o){return this.x/=o,this.y/=o,this},multiplyBy:function(o){return this.clone()._multiplyBy(o)},_multiplyBy:function(o){return this.x*=o,this.y*=o,this},scaleBy:function(o){return new V(this.x*o.x,this.y*o.y)},unscaleBy:function(o){return new V(this.x/o.x,this.y/o.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=ae(this.x),this.y=ae(this.y),this},distanceTo:function(o){o=q(o);var h=o.x-this.x,g=o.y-this.y;return Math.sqrt(h*h+g*g)},equals:function(o){return o=q(o),o.x===this.x&&o.y===this.y},contains:function(o){return o=q(o),Math.abs(o.x)<=Math.abs(this.x)&&Math.abs(o.y)<=Math.abs(this.y)},toString:function(){return"Point("+T(this.x)+", "+T(this.y)+")"}};function q(o,h,g){return o instanceof V?o:se(o)?new V(o[0],o[1]):o==null?o:typeof o=="object"&&"x"in o&&"y"in o?new V(o.x,o.y):new V(o,h,g)}function I(o,h){if(o)for(var g=h?[o,h]:o,x=0,S=g.length;x<S;x++)this.extend(g[x])}I.prototype={extend:function(o){var h,g;if(!o)return this;if(o instanceof V||typeof o[0]=="number"||"x"in o)h=g=q(o);else if(o=G(o),h=o.min,g=o.max,!h||!g)return this;return!this.min&&!this.max?(this.min=h.clone(),this.max=g.clone()):(this.min.x=Math.min(h.x,this.min.x),this.max.x=Math.max(g.x,this.max.x),this.min.y=Math.min(h.y,this.min.y),this.max.y=Math.max(g.y,this.max.y)),this},getCenter:function(o){return q((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,o)},getBottomLeft:function(){return q(this.min.x,this.max.y)},getTopRight:function(){return q(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(o){var h,g;return typeof o[0]=="number"||o instanceof V?o=q(o):o=G(o),o instanceof I?(h=o.min,g=o.max):h=g=o,h.x>=this.min.x&&g.x<=this.max.x&&h.y>=this.min.y&&g.y<=this.max.y},intersects:function(o){o=G(o);var h=this.min,g=this.max,x=o.min,S=o.max,N=S.x>=h.x&&x.x<=g.x,H=S.y>=h.y&&x.y<=g.y;return N&&H},overlaps:function(o){o=G(o);var h=this.min,g=this.max,x=o.min,S=o.max,N=S.x>h.x&&x.x<g.x,H=S.y>h.y&&x.y<g.y;return N&&H},isValid:function(){return!!(this.min&&this.max)},pad:function(o){var h=this.min,g=this.max,x=Math.abs(h.x-g.x)*o,S=Math.abs(h.y-g.y)*o;return G(q(h.x-x,h.y-S),q(g.x+x,g.y+S))},equals:function(o){return o?(o=G(o),this.min.equals(o.getTopLeft())&&this.max.equals(o.getBottomRight())):!1}};function G(o,h){return!o||o instanceof I?o:new I(o,h)}function Ee(o,h){if(o)for(var g=h?[o,h]:o,x=0,S=g.length;x<S;x++)this.extend(g[x])}Ee.prototype={extend:function(o){var h=this._southWest,g=this._northEast,x,S;if(o instanceof pe)x=o,S=o;else if(o instanceof Ee){if(x=o._southWest,S=o._northEast,!x||!S)return this}else return o?this.extend(_e(o)||we(o)):this;return!h&&!g?(this._southWest=new pe(x.lat,x.lng),this._northEast=new pe(S.lat,S.lng)):(h.lat=Math.min(x.lat,h.lat),h.lng=Math.min(x.lng,h.lng),g.lat=Math.max(S.lat,g.lat),g.lng=Math.max(S.lng,g.lng)),this},pad:function(o){var h=this._southWest,g=this._northEast,x=Math.abs(h.lat-g.lat)*o,S=Math.abs(h.lng-g.lng)*o;return new Ee(new pe(h.lat-x,h.lng-S),new pe(g.lat+x,g.lng+S))},getCenter:function(){return new pe((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new pe(this.getNorth(),this.getWest())},getSouthEast:function(){return new pe(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(o){typeof o[0]=="number"||o instanceof pe||"lat"in o?o=_e(o):o=we(o);var h=this._southWest,g=this._northEast,x,S;return o instanceof Ee?(x=o.getSouthWest(),S=o.getNorthEast()):x=S=o,x.lat>=h.lat&&S.lat<=g.lat&&x.lng>=h.lng&&S.lng<=g.lng},intersects:function(o){o=we(o);var h=this._southWest,g=this._northEast,x=o.getSouthWest(),S=o.getNorthEast(),N=S.lat>=h.lat&&x.lat<=g.lat,H=S.lng>=h.lng&&x.lng<=g.lng;return N&&H},overlaps:function(o){o=we(o);var h=this._southWest,g=this._northEast,x=o.getSouthWest(),S=o.getNorthEast(),N=S.lat>h.lat&&x.lat<g.lat,H=S.lng>h.lng&&x.lng<g.lng;return N&&H},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(o,h){return o?(o=we(o),this._southWest.equals(o.getSouthWest(),h)&&this._northEast.equals(o.getNorthEast(),h)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function we(o,h){return o instanceof Ee?o:new Ee(o,h)}function pe(o,h,g){if(isNaN(o)||isNaN(h))throw new Error("Invalid LatLng object: ("+o+", "+h+")");this.lat=+o,this.lng=+h,g!==void 0&&(this.alt=+g)}pe.prototype={equals:function(o,h){if(!o)return!1;o=_e(o);var g=Math.max(Math.abs(this.lat-o.lat),Math.abs(this.lng-o.lng));return g<=(h===void 0?1e-9:h)},toString:function(o){return"LatLng("+T(this.lat,o)+", "+T(this.lng,o)+")"},distanceTo:function(o){return Ie.distance(this,_e(o))},wrap:function(){return Ie.wrapLatLng(this)},toBounds:function(o){var h=180*o/40075017,g=h/Math.cos(Math.PI/180*this.lat);return we([this.lat-h,this.lng-g],[this.lat+h,this.lng+g])},clone:function(){return new pe(this.lat,this.lng,this.alt)}};function _e(o,h,g){return o instanceof pe?o:se(o)&&typeof o[0]!="object"?o.length===3?new pe(o[0],o[1],o[2]):o.length===2?new pe(o[0],o[1]):null:o==null?o:typeof o=="object"&&"lat"in o?new pe(o.lat,"lng"in o?o.lng:o.lon,o.alt):h===void 0?null:new pe(o,h,g)}var Re={latLngToPoint:function(o,h){var g=this.projection.project(o),x=this.scale(h);return this.transformation._transform(g,x)},pointToLatLng:function(o,h){var g=this.scale(h),x=this.transformation.untransform(o,g);return this.projection.unproject(x)},project:function(o){return this.projection.project(o)},unproject:function(o){return this.projection.unproject(o)},scale:function(o){return 256*Math.pow(2,o)},zoom:function(o){return Math.log(o/256)/Math.LN2},getProjectedBounds:function(o){if(this.infinite)return null;var h=this.projection.bounds,g=this.scale(o),x=this.transformation.transform(h.min,g),S=this.transformation.transform(h.max,g);return new I(x,S)},infinite:!1,wrapLatLng:function(o){var h=this.wrapLng?C(o.lng,this.wrapLng,!0):o.lng,g=this.wrapLat?C(o.lat,this.wrapLat,!0):o.lat,x=o.alt;return new pe(g,h,x)},wrapLatLngBounds:function(o){var h=o.getCenter(),g=this.wrapLatLng(h),x=h.lat-g.lat,S=h.lng-g.lng;if(x===0&&S===0)return o;var N=o.getSouthWest(),H=o.getNorthEast(),ie=new pe(N.lat-x,N.lng-S),ce=new pe(H.lat-x,H.lng-S);return new Ee(ie,ce)}},Ie=c({},Re,{wrapLng:[-180,180],R:6371e3,distance:function(o,h){var g=Math.PI/180,x=o.lat*g,S=h.lat*g,N=Math.sin((h.lat-o.lat)*g/2),H=Math.sin((h.lng-o.lng)*g/2),ie=N*N+Math.cos(x)*Math.cos(S)*H*H,ce=2*Math.atan2(Math.sqrt(ie),Math.sqrt(1-ie));return this.R*ce}}),Me=6378137,Ke={R:Me,MAX_LATITUDE:85.0511287798,project:function(o){var h=Math.PI/180,g=this.MAX_LATITUDE,x=Math.max(Math.min(g,o.lat),-g),S=Math.sin(x*h);return new V(this.R*o.lng*h,this.R*Math.log((1+S)/(1-S))/2)},unproject:function(o){var h=180/Math.PI;return new pe((2*Math.atan(Math.exp(o.y/this.R))-Math.PI/2)*h,o.x*h/this.R)},bounds:(function(){var o=Me*Math.PI;return new I([-o,-o],[o,o])})()};function kt(o,h,g,x){if(se(o)){this._a=o[0],this._b=o[1],this._c=o[2],this._d=o[3];return}this._a=o,this._b=h,this._c=g,this._d=x}kt.prototype={transform:function(o,h){return this._transform(o.clone(),h)},_transform:function(o,h){return h=h||1,o.x=h*(this._a*o.x+this._b),o.y=h*(this._c*o.y+this._d),o},untransform:function(o,h){return h=h||1,new V((o.x/h-this._b)/this._a,(o.y/h-this._d)/this._c)}};function at(o,h,g,x){return new kt(o,h,g,x)}var vt=c({},Ie,{code:"EPSG:3857",projection:Ke,transformation:(function(){var o=.5/(Math.PI*Ke.R);return at(o,.5,-o,.5)})()}),Cn=c({},vt,{code:"EPSG:900913"});function ur(o){return document.createElementNS("http://www.w3.org/2000/svg",o)}function cr(o,h){var g="",x,S,N,H,ie,ce;for(x=0,N=o.length;x<N;x++){for(ie=o[x],S=0,H=ie.length;S<H;S++)ce=ie[S],g+=(S?"L":"M")+ce.x+" "+ce.y;g+=h?Ae.svg?"z":"x":""}return g||"M0 0"}var Wr=document.documentElement.style,qr="ActiveXObject"in window,vs=qr&&!document.addEventListener,hr="msLaunchUri"in navigator&&!("documentMode"in document),Rn=St("webkit"),Si=St("android"),_s=St("android 2")||St("android 3"),go=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),yo=Si&&St("Google")&&go<537&&!("AudioNode"in window),Ci=!!window.opera,Ri=!hr&&St("chrome"),Gr=St("gecko")&&!Rn&&!Ci&&!qr,vo=!Ri&&St("safari"),dr=St("phantom"),fr="OTransition"in Wr,ja=navigator.platform.indexOf("Win")===0,ws=qr&&"transition"in Wr,Ti="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!_s,_o="MozPerspective"in Wr,xs=!window.L_DISABLE_3D&&(ws||Ti||_o)&&!fr&&!dr,jn=typeof orientation<"u"||St("mobile"),bs=jn&&Rn,Es=jn&&Ti,Pi=!window.PointerEvent&&window.MSPointerEvent,Un=!!(window.PointerEvent||Pi),Fn="ontouchstart"in window||!!window.TouchEvent,wo=!window.L_NO_TOUCH&&(Fn||Un),xo=jn&&Ci,bo=jn&&Gr,Eo=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,ko=(function(){var o=!1;try{var h=Object.defineProperty({},"passive",{get:function(){o=!0}});window.addEventListener("testPassiveEventSupport",R,h),window.removeEventListener("testPassiveEventSupport",R,h)}catch{}return o})(),ks=(function(){return!!document.createElement("canvas").getContext})(),Li=!!(document.createElementNS&&ur("svg").createSVGRect),Yr=!!Li&&(function(){var o=document.createElement("div");return o.innerHTML="<svg/>",(o.firstChild&&o.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),Ss=!Li&&(function(){try{var o=document.createElement("div");o.innerHTML='<v:shape adj="1"/>';var h=o.firstChild;return h.style.behavior="url(#default#VML)",h&&typeof h.adj=="object"}catch{return!1}})(),Jr=navigator.platform.indexOf("Mac")===0,Ua=navigator.platform.indexOf("Linux")===0;function St(o){return navigator.userAgent.toLowerCase().indexOf(o)>=0}var Ae={ie:qr,ielt9:vs,edge:hr,webkit:Rn,android:Si,android23:_s,androidStock:yo,opera:Ci,chrome:Ri,gecko:Gr,safari:vo,phantom:dr,opera12:fr,win:ja,ie3d:ws,webkit3d:Ti,gecko3d:_o,any3d:xs,mobile:jn,mobileWebkit:bs,mobileWebkit3d:Es,msPointer:Pi,pointer:Un,touch:wo,touchNative:Fn,mobileOpera:xo,mobileGecko:bo,retina:Eo,passiveEvents:ko,canvas:ks,svg:Li,vml:Ss,inlineSvg:Yr,mac:Jr,linux:Ua},Xr=Ae.msPointer?"MSPointerDown":"pointerdown",Ni=Ae.msPointer?"MSPointerMove":"pointermove",So=Ae.msPointer?"MSPointerUp":"pointerup",Co=Ae.msPointer?"MSPointerCancel":"pointercancel",Cs={touchstart:Xr,touchmove:Ni,touchend:So,touchcancel:Co},Tn={touchstart:rt,touchmove:Ai,touchend:Ai,touchcancel:Ai},Hn={},Rs=!1;function Fa(o,h,g){return h==="touchstart"&&Ha(),Tn[h]?(g=Tn[h].bind(this,g),o.addEventListener(Cs[h],g,!1),g):(console.warn("wrong event specified:",h),R)}function Ro(o,h,g){if(!Cs[h]){console.warn("wrong event specified:",h);return}o.removeEventListener(Cs[h],g,!1)}function To(o){Hn[o.pointerId]=o}function Po(o){Hn[o.pointerId]&&(Hn[o.pointerId]=o)}function Ts(o){delete Hn[o.pointerId]}function Ha(){Rs||(document.addEventListener(Xr,To,!0),document.addEventListener(Ni,Po,!0),document.addEventListener(So,Ts,!0),document.addEventListener(Co,Ts,!0),Rs=!0)}function Ai(o,h){if(h.pointerType!==(h.MSPOINTER_TYPE_MOUSE||"mouse")){h.touches=[];for(var g in Hn)h.touches.push(Hn[g]);h.changedTouches=[h],o(h)}}function rt(o,h){h.MSPOINTER_TYPE_TOUCH&&h.pointerType===h.MSPOINTER_TYPE_TOUCH&&it(h),Ai(o,h)}function Ka(o){var h={},g,x;for(x in o)g=o[x],h[x]=g&&g.bind?g.bind(o):g;return o=h,h.type="dblclick",h.detail=2,h.isTrusted=!1,h._simulated=!0,h}var Ps=200;function Lo(o,h){o.addEventListener("dblclick",h);var g=0,x;function S(N){if(N.detail!==1){x=N.detail;return}if(!(N.pointerType==="mouse"||N.sourceCapabilities&&!N.sourceCapabilities.firesTouchEvents)){var H=Zn(N);if(!(H.some(function(ce){return ce instanceof HTMLLabelElement&&ce.attributes.for})&&!H.some(function(ce){return ce instanceof HTMLInputElement||ce instanceof HTMLSelectElement}))){var ie=Date.now();ie-g<=Ps?(x++,x===2&&h(Ka(N))):x=1,g=ie}}}return o.addEventListener("click",S),{dblclick:h,simDblclick:S}}function Ii(o,h){o.removeEventListener("dblclick",h.dblclick),o.removeEventListener("click",h.simDblclick)}var Ls=yr(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),pr=yr(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Qr=pr==="webkitTransition"||pr==="OTransition"?pr+"End":"transitionend";function Vt(o){return typeof o=="string"?document.getElementById(o):o}function ei(o,h){var g=o.style[h]||o.currentStyle&&o.currentStyle[h];if((!g||g==="auto")&&document.defaultView){var x=document.defaultView.getComputedStyle(o,null);g=x?x[h]:null}return g==="auto"?null:g}function Fe(o,h,g){var x=document.createElement(o);return x.className=h||"",g&&g.appendChild(x),x}function et(o){var h=o.parentNode;h&&h.removeChild(o)}function Bi(o){for(;o.firstChild;)o.removeChild(o.firstChild)}function mr(o){var h=o.parentNode;h&&h.lastChild!==o&&h.appendChild(o)}function mn(o){var h=o.parentNode;h&&h.firstChild!==o&&h.insertBefore(o,h.firstChild)}function gr(o,h){if(o.classList!==void 0)return o.classList.contains(h);var g=Mi(o);return g.length>0&&new RegExp("(^|\\s)"+h+"(\\s|$)").test(g)}function Ue(o,h){if(o.classList!==void 0)for(var g=M(h),x=0,S=g.length;x<S;x++)o.classList.add(g[x]);else if(!gr(o,h)){var N=Mi(o);Ns(o,(N?N+" ":"")+h)}}function Xe(o,h){o.classList!==void 0?o.classList.remove(h):Ns(o,A((" "+Mi(o)+" ").replace(" "+h+" "," ")))}function Ns(o,h){o.className.baseVal===void 0?o.className=h:o.className.baseVal=h}function Mi(o){return o.correspondingElement&&(o=o.correspondingElement),o.className.baseVal===void 0?o.className:o.className.baseVal}function Ct(o,h){"opacity"in o.style?o.style.opacity=h:"filter"in o.style&&No(o,h)}function No(o,h){var g=!1,x="DXImageTransform.Microsoft.Alpha";try{g=o.filters.item(x)}catch{if(h===1)return}h=Math.round(h*100),g?(g.Enabled=h!==100,g.Opacity=h):o.style.filter+=" progid:"+x+"(opacity="+h+")"}function yr(o){for(var h=document.documentElement.style,g=0;g<o.length;g++)if(o[g]in h)return o[g];return!1}function Zt(o,h,g){var x=h||new V(0,0);o.style[Ls]=(Ae.ie3d?"translate("+x.x+"px,"+x.y+"px)":"translate3d("+x.x+"px,"+x.y+"px,0)")+(g?" scale("+g+")":"")}function lt(o,h){o._leaflet_pos=h,Ae.any3d?Zt(o,h):(o.style.left=h.x+"px",o.style.top=h.y+"px")}function gn(o){return o._leaflet_pos||new V(0,0)}var Ze,vr,$i;if("onselectstart"in document)Ze=function(){ze(window,"selectstart",it)},vr=function(){Ye(window,"selectstart",it)};else{var Kn=yr(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Ze=function(){if(Kn){var o=document.documentElement.style;$i=o[Kn],o[Kn]="none"}},vr=function(){Kn&&(document.documentElement.style[Kn]=$i,$i=void 0)}}function Di(){ze(window,"dragstart",it)}function Oi(){Ye(window,"dragstart",it)}var ti,ni;function _r(o){for(;o.tabIndex===-1;)o=o.parentNode;o.style&&(Wt(),ti=o,ni=o.style.outlineStyle,o.style.outlineStyle="none",ze(window,"keydown",Wt))}function Wt(){ti&&(ti.style.outlineStyle=ni,ti=void 0,ni=void 0,Ye(window,"keydown",Wt))}function yn(o){do o=o.parentNode;while((!o.offsetWidth||!o.offsetHeight)&&o!==document.body);return o}function nn(o){var h=o.getBoundingClientRect();return{x:h.width/o.offsetWidth||1,y:h.height/o.offsetHeight||1,boundingClientRect:h}}var ri={__proto__:null,TRANSFORM:Ls,TRANSITION:pr,TRANSITION_END:Qr,get:Vt,getStyle:ei,create:Fe,remove:et,empty:Bi,toFront:mr,toBack:mn,hasClass:gr,addClass:Ue,removeClass:Xe,setClass:Ns,getClass:Mi,setOpacity:Ct,testProp:yr,setTransform:Zt,setPosition:lt,getPosition:gn,get disableTextSelection(){return Ze},get enableTextSelection(){return vr},disableImageDrag:Di,enableImageDrag:Oi,preventOutline:_r,restoreOutline:Wt,getSizedParentNode:yn,getScale:nn};function ze(o,h,g,x){if(h&&typeof h=="object")for(var S in h)Is(o,S,h[S],g);else{h=M(h);for(var N=0,H=h.length;N<H;N++)Is(o,h[N],g,x)}return this}var pt="_leaflet_events";function Ye(o,h,g,x){if(arguments.length===1)As(o),delete o[pt];else if(h&&typeof h=="object")for(var S in h)zi(o,S,h[S],g);else if(h=M(h),arguments.length===2)As(o,function(ie){return ye(h,ie)!==-1});else for(var N=0,H=h.length;N<H;N++)zi(o,h[N],g,x);return this}function As(o,h){for(var g in o[pt]){var x=g.split(/\d/)[0];(!h||h(x))&&zi(o,x,null,null,g)}}var Vn={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Is(o,h,g,x){var S=h+w(g)+(x?"_"+w(x):"");if(o[pt]&&o[pt][S])return this;var N=function(ie){return g.call(x||o,ie||window.event)},H=N;!Ae.touchNative&&Ae.pointer&&h.indexOf("touch")===0?N=Fa(o,h,N):Ae.touch&&h==="dblclick"?N=Lo(o,N):"addEventListener"in o?h==="touchstart"||h==="touchmove"||h==="wheel"||h==="mousewheel"?o.addEventListener(Vn[h]||h,N,Ae.passiveEvents?{passive:!1}:!1):h==="mouseenter"||h==="mouseleave"?(N=function(ie){ie=ie||window.event,oi(o,ie)&&H(ie)},o.addEventListener(Vn[h],N,!1)):o.addEventListener(h,H,!1):o.attachEvent("on"+h,N),o[pt]=o[pt]||{},o[pt][S]=N}function zi(o,h,g,x,S){S=S||h+w(g)+(x?"_"+w(x):"");var N=o[pt]&&o[pt][S];if(!N)return this;!Ae.touchNative&&Ae.pointer&&h.indexOf("touch")===0?Ro(o,h,N):Ae.touch&&h==="dblclick"?Ii(o,N):"removeEventListener"in o?o.removeEventListener(Vn[h]||h,N,!1):o.detachEvent("on"+h,N),o[pt][S]=null}function rn(o){return o.stopPropagation?o.stopPropagation():o.originalEvent?o.originalEvent._stopped=!0:o.cancelBubble=!0,this}function ji(o){return Is(o,"wheel",rn),this}function ii(o){return ze(o,"mousedown touchstart dblclick contextmenu",rn),o._leaflet_disable_click=!0,this}function it(o){return o.preventDefault?o.preventDefault():o.returnValue=!1,this}function qt(o){return it(o),rn(o),this}function Zn(o){if(o.composedPath)return o.composedPath();for(var h=[],g=o.target;g;)h.push(g),g=g.parentNode;return h}function si(o,h){if(!h)return new V(o.clientX,o.clientY);var g=nn(h),x=g.boundingClientRect;return new V((o.clientX-x.left)/g.x-h.clientLeft,(o.clientY-x.top)/g.y-h.clientTop)}var Va=Ae.linux&&Ae.chrome?window.devicePixelRatio:Ae.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Ao(o){return Ae.edge?o.wheelDeltaY/2:o.deltaY&&o.deltaMode===0?-o.deltaY/Va:o.deltaY&&o.deltaMode===1?-o.deltaY*20:o.deltaY&&o.deltaMode===2?-o.deltaY*60:o.deltaX||o.deltaZ?0:o.wheelDelta?(o.wheelDeltaY||o.wheelDelta)/2:o.detail&&Math.abs(o.detail)<32765?-o.detail*20:o.detail?o.detail/-32765*60:0}function oi(o,h){var g=h.relatedTarget;if(!g)return!0;try{for(;g&&g!==o;)g=g.parentNode}catch{return!1}return g!==o}var Ui={__proto__:null,on:ze,off:Ye,stopPropagation:rn,disableScrollPropagation:ji,disableClickPropagation:ii,preventDefault:it,stop:qt,getPropagationPath:Zn,getMousePosition:si,getWheelDelta:Ao,isExternalTarget:oi,addListener:ze,removeListener:Ye},Fi=ne.extend({run:function(o,h,g,x){this.stop(),this._el=o,this._inProgress=!0,this._duration=g||.25,this._easeOutPower=1/Math.max(x||.5,.2),this._startPos=gn(o),this._offset=h.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=F(this._animate,this),this._step()},_step:function(o){var h=+new Date-this._startTime,g=this._duration*1e3;h<g?this._runFrame(this._easeOut(h/g),o):(this._runFrame(1),this._complete())},_runFrame:function(o,h){var g=this._startPos.add(this._offset.multiplyBy(o));h&&g._round(),lt(this._el,g),this.fire("step")},_complete:function(){K(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(o){return 1-Math.pow(1-o,this._easeOutPower)}}),Ve=ne.extend({options:{crs:vt,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(o,h){h=B(this,h),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(o),this._initLayout(),this._onResize=y(this._onResize,this),this._initEvents(),h.maxBounds&&this.setMaxBounds(h.maxBounds),h.zoom!==void 0&&(this._zoom=this._limitZoom(h.zoom)),h.center&&h.zoom!==void 0&&this.setView(_e(h.center),h.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=pr&&Ae.any3d&&!Ae.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),ze(this._proxy,Qr,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(o,h,g){if(h=h===void 0?this._zoom:this._limitZoom(h),o=this._limitCenter(_e(o),h,this.options.maxBounds),g=g||{},this._stop(),this._loaded&&!g.reset&&g!==!0){g.animate!==void 0&&(g.zoom=c({animate:g.animate},g.zoom),g.pan=c({animate:g.animate,duration:g.duration},g.pan));var x=this._zoom!==h?this._tryAnimatedZoom&&this._tryAnimatedZoom(o,h,g.zoom):this._tryAnimatedPan(o,g.pan);if(x)return clearTimeout(this._sizeTimer),this}return this._resetView(o,h,g.pan&&g.pan.noMoveStart),this},setZoom:function(o,h){return this._loaded?this.setView(this.getCenter(),o,{zoom:h}):(this._zoom=o,this)},zoomIn:function(o,h){return o=o||(Ae.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+o,h)},zoomOut:function(o,h){return o=o||(Ae.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-o,h)},setZoomAround:function(o,h,g){var x=this.getZoomScale(h),S=this.getSize().divideBy(2),N=o instanceof V?o:this.latLngToContainerPoint(o),H=N.subtract(S).multiplyBy(1-1/x),ie=this.containerPointToLatLng(S.add(H));return this.setView(ie,h,{zoom:g})},_getBoundsCenterZoom:function(o,h){h=h||{},o=o.getBounds?o.getBounds():we(o);var g=q(h.paddingTopLeft||h.padding||[0,0]),x=q(h.paddingBottomRight||h.padding||[0,0]),S=this.getBoundsZoom(o,!1,g.add(x));if(S=typeof h.maxZoom=="number"?Math.min(h.maxZoom,S):S,S===1/0)return{center:o.getCenter(),zoom:S};var N=x.subtract(g).divideBy(2),H=this.project(o.getSouthWest(),S),ie=this.project(o.getNorthEast(),S),ce=this.unproject(H.add(ie).divideBy(2).add(N),S);return{center:ce,zoom:S}},fitBounds:function(o,h){if(o=we(o),!o.isValid())throw new Error("Bounds are not valid.");var g=this._getBoundsCenterZoom(o,h);return this.setView(g.center,g.zoom,h)},fitWorld:function(o){return this.fitBounds([[-90,-180],[90,180]],o)},panTo:function(o,h){return this.setView(o,this._zoom,{pan:h})},panBy:function(o,h){if(o=q(o).round(),h=h||{},!o.x&&!o.y)return this.fire("moveend");if(h.animate!==!0&&!this.getSize().contains(o))return this._resetView(this.unproject(this.project(this.getCenter()).add(o)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Fi,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),h.noMoveStart||this.fire("movestart"),h.animate!==!1){Ue(this._mapPane,"leaflet-pan-anim");var g=this._getMapPanePos().subtract(o).round();this._panAnim.run(this._mapPane,g,h.duration||.25,h.easeLinearity)}else this._rawPanBy(o),this.fire("move").fire("moveend");return this},flyTo:function(o,h,g){if(g=g||{},g.animate===!1||!Ae.any3d)return this.setView(o,h,g);this._stop();var x=this.project(this.getCenter()),S=this.project(o),N=this.getSize(),H=this._zoom;o=_e(o),h=h===void 0?H:h;var ie=Math.max(N.x,N.y),ce=ie*this.getZoomScale(H,h),ve=S.distanceTo(x)||1,Ce=1.42,$e=Ce*Ce;function He(Ge){var Br=Ge?-1:1,sl=Ge?ce:ie,ol=ce*ce-ie*ie+Br*$e*$e*ve*ve,Qn=2*sl*$e*ve,er=ol/Qn,tr=Math.sqrt(er*er+1)-er,ns=tr<1e-9?-18:Math.log(tr);return ns}function mt(Ge){return(Math.exp(Ge)-Math.exp(-Ge))/2}function dt(Ge){return(Math.exp(Ge)+Math.exp(-Ge))/2}function Mt(Ge){return mt(Ge)/dt(Ge)}var Tt=He(0);function Ar(Ge){return ie*(dt(Tt)/dt(Tt+Ce*Ge))}function eo(Ge){return ie*(dt(Tt)*Mt(Tt+Ce*Ge)-mt(Tt))/$e}function $n(Ge){return 1-Math.pow(1-Ge,1.5)}var Qo=Date.now(),Xn=(He(1)-Tt)/Ce,ln=g.duration?1e3*g.duration:1e3*Xn*.8;function Ir(){var Ge=(Date.now()-Qo)/ln,Br=$n(Ge)*Xn;Ge<=1?(this._flyToFrame=F(Ir,this),this._move(this.unproject(x.add(S.subtract(x).multiplyBy(eo(Br)/ve)),H),this.getScaleZoom(ie/Ar(Br),H),{flyTo:!0})):this._move(o,h)._moveEnd(!0)}return this._moveStart(!0,g.noMoveStart),Ir.call(this),this},flyToBounds:function(o,h){var g=this._getBoundsCenterZoom(o,h);return this.flyTo(g.center,g.zoom,h)},setMaxBounds:function(o){return o=we(o),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),o.isValid()?(this.options.maxBounds=o,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(o){var h=this.options.minZoom;return this.options.minZoom=o,this._loaded&&h!==o&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(o):this},setMaxZoom:function(o){var h=this.options.maxZoom;return this.options.maxZoom=o,this._loaded&&h!==o&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(o):this},panInsideBounds:function(o,h){this._enforcingBounds=!0;var g=this.getCenter(),x=this._limitCenter(g,this._zoom,we(o));return g.equals(x)||this.panTo(x,h),this._enforcingBounds=!1,this},panInside:function(o,h){h=h||{};var g=q(h.paddingTopLeft||h.padding||[0,0]),x=q(h.paddingBottomRight||h.padding||[0,0]),S=this.project(this.getCenter()),N=this.project(o),H=this.getPixelBounds(),ie=G([H.min.add(g),H.max.subtract(x)]),ce=ie.getSize();if(!ie.contains(N)){this._enforcingBounds=!0;var ve=N.subtract(ie.getCenter()),Ce=ie.extend(N).getSize().subtract(ce);S.x+=ve.x<0?-Ce.x:Ce.x,S.y+=ve.y<0?-Ce.y:Ce.y,this.panTo(this.unproject(S),h),this._enforcingBounds=!1}return this},invalidateSize:function(o){if(!this._loaded)return this;o=c({animate:!1,pan:!0},o===!0?{animate:!0}:o);var h=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var g=this.getSize(),x=h.divideBy(2).round(),S=g.divideBy(2).round(),N=x.subtract(S);return!N.x&&!N.y?this:(o.animate&&o.pan?this.panBy(N):(o.pan&&this._rawPanBy(N),this.fire("move"),o.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(y(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:h,newSize:g}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(o){if(o=this._locateOptions=c({timeout:1e4,watch:!1},o),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var h=y(this._handleGeolocationResponse,this),g=y(this._handleGeolocationError,this);return o.watch?this._locationWatchId=navigator.geolocation.watchPosition(h,g,o):navigator.geolocation.getCurrentPosition(h,g,o),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(o){if(this._container._leaflet_id){var h=o.code,g=o.message||(h===1?"permission denied":h===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:h,message:"Geolocation error: "+g+"."})}},_handleGeolocationResponse:function(o){if(this._container._leaflet_id){var h=o.coords.latitude,g=o.coords.longitude,x=new pe(h,g),S=x.toBounds(o.coords.accuracy*2),N=this._locateOptions;if(N.setView){var H=this.getBoundsZoom(S);this.setView(x,N.maxZoom?Math.min(H,N.maxZoom):H)}var ie={latlng:x,bounds:S,timestamp:o.timestamp};for(var ce in o.coords)typeof o.coords[ce]=="number"&&(ie[ce]=o.coords[ce]);this.fire("locationfound",ie)}},addHandler:function(o,h){if(!h)return this;var g=this[o]=new h(this);return this._handlers.push(g),this.options[o]&&g.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),et(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(K(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var o;for(o in this._layers)this._layers[o].remove();for(o in this._panes)et(this._panes[o]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(o,h){var g="leaflet-pane"+(o?" leaflet-"+o.replace("Pane","")+"-pane":""),x=Fe("div",g,h||this._mapPane);return o&&(this._panes[o]=x),x},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var o=this.getPixelBounds(),h=this.unproject(o.getBottomLeft()),g=this.unproject(o.getTopRight());return new Ee(h,g)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(o,h,g){o=we(o),g=q(g||[0,0]);var x=this.getZoom()||0,S=this.getMinZoom(),N=this.getMaxZoom(),H=o.getNorthWest(),ie=o.getSouthEast(),ce=this.getSize().subtract(g),ve=G(this.project(ie,x),this.project(H,x)).getSize(),Ce=Ae.any3d?this.options.zoomSnap:1,$e=ce.x/ve.x,He=ce.y/ve.y,mt=h?Math.max($e,He):Math.min($e,He);return x=this.getScaleZoom(mt,x),Ce&&(x=Math.round(x/(Ce/100))*(Ce/100),x=h?Math.ceil(x/Ce)*Ce:Math.floor(x/Ce)*Ce),Math.max(S,Math.min(N,x))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new V(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(o,h){var g=this._getTopLeftPoint(o,h);return new I(g,g.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(o){return this.options.crs.getProjectedBounds(o===void 0?this.getZoom():o)},getPane:function(o){return typeof o=="string"?this._panes[o]:o},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(o,h){var g=this.options.crs;return h=h===void 0?this._zoom:h,g.scale(o)/g.scale(h)},getScaleZoom:function(o,h){var g=this.options.crs;h=h===void 0?this._zoom:h;var x=g.zoom(o*g.scale(h));return isNaN(x)?1/0:x},project:function(o,h){return h=h===void 0?this._zoom:h,this.options.crs.latLngToPoint(_e(o),h)},unproject:function(o,h){return h=h===void 0?this._zoom:h,this.options.crs.pointToLatLng(q(o),h)},layerPointToLatLng:function(o){var h=q(o).add(this.getPixelOrigin());return this.unproject(h)},latLngToLayerPoint:function(o){var h=this.project(_e(o))._round();return h._subtract(this.getPixelOrigin())},wrapLatLng:function(o){return this.options.crs.wrapLatLng(_e(o))},wrapLatLngBounds:function(o){return this.options.crs.wrapLatLngBounds(we(o))},distance:function(o,h){return this.options.crs.distance(_e(o),_e(h))},containerPointToLayerPoint:function(o){return q(o).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(o){return q(o).add(this._getMapPanePos())},containerPointToLatLng:function(o){var h=this.containerPointToLayerPoint(q(o));return this.layerPointToLatLng(h)},latLngToContainerPoint:function(o){return this.layerPointToContainerPoint(this.latLngToLayerPoint(_e(o)))},mouseEventToContainerPoint:function(o){return si(o,this._container)},mouseEventToLayerPoint:function(o){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(o))},mouseEventToLatLng:function(o){return this.layerPointToLatLng(this.mouseEventToLayerPoint(o))},_initContainer:function(o){var h=this._container=Vt(o);if(h){if(h._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");ze(h,"scroll",this._onScroll,this),this._containerId=w(h)},_initLayout:function(){var o=this._container;this._fadeAnimated=this.options.fadeAnimation&&Ae.any3d,Ue(o,"leaflet-container"+(Ae.touch?" leaflet-touch":"")+(Ae.retina?" leaflet-retina":"")+(Ae.ielt9?" leaflet-oldie":"")+(Ae.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var h=ei(o,"position");h!=="absolute"&&h!=="relative"&&h!=="fixed"&&h!=="sticky"&&(o.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var o=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),lt(this._mapPane,new V(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Ue(o.markerPane,"leaflet-zoom-hide"),Ue(o.shadowPane,"leaflet-zoom-hide"))},_resetView:function(o,h,g){lt(this._mapPane,new V(0,0));var x=!this._loaded;this._loaded=!0,h=this._limitZoom(h),this.fire("viewprereset");var S=this._zoom!==h;this._moveStart(S,g)._move(o,h)._moveEnd(S),this.fire("viewreset"),x&&this.fire("load")},_moveStart:function(o,h){return o&&this.fire("zoomstart"),h||this.fire("movestart"),this},_move:function(o,h,g,x){h===void 0&&(h=this._zoom);var S=this._zoom!==h;return this._zoom=h,this._lastCenter=o,this._pixelOrigin=this._getNewPixelOrigin(o),x?g&&g.pinch&&this.fire("zoom",g):((S||g&&g.pinch)&&this.fire("zoom",g),this.fire("move",g)),this},_moveEnd:function(o){return o&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return K(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(o){lt(this._mapPane,this._getMapPanePos().subtract(o))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(o){this._targets={},this._targets[w(this._container)]=this;var h=o?Ye:ze;h(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&h(window,"resize",this._onResize,this),Ae.any3d&&this.options.transform3DLimit&&(o?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){K(this._resizeRequest),this._resizeRequest=F(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var o=this._getMapPanePos();Math.max(Math.abs(o.x),Math.abs(o.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(o,h){for(var g=[],x,S=h==="mouseout"||h==="mouseover",N=o.target||o.srcElement,H=!1;N;){if(x=this._targets[w(N)],x&&(h==="click"||h==="preclick")&&this._draggableMoved(x)){H=!0;break}if(x&&x.listens(h,!0)&&(S&&!oi(N,o)||(g.push(x),S))||N===this._container)break;N=N.parentNode}return!g.length&&!H&&!S&&this.listens(h,!0)&&(g=[this]),g},_isClickDisabled:function(o){for(;o&&o!==this._container;){if(o._leaflet_disable_click)return!0;o=o.parentNode}},_handleDOMEvent:function(o){var h=o.target||o.srcElement;if(!(!this._loaded||h._leaflet_disable_events||o.type==="click"&&this._isClickDisabled(h))){var g=o.type;g==="mousedown"&&_r(h),this._fireDOMEvent(o,g)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(o,h,g){if(o.type==="click"){var x=c({},o);x.type="preclick",this._fireDOMEvent(x,x.type,g)}var S=this._findEventTargets(o,h);if(g){for(var N=[],H=0;H<g.length;H++)g[H].listens(h,!0)&&N.push(g[H]);S=N.concat(S)}if(S.length){h==="contextmenu"&&it(o);var ie=S[0],ce={originalEvent:o};if(o.type!=="keypress"&&o.type!=="keydown"&&o.type!=="keyup"){var ve=ie.getLatLng&&(!ie._radius||ie._radius<=10);ce.containerPoint=ve?this.latLngToContainerPoint(ie.getLatLng()):this.mouseEventToContainerPoint(o),ce.layerPoint=this.containerPointToLayerPoint(ce.containerPoint),ce.latlng=ve?ie.getLatLng():this.layerPointToLatLng(ce.layerPoint)}for(H=0;H<S.length;H++)if(S[H].fire(h,ce,!0),ce.originalEvent._stopped||S[H].options.bubblingMouseEvents===!1&&ye(this._mouseEvents,h)!==-1)return}},_draggableMoved:function(o){return o=o.dragging&&o.dragging.enabled()?o:this,o.dragging&&o.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var o=0,h=this._handlers.length;o<h;o++)this._handlers[o].disable()},whenReady:function(o,h){return this._loaded?o.call(h||this,{target:this}):this.on("load",o,h),this},_getMapPanePos:function(){return gn(this._mapPane)||new V(0,0)},_moved:function(){var o=this._getMapPanePos();return o&&!o.equals([0,0])},_getTopLeftPoint:function(o,h){var g=o&&h!==void 0?this._getNewPixelOrigin(o,h):this.getPixelOrigin();return g.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(o,h){var g=this.getSize()._divideBy(2);return this.project(o,h)._subtract(g)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(o,h,g){var x=this._getNewPixelOrigin(g,h);return this.project(o,h)._subtract(x)},_latLngBoundsToNewLayerBounds:function(o,h,g){var x=this._getNewPixelOrigin(g,h);return G([this.project(o.getSouthWest(),h)._subtract(x),this.project(o.getNorthWest(),h)._subtract(x),this.project(o.getSouthEast(),h)._subtract(x),this.project(o.getNorthEast(),h)._subtract(x)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(o){return this.latLngToLayerPoint(o).subtract(this._getCenterLayerPoint())},_limitCenter:function(o,h,g){if(!g)return o;var x=this.project(o,h),S=this.getSize().divideBy(2),N=new I(x.subtract(S),x.add(S)),H=this._getBoundsOffset(N,g,h);return Math.abs(H.x)<=1&&Math.abs(H.y)<=1?o:this.unproject(x.add(H),h)},_limitOffset:function(o,h){if(!h)return o;var g=this.getPixelBounds(),x=new I(g.min.add(o),g.max.add(o));return o.add(this._getBoundsOffset(x,h))},_getBoundsOffset:function(o,h,g){var x=G(this.project(h.getNorthEast(),g),this.project(h.getSouthWest(),g)),S=x.min.subtract(o.min),N=x.max.subtract(o.max),H=this._rebound(S.x,-N.x),ie=this._rebound(S.y,-N.y);return new V(H,ie)},_rebound:function(o,h){return o+h>0?Math.round(o-h)/2:Math.max(0,Math.ceil(o))-Math.max(0,Math.floor(h))},_limitZoom:function(o){var h=this.getMinZoom(),g=this.getMaxZoom(),x=Ae.any3d?this.options.zoomSnap:1;return x&&(o=Math.round(o/x)*x),Math.max(h,Math.min(g,o))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Xe(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(o,h){var g=this._getCenterOffset(o)._trunc();return(h&&h.animate)!==!0&&!this.getSize().contains(g)?!1:(this.panBy(g,h),!0)},_createAnimProxy:function(){var o=this._proxy=Fe("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(o),this.on("zoomanim",function(h){var g=Ls,x=this._proxy.style[g];Zt(this._proxy,this.project(h.center,h.zoom),this.getZoomScale(h.zoom,1)),x===this._proxy.style[g]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){et(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var o=this.getCenter(),h=this.getZoom();Zt(this._proxy,this.project(o,h),this.getZoomScale(h,1))},_catchTransitionEnd:function(o){this._animatingZoom&&o.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(o,h,g){if(this._animatingZoom)return!0;if(g=g||{},!this._zoomAnimated||g.animate===!1||this._nothingToAnimate()||Math.abs(h-this._zoom)>this.options.zoomAnimationThreshold)return!1;var x=this.getZoomScale(h),S=this._getCenterOffset(o)._divideBy(1-1/x);return g.animate!==!0&&!this.getSize().contains(S)?!1:(F(function(){this._moveStart(!0,g.noMoveStart||!1)._animateZoom(o,h,!0)},this),!0)},_animateZoom:function(o,h,g,x){this._mapPane&&(g&&(this._animatingZoom=!0,this._animateToCenter=o,this._animateToZoom=h,Ue(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:o,zoom:h,noUpdate:x}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(y(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Xe(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Pn(o,h){return new Ve(o,h)}var It=Y.extend({options:{position:"topright"},initialize:function(o){B(this,o)},getPosition:function(){return this.options.position},setPosition:function(o){var h=this._map;return h&&h.removeControl(this),this.options.position=o,h&&h.addControl(this),this},getContainer:function(){return this._container},addTo:function(o){this.remove(),this._map=o;var h=this._container=this.onAdd(o),g=this.getPosition(),x=o._controlCorners[g];return Ue(h,"leaflet-control"),g.indexOf("bottom")!==-1?x.insertBefore(h,x.firstChild):x.appendChild(h),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(et(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(o){this._map&&o&&o.screenX>0&&o.screenY>0&&this._map.getContainer().focus()}}),Ln=function(o){return new It(o)};Ve.include({addControl:function(o){return o.addTo(this),this},removeControl:function(o){return o.remove(),this},_initControlPos:function(){var o=this._controlCorners={},h="leaflet-",g=this._controlContainer=Fe("div",h+"control-container",this._container);function x(S,N){var H=h+S+" "+h+N;o[S+N]=Fe("div",H,g)}x("top","left"),x("top","right"),x("bottom","left"),x("bottom","right")},_clearControlPos:function(){for(var o in this._controlCorners)et(this._controlCorners[o]);et(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Bs=It.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(o,h,g,x){return g<x?-1:x<g?1:0}},initialize:function(o,h,g){B(this,g),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var x in o)this._addLayer(o[x],x);for(x in h)this._addLayer(h[x],x,!0)},onAdd:function(o){this._initLayout(),this._update(),this._map=o,o.on("zoomend",this._checkDisabledLayers,this);for(var h=0;h<this._layers.length;h++)this._layers[h].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(o){return It.prototype.addTo.call(this,o),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var o=0;o<this._layers.length;o++)this._layers[o].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(o,h){return this._addLayer(o,h),this._map?this._update():this},addOverlay:function(o,h){return this._addLayer(o,h,!0),this._map?this._update():this},removeLayer:function(o){o.off("add remove",this._onLayerChange,this);var h=this._getLayer(w(o));return h&&this._layers.splice(this._layers.indexOf(h),1),this._map?this._update():this},expand:function(){Ue(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var o=this._map.getSize().y-(this._container.offsetTop+50);return o<this._section.clientHeight?(Ue(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=o+"px"):Xe(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Xe(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var o="leaflet-control-layers",h=this._container=Fe("div",o),g=this.options.collapsed;h.setAttribute("aria-haspopup",!0),ii(h),ji(h);var x=this._section=Fe("section",o+"-list");g&&(this._map.on("click",this.collapse,this),ze(h,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var S=this._layersLink=Fe("a",o+"-toggle",h);S.href="#",S.title="Layers",S.setAttribute("role","button"),ze(S,{keydown:function(N){N.keyCode===13&&this._expandSafely()},click:function(N){it(N),this._expandSafely()}},this),g||this.expand(),this._baseLayersList=Fe("div",o+"-base",x),this._separator=Fe("div",o+"-separator",x),this._overlaysList=Fe("div",o+"-overlays",x),h.appendChild(x)},_getLayer:function(o){for(var h=0;h<this._layers.length;h++)if(this._layers[h]&&w(this._layers[h].layer)===o)return this._layers[h]},_addLayer:function(o,h,g){this._map&&o.on("add remove",this._onLayerChange,this),this._layers.push({layer:o,name:h,overlay:g}),this.options.sortLayers&&this._layers.sort(y(function(x,S){return this.options.sortFunction(x.layer,S.layer,x.name,S.name)},this)),this.options.autoZIndex&&o.setZIndex&&(this._lastZIndex++,o.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Bi(this._baseLayersList),Bi(this._overlaysList),this._layerControlInputs=[];var o,h,g,x,S=0;for(g=0;g<this._layers.length;g++)x=this._layers[g],this._addItem(x),h=h||x.overlay,o=o||!x.overlay,S+=x.overlay?0:1;return this.options.hideSingleBase&&(o=o&&S>1,this._baseLayersList.style.display=o?"":"none"),this._separator.style.display=h&&o?"":"none",this},_onLayerChange:function(o){this._handlingClick||this._update();var h=this._getLayer(w(o.target)),g=h.overlay?o.type==="add"?"overlayadd":"overlayremove":o.type==="add"?"baselayerchange":null;g&&this._map.fire(g,h)},_createRadioElement:function(o,h){var g='<input type="radio" class="leaflet-control-layers-selector" name="'+o+'"'+(h?' checked="checked"':"")+"/>",x=document.createElement("div");return x.innerHTML=g,x.firstChild},_addItem:function(o){var h=document.createElement("label"),g=this._map.hasLayer(o.layer),x;o.overlay?(x=document.createElement("input"),x.type="checkbox",x.className="leaflet-control-layers-selector",x.defaultChecked=g):x=this._createRadioElement("leaflet-base-layers_"+w(this),g),this._layerControlInputs.push(x),x.layerId=w(o.layer),ze(x,"click",this._onInputClick,this);var S=document.createElement("span");S.innerHTML=" "+o.name;var N=document.createElement("span");h.appendChild(N),N.appendChild(x),N.appendChild(S);var H=o.overlay?this._overlaysList:this._baseLayersList;return H.appendChild(h),this._checkDisabledLayers(),h},_onInputClick:function(){if(!this._preventClick){var o=this._layerControlInputs,h,g,x=[],S=[];this._handlingClick=!0;for(var N=o.length-1;N>=0;N--)h=o[N],g=this._getLayer(h.layerId).layer,h.checked?x.push(g):h.checked||S.push(g);for(N=0;N<S.length;N++)this._map.hasLayer(S[N])&&this._map.removeLayer(S[N]);for(N=0;N<x.length;N++)this._map.hasLayer(x[N])||this._map.addLayer(x[N]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var o=this._layerControlInputs,h,g,x=this._map.getZoom(),S=o.length-1;S>=0;S--)h=o[S],g=this._getLayer(h.layerId).layer,h.disabled=g.options.minZoom!==void 0&&x<g.options.minZoom||g.options.maxZoom!==void 0&&x>g.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var o=this._section;this._preventClick=!0,ze(o,"click",it),this.expand();var h=this;setTimeout(function(){Ye(o,"click",it),h._preventClick=!1})}}),Hi=function(o,h,g){return new Bs(o,h,g)},wr=It.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(o){var h="leaflet-control-zoom",g=Fe("div",h+" leaflet-bar"),x=this.options;return this._zoomInButton=this._createButton(x.zoomInText,x.zoomInTitle,h+"-in",g,this._zoomIn),this._zoomOutButton=this._createButton(x.zoomOutText,x.zoomOutTitle,h+"-out",g,this._zoomOut),this._updateDisabled(),o.on("zoomend zoomlevelschange",this._updateDisabled,this),g},onRemove:function(o){o.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(o){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(o.shiftKey?3:1))},_zoomOut:function(o){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(o.shiftKey?3:1))},_createButton:function(o,h,g,x,S){var N=Fe("a",g,x);return N.innerHTML=o,N.href="#",N.title=h,N.setAttribute("role","button"),N.setAttribute("aria-label",h),ii(N),ze(N,"click",qt),ze(N,"click",S,this),ze(N,"click",this._refocusOnMap,this),N},_updateDisabled:function(){var o=this._map,h="leaflet-disabled";Xe(this._zoomInButton,h),Xe(this._zoomOutButton,h),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||o._zoom===o.getMinZoom())&&(Ue(this._zoomOutButton,h),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||o._zoom===o.getMaxZoom())&&(Ue(this._zoomInButton,h),this._zoomInButton.setAttribute("aria-disabled","true"))}});Ve.mergeOptions({zoomControl:!0}),Ve.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new wr,this.addControl(this.zoomControl))});var Io=function(o){return new wr(o)},Rt=It.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(o){var h="leaflet-control-scale",g=Fe("div",h),x=this.options;return this._addScales(x,h+"-line",g),o.on(x.updateWhenIdle?"moveend":"move",this._update,this),o.whenReady(this._update,this),g},onRemove:function(o){o.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(o,h,g){o.metric&&(this._mScale=Fe("div",h,g)),o.imperial&&(this._iScale=Fe("div",h,g))},_update:function(){var o=this._map,h=o.getSize().y/2,g=o.distance(o.containerPointToLatLng([0,h]),o.containerPointToLatLng([this.options.maxWidth,h]));this._updateScales(g)},_updateScales:function(o){this.options.metric&&o&&this._updateMetric(o),this.options.imperial&&o&&this._updateImperial(o)},_updateMetric:function(o){var h=this._getRoundNum(o),g=h<1e3?h+" m":h/1e3+" km";this._updateScale(this._mScale,g,h/o)},_updateImperial:function(o){var h=o*3.2808399,g,x,S;h>5280?(g=h/5280,x=this._getRoundNum(g),this._updateScale(this._iScale,x+" mi",x/g)):(S=this._getRoundNum(h),this._updateScale(this._iScale,S+" ft",S/h))},_updateScale:function(o,h,g){o.style.width=Math.round(this.options.maxWidth*g)+"px",o.innerHTML=h},_getRoundNum:function(o){var h=Math.pow(10,(Math.floor(o)+"").length-1),g=o/h;return g=g>=10?10:g>=5?5:g>=3?3:g>=2?2:1,h*g}}),xr=function(o){return new Rt(o)},Ms='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Wn=It.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Ae.inlineSvg?Ms+" ":"")+"Leaflet</a>"},initialize:function(o){B(this,o),this._attributions={}},onAdd:function(o){o.attributionControl=this,this._container=Fe("div","leaflet-control-attribution"),ii(this._container);for(var h in o._layers)o._layers[h].getAttribution&&this.addAttribution(o._layers[h].getAttribution());return this._update(),o.on("layeradd",this._addAttribution,this),this._container},onRemove:function(o){o.off("layeradd",this._addAttribution,this)},_addAttribution:function(o){o.layer.getAttribution&&(this.addAttribution(o.layer.getAttribution()),o.layer.once("remove",function(){this.removeAttribution(o.layer.getAttribution())},this))},setPrefix:function(o){return this.options.prefix=o,this._update(),this},addAttribution:function(o){return o?(this._attributions[o]||(this._attributions[o]=0),this._attributions[o]++,this._update(),this):this},removeAttribution:function(o){return o?(this._attributions[o]&&(this._attributions[o]--,this._update()),this):this},_update:function(){if(this._map){var o=[];for(var h in this._attributions)this._attributions[h]&&o.push(h);var g=[];this.options.prefix&&g.push(this.options.prefix),o.length&&g.push(o.join(", ")),this._container.innerHTML=g.join(' <span aria-hidden="true">|</span> ')}}});Ve.mergeOptions({attributionControl:!0}),Ve.addInitHook(function(){this.options.attributionControl&&new Wn().addTo(this)});var Za=function(o){return new Wn(o)};It.Layers=Bs,It.Zoom=wr,It.Scale=Rt,It.Attribution=Wn,Ln.layers=Hi,Ln.zoom=Io,Ln.scale=xr,Ln.attribution=Za;var Ot=Y.extend({initialize:function(o){this._map=o},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Ot.addTo=function(o,h){return o.addHandler(h,this),this};var $s={Events:U},br=Ae.touch?"touchstart mousedown":"mousedown",Gt=ne.extend({options:{clickTolerance:3},initialize:function(o,h,g,x){B(this,x),this._element=o,this._dragStartTarget=h||o,this._preventOutline=g},enable:function(){this._enabled||(ze(this._dragStartTarget,br,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Gt._dragging===this&&this.finishDrag(!0),Ye(this._dragStartTarget,br,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(o){if(this._enabled&&(this._moved=!1,!gr(this._element,"leaflet-zoom-anim"))){if(o.touches&&o.touches.length!==1){Gt._dragging===this&&this.finishDrag();return}if(!(Gt._dragging||o.shiftKey||o.which!==1&&o.button!==1&&!o.touches)&&(Gt._dragging=this,this._preventOutline&&_r(this._element),Di(),Ze(),!this._moving)){this.fire("down");var h=o.touches?o.touches[0]:o,g=yn(this._element);this._startPoint=new V(h.clientX,h.clientY),this._startPos=gn(this._element),this._parentScale=nn(g);var x=o.type==="mousedown";ze(document,x?"mousemove":"touchmove",this._onMove,this),ze(document,x?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(o){if(this._enabled){if(o.touches&&o.touches.length>1){this._moved=!0;return}var h=o.touches&&o.touches.length===1?o.touches[0]:o,g=new V(h.clientX,h.clientY)._subtract(this._startPoint);!g.x&&!g.y||Math.abs(g.x)+Math.abs(g.y)<this.options.clickTolerance||(g.x/=this._parentScale.x,g.y/=this._parentScale.y,it(o),this._moved||(this.fire("dragstart"),this._moved=!0,Ue(document.body,"leaflet-dragging"),this._lastTarget=o.target||o.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Ue(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(g),this._moving=!0,this._lastEvent=o,this._updatePosition())}},_updatePosition:function(){var o={originalEvent:this._lastEvent};this.fire("predrag",o),lt(this._element,this._newPos),this.fire("drag",o)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(o){Xe(document.body,"leaflet-dragging"),this._lastTarget&&(Xe(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Ye(document,"mousemove touchmove",this._onMove,this),Ye(document,"mouseup touchend touchcancel",this._onUp,this),Oi(),vr();var h=this._moved&&this._moving;this._moving=!1,Gt._dragging=!1,h&&this.fire("dragend",{noInertia:o,distance:this._newPos.distanceTo(this._startPos)})}});function Ds(o,h,g){var x,S=[1,4,2,8],N,H,ie,ce,ve,Ce,$e,He;for(N=0,Ce=o.length;N<Ce;N++)o[N]._code=qn(o[N],h);for(ie=0;ie<4;ie++){for($e=S[ie],x=[],N=0,Ce=o.length,H=Ce-1;N<Ce;H=N++)ce=o[N],ve=o[H],ce._code&$e?ve._code&$e||(He=Vi(ve,ce,$e,h,g),He._code=qn(He,h),x.push(He)):(ve._code&$e&&(He=Vi(ve,ce,$e,h,g),He._code=qn(He,h),x.push(He)),x.push(ce));o=x}return o}function Bo(o,h){var g,x,S,N,H,ie,ce,ve,Ce;if(!o||o.length===0)throw new Error("latlngs not passed");zt(o)||(console.warn("latlngs are not flat! Only the first ring will be used"),o=o[0]);var $e=_e([0,0]),He=we(o),mt=He.getNorthWest().distanceTo(He.getSouthWest())*He.getNorthEast().distanceTo(He.getNorthWest());mt<1700&&($e=Os(o));var dt=o.length,Mt=[];for(g=0;g<dt;g++){var Tt=_e(o[g]);Mt.push(h.project(_e([Tt.lat-$e.lat,Tt.lng-$e.lng])))}for(ie=ce=ve=0,g=0,x=dt-1;g<dt;x=g++)S=Mt[g],N=Mt[x],H=S.y*N.x-N.y*S.x,ce+=(S.x+N.x)*H,ve+=(S.y+N.y)*H,ie+=H*3;ie===0?Ce=Mt[0]:Ce=[ce/ie,ve/ie];var Ar=h.unproject(q(Ce));return _e([Ar.lat+$e.lat,Ar.lng+$e.lng])}function Os(o){for(var h=0,g=0,x=0,S=0;S<o.length;S++){var N=_e(o[S]);h+=N.lat,g+=N.lng,x++}return _e([h/x,g/x])}var Wa={__proto__:null,clipPolygon:Ds,polygonCenter:Bo,centroid:Os};function Ki(o,h){if(!h||!o.length)return o.slice();var g=h*h;return o=Ya(o,g),o=Ga(o,g),o}function Mo(o,h,g){return Math.sqrt(Gn(o,h,g,!0))}function qa(o,h,g){return Gn(o,h,g)}function Ga(o,h){var g=o.length,x=typeof Uint8Array<"u"?Uint8Array:Array,S=new x(g);S[0]=S[g-1]=1,zs(o,S,h,0,g-1);var N,H=[];for(N=0;N<g;N++)S[N]&&H.push(o[N]);return H}function zs(o,h,g,x,S){var N=0,H,ie,ce;for(ie=x+1;ie<=S-1;ie++)ce=Gn(o[ie],o[x],o[S],!0),ce>N&&(H=ie,N=ce);N>g&&(h[H]=1,zs(o,h,g,x,H),zs(o,h,g,H,S))}function Ya(o,h){for(var g=[o[0]],x=1,S=0,N=o.length;x<N;x++)Ja(o[x],o[S])>h&&(g.push(o[x]),S=x);return S<N-1&&g.push(o[N-1]),g}var js;function $o(o,h,g,x,S){var N=x?js:qn(o,g),H=qn(h,g),ie,ce,ve;for(js=H;;){if(!(N|H))return[o,h];if(N&H)return!1;ie=N||H,ce=Vi(o,h,ie,g,S),ve=qn(ce,g),ie===N?(o=ce,N=ve):(h=ce,H=ve)}}function Vi(o,h,g,x,S){var N=h.x-o.x,H=h.y-o.y,ie=x.min,ce=x.max,ve,Ce;return g&8?(ve=o.x+N*(ce.y-o.y)/H,Ce=ce.y):g&4?(ve=o.x+N*(ie.y-o.y)/H,Ce=ie.y):g&2?(ve=ce.x,Ce=o.y+H*(ce.x-o.x)/N):g&1&&(ve=ie.x,Ce=o.y+H*(ie.x-o.x)/N),new V(ve,Ce,S)}function qn(o,h){var g=0;return o.x<h.min.x?g|=1:o.x>h.max.x&&(g|=2),o.y<h.min.y?g|=4:o.y>h.max.y&&(g|=8),g}function Ja(o,h){var g=h.x-o.x,x=h.y-o.y;return g*g+x*x}function Gn(o,h,g,x){var S=h.x,N=h.y,H=g.x-S,ie=g.y-N,ce=H*H+ie*ie,ve;return ce>0&&(ve=((o.x-S)*H+(o.y-N)*ie)/ce,ve>1?(S=g.x,N=g.y):ve>0&&(S+=H*ve,N+=ie*ve)),H=o.x-S,ie=o.y-N,x?H*H+ie*ie:new V(S,N)}function zt(o){return!se(o[0])||typeof o[0][0]!="object"&&typeof o[0][0]<"u"}function Do(o){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),zt(o)}function Oo(o,h){var g,x,S,N,H,ie,ce,ve;if(!o||o.length===0)throw new Error("latlngs not passed");zt(o)||(console.warn("latlngs are not flat! Only the first ring will be used"),o=o[0]);var Ce=_e([0,0]),$e=we(o),He=$e.getNorthWest().distanceTo($e.getSouthWest())*$e.getNorthEast().distanceTo($e.getNorthWest());He<1700&&(Ce=Os(o));var mt=o.length,dt=[];for(g=0;g<mt;g++){var Mt=_e(o[g]);dt.push(h.project(_e([Mt.lat-Ce.lat,Mt.lng-Ce.lng])))}for(g=0,x=0;g<mt-1;g++)x+=dt[g].distanceTo(dt[g+1])/2;if(x===0)ve=dt[0];else for(g=0,N=0;g<mt-1;g++)if(H=dt[g],ie=dt[g+1],S=H.distanceTo(ie),N+=S,N>x){ce=(N-x)/S,ve=[ie.x-ce*(ie.x-H.x),ie.y-ce*(ie.y-H.y)];break}var Tt=h.unproject(q(ve));return _e([Tt.lat+Ce.lat,Tt.lng+Ce.lng])}var zo={__proto__:null,simplify:Ki,pointToSegmentDistance:Mo,closestPointOnSegment:qa,clipSegment:$o,_getEdgeIntersection:Vi,_getBitCode:qn,_sqClosestPointOnSegment:Gn,isFlat:zt,_flat:Do,polylineCenter:Oo},Us={project:function(o){return new V(o.lng,o.lat)},unproject:function(o){return new pe(o.y,o.x)},bounds:new I([-180,-90],[180,90])},Fs={R:6378137,R_MINOR:6356752314245179e-9,bounds:new I([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(o){var h=Math.PI/180,g=this.R,x=o.lat*h,S=this.R_MINOR/g,N=Math.sqrt(1-S*S),H=N*Math.sin(x),ie=Math.tan(Math.PI/4-x/2)/Math.pow((1-H)/(1+H),N/2);return x=-g*Math.log(Math.max(ie,1e-10)),new V(o.lng*h*g,x)},unproject:function(o){for(var h=180/Math.PI,g=this.R,x=this.R_MINOR/g,S=Math.sqrt(1-x*x),N=Math.exp(-o.y/g),H=Math.PI/2-2*Math.atan(N),ie=0,ce=.1,ve;ie<15&&Math.abs(ce)>1e-7;ie++)ve=S*Math.sin(H),ve=Math.pow((1-ve)/(1+ve),S/2),ce=Math.PI/2-2*Math.atan(N*ve)-H,H+=ce;return new pe(H*h,o.x*h/g)}},Xa={__proto__:null,LonLat:Us,Mercator:Fs,SphericalMercator:Ke},Qa=c({},Ie,{code:"EPSG:3395",projection:Fs,transformation:(function(){var o=.5/(Math.PI*Fs.R);return at(o,.5,-o,.5)})()}),jo=c({},Ie,{code:"EPSG:4326",projection:Us,transformation:at(1/180,1,-1/180,.5)}),el=c({},Re,{projection:Us,transformation:at(1,0,-1,0),scale:function(o){return Math.pow(2,o)},zoom:function(o){return Math.log(o)/Math.LN2},distance:function(o,h){var g=h.lng-o.lng,x=h.lat-o.lat;return Math.sqrt(g*g+x*x)},infinite:!0});Re.Earth=Ie,Re.EPSG3395=Qa,Re.EPSG3857=vt,Re.EPSG900913=Cn,Re.EPSG4326=jo,Re.Simple=el;var Yt=ne.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(o){return o.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(o){return o&&o.removeLayer(this),this},getPane:function(o){return this._map.getPane(o?this.options[o]||o:this.options.pane)},addInteractiveTarget:function(o){return this._map._targets[w(o)]=this,this},removeInteractiveTarget:function(o){return delete this._map._targets[w(o)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(o){var h=o.target;if(h.hasLayer(this)){if(this._map=h,this._zoomAnimated=h._zoomAnimated,this.getEvents){var g=this.getEvents();h.on(g,this),this.once("remove",function(){h.off(g,this)},this)}this.onAdd(h),this.fire("add"),h.fire("layeradd",{layer:this})}}});Ve.include({addLayer:function(o){if(!o._layerAdd)throw new Error("The provided object is not a Layer.");var h=w(o);return this._layers[h]?this:(this._layers[h]=o,o._mapToAdd=this,o.beforeAdd&&o.beforeAdd(this),this.whenReady(o._layerAdd,o),this)},removeLayer:function(o){var h=w(o);return this._layers[h]?(this._loaded&&o.onRemove(this),delete this._layers[h],this._loaded&&(this.fire("layerremove",{layer:o}),o.fire("remove")),o._map=o._mapToAdd=null,this):this},hasLayer:function(o){return w(o)in this._layers},eachLayer:function(o,h){for(var g in this._layers)o.call(h,this._layers[g]);return this},_addLayers:function(o){o=o?se(o)?o:[o]:[];for(var h=0,g=o.length;h<g;h++)this.addLayer(o[h])},_addZoomLimit:function(o){(!isNaN(o.options.maxZoom)||!isNaN(o.options.minZoom))&&(this._zoomBoundLayers[w(o)]=o,this._updateZoomLevels())},_removeZoomLimit:function(o){var h=w(o);this._zoomBoundLayers[h]&&(delete this._zoomBoundLayers[h],this._updateZoomLevels())},_updateZoomLevels:function(){var o=1/0,h=-1/0,g=this._getZoomSpan();for(var x in this._zoomBoundLayers){var S=this._zoomBoundLayers[x].options;o=S.minZoom===void 0?o:Math.min(o,S.minZoom),h=S.maxZoom===void 0?h:Math.max(h,S.maxZoom)}this._layersMaxZoom=h===-1/0?void 0:h,this._layersMinZoom=o===1/0?void 0:o,g!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Nn=Yt.extend({initialize:function(o,h){B(this,h),this._layers={};var g,x;if(o)for(g=0,x=o.length;g<x;g++)this.addLayer(o[g])},addLayer:function(o){var h=this.getLayerId(o);return this._layers[h]=o,this._map&&this._map.addLayer(o),this},removeLayer:function(o){var h=o in this._layers?o:this.getLayerId(o);return this._map&&this._layers[h]&&this._map.removeLayer(this._layers[h]),delete this._layers[h],this},hasLayer:function(o){var h=typeof o=="number"?o:this.getLayerId(o);return h in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(o){var h=Array.prototype.slice.call(arguments,1),g,x;for(g in this._layers)x=this._layers[g],x[o]&&x[o].apply(x,h);return this},onAdd:function(o){this.eachLayer(o.addLayer,o)},onRemove:function(o){this.eachLayer(o.removeLayer,o)},eachLayer:function(o,h){for(var g in this._layers)o.call(h,this._layers[g]);return this},getLayer:function(o){return this._layers[o]},getLayers:function(){var o=[];return this.eachLayer(o.push,o),o},setZIndex:function(o){return this.invoke("setZIndex",o)},getLayerId:function(o){return w(o)}}),ai=function(o,h){return new Nn(o,h)},vn=Nn.extend({addLayer:function(o){return this.hasLayer(o)?this:(o.addEventParent(this),Nn.prototype.addLayer.call(this,o),this.fire("layeradd",{layer:o}))},removeLayer:function(o){return this.hasLayer(o)?(o in this._layers&&(o=this._layers[o]),o.removeEventParent(this),Nn.prototype.removeLayer.call(this,o),this.fire("layerremove",{layer:o})):this},setStyle:function(o){return this.invoke("setStyle",o)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var o=new Ee;for(var h in this._layers){var g=this._layers[h];o.extend(g.getBounds?g.getBounds():g.getLatLng())}return o}}),Uo=function(o,h){return new vn(o,h)},Yn=Y.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(o){B(this,o)},createIcon:function(o){return this._createIcon("icon",o)},createShadow:function(o){return this._createIcon("shadow",o)},_createIcon:function(o,h){var g=this._getIconUrl(o);if(!g){if(o==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var x=this._createImg(g,h&&h.tagName==="IMG"?h:null);return this._setIconStyles(x,o),(this.options.crossOrigin||this.options.crossOrigin==="")&&(x.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),x},_setIconStyles:function(o,h){var g=this.options,x=g[h+"Size"];typeof x=="number"&&(x=[x,x]);var S=q(x),N=q(h==="shadow"&&g.shadowAnchor||g.iconAnchor||S&&S.divideBy(2,!0));o.className="leaflet-marker-"+h+" "+(g.className||""),N&&(o.style.marginLeft=-N.x+"px",o.style.marginTop=-N.y+"px"),S&&(o.style.width=S.x+"px",o.style.height=S.y+"px")},_createImg:function(o,h){return h=h||document.createElement("img"),h.src=o,h},_getIconUrl:function(o){return Ae.retina&&this.options[o+"RetinaUrl"]||this.options[o+"Url"]}});function Fo(o){return new Yn(o)}var Er=Yn.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(o){return typeof Er.imagePath!="string"&&(Er.imagePath=this._detectIconPath()),(this.options.imagePath||Er.imagePath)+Yn.prototype._getIconUrl.call(this,o)},_stripUrl:function(o){var h=function(g,x,S){var N=x.exec(g);return N&&N[S]};return o=h(o,/^url\((['"])?(.+)\1\)$/,2),o&&h(o,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var o=Fe("div","leaflet-default-icon-path",document.body),h=ei(o,"background-image")||ei(o,"backgroundImage");if(document.body.removeChild(o),h=this._stripUrl(h),h)return h;var g=document.querySelector('link[href$="leaflet.css"]');return g?g.href.substring(0,g.href.length-11-1):""}}),Hs=Ot.extend({initialize:function(o){this._marker=o},addHooks:function(){var o=this._marker._icon;this._draggable||(this._draggable=new Gt(o,o,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Ue(o,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Xe(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(o){var h=this._marker,g=h._map,x=this._marker.options.autoPanSpeed,S=this._marker.options.autoPanPadding,N=gn(h._icon),H=g.getPixelBounds(),ie=g.getPixelOrigin(),ce=G(H.min._subtract(ie).add(S),H.max._subtract(ie).subtract(S));if(!ce.contains(N)){var ve=q((Math.max(ce.max.x,N.x)-ce.max.x)/(H.max.x-ce.max.x)-(Math.min(ce.min.x,N.x)-ce.min.x)/(H.min.x-ce.min.x),(Math.max(ce.max.y,N.y)-ce.max.y)/(H.max.y-ce.max.y)-(Math.min(ce.min.y,N.y)-ce.min.y)/(H.min.y-ce.min.y)).multiplyBy(x);g.panBy(ve,{animate:!1}),this._draggable._newPos._add(ve),this._draggable._startPos._add(ve),lt(h._icon,this._draggable._newPos),this._onDrag(o),this._panRequest=F(this._adjustPan.bind(this,o))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(o){this._marker.options.autoPan&&(K(this._panRequest),this._panRequest=F(this._adjustPan.bind(this,o)))},_onDrag:function(o){var h=this._marker,g=h._shadow,x=gn(h._icon),S=h._map.layerPointToLatLng(x);g&&lt(g,x),h._latlng=S,o.latlng=S,o.oldLatLng=this._oldLatLng,h.fire("move",o).fire("drag",o)},_onDragEnd:function(o){K(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",o)}}),_n=Yt.extend({options:{icon:new Er,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(o,h){B(this,h),this._latlng=_e(o)},onAdd:function(o){this._zoomAnimated=this._zoomAnimated&&o.options.markerZoomAnimation,this._zoomAnimated&&o.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(o){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&o.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(o){var h=this._latlng;return this._latlng=_e(o),this.update(),this.fire("move",{oldLatLng:h,latlng:this._latlng})},setZIndexOffset:function(o){return this.options.zIndexOffset=o,this.update()},getIcon:function(){return this.options.icon},setIcon:function(o){return this.options.icon=o,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var o=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(o)}return this},_initIcon:function(){var o=this.options,h="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),g=o.icon.createIcon(this._icon),x=!1;g!==this._icon&&(this._icon&&this._removeIcon(),x=!0,o.title&&(g.title=o.title),g.tagName==="IMG"&&(g.alt=o.alt||"")),Ue(g,h),o.keyboard&&(g.tabIndex="0",g.setAttribute("role","button")),this._icon=g,o.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&ze(g,"focus",this._panOnFocus,this);var S=o.icon.createShadow(this._shadow),N=!1;S!==this._shadow&&(this._removeShadow(),N=!0),S&&(Ue(S,h),S.alt=""),this._shadow=S,o.opacity<1&&this._updateOpacity(),x&&this.getPane().appendChild(this._icon),this._initInteraction(),S&&N&&this.getPane(o.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ye(this._icon,"focus",this._panOnFocus,this),et(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&et(this._shadow),this._shadow=null},_setPos:function(o){this._icon&&lt(this._icon,o),this._shadow&&lt(this._shadow,o),this._zIndex=o.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(o){this._icon&&(this._icon.style.zIndex=this._zIndex+o)},_animateZoom:function(o){var h=this._map._latLngToNewLayerPoint(this._latlng,o.zoom,o.center).round();this._setPos(h)},_initInteraction:function(){if(this.options.interactive&&(Ue(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Hs)){var o=this.options.draggable;this.dragging&&(o=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Hs(this),o&&this.dragging.enable()}},setOpacity:function(o){return this.options.opacity=o,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var o=this.options.opacity;this._icon&&Ct(this._icon,o),this._shadow&&Ct(this._shadow,o)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var o=this._map;if(o){var h=this.options.icon.options,g=h.iconSize?q(h.iconSize):q(0,0),x=h.iconAnchor?q(h.iconAnchor):q(0,0);o.panInside(this._latlng,{paddingTopLeft:x,paddingBottomRight:g.subtract(x)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function tl(o,h){return new _n(o,h)}var An=Yt.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(o){this._renderer=o.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(o){return B(this,o),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&o&&Object.prototype.hasOwnProperty.call(o,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Zi=An.extend({options:{fill:!0,radius:10},initialize:function(o,h){B(this,h),this._latlng=_e(o),this._radius=this.options.radius},setLatLng:function(o){var h=this._latlng;return this._latlng=_e(o),this.redraw(),this.fire("move",{oldLatLng:h,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(o){return this.options.radius=this._radius=o,this.redraw()},getRadius:function(){return this._radius},setStyle:function(o){var h=o&&o.radius||this._radius;return An.prototype.setStyle.call(this,o),this.setRadius(h),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var o=this._radius,h=this._radiusY||o,g=this._clickTolerance(),x=[o+g,h+g];this._pxBounds=new I(this._point.subtract(x),this._point.add(x))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(o){return o.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Ho(o,h){return new Zi(o,h)}var Wi=Zi.extend({initialize:function(o,h,g){if(typeof h=="number"&&(h=c({},g,{radius:h})),B(this,h),this._latlng=_e(o),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(o){return this._mRadius=o,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var o=[this._radius,this._radiusY||this._radius];return new Ee(this._map.layerPointToLatLng(this._point.subtract(o)),this._map.layerPointToLatLng(this._point.add(o)))},setStyle:An.prototype.setStyle,_project:function(){var o=this._latlng.lng,h=this._latlng.lat,g=this._map,x=g.options.crs;if(x.distance===Ie.distance){var S=Math.PI/180,N=this._mRadius/Ie.R/S,H=g.project([h+N,o]),ie=g.project([h-N,o]),ce=H.add(ie).divideBy(2),ve=g.unproject(ce).lat,Ce=Math.acos((Math.cos(N*S)-Math.sin(h*S)*Math.sin(ve*S))/(Math.cos(h*S)*Math.cos(ve*S)))/S;(isNaN(Ce)||Ce===0)&&(Ce=N/Math.cos(Math.PI/180*h)),this._point=ce.subtract(g.getPixelOrigin()),this._radius=isNaN(Ce)?0:ce.x-g.project([ve,o-Ce]).x,this._radiusY=ce.y-H.y}else{var $e=x.unproject(x.project(this._latlng).subtract([this._mRadius,0]));this._point=g.latLngToLayerPoint(this._latlng),this._radius=this._point.x-g.latLngToLayerPoint($e).x}this._updateBounds()}});function li(o,h,g){return new Wi(o,h,g)}var Bt=An.extend({options:{smoothFactor:1,noClip:!1},initialize:function(o,h){B(this,h),this._setLatLngs(o)},getLatLngs:function(){return this._latlngs},setLatLngs:function(o){return this._setLatLngs(o),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(o){for(var h=1/0,g=null,x=Gn,S,N,H=0,ie=this._parts.length;H<ie;H++)for(var ce=this._parts[H],ve=1,Ce=ce.length;ve<Ce;ve++){S=ce[ve-1],N=ce[ve];var $e=x(o,S,N,!0);$e<h&&(h=$e,g=x(o,S,N))}return g&&(g.distance=Math.sqrt(h)),g},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Oo(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(o,h){return h=h||this._defaultShape(),o=_e(o),h.push(o),this._bounds.extend(o),this.redraw()},_setLatLngs:function(o){this._bounds=new Ee,this._latlngs=this._convertLatLngs(o)},_defaultShape:function(){return zt(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(o){for(var h=[],g=zt(o),x=0,S=o.length;x<S;x++)g?(h[x]=_e(o[x]),this._bounds.extend(h[x])):h[x]=this._convertLatLngs(o[x]);return h},_project:function(){var o=new I;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,o),this._bounds.isValid()&&o.isValid()&&(this._rawPxBounds=o,this._updateBounds())},_updateBounds:function(){var o=this._clickTolerance(),h=new V(o,o);this._rawPxBounds&&(this._pxBounds=new I([this._rawPxBounds.min.subtract(h),this._rawPxBounds.max.add(h)]))},_projectLatlngs:function(o,h,g){var x=o[0]instanceof pe,S=o.length,N,H;if(x){for(H=[],N=0;N<S;N++)H[N]=this._map.latLngToLayerPoint(o[N]),g.extend(H[N]);h.push(H)}else for(N=0;N<S;N++)this._projectLatlngs(o[N],h,g)},_clipPoints:function(){var o=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(o))){if(this.options.noClip){this._parts=this._rings;return}var h=this._parts,g,x,S,N,H,ie,ce;for(g=0,S=0,N=this._rings.length;g<N;g++)for(ce=this._rings[g],x=0,H=ce.length;x<H-1;x++)ie=$o(ce[x],ce[x+1],o,x,!0),ie&&(h[S]=h[S]||[],h[S].push(ie[0]),(ie[1]!==ce[x+1]||x===H-2)&&(h[S].push(ie[1]),S++))}},_simplifyPoints:function(){for(var o=this._parts,h=this.options.smoothFactor,g=0,x=o.length;g<x;g++)o[g]=Ki(o[g],h)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(o,h){var g,x,S,N,H,ie,ce=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(o))return!1;for(g=0,N=this._parts.length;g<N;g++)for(ie=this._parts[g],x=0,H=ie.length,S=H-1;x<H;S=x++)if(!(!h&&x===0)&&Mo(o,ie[S],ie[x])<=ce)return!0;return!1}});function nl(o,h){return new Bt(o,h)}Bt._flat=Do;var wn=Bt.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Bo(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(o){var h=Bt.prototype._convertLatLngs.call(this,o),g=h.length;return g>=2&&h[0]instanceof pe&&h[0].equals(h[g-1])&&h.pop(),h},_setLatLngs:function(o){Bt.prototype._setLatLngs.call(this,o),zt(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return zt(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var o=this._renderer._bounds,h=this.options.weight,g=new V(h,h);if(o=new I(o.min.subtract(g),o.max.add(g)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(o))){if(this.options.noClip){this._parts=this._rings;return}for(var x=0,S=this._rings.length,N;x<S;x++)N=Ds(this._rings[x],o,!0),N.length&&this._parts.push(N)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(o){var h=!1,g,x,S,N,H,ie,ce,ve;if(!this._pxBounds||!this._pxBounds.contains(o))return!1;for(N=0,ce=this._parts.length;N<ce;N++)for(g=this._parts[N],H=0,ve=g.length,ie=ve-1;H<ve;ie=H++)x=g[H],S=g[ie],x.y>o.y!=S.y>o.y&&o.x<(S.x-x.x)*(o.y-x.y)/(S.y-x.y)+x.x&&(h=!h);return h||Bt.prototype._containsPoint.call(this,o,!0)}});function rl(o,h){return new wn(o,h)}var sn=vn.extend({initialize:function(o,h){B(this,h),this._layers={},o&&this.addData(o)},addData:function(o){var h=se(o)?o:o.features,g,x,S;if(h){for(g=0,x=h.length;g<x;g++)S=h[g],(S.geometries||S.geometry||S.features||S.coordinates)&&this.addData(S);return this}var N=this.options;if(N.filter&&!N.filter(o))return this;var H=kr(o,N);return H?(H.feature=Xi(o),H.defaultOptions=H.options,this.resetStyle(H),N.onEachFeature&&N.onEachFeature(o,H),this.addLayer(H)):this},resetStyle:function(o){return o===void 0?this.eachLayer(this.resetStyle,this):(o.options=c({},o.defaultOptions),this._setLayerStyle(o,this.options.style),this)},setStyle:function(o){return this.eachLayer(function(h){this._setLayerStyle(h,o)},this)},_setLayerStyle:function(o,h){o.setStyle&&(typeof h=="function"&&(h=h(o.feature)),o.setStyle(h))}});function kr(o,h){var g=o.type==="Feature"?o.geometry:o,x=g?g.coordinates:null,S=[],N=h&&h.pointToLayer,H=h&&h.coordsToLatLng||Gi,ie,ce,ve,Ce;if(!x&&!g)return null;switch(g.type){case"Point":return ie=H(x),qi(N,o,ie,h);case"MultiPoint":for(ve=0,Ce=x.length;ve<Ce;ve++)ie=H(x[ve]),S.push(qi(N,o,ie,h));return new vn(S);case"LineString":case"MultiLineString":return ce=ui(x,g.type==="LineString"?0:1,H),new Bt(ce,h);case"Polygon":case"MultiPolygon":return ce=ui(x,g.type==="Polygon"?1:2,H),new wn(ce,h);case"GeometryCollection":for(ve=0,Ce=g.geometries.length;ve<Ce;ve++){var $e=kr({geometry:g.geometries[ve],type:"Feature",properties:o.properties},h);$e&&S.push($e)}return new vn(S);case"FeatureCollection":for(ve=0,Ce=g.features.length;ve<Ce;ve++){var He=kr(g.features[ve],h);He&&S.push(He)}return new vn(S);default:throw new Error("Invalid GeoJSON object.")}}function qi(o,h,g,x){return o?o(h,g):new _n(g,x&&x.markersInheritOptions&&x)}function Gi(o){return new pe(o[1],o[0],o[2])}function ui(o,h,g){for(var x=[],S=0,N=o.length,H;S<N;S++)H=h?ui(o[S],h-1,g):(g||Gi)(o[S]),x.push(H);return x}function Yi(o,h){return o=_e(o),o.alt!==void 0?[T(o.lng,h),T(o.lat,h),T(o.alt,h)]:[T(o.lng,h),T(o.lat,h)]}function Ji(o,h,g,x){for(var S=[],N=0,H=o.length;N<H;N++)S.push(h?Ji(o[N],zt(o[N])?0:h-1,g,x):Yi(o[N],x));return!h&&g&&S.length>0&&S.push(S[0].slice()),S}function Sr(o,h){return o.feature?c({},o.feature,{geometry:h}):Xi(h)}function Xi(o){return o.type==="Feature"||o.type==="FeatureCollection"?o:{type:"Feature",properties:{},geometry:o}}var Ks={toGeoJSON:function(o){return Sr(this,{type:"Point",coordinates:Yi(this.getLatLng(),o)})}};_n.include(Ks),Wi.include(Ks),Zi.include(Ks),Bt.include({toGeoJSON:function(o){var h=!zt(this._latlngs),g=Ji(this._latlngs,h?1:0,!1,o);return Sr(this,{type:(h?"Multi":"")+"LineString",coordinates:g})}}),wn.include({toGeoJSON:function(o){var h=!zt(this._latlngs),g=h&&!zt(this._latlngs[0]),x=Ji(this._latlngs,g?2:h?1:0,!0,o);return h||(x=[x]),Sr(this,{type:(g?"Multi":"")+"Polygon",coordinates:x})}}),Nn.include({toMultiPoint:function(o){var h=[];return this.eachLayer(function(g){h.push(g.toGeoJSON(o).geometry.coordinates)}),Sr(this,{type:"MultiPoint",coordinates:h})},toGeoJSON:function(o){var h=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(h==="MultiPoint")return this.toMultiPoint(o);var g=h==="GeometryCollection",x=[];return this.eachLayer(function(S){if(S.toGeoJSON){var N=S.toGeoJSON(o);if(g)x.push(N.geometry);else{var H=Xi(N);H.type==="FeatureCollection"?x.push.apply(x,H.features):x.push(H)}}}),g?Sr(this,{geometries:x,type:"GeometryCollection"}):{type:"FeatureCollection",features:x}}});function Ko(o,h){return new sn(o,h)}var Jt=Ko,In=Yt.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(o,h,g){this._url=o,this._bounds=we(h),B(this,g)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Ue(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){et(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(o){return this.options.opacity=o,this._image&&this._updateOpacity(),this},setStyle:function(o){return o.opacity&&this.setOpacity(o.opacity),this},bringToFront:function(){return this._map&&mr(this._image),this},bringToBack:function(){return this._map&&mn(this._image),this},setUrl:function(o){return this._url=o,this._image&&(this._image.src=o),this},setBounds:function(o){return this._bounds=we(o),this._map&&this._reset(),this},getEvents:function(){var o={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(o.zoomanim=this._animateZoom),o},setZIndex:function(o){return this.options.zIndex=o,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var o=this._url.tagName==="IMG",h=this._image=o?this._url:Fe("img");if(Ue(h,"leaflet-image-layer"),this._zoomAnimated&&Ue(h,"leaflet-zoom-animated"),this.options.className&&Ue(h,this.options.className),h.onselectstart=R,h.onmousemove=R,h.onload=y(this.fire,this,"load"),h.onerror=y(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(h.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),o){this._url=h.src;return}h.src=this._url,h.alt=this.options.alt},_animateZoom:function(o){var h=this._map.getZoomScale(o.zoom),g=this._map._latLngBoundsToNewLayerBounds(this._bounds,o.zoom,o.center).min;Zt(this._image,g,h)},_reset:function(){var o=this._image,h=new I(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),g=h.getSize();lt(o,h.min),o.style.width=g.x+"px",o.style.height=g.y+"px"},_updateOpacity:function(){Ct(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var o=this.options.errorOverlayUrl;o&&this._url!==o&&(this._url=o,this._image.src=o)},getCenter:function(){return this._bounds.getCenter()}}),Vo=function(o,h,g){return new In(o,h,g)},Vs=In.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var o=this._url.tagName==="VIDEO",h=this._image=o?this._url:Fe("video");if(Ue(h,"leaflet-image-layer"),this._zoomAnimated&&Ue(h,"leaflet-zoom-animated"),this.options.className&&Ue(h,this.options.className),h.onselectstart=R,h.onmousemove=R,h.onloadeddata=y(this.fire,this,"load"),o){for(var g=h.getElementsByTagName("source"),x=[],S=0;S<g.length;S++)x.push(g[S].src);this._url=g.length>0?x:[h.src];return}se(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(h.style,"objectFit")&&(h.style.objectFit="fill"),h.autoplay=!!this.options.autoplay,h.loop=!!this.options.loop,h.muted=!!this.options.muted,h.playsInline=!!this.options.playsInline;for(var N=0;N<this._url.length;N++){var H=Fe("source");H.src=this._url[N],h.appendChild(H)}}});function Zo(o,h,g){return new Vs(o,h,g)}var Zs=In.extend({_initImage:function(){var o=this._image=this._url;Ue(o,"leaflet-image-layer"),this._zoomAnimated&&Ue(o,"leaflet-zoom-animated"),this.options.className&&Ue(o,this.options.className),o.onselectstart=R,o.onmousemove=R}});function Ws(o,h,g){return new Zs(o,h,g)}var on=Yt.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(o,h){o&&(o instanceof pe||se(o))?(this._latlng=_e(o),B(this,h)):(B(this,o),this._source=h),this.options.content&&(this._content=this.options.content)},openOn:function(o){return o=arguments.length?o:this._source._map,o.hasLayer(this)||o.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(o){return this._map?this.close():(arguments.length?this._source=o:o=this._source,this._prepareOpen(),this.openOn(o._map)),this},onAdd:function(o){this._zoomAnimated=o._zoomAnimated,this._container||this._initLayout(),o._fadeAnimated&&Ct(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),o._fadeAnimated&&Ct(this._container,1),this.bringToFront(),this.options.interactive&&(Ue(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(o){o._fadeAnimated?(Ct(this._container,0),this._removeTimeout=setTimeout(y(et,void 0,this._container),200)):et(this._container),this.options.interactive&&(Xe(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(o){return this._latlng=_e(o),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(o){return this._content=o,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var o={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(o.zoomanim=this._animateZoom),o},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&mr(this._container),this},bringToBack:function(){return this._map&&mn(this._container),this},_prepareOpen:function(o){var h=this._source;if(!h._map)return!1;if(h instanceof vn){h=null;var g=this._source._layers;for(var x in g)if(g[x]._map){h=g[x];break}if(!h)return!1;this._source=h}if(!o)if(h.getCenter)o=h.getCenter();else if(h.getLatLng)o=h.getLatLng();else if(h.getBounds)o=h.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(o),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var o=this._contentNode,h=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof h=="string")o.innerHTML=h;else{for(;o.hasChildNodes();)o.removeChild(o.firstChild);o.appendChild(h)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var o=this._map.latLngToLayerPoint(this._latlng),h=q(this.options.offset),g=this._getAnchor();this._zoomAnimated?lt(this._container,o.add(g)):h=h.add(o).add(g);var x=this._containerBottom=-h.y,S=this._containerLeft=-Math.round(this._containerWidth/2)+h.x;this._container.style.bottom=x+"px",this._container.style.left=S+"px"}},_getAnchor:function(){return[0,0]}});Ve.include({_initOverlay:function(o,h,g,x){var S=h;return S instanceof o||(S=new o(x).setContent(h)),g&&S.setLatLng(g),S}}),Yt.include({_initOverlay:function(o,h,g,x){var S=g;return S instanceof o?(B(S,x),S._source=this):(S=h&&!x?h:new o(x,this),S.setContent(g)),S}});var Qi=on.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(o){return o=arguments.length?o:this._source._map,!o.hasLayer(this)&&o._popup&&o._popup.options.autoClose&&o.removeLayer(o._popup),o._popup=this,on.prototype.openOn.call(this,o)},onAdd:function(o){on.prototype.onAdd.call(this,o),o.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof An||this._source.on("preclick",rn))},onRemove:function(o){on.prototype.onRemove.call(this,o),o.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof An||this._source.off("preclick",rn))},getEvents:function(){var o=on.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(o.preclick=this.close),this.options.keepInView&&(o.moveend=this._adjustPan),o},_initLayout:function(){var o="leaflet-popup",h=this._container=Fe("div",o+" "+(this.options.className||"")+" leaflet-zoom-animated"),g=this._wrapper=Fe("div",o+"-content-wrapper",h);if(this._contentNode=Fe("div",o+"-content",g),ii(h),ji(this._contentNode),ze(h,"contextmenu",rn),this._tipContainer=Fe("div",o+"-tip-container",h),this._tip=Fe("div",o+"-tip",this._tipContainer),this.options.closeButton){var x=this._closeButton=Fe("a",o+"-close-button",h);x.setAttribute("role","button"),x.setAttribute("aria-label","Close popup"),x.href="#close",x.innerHTML='<span aria-hidden="true">&#215;</span>',ze(x,"click",function(S){it(S),this.close()},this)}},_updateLayout:function(){var o=this._contentNode,h=o.style;h.width="",h.whiteSpace="nowrap";var g=o.offsetWidth;g=Math.min(g,this.options.maxWidth),g=Math.max(g,this.options.minWidth),h.width=g+1+"px",h.whiteSpace="",h.height="";var x=o.offsetHeight,S=this.options.maxHeight,N="leaflet-popup-scrolled";S&&x>S?(h.height=S+"px",Ue(o,N)):Xe(o,N),this._containerWidth=this._container.offsetWidth},_animateZoom:function(o){var h=this._map._latLngToNewLayerPoint(this._latlng,o.zoom,o.center),g=this._getAnchor();lt(this._container,h.add(g))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var o=this._map,h=parseInt(ei(this._container,"marginBottom"),10)||0,g=this._container.offsetHeight+h,x=this._containerWidth,S=new V(this._containerLeft,-g-this._containerBottom);S._add(gn(this._container));var N=o.layerPointToContainerPoint(S),H=q(this.options.autoPanPadding),ie=q(this.options.autoPanPaddingTopLeft||H),ce=q(this.options.autoPanPaddingBottomRight||H),ve=o.getSize(),Ce=0,$e=0;N.x+x+ce.x>ve.x&&(Ce=N.x+x-ve.x+ce.x),N.x-Ce-ie.x<0&&(Ce=N.x-ie.x),N.y+g+ce.y>ve.y&&($e=N.y+g-ve.y+ce.y),N.y-$e-ie.y<0&&($e=N.y-ie.y),(Ce||$e)&&(this.options.keepInView&&(this._autopanning=!0),o.fire("autopanstart").panBy([Ce,$e]))}},_getAnchor:function(){return q(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Cr=function(o,h){return new Qi(o,h)};Ve.mergeOptions({closePopupOnClick:!0}),Ve.include({openPopup:function(o,h,g){return this._initOverlay(Qi,o,h,g).openOn(this),this},closePopup:function(o){return o=arguments.length?o:this._popup,o&&o.close(),this}}),Yt.include({bindPopup:function(o,h){return this._popup=this._initOverlay(Qi,this._popup,o,h),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(o){return this._popup&&(this instanceof vn||(this._popup._source=this),this._popup._prepareOpen(o||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(o){return this._popup&&this._popup.setContent(o),this},getPopup:function(){return this._popup},_openPopup:function(o){if(!(!this._popup||!this._map)){qt(o);var h=o.layer||o.target;if(this._popup._source===h&&!(h instanceof An)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(o.latlng);return}this._popup._source=h,this.openPopup(o.latlng)}},_movePopup:function(o){this._popup.setLatLng(o.latlng)},_onKeyPress:function(o){o.originalEvent.keyCode===13&&this._openPopup(o)}});var Rr=on.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(o){on.prototype.onAdd.call(this,o),this.setOpacity(this.options.opacity),o.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(o){on.prototype.onRemove.call(this,o),o.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var o=on.prototype.getEvents.call(this);return this.options.permanent||(o.preclick=this.close),o},_initLayout:function(){var o="leaflet-tooltip",h=o+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Fe("div",h),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+w(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(o){var h,g,x=this._map,S=this._container,N=x.latLngToContainerPoint(x.getCenter()),H=x.layerPointToContainerPoint(o),ie=this.options.direction,ce=S.offsetWidth,ve=S.offsetHeight,Ce=q(this.options.offset),$e=this._getAnchor();ie==="top"?(h=ce/2,g=ve):ie==="bottom"?(h=ce/2,g=0):ie==="center"?(h=ce/2,g=ve/2):ie==="right"?(h=0,g=ve/2):ie==="left"?(h=ce,g=ve/2):H.x<N.x?(ie="right",h=0,g=ve/2):(ie="left",h=ce+(Ce.x+$e.x)*2,g=ve/2),o=o.subtract(q(h,g,!0)).add(Ce).add($e),Xe(S,"leaflet-tooltip-right"),Xe(S,"leaflet-tooltip-left"),Xe(S,"leaflet-tooltip-top"),Xe(S,"leaflet-tooltip-bottom"),Ue(S,"leaflet-tooltip-"+ie),lt(S,o)},_updatePosition:function(){var o=this._map.latLngToLayerPoint(this._latlng);this._setPosition(o)},setOpacity:function(o){this.options.opacity=o,this._container&&Ct(this._container,o)},_animateZoom:function(o){var h=this._map._latLngToNewLayerPoint(this._latlng,o.zoom,o.center);this._setPosition(h)},_getAnchor:function(){return q(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),ci=function(o,h){return new Rr(o,h)};Ve.include({openTooltip:function(o,h,g){return this._initOverlay(Rr,o,h,g).openOn(this),this},closeTooltip:function(o){return o.close(),this}}),Yt.include({bindTooltip:function(o,h){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Rr,this._tooltip,o,h),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(o){if(!(!o&&this._tooltipHandlersAdded)){var h=o?"off":"on",g={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?g.add=this._openTooltip:(g.mouseover=this._openTooltip,g.mouseout=this.closeTooltip,g.click=this._openTooltip,this._map?this._addFocusListeners():g.add=this._addFocusListeners),this._tooltip.options.sticky&&(g.mousemove=this._moveTooltip),this[h](g),this._tooltipHandlersAdded=!o}},openTooltip:function(o){return this._tooltip&&(this instanceof vn||(this._tooltip._source=this),this._tooltip._prepareOpen(o)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(o){return this._tooltip&&this._tooltip.setContent(o),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(o){var h=typeof o.getElement=="function"&&o.getElement();h&&(ze(h,"focus",function(){this._tooltip._source=o,this.openTooltip()},this),ze(h,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(o){var h=typeof o.getElement=="function"&&o.getElement();h&&h.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(o){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var h=this;this._map.once("moveend",function(){h._openOnceFlag=!1,h._openTooltip(o)});return}this._tooltip._source=o.layer||o.target,this.openTooltip(this._tooltip.options.sticky?o.latlng:void 0)}},_moveTooltip:function(o){var h=o.latlng,g,x;this._tooltip.options.sticky&&o.originalEvent&&(g=this._map.mouseEventToContainerPoint(o.originalEvent),x=this._map.containerPointToLayerPoint(g),h=this._map.layerPointToLatLng(x)),this._tooltip.setLatLng(h)}});var es=Yn.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(o){var h=o&&o.tagName==="DIV"?o:document.createElement("div"),g=this.options;if(g.html instanceof Element?(Bi(h),h.appendChild(g.html)):h.innerHTML=g.html!==!1?g.html:"",g.bgPos){var x=q(g.bgPos);h.style.backgroundPosition=-x.x+"px "+-x.y+"px"}return this._setIconStyles(h,"icon"),h},createShadow:function(){return null}});function Wo(o){return new es(o)}Yn.Default=Er;var Bn=Yt.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Ae.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(o){B(this,o)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(o){o._addZoomLimit(this)},onRemove:function(o){this._removeAllTiles(),et(this._container),o._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(mr(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(mn(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(o){return this.options.opacity=o,this._updateOpacity(),this},setZIndex:function(o){return this.options.zIndex=o,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var o=this._clampZoom(this._map.getZoom());o!==this._tileZoom&&(this._tileZoom=o,this._updateLevels()),this._update()}return this},getEvents:function(){var o={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=k(this._onMoveEnd,this.options.updateInterval,this)),o.move=this._onMove),this._zoomAnimated&&(o.zoomanim=this._animateZoom),o},createTile:function(){return document.createElement("div")},getTileSize:function(){var o=this.options.tileSize;return o instanceof V?o:new V(o,o)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(o){for(var h=this.getPane().children,g=-o(-1/0,1/0),x=0,S=h.length,N;x<S;x++)N=h[x].style.zIndex,h[x]!==this._container&&N&&(g=o(g,+N));isFinite(g)&&(this.options.zIndex=g+o(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Ae.ielt9){Ct(this._container,this.options.opacity);var o=+new Date,h=!1,g=!1;for(var x in this._tiles){var S=this._tiles[x];if(!(!S.current||!S.loaded)){var N=Math.min(1,(o-S.loaded)/200);Ct(S.el,N),N<1?h=!0:(S.active?g=!0:this._onOpaqueTile(S),S.active=!0)}}g&&!this._noPrune&&this._pruneTiles(),h&&(K(this._fadeFrame),this._fadeFrame=F(this._updateOpacity,this))}},_onOpaqueTile:R,_initContainer:function(){this._container||(this._container=Fe("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var o=this._tileZoom,h=this.options.maxZoom;if(o!==void 0){for(var g in this._levels)g=Number(g),this._levels[g].el.children.length||g===o?(this._levels[g].el.style.zIndex=h-Math.abs(o-g),this._onUpdateLevel(g)):(et(this._levels[g].el),this._removeTilesAtZoom(g),this._onRemoveLevel(g),delete this._levels[g]);var x=this._levels[o],S=this._map;return x||(x=this._levels[o]={},x.el=Fe("div","leaflet-tile-container leaflet-zoom-animated",this._container),x.el.style.zIndex=h,x.origin=S.project(S.unproject(S.getPixelOrigin()),o).round(),x.zoom=o,this._setZoomTransform(x,S.getCenter(),S.getZoom()),R(x.el.offsetWidth),this._onCreateLevel(x)),this._level=x,x}},_onUpdateLevel:R,_onRemoveLevel:R,_onCreateLevel:R,_pruneTiles:function(){if(this._map){var o,h,g=this._map.getZoom();if(g>this.options.maxZoom||g<this.options.minZoom){this._removeAllTiles();return}for(o in this._tiles)h=this._tiles[o],h.retain=h.current;for(o in this._tiles)if(h=this._tiles[o],h.current&&!h.active){var x=h.coords;this._retainParent(x.x,x.y,x.z,x.z-5)||this._retainChildren(x.x,x.y,x.z,x.z+2)}for(o in this._tiles)this._tiles[o].retain||this._removeTile(o)}},_removeTilesAtZoom:function(o){for(var h in this._tiles)this._tiles[h].coords.z===o&&this._removeTile(h)},_removeAllTiles:function(){for(var o in this._tiles)this._removeTile(o)},_invalidateAll:function(){for(var o in this._levels)et(this._levels[o].el),this._onRemoveLevel(Number(o)),delete this._levels[o];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(o,h,g,x){var S=Math.floor(o/2),N=Math.floor(h/2),H=g-1,ie=new V(+S,+N);ie.z=+H;var ce=this._tileCoordsToKey(ie),ve=this._tiles[ce];return ve&&ve.active?(ve.retain=!0,!0):(ve&&ve.loaded&&(ve.retain=!0),H>x?this._retainParent(S,N,H,x):!1)},_retainChildren:function(o,h,g,x){for(var S=2*o;S<2*o+2;S++)for(var N=2*h;N<2*h+2;N++){var H=new V(S,N);H.z=g+1;var ie=this._tileCoordsToKey(H),ce=this._tiles[ie];if(ce&&ce.active){ce.retain=!0;continue}else ce&&ce.loaded&&(ce.retain=!0);g+1<x&&this._retainChildren(S,N,g+1,x)}},_resetView:function(o){var h=o&&(o.pinch||o.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),h,h)},_animateZoom:function(o){this._setView(o.center,o.zoom,!0,o.noUpdate)},_clampZoom:function(o){var h=this.options;return h.minNativeZoom!==void 0&&o<h.minNativeZoom?h.minNativeZoom:h.maxNativeZoom!==void 0&&h.maxNativeZoom<o?h.maxNativeZoom:o},_setView:function(o,h,g,x){var S=Math.round(h);this.options.maxZoom!==void 0&&S>this.options.maxZoom||this.options.minZoom!==void 0&&S<this.options.minZoom?S=void 0:S=this._clampZoom(S);var N=this.options.updateWhenZooming&&S!==this._tileZoom;(!x||N)&&(this._tileZoom=S,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),S!==void 0&&this._update(o),g||this._pruneTiles(),this._noPrune=!!g),this._setZoomTransforms(o,h)},_setZoomTransforms:function(o,h){for(var g in this._levels)this._setZoomTransform(this._levels[g],o,h)},_setZoomTransform:function(o,h,g){var x=this._map.getZoomScale(g,o.zoom),S=o.origin.multiplyBy(x).subtract(this._map._getNewPixelOrigin(h,g)).round();Ae.any3d?Zt(o.el,S,x):lt(o.el,S)},_resetGrid:function(){var o=this._map,h=o.options.crs,g=this._tileSize=this.getTileSize(),x=this._tileZoom,S=this._map.getPixelWorldBounds(this._tileZoom);S&&(this._globalTileRange=this._pxBoundsToTileRange(S)),this._wrapX=h.wrapLng&&!this.options.noWrap&&[Math.floor(o.project([0,h.wrapLng[0]],x).x/g.x),Math.ceil(o.project([0,h.wrapLng[1]],x).x/g.y)],this._wrapY=h.wrapLat&&!this.options.noWrap&&[Math.floor(o.project([h.wrapLat[0],0],x).y/g.x),Math.ceil(o.project([h.wrapLat[1],0],x).y/g.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(o){var h=this._map,g=h._animatingZoom?Math.max(h._animateToZoom,h.getZoom()):h.getZoom(),x=h.getZoomScale(g,this._tileZoom),S=h.project(o,this._tileZoom).floor(),N=h.getSize().divideBy(x*2);return new I(S.subtract(N),S.add(N))},_update:function(o){var h=this._map;if(h){var g=this._clampZoom(h.getZoom());if(o===void 0&&(o=h.getCenter()),this._tileZoom!==void 0){var x=this._getTiledPixelBounds(o),S=this._pxBoundsToTileRange(x),N=S.getCenter(),H=[],ie=this.options.keepBuffer,ce=new I(S.getBottomLeft().subtract([ie,-ie]),S.getTopRight().add([ie,-ie]));if(!(isFinite(S.min.x)&&isFinite(S.min.y)&&isFinite(S.max.x)&&isFinite(S.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var ve in this._tiles){var Ce=this._tiles[ve].coords;(Ce.z!==this._tileZoom||!ce.contains(new V(Ce.x,Ce.y)))&&(this._tiles[ve].current=!1)}if(Math.abs(g-this._tileZoom)>1){this._setView(o,g);return}for(var $e=S.min.y;$e<=S.max.y;$e++)for(var He=S.min.x;He<=S.max.x;He++){var mt=new V(He,$e);if(mt.z=this._tileZoom,!!this._isValidTile(mt)){var dt=this._tiles[this._tileCoordsToKey(mt)];dt?dt.current=!0:H.push(mt)}}if(H.sort(function(Tt,Ar){return Tt.distanceTo(N)-Ar.distanceTo(N)}),H.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Mt=document.createDocumentFragment();for(He=0;He<H.length;He++)this._addTile(H[He],Mt);this._level.el.appendChild(Mt)}}}},_isValidTile:function(o){var h=this._map.options.crs;if(!h.infinite){var g=this._globalTileRange;if(!h.wrapLng&&(o.x<g.min.x||o.x>g.max.x)||!h.wrapLat&&(o.y<g.min.y||o.y>g.max.y))return!1}if(!this.options.bounds)return!0;var x=this._tileCoordsToBounds(o);return we(this.options.bounds).overlaps(x)},_keyToBounds:function(o){return this._tileCoordsToBounds(this._keyToTileCoords(o))},_tileCoordsToNwSe:function(o){var h=this._map,g=this.getTileSize(),x=o.scaleBy(g),S=x.add(g),N=h.unproject(x,o.z),H=h.unproject(S,o.z);return[N,H]},_tileCoordsToBounds:function(o){var h=this._tileCoordsToNwSe(o),g=new Ee(h[0],h[1]);return this.options.noWrap||(g=this._map.wrapLatLngBounds(g)),g},_tileCoordsToKey:function(o){return o.x+":"+o.y+":"+o.z},_keyToTileCoords:function(o){var h=o.split(":"),g=new V(+h[0],+h[1]);return g.z=+h[2],g},_removeTile:function(o){var h=this._tiles[o];h&&(et(h.el),delete this._tiles[o],this.fire("tileunload",{tile:h.el,coords:this._keyToTileCoords(o)}))},_initTile:function(o){Ue(o,"leaflet-tile");var h=this.getTileSize();o.style.width=h.x+"px",o.style.height=h.y+"px",o.onselectstart=R,o.onmousemove=R,Ae.ielt9&&this.options.opacity<1&&Ct(o,this.options.opacity)},_addTile:function(o,h){var g=this._getTilePos(o),x=this._tileCoordsToKey(o),S=this.createTile(this._wrapCoords(o),y(this._tileReady,this,o));this._initTile(S),this.createTile.length<2&&F(y(this._tileReady,this,o,null,S)),lt(S,g),this._tiles[x]={el:S,coords:o,current:!0},h.appendChild(S),this.fire("tileloadstart",{tile:S,coords:o})},_tileReady:function(o,h,g){h&&this.fire("tileerror",{error:h,tile:g,coords:o});var x=this._tileCoordsToKey(o);g=this._tiles[x],g&&(g.loaded=+new Date,this._map._fadeAnimated?(Ct(g.el,0),K(this._fadeFrame),this._fadeFrame=F(this._updateOpacity,this)):(g.active=!0,this._pruneTiles()),h||(Ue(g.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:g.el,coords:o})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Ae.ielt9||!this._map._fadeAnimated?F(this._pruneTiles,this):setTimeout(y(this._pruneTiles,this),250)))},_getTilePos:function(o){return o.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(o){var h=new V(this._wrapX?C(o.x,this._wrapX):o.x,this._wrapY?C(o.y,this._wrapY):o.y);return h.z=o.z,h},_pxBoundsToTileRange:function(o){var h=this.getTileSize();return new I(o.min.unscaleBy(h).floor(),o.max.unscaleBy(h).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var o in this._tiles)if(!this._tiles[o].loaded)return!1;return!0}});function Tr(o){return new Bn(o)}var Mn=Bn.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(o,h){this._url=o,h=B(this,h),h.detectRetina&&Ae.retina&&h.maxZoom>0?(h.tileSize=Math.floor(h.tileSize/2),h.zoomReverse?(h.zoomOffset--,h.minZoom=Math.min(h.maxZoom,h.minZoom+1)):(h.zoomOffset++,h.maxZoom=Math.max(h.minZoom,h.maxZoom-1)),h.minZoom=Math.max(0,h.minZoom)):h.zoomReverse?h.minZoom=Math.min(h.maxZoom,h.minZoom):h.maxZoom=Math.max(h.minZoom,h.maxZoom),typeof h.subdomains=="string"&&(h.subdomains=h.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(o,h){return this._url===o&&h===void 0&&(h=!0),this._url=o,h||this.redraw(),this},createTile:function(o,h){var g=document.createElement("img");return ze(g,"load",y(this._tileOnLoad,this,h,g)),ze(g,"error",y(this._tileOnError,this,h,g)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(g.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(g.referrerPolicy=this.options.referrerPolicy),g.alt="",g.src=this.getTileUrl(o),g},getTileUrl:function(o){var h={r:Ae.retina?"@2x":"",s:this._getSubdomain(o),x:o.x,y:o.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var g=this._globalTileRange.max.y-o.y;this.options.tms&&(h.y=g),h["-y"]=g}return de(this._url,c(h,this.options))},_tileOnLoad:function(o,h){Ae.ielt9?setTimeout(y(o,this,null,h),0):o(null,h)},_tileOnError:function(o,h,g){var x=this.options.errorTileUrl;x&&h.getAttribute("src")!==x&&(h.src=x),o(g,h)},_onTileRemove:function(o){o.tile.onload=null},_getZoomForUrl:function(){var o=this._tileZoom,h=this.options.maxZoom,g=this.options.zoomReverse,x=this.options.zoomOffset;return g&&(o=h-o),o+x},_getSubdomain:function(o){var h=Math.abs(o.x+o.y)%this.options.subdomains.length;return this.options.subdomains[h]},_abortLoading:function(){var o,h;for(o in this._tiles)if(this._tiles[o].coords.z!==this._tileZoom&&(h=this._tiles[o].el,h.onload=R,h.onerror=R,!h.complete)){h.src=z;var g=this._tiles[o].coords;et(h),delete this._tiles[o],this.fire("tileabort",{tile:h,coords:g})}},_removeTile:function(o){var h=this._tiles[o];if(h)return h.el.setAttribute("src",z),Bn.prototype._removeTile.call(this,o)},_tileReady:function(o,h,g){if(!(!this._map||g&&g.getAttribute("src")===z))return Bn.prototype._tileReady.call(this,o,h,g)}});function qs(o,h){return new Mn(o,h)}var hi=Mn.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(o,h){this._url=o;var g=c({},this.defaultWmsParams);for(var x in h)x in this.options||(g[x]=h[x]);h=B(this,h);var S=h.detectRetina&&Ae.retina?2:1,N=this.getTileSize();g.width=N.x*S,g.height=N.y*S,this.wmsParams=g},onAdd:function(o){this._crs=this.options.crs||o.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var h=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[h]=this._crs.code,Mn.prototype.onAdd.call(this,o)},getTileUrl:function(o){var h=this._tileCoordsToNwSe(o),g=this._crs,x=G(g.project(h[0]),g.project(h[1])),S=x.min,N=x.max,H=(this._wmsVersion>=1.3&&this._crs===jo?[S.y,S.x,N.y,N.x]:[S.x,S.y,N.x,N.y]).join(","),ie=Mn.prototype.getTileUrl.call(this,o);return ie+j(this.wmsParams,ie,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+H},setParams:function(o,h){return c(this.wmsParams,o),h||this.redraw(),this}});function qo(o,h){return new hi(o,h)}Mn.WMS=hi,qs.wms=qo;var an=Yt.extend({options:{padding:.1},initialize:function(o){B(this,o),w(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Ue(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var o={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(o.zoomanim=this._onAnimZoom),o},_onAnimZoom:function(o){this._updateTransform(o.center,o.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(o,h){var g=this._map.getZoomScale(h,this._zoom),x=this._map.getSize().multiplyBy(.5+this.options.padding),S=this._map.project(this._center,h),N=x.multiplyBy(-g).add(S).subtract(this._map._getNewPixelOrigin(o,h));Ae.any3d?Zt(this._container,N,g):lt(this._container,N)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var o in this._layers)this._layers[o]._reset()},_onZoomEnd:function(){for(var o in this._layers)this._layers[o]._project()},_updatePaths:function(){for(var o in this._layers)this._layers[o]._update()},_update:function(){var o=this.options.padding,h=this._map.getSize(),g=this._map.containerPointToLayerPoint(h.multiplyBy(-o)).round();this._bounds=new I(g,g.add(h.multiplyBy(1+o*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Gs=an.extend({options:{tolerance:0},getEvents:function(){var o=an.prototype.getEvents.call(this);return o.viewprereset=this._onViewPreReset,o},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){an.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var o=this._container=document.createElement("canvas");ze(o,"mousemove",this._onMouseMove,this),ze(o,"click dblclick mousedown mouseup contextmenu",this._onClick,this),ze(o,"mouseout",this._handleMouseOut,this),o._leaflet_disable_events=!0,this._ctx=o.getContext("2d")},_destroyContainer:function(){K(this._redrawRequest),delete this._ctx,et(this._container),Ye(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var o;this._redrawBounds=null;for(var h in this._layers)o=this._layers[h],o._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){an.prototype._update.call(this);var o=this._bounds,h=this._container,g=o.getSize(),x=Ae.retina?2:1;lt(h,o.min),h.width=x*g.x,h.height=x*g.y,h.style.width=g.x+"px",h.style.height=g.y+"px",Ae.retina&&this._ctx.scale(2,2),this._ctx.translate(-o.min.x,-o.min.y),this.fire("update")}},_reset:function(){an.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(o){this._updateDashArray(o),this._layers[w(o)]=o;var h=o._order={layer:o,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=h),this._drawLast=h,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(o){this._requestRedraw(o)},_removePath:function(o){var h=o._order,g=h.next,x=h.prev;g?g.prev=x:this._drawLast=x,x?x.next=g:this._drawFirst=g,delete o._order,delete this._layers[w(o)],this._requestRedraw(o)},_updatePath:function(o){this._extendRedrawBounds(o),o._project(),o._update(),this._requestRedraw(o)},_updateStyle:function(o){this._updateDashArray(o),this._requestRedraw(o)},_updateDashArray:function(o){if(typeof o.options.dashArray=="string"){var h=o.options.dashArray.split(/[, ]+/),g=[],x,S;for(S=0;S<h.length;S++){if(x=Number(h[S]),isNaN(x))return;g.push(x)}o.options._dashArray=g}else o.options._dashArray=o.options.dashArray},_requestRedraw:function(o){this._map&&(this._extendRedrawBounds(o),this._redrawRequest=this._redrawRequest||F(this._redraw,this))},_extendRedrawBounds:function(o){if(o._pxBounds){var h=(o.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new I,this._redrawBounds.extend(o._pxBounds.min.subtract([h,h])),this._redrawBounds.extend(o._pxBounds.max.add([h,h]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var o=this._redrawBounds;if(o){var h=o.getSize();this._ctx.clearRect(o.min.x,o.min.y,h.x,h.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var o,h=this._redrawBounds;if(this._ctx.save(),h){var g=h.getSize();this._ctx.beginPath(),this._ctx.rect(h.min.x,h.min.y,g.x,g.y),this._ctx.clip()}this._drawing=!0;for(var x=this._drawFirst;x;x=x.next)o=x.layer,(!h||o._pxBounds&&o._pxBounds.intersects(h))&&o._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(o,h){if(this._drawing){var g,x,S,N,H=o._parts,ie=H.length,ce=this._ctx;if(ie){for(ce.beginPath(),g=0;g<ie;g++){for(x=0,S=H[g].length;x<S;x++)N=H[g][x],ce[x?"lineTo":"moveTo"](N.x,N.y);h&&ce.closePath()}this._fillStroke(ce,o)}}},_updateCircle:function(o){if(!(!this._drawing||o._empty())){var h=o._point,g=this._ctx,x=Math.max(Math.round(o._radius),1),S=(Math.max(Math.round(o._radiusY),1)||x)/x;S!==1&&(g.save(),g.scale(1,S)),g.beginPath(),g.arc(h.x,h.y/S,x,0,Math.PI*2,!1),S!==1&&g.restore(),this._fillStroke(g,o)}},_fillStroke:function(o,h){var g=h.options;g.fill&&(o.globalAlpha=g.fillOpacity,o.fillStyle=g.fillColor||g.color,o.fill(g.fillRule||"evenodd")),g.stroke&&g.weight!==0&&(o.setLineDash&&o.setLineDash(h.options&&h.options._dashArray||[]),o.globalAlpha=g.opacity,o.lineWidth=g.weight,o.strokeStyle=g.color,o.lineCap=g.lineCap,o.lineJoin=g.lineJoin,o.stroke())},_onClick:function(o){for(var h=this._map.mouseEventToLayerPoint(o),g,x,S=this._drawFirst;S;S=S.next)g=S.layer,g.options.interactive&&g._containsPoint(h)&&(!(o.type==="click"||o.type==="preclick")||!this._map._draggableMoved(g))&&(x=g);this._fireEvent(x?[x]:!1,o)},_onMouseMove:function(o){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var h=this._map.mouseEventToLayerPoint(o);this._handleMouseHover(o,h)}},_handleMouseOut:function(o){var h=this._hoveredLayer;h&&(Xe(this._container,"leaflet-interactive"),this._fireEvent([h],o,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(o,h){if(!this._mouseHoverThrottled){for(var g,x,S=this._drawFirst;S;S=S.next)g=S.layer,g.options.interactive&&g._containsPoint(h)&&(x=g);x!==this._hoveredLayer&&(this._handleMouseOut(o),x&&(Ue(this._container,"leaflet-interactive"),this._fireEvent([x],o,"mouseover"),this._hoveredLayer=x)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,o),this._mouseHoverThrottled=!0,setTimeout(y(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(o,h,g){this._map._fireDOMEvent(h,g||h.type,o)},_bringToFront:function(o){var h=o._order;if(h){var g=h.next,x=h.prev;if(g)g.prev=x;else return;x?x.next=g:g&&(this._drawFirst=g),h.prev=this._drawLast,this._drawLast.next=h,h.next=null,this._drawLast=h,this._requestRedraw(o)}},_bringToBack:function(o){var h=o._order;if(h){var g=h.next,x=h.prev;if(x)x.next=g;else return;g?g.prev=x:x&&(this._drawLast=x),h.prev=null,h.next=this._drawFirst,this._drawFirst.prev=h,this._drawFirst=h,this._requestRedraw(o)}}});function Ys(o){return Ae.canvas?new Gs(o):null}var Pr=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(o){return document.createElement("<lvml:"+o+' class="lvml">')}}catch{}return function(o){return document.createElement("<"+o+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),Go={_initContainer:function(){this._container=Fe("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(an.prototype._update.call(this),this.fire("update"))},_initPath:function(o){var h=o._container=Pr("shape");Ue(h,"leaflet-vml-shape "+(this.options.className||"")),h.coordsize="1 1",o._path=Pr("path"),h.appendChild(o._path),this._updateStyle(o),this._layers[w(o)]=o},_addPath:function(o){var h=o._container;this._container.appendChild(h),o.options.interactive&&o.addInteractiveTarget(h)},_removePath:function(o){var h=o._container;et(h),o.removeInteractiveTarget(h),delete this._layers[w(o)]},_updateStyle:function(o){var h=o._stroke,g=o._fill,x=o.options,S=o._container;S.stroked=!!x.stroke,S.filled=!!x.fill,x.stroke?(h||(h=o._stroke=Pr("stroke")),S.appendChild(h),h.weight=x.weight+"px",h.color=x.color,h.opacity=x.opacity,x.dashArray?h.dashStyle=se(x.dashArray)?x.dashArray.join(" "):x.dashArray.replace(/( *, *)/g," "):h.dashStyle="",h.endcap=x.lineCap.replace("butt","flat"),h.joinstyle=x.lineJoin):h&&(S.removeChild(h),o._stroke=null),x.fill?(g||(g=o._fill=Pr("fill")),S.appendChild(g),g.color=x.fillColor||x.color,g.opacity=x.fillOpacity):g&&(S.removeChild(g),o._fill=null)},_updateCircle:function(o){var h=o._point.round(),g=Math.round(o._radius),x=Math.round(o._radiusY||g);this._setPath(o,o._empty()?"M0 0":"AL "+h.x+","+h.y+" "+g+","+x+" 0,"+65535*360)},_setPath:function(o,h){o._path.v=h},_bringToFront:function(o){mr(o._container)},_bringToBack:function(o){mn(o._container)}},Xt=Ae.vml?Pr:ur,Jn=an.extend({_initContainer:function(){this._container=Xt("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Xt("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){et(this._container),Ye(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){an.prototype._update.call(this);var o=this._bounds,h=o.getSize(),g=this._container;(!this._svgSize||!this._svgSize.equals(h))&&(this._svgSize=h,g.setAttribute("width",h.x),g.setAttribute("height",h.y)),lt(g,o.min),g.setAttribute("viewBox",[o.min.x,o.min.y,h.x,h.y].join(" ")),this.fire("update")}},_initPath:function(o){var h=o._path=Xt("path");o.options.className&&Ue(h,o.options.className),o.options.interactive&&Ue(h,"leaflet-interactive"),this._updateStyle(o),this._layers[w(o)]=o},_addPath:function(o){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(o._path),o.addInteractiveTarget(o._path)},_removePath:function(o){et(o._path),o.removeInteractiveTarget(o._path),delete this._layers[w(o)]},_updatePath:function(o){o._project(),o._update()},_updateStyle:function(o){var h=o._path,g=o.options;h&&(g.stroke?(h.setAttribute("stroke",g.color),h.setAttribute("stroke-opacity",g.opacity),h.setAttribute("stroke-width",g.weight),h.setAttribute("stroke-linecap",g.lineCap),h.setAttribute("stroke-linejoin",g.lineJoin),g.dashArray?h.setAttribute("stroke-dasharray",g.dashArray):h.removeAttribute("stroke-dasharray"),g.dashOffset?h.setAttribute("stroke-dashoffset",g.dashOffset):h.removeAttribute("stroke-dashoffset")):h.setAttribute("stroke","none"),g.fill?(h.setAttribute("fill",g.fillColor||g.color),h.setAttribute("fill-opacity",g.fillOpacity),h.setAttribute("fill-rule",g.fillRule||"evenodd")):h.setAttribute("fill","none"))},_updatePoly:function(o,h){this._setPath(o,cr(o._parts,h))},_updateCircle:function(o){var h=o._point,g=Math.max(Math.round(o._radius),1),x=Math.max(Math.round(o._radiusY),1)||g,S="a"+g+","+x+" 0 1,0 ",N=o._empty()?"M0 0":"M"+(h.x-g)+","+h.y+S+g*2+",0 "+S+-g*2+",0 ";this._setPath(o,N)},_setPath:function(o,h){o._path.setAttribute("d",h)},_bringToFront:function(o){mr(o._path)},_bringToBack:function(o){mn(o._path)}});Ae.vml&&Jn.include(Go);function ts(o){return Ae.svg||Ae.vml?new Jn(o):null}Ve.include({getRenderer:function(o){var h=o.options.renderer||this._getPaneRenderer(o.options.pane)||this.options.renderer||this._renderer;return h||(h=this._renderer=this._createRenderer()),this.hasLayer(h)||this.addLayer(h),h},_getPaneRenderer:function(o){if(o==="overlayPane"||o===void 0)return!1;var h=this._paneRenderers[o];return h===void 0&&(h=this._createRenderer({pane:o}),this._paneRenderers[o]=h),h},_createRenderer:function(o){return this.options.preferCanvas&&Ys(o)||ts(o)}});var Yo=wn.extend({initialize:function(o,h){wn.prototype.initialize.call(this,this._boundsToLatLngs(o),h)},setBounds:function(o){return this.setLatLngs(this._boundsToLatLngs(o))},_boundsToLatLngs:function(o){return o=we(o),[o.getSouthWest(),o.getNorthWest(),o.getNorthEast(),o.getSouthEast()]}});function il(o,h){return new Yo(o,h)}Jn.create=Xt,Jn.pointsToPath=cr,sn.geometryToLayer=kr,sn.coordsToLatLng=Gi,sn.coordsToLatLngs=ui,sn.latLngToCoords=Yi,sn.latLngsToCoords=Ji,sn.getFeature=Sr,sn.asFeature=Xi,Ve.mergeOptions({boxZoom:!0});var Lr=Ot.extend({initialize:function(o){this._map=o,this._container=o._container,this._pane=o._panes.overlayPane,this._resetStateTimeout=0,o.on("unload",this._destroy,this)},addHooks:function(){ze(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Ye(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){et(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(o){if(!o.shiftKey||o.which!==1&&o.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Ze(),Di(),this._startPoint=this._map.mouseEventToContainerPoint(o),ze(document,{contextmenu:qt,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(o){this._moved||(this._moved=!0,this._box=Fe("div","leaflet-zoom-box",this._container),Ue(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(o);var h=new I(this._point,this._startPoint),g=h.getSize();lt(this._box,h.min),this._box.style.width=g.x+"px",this._box.style.height=g.y+"px"},_finish:function(){this._moved&&(et(this._box),Xe(this._container,"leaflet-crosshair")),vr(),Oi(),Ye(document,{contextmenu:qt,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(o){if(!(o.which!==1&&o.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(y(this._resetState,this),0);var h=new Ee(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(h).fire("boxzoomend",{boxZoomBounds:h})}},_onKeyDown:function(o){o.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Ve.addInitHook("addHandler","boxZoom",Lr),Ve.mergeOptions({doubleClickZoom:!0});var Jo=Ot.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(o){var h=this._map,g=h.getZoom(),x=h.options.zoomDelta,S=o.originalEvent.shiftKey?g-x:g+x;h.options.doubleClickZoom==="center"?h.setZoom(S):h.setZoomAround(o.containerPoint,S)}});Ve.addInitHook("addHandler","doubleClickZoom",Jo),Ve.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Js=Ot.extend({addHooks:function(){if(!this._draggable){var o=this._map;this._draggable=new Gt(o._mapPane,o._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),o.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),o.on("zoomend",this._onZoomEnd,this),o.whenReady(this._onZoomEnd,this))}Ue(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Xe(this._map._container,"leaflet-grab"),Xe(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var o=this._map;if(o._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var h=we(this._map.options.maxBounds);this._offsetLimit=G(this._map.latLngToContainerPoint(h.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(h.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;o.fire("movestart").fire("dragstart"),o.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(o){if(this._map.options.inertia){var h=this._lastTime=+new Date,g=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(g),this._times.push(h),this._prunePositions(h)}this._map.fire("move",o).fire("drag",o)},_prunePositions:function(o){for(;this._positions.length>1&&o-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var o=this._map.getSize().divideBy(2),h=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=h.subtract(o).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(o,h){return o-(o-h)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var o=this._draggable._newPos.subtract(this._draggable._startPos),h=this._offsetLimit;o.x<h.min.x&&(o.x=this._viscousLimit(o.x,h.min.x)),o.y<h.min.y&&(o.y=this._viscousLimit(o.y,h.min.y)),o.x>h.max.x&&(o.x=this._viscousLimit(o.x,h.max.x)),o.y>h.max.y&&(o.y=this._viscousLimit(o.y,h.max.y)),this._draggable._newPos=this._draggable._startPos.add(o)}},_onPreDragWrap:function(){var o=this._worldWidth,h=Math.round(o/2),g=this._initialWorldOffset,x=this._draggable._newPos.x,S=(x-h+g)%o+h-g,N=(x+h+g)%o-h-g,H=Math.abs(S+g)<Math.abs(N+g)?S:N;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=H},_onDragEnd:function(o){var h=this._map,g=h.options,x=!g.inertia||o.noInertia||this._times.length<2;if(h.fire("dragend",o),x)h.fire("moveend");else{this._prunePositions(+new Date);var S=this._lastPos.subtract(this._positions[0]),N=(this._lastTime-this._times[0])/1e3,H=g.easeLinearity,ie=S.multiplyBy(H/N),ce=ie.distanceTo([0,0]),ve=Math.min(g.inertiaMaxSpeed,ce),Ce=ie.multiplyBy(ve/ce),$e=ve/(g.inertiaDeceleration*H),He=Ce.multiplyBy(-$e/2).round();!He.x&&!He.y?h.fire("moveend"):(He=h._limitOffset(He,h.options.maxBounds),F(function(){h.panBy(He,{duration:$e,easeLinearity:H,noMoveStart:!0,animate:!0})}))}}});Ve.addInitHook("addHandler","dragging",Js),Ve.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Xs=Ot.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(o){this._map=o,this._setPanDelta(o.options.keyboardPanDelta),this._setZoomDelta(o.options.zoomDelta)},addHooks:function(){var o=this._map._container;o.tabIndex<=0&&(o.tabIndex="0"),ze(o,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Ye(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var o=document.body,h=document.documentElement,g=o.scrollTop||h.scrollTop,x=o.scrollLeft||h.scrollLeft;this._map._container.focus(),window.scrollTo(x,g)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(o){var h=this._panKeys={},g=this.keyCodes,x,S;for(x=0,S=g.left.length;x<S;x++)h[g.left[x]]=[-1*o,0];for(x=0,S=g.right.length;x<S;x++)h[g.right[x]]=[o,0];for(x=0,S=g.down.length;x<S;x++)h[g.down[x]]=[0,o];for(x=0,S=g.up.length;x<S;x++)h[g.up[x]]=[0,-1*o]},_setZoomDelta:function(o){var h=this._zoomKeys={},g=this.keyCodes,x,S;for(x=0,S=g.zoomIn.length;x<S;x++)h[g.zoomIn[x]]=o;for(x=0,S=g.zoomOut.length;x<S;x++)h[g.zoomOut[x]]=-o},_addHooks:function(){ze(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Ye(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(o){if(!(o.altKey||o.ctrlKey||o.metaKey)){var h=o.keyCode,g=this._map,x;if(h in this._panKeys){if(!g._panAnim||!g._panAnim._inProgress)if(x=this._panKeys[h],o.shiftKey&&(x=q(x).multiplyBy(3)),g.options.maxBounds&&(x=g._limitOffset(q(x),g.options.maxBounds)),g.options.worldCopyJump){var S=g.wrapLatLng(g.unproject(g.project(g.getCenter()).add(x)));g.panTo(S)}else g.panBy(x)}else if(h in this._zoomKeys)g.setZoom(g.getZoom()+(o.shiftKey?3:1)*this._zoomKeys[h]);else if(h===27&&g._popup&&g._popup.options.closeOnEscapeKey)g.closePopup();else return;qt(o)}}});Ve.addInitHook("addHandler","keyboard",Xs),Ve.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Je=Ot.extend({addHooks:function(){ze(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Ye(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(o){var h=Ao(o),g=this._map.options.wheelDebounceTime;this._delta+=h,this._lastMousePos=this._map.mouseEventToContainerPoint(o),this._startTime||(this._startTime=+new Date);var x=Math.max(g-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(y(this._performZoom,this),x),qt(o)},_performZoom:function(){var o=this._map,h=o.getZoom(),g=this._map.options.zoomSnap||0;o._stop();var x=this._delta/(this._map.options.wheelPxPerZoomLevel*4),S=4*Math.log(2/(1+Math.exp(-Math.abs(x))))/Math.LN2,N=g?Math.ceil(S/g)*g:S,H=o._limitZoom(h+(this._delta>0?N:-N))-h;this._delta=0,this._startTime=null,H&&(o.options.scrollWheelZoom==="center"?o.setZoom(h+H):o.setZoomAround(this._lastMousePos,h+H))}});Ve.addInitHook("addHandler","scrollWheelZoom",Je);var Qs=600;Ve.mergeOptions({tapHold:Ae.touchNative&&Ae.safari&&Ae.mobile,tapTolerance:15});var di=Ot.extend({addHooks:function(){ze(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Ye(this._map._container,"touchstart",this._onDown,this)},_onDown:function(o){if(clearTimeout(this._holdTimeout),o.touches.length===1){var h=o.touches[0];this._startPos=this._newPos=new V(h.clientX,h.clientY),this._holdTimeout=setTimeout(y(function(){this._cancel(),this._isTapValid()&&(ze(document,"touchend",it),ze(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",h))},this),Qs),ze(document,"touchend touchcancel contextmenu",this._cancel,this),ze(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function o(){Ye(document,"touchend",it),Ye(document,"touchend touchcancel",o)},_cancel:function(){clearTimeout(this._holdTimeout),Ye(document,"touchend touchcancel contextmenu",this._cancel,this),Ye(document,"touchmove",this._onMove,this)},_onMove:function(o){var h=o.touches[0];this._newPos=new V(h.clientX,h.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(o,h){var g=new MouseEvent(o,{bubbles:!0,cancelable:!0,view:window,screenX:h.screenX,screenY:h.screenY,clientX:h.clientX,clientY:h.clientY});g._simulated=!0,h.target.dispatchEvent(g)}});Ve.addInitHook("addHandler","tapHold",di),Ve.mergeOptions({touchZoom:Ae.touch,bounceAtZoomLimits:!0});var Nr=Ot.extend({addHooks:function(){Ue(this._map._container,"leaflet-touch-zoom"),ze(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Xe(this._map._container,"leaflet-touch-zoom"),Ye(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(o){var h=this._map;if(!(!o.touches||o.touches.length!==2||h._animatingZoom||this._zooming)){var g=h.mouseEventToContainerPoint(o.touches[0]),x=h.mouseEventToContainerPoint(o.touches[1]);this._centerPoint=h.getSize()._divideBy(2),this._startLatLng=h.containerPointToLatLng(this._centerPoint),h.options.touchZoom!=="center"&&(this._pinchStartLatLng=h.containerPointToLatLng(g.add(x)._divideBy(2))),this._startDist=g.distanceTo(x),this._startZoom=h.getZoom(),this._moved=!1,this._zooming=!0,h._stop(),ze(document,"touchmove",this._onTouchMove,this),ze(document,"touchend touchcancel",this._onTouchEnd,this),it(o)}},_onTouchMove:function(o){if(!(!o.touches||o.touches.length!==2||!this._zooming)){var h=this._map,g=h.mouseEventToContainerPoint(o.touches[0]),x=h.mouseEventToContainerPoint(o.touches[1]),S=g.distanceTo(x)/this._startDist;if(this._zoom=h.getScaleZoom(S,this._startZoom),!h.options.bounceAtZoomLimits&&(this._zoom<h.getMinZoom()&&S<1||this._zoom>h.getMaxZoom()&&S>1)&&(this._zoom=h._limitZoom(this._zoom)),h.options.touchZoom==="center"){if(this._center=this._startLatLng,S===1)return}else{var N=g._add(x)._divideBy(2)._subtract(this._centerPoint);if(S===1&&N.x===0&&N.y===0)return;this._center=h.unproject(h.project(this._pinchStartLatLng,this._zoom).subtract(N),this._zoom)}this._moved||(h._moveStart(!0,!1),this._moved=!0),K(this._animRequest);var H=y(h._move,h,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=F(H,this,!0),it(o)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,K(this._animRequest),Ye(document,"touchmove",this._onTouchMove,this),Ye(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Ve.addInitHook("addHandler","touchZoom",Nr),Ve.BoxZoom=Lr,Ve.DoubleClickZoom=Jo,Ve.Drag=Js,Ve.Keyboard=Xs,Ve.ScrollWheelZoom=Je,Ve.TapHold=di,Ve.TouchZoom=Nr,r.Bounds=I,r.Browser=Ae,r.CRS=Re,r.Canvas=Gs,r.Circle=Wi,r.CircleMarker=Zi,r.Class=Y,r.Control=It,r.DivIcon=es,r.DivOverlay=on,r.DomEvent=Ui,r.DomUtil=ri,r.Draggable=Gt,r.Evented=ne,r.FeatureGroup=vn,r.GeoJSON=sn,r.GridLayer=Bn,r.Handler=Ot,r.Icon=Yn,r.ImageOverlay=In,r.LatLng=pe,r.LatLngBounds=Ee,r.Layer=Yt,r.LayerGroup=Nn,r.LineUtil=zo,r.Map=Ve,r.Marker=_n,r.Mixin=$s,r.Path=An,r.Point=V,r.PolyUtil=Wa,r.Polygon=wn,r.Polyline=Bt,r.Popup=Qi,r.PosAnimation=Fi,r.Projection=Xa,r.Rectangle=Yo,r.Renderer=an,r.SVG=Jn,r.SVGOverlay=Zs,r.TileLayer=Mn,r.Tooltip=Rr,r.Transformation=kt,r.Util=D,r.VideoOverlay=Vs,r.bind=y,r.bounds=G,r.canvas=Ys,r.circle=li,r.circleMarker=Ho,r.control=Ln,r.divIcon=Wo,r.extend=c,r.featureGroup=Uo,r.geoJSON=Ko,r.geoJson=Jt,r.gridLayer=Tr,r.icon=Fo,r.imageOverlay=Vo,r.latLng=_e,r.latLngBounds=we,r.layerGroup=ai,r.map=Pn,r.marker=tl,r.point=q,r.polygon=rl,r.polyline=nl,r.popup=Cr,r.rectangle=il,r.setOptions=B,r.stamp=w,r.svg=ts,r.svgOverlay=Ws,r.tileLayer=qs,r.tooltip=ci,r.transformation=at,r.version=l,r.videoOverlay=Zo;var Xo=window.L;r.noConflict=function(){return window.L=Xo,this},window.L=r}))})(leafletSrc$1,leafletSrc$1.exports)),leafletSrc$1.exports}var leafletSrcExports=requireLeafletSrc();const L$1=getDefaultExportFromCjs(leafletSrcExports);function createElementObject(t,e,r){return Object.freeze({instance:t,context:e,container:r})}function createElementHook(t,e){return e==null?function(l,c){const m=reactExports.useRef();return m.current||(m.current=t(l,c)),m}:function(l,c){const m=reactExports.useRef();m.current||(m.current=t(l,c));const y=reactExports.useRef(l),{instance:_}=m.current;return reactExports.useEffect(function(){y.current!==l&&(e(_,l,y.current),y.current=l)},[_,l,c]),m}}function useLayerLifecycle(t,e){reactExports.useEffect(function(){return(e.layerContainer??e.map).addLayer(t.instance),function(){e.layerContainer?.removeLayer(t.instance),e.map.removeLayer(t.instance)}},[e,t])}function createLayerHook(t){return function(r){const l=useLeafletContext(),c=t(withPane(r,l),l);return useAttribution(l.map,r.attribution),useEventHandlers(c.current,r.eventHandlers),useLayerLifecycle(c.current,l),c}}function usePathOptions(t,e){const r=reactExports.useRef();reactExports.useEffect(function(){if(e.pathOptions!==r.current){const c=e.pathOptions??{};t.instance.setStyle(c),r.current=c}},[t,e])}function createPathHook(t){return function(r){const l=useLeafletContext(),c=t(withPane(r,l),l);return useEventHandlers(c.current,r.eventHandlers),useLayerLifecycle(c.current,l),usePathOptions(c.current,r),c}}function createLayerComponent(t,e){const r=createElementHook(t,e),l=createLayerHook(r);return createContainerComponent(l)}function createOverlayComponent(t,e){const r=createElementHook(t),l=createDivOverlayHook(r,e);return createDivOverlayComponent(l)}function createPathComponent(t,e){const r=createElementHook(t,e),l=createPathHook(r);return createContainerComponent(l)}function createTileLayerComponent(t,e){const r=createElementHook(t,e),l=createLayerHook(r);return createLeafComponent(l)}function updateGridLayer(t,e,r){const{opacity:l,zIndex:c}=e;l!=null&&l!==r.opacity&&t.setOpacity(l),c!=null&&c!==r.zIndex&&t.setZIndex(c)}function useMap(){return useLeafletContext().map}function useMapEvents(t){const e=useMap();return reactExports.useEffect(function(){return e.on(t),function(){e.off(t)}},[e,t]),e}const Circle=createPathComponent(function t({center:e,children:r,...l},c){const m=new leafletSrcExports.Circle(e,l);return createElementObject(m,extendContext(c,{overlayContainer:m}))},updateCircle);function _extends(){return _extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(t[l]=r[l])}return t},_extends.apply(this,arguments)}function MapContainerComponent({bounds:t,boundsOptions:e,center:r,children:l,className:c,id:m,placeholder:y,style:_,whenReady:w,zoom:k,...C},R){const[T]=reactExports.useState({className:c,id:m,style:_}),[A,M]=reactExports.useState(null);reactExports.useImperativeHandle(R,()=>A?.map??null,[A]);const B=reactExports.useCallback(re=>{if(re!==null&&A===null){const de=new leafletSrcExports.Map(re,C);r!=null&&k!=null?de.setView(r,k):t!=null&&de.fitBounds(t,e),w!=null&&de.whenReady(w),M(createLeafletContext(de))}},[]);reactExports.useEffect(()=>()=>{A?.map.remove()},[A]);const j=A?React.createElement(LeafletProvider,{value:A},l):y??null;return React.createElement("div",_extends({},T,{ref:B}),j)}const MapContainer=reactExports.forwardRef(MapContainerComponent),Marker=createLayerComponent(function t({position:e,...r},l){const c=new leafletSrcExports.Marker(e,r);return createElementObject(c,extendContext(l,{overlayContainer:c}))},function t(e,r,l){r.position!==l.position&&e.setLatLng(r.position),r.icon!=null&&r.icon!==l.icon&&e.setIcon(r.icon),r.zIndexOffset!=null&&r.zIndexOffset!==l.zIndexOffset&&e.setZIndexOffset(r.zIndexOffset),r.opacity!=null&&r.opacity!==l.opacity&&e.setOpacity(r.opacity),e.dragging!=null&&r.draggable!==l.draggable&&(r.draggable===!0?e.dragging.enable():e.dragging.disable())}),Popup=createOverlayComponent(function t(e,r){const l=new leafletSrcExports.Popup(e,r.overlayContainer);return createElementObject(l,r)},function t(e,r,{position:l},c){reactExports.useEffect(function(){const{instance:y}=e;function _(k){k.popup===y&&(y.update(),c(!0))}function w(k){k.popup===y&&c(!1)}return r.map.on({popupopen:_,popupclose:w}),r.overlayContainer==null?(l!=null&&y.setLatLng(l),y.openOn(r.map)):r.overlayContainer.bindPopup(y),function(){r.map.off({popupopen:_,popupclose:w}),r.overlayContainer?.unbindPopup(),r.map.removeLayer(y)}},[e,r,c,l])}),TileLayer=createTileLayerComponent(function t({url:e,...r},l){const c=new leafletSrcExports.TileLayer(e,withPane(r,l));return createElementObject(c,l)},function t(e,r,l){updateGridLayer(e,r,l);const{url:c}=r;c!=null&&c!==l.url&&e.setUrl(c)});function useEventAttendance(t){const{ndk:e}=useNDK(),[r,l]=reactExports.useState(new Set);return reactExports.useEffect(()=>{const c=t.tagValue("d");if(!c)return;const m={kinds:[31925],"#a":[`${t.kind}:${t.pubkey}:${c}`]},y=e.subscribe(m,{closeOnEose:!1});return y.on("event",_=>{l(w=>new Set(w).add(_.pubkey))}),()=>{y.stop()}},[e,t]),r}function useCommunityName(t){const{ndk:e}=useNDK(),[r,l]=reactExports.useState(null);return reactExports.useEffect(()=>{if(!t)return;(async()=>{const[m,y,_]=t.split(":"),w={kinds:[parseInt(m)],authors:[y],"#d":[_]},k=await e.fetchEvent(w);k&&l(k.tagValue("title")||null)})()},[e,t]),r}/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const toKebabCase=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),toCamelCase=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,l)=>l?l.toUpperCase():r.toLowerCase()),toPascalCase=t=>{const e=toCamelCase(t);return e.charAt(0).toUpperCase()+e.slice(1)},mergeClasses=(...t)=>t.filter((e,r,l)=>!!e&&e.trim()!==""&&l.indexOf(e)===r).join(" ").trim(),hasA11yProp=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var defaultAttributes={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Icon=reactExports.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:l,className:c="",children:m,iconNode:y,..._},w)=>reactExports.createElement("svg",{ref:w,...defaultAttributes,width:e,height:e,stroke:t,strokeWidth:l?Number(r)*24/Number(e):r,className:mergeClasses("lucide",c),...!m&&!hasA11yProp(_)&&{"aria-hidden":"true"},..._},[...y.map(([k,C])=>reactExports.createElement(k,C)),...Array.isArray(m)?m:[m]]));/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const createLucideIcon=(t,e)=>{const r=reactExports.forwardRef(({className:l,...c},m)=>reactExports.createElement(Icon,{ref:m,iconNode:e,className:mergeClasses(`lucide-${toKebabCase(toPascalCase(t))}`,`lucide-${t}`,l),...c}));return r.displayName=toPascalCase(t),r};/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$9=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],ArrowLeft=createLucideIcon("arrow-left",__iconNode$9);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$8=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],Globe=createLucideIcon("globe",__iconNode$8);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$7=[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],LocateFixed=createLucideIcon("locate-fixed",__iconNode$7);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$6=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Lock=createLucideIcon("lock",__iconNode$6);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$5=[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]],LogIn=createLucideIcon("log-in",__iconNode$5);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$4=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],LogOut=createLucideIcon("log-out",__iconNode$4);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$3=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],Map$1=createLucideIcon("map",__iconNode$3);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$2=[["path",{d:"M18 21a8 8 0 0 0-16 0",key:"3ypg7q"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M22 20c0-3.37-2-6.5-4-8a5 5 0 0 0-.45-8.3",key:"10s06x"}]],UsersRound=createLucideIcon("users-round",__iconNode$2);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$1=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Users=createLucideIcon("users",__iconNode$1);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],X=createLucideIcon("x",__iconNode),base32="0123456789bcdefghjkmnpqrstuvwxyz";class Geohash{static encode(e,r,l){if(typeof l>"u"){for(let T=1;T<=12;T++){const A=Geohash.encode(e,r,T),M=Geohash.decode(A);if(M.lat==e&&M.lon==r)return A}l=12}if(e=Number(e),r=Number(r),l=Number(l),isNaN(e)||isNaN(r)||isNaN(l))throw new Error("Invalid geohash");let c=0,m=0,y=!0,_="",w=-90,k=90,C=-180,R=180;for(;_.length<l;){if(y){const T=(C+R)/2;r>=T?(c=c*2+1,C=T):(c=c*2,R=T)}else{const T=(w+k)/2;e>=T?(c=c*2+1,w=T):(c=c*2,k=T)}y=!y,++m==5&&(_+=base32.charAt(c),m=0,c=0)}return _}static decode(e){const r=Geohash.bounds(e),l=r.sw.lat,c=r.sw.lon,m=r.ne.lat,y=r.ne.lon;let _=(l+m)/2,w=(c+y)/2;return _=_.toFixed(Math.floor(2-Math.log(m-l)/Math.LN10)),w=w.toFixed(Math.floor(2-Math.log(y-c)/Math.LN10)),{lat:Number(_),lon:Number(w)}}static bounds(e){if(e.length==0)throw new Error("Invalid geohash");e=e.toLowerCase();let r=!0,l=-90,c=90,m=-180,y=180;for(let w=0;w<e.length;w++){const k=e.charAt(w),C=base32.indexOf(k);if(C==-1)throw new Error("Invalid geohash");for(let R=4;R>=0;R--){const T=C>>R&1;if(r){const A=(m+y)/2;T==1?m=A:y=A}else{const A=(l+c)/2;T==1?l=A:c=A}r=!r}}return{sw:{lat:l,lon:m},ne:{lat:c,lon:y}}}static adjacent(e,r){if(e=e.toLowerCase(),r=r.toLowerCase(),e.length==0)throw new Error("Invalid geohash");if("nsew".indexOf(r)==-1)throw new Error("Invalid direction");const l={n:["p0r21436x8zb9dcf5h7kjnmqesgutwvy","bc01fg45238967deuvhjyznpkmstqrwx"],s:["14365h7k9dcfesgujnmqp0r2twvyx8zb","238967debc01fg45kmstqrwxuvhjyznp"],e:["bc01fg45238967deuvhjyznpkmstqrwx","p0r21436x8zb9dcf5h7kjnmqesgutwvy"],w:["238967debc01fg45kmstqrwxuvhjyznp","14365h7k9dcfesgujnmqp0r2twvyx8zb"]},c={n:["prxz","bcfguvyz"],s:["028b","0145hjnp"],e:["bcfguvyz","prxz"],w:["0145hjnp","028b"]},m=e.slice(-1);let y=e.slice(0,-1);const _=e.length%2;return c[r][_].indexOf(m)!=-1&&y!=""&&(y=Geohash.adjacent(y,r)),y+base32.charAt(l[r][_].indexOf(m))}static neighbours(e){return{n:Geohash.adjacent(e,"n"),ne:Geohash.adjacent(Geohash.adjacent(e,"n"),"e"),e:Geohash.adjacent(e,"e"),se:Geohash.adjacent(Geohash.adjacent(e,"s"),"e"),s:Geohash.adjacent(e,"s"),sw:Geohash.adjacent(Geohash.adjacent(e,"s"),"w"),w:Geohash.adjacent(e,"w"),nw:Geohash.adjacent(Geohash.adjacent(e,"n"),"w")}}}const allRelays={"wss://relay.damus.io":{lat:37.7621,lon:-122.3971},"wss://nostr-pub.wellorder.net":{lat:45.5229,lon:-122.9898},"wss://nostr.mom":{lat:50.4779,lon:12.3713},"wss://nostr.slothy.win":{lat:37.7621,lon:-122.3971},"wss://nostr.einundzwanzig.space":{lat:50.1155,lon:8.6842},"wss://nos.lol":{lat:50.4779,lon:12.3713},"wss://relay.nostr.band":{lat:60.1695,lon:24.9354},"wss://no.str.cr":{lat:9.9339,lon:-84.0849},"wss://nostr.massmux.com":{lat:50.1155,lon:8.6842},"wss://nostr-relay.schnitzel.world":{lat:39.0437,lon:-77.4875},"wss://relay.nostr.com.au":{lat:37.7621,lon:-122.3971},"wss://knostr.neutrine.com":{lat:48.8534,lon:2.3488},"wss://nostr.nodeofsven.com":{lat:47.4875,lon:8.2965},"wss://nostr.vulpem.com":{lat:49.4542,lon:11.0775},"wss://nostr-verif.slothy.win":{lat:37.7621,lon:-122.3971},"wss://relay.lexingtonbitcoin.org":{lat:37.7621,lon:-122.3971},"wss://nostr-1.nbo.angani.co":{lat:-1.2615,lon:36.7903},"wss://relay.wellorder.net":{lat:45.5229,lon:-122.9898},"wss://nostr.easydns.ca":{lat:43.7064,lon:-79.3986},"wss://relay.dwadziesciajeden.pl":{lat:52.2298,lon:21.0118},"wss://nostr.data.haus":{lat:50.4779,lon:12.3713},"wss://relay.nostromo.social":{lat:49.4542,lon:11.0775},"wss://offchain.pub":{lat:34.0522,lon:-118.2437},"wss://relay.nostr.wirednet.jp":{lat:35.9356,lon:139.3044},"wss://relay.nostrcheck.me":{lat:37.7621,lon:-122.3971},"wss://nostrue.com":{lat:40.8043,lon:-74.0121},"wss://nproxy.kristapsk.lv":{lat:60.1695,lon:24.9354},"wss://nostr.spaceshell.xyz":{lat:37.7621,lon:-122.3971},"wss://nostr-dev.wellorder.net":{lat:45.5229,lon:-122.9898},"wss://nostr-verified.wellorder.net":{lat:45.5229,lon:-122.9898},"wss://nostr.roundrockbitcoiners.com":{lat:40.8043,lon:-74.0121},"wss://slick.mjex.me":{lat:39.0437,lon:-77.4875},"wss://nostr.yael.at":{lat:52.374,lon:4.8897},"wss://relay.primal.net":{lat:37.7621,lon:-122.3971},"wss://nostr.oxtr.dev":{lat:50.4779,lon:12.3713},"wss://nostr.21crypto.ch":{lat:46.516,lon:6.6328},"wss://nostr.liberty.fans":{lat:38.8003,lon:-90.6265},"wss://nostr-02.dorafactory.org":{lat:1.2897,lon:103.8501},"wss://relay.hodl.ar":{lat:-32.9468,lon:-60.6393},"wss://nostr.middling.mydns.jp":{lat:35.8089,lon:140.1185},"wss://nostr.namek.link":{lat:37.7621,lon:-122.3971},"wss://nostrja-kari.heguro.com":{lat:37.7621,lon:-122.3971},"wss://nostr.hifish.org":{lat:47.3667,lon:8.55},"wss://nostr.rikmeijer.nl":{lat:50.4779,lon:12.3713},"wss://black.nostrcity.club":{lat:41.8119,lon:-87.6873},"wss://nostr.hekster.org":{lat:37.3924,lon:-121.9623},"wss://relay.wavlake.com":{lat:41.2619,lon:-95.8608},"wss://nostr.sagaciousd.com":{lat:49.2497,lon:-123.1193},"wss://nostr.fbxl.net":{lat:43.7064,lon:-79.3986},"wss://ithurtswhenip.ee":{lat:50.799,lon:-1.0913},"wss://relay2.nostrchat.io":{lat:49.4542,lon:11.0775},"wss://relay1.nostrchat.io":{lat:60.1695,lon:24.9354},"wss://nostr-01.yakihonne.com":{lat:1.3215,lon:103.6957},"wss://nostr.sathoarder.com":{lat:48.5839,lon:7.7455},"wss://nostr.overmind.lol":{lat:37.7621,lon:-122.3971},"wss://relay.verified-nostr.com":{lat:37.7621,lon:-122.3971},"wss://purplerelay.com":{lat:50.1155,lon:8.6842},"wss://relay.orangepill.ovh":{lat:49.0127,lon:1.9694},"wss://nostr-relay.psfoundation.info":{lat:39.0437,lon:-77.4875},"wss://soloco.nl":{lat:37.7621,lon:-122.3971},"wss://relay.froth.zone":{lat:60.1695,lon:24.9354},"wss://nostr.stakey.net":{lat:52.525,lon:5.7181},"wss://nostr.2b9t.xyz":{lat:34.0522,lon:-118.2437},"wss://pyramid.fiatjaf.com":{lat:50.1155,lon:8.6842},"wss://a.nos.lol":{lat:50.4779,lon:12.3713},"wss://relay.magiccity.live":{lat:25.813,lon:-80.232},"wss://nostr.notribe.net":{lat:40.8344,lon:-74.1377},"wss://freelay.sovbit.host":{lat:64.1355,lon:-21.8954},"wss://relay.credenso.cafe":{lat:43.4254,lon:-80.5112},"wss://nostr.huszonegy.world":{lat:47.4984,lon:19.0404},"wss://multiplexer.huszonegy.world":{lat:47.4984,lon:19.0404},"wss://bucket.coracle.social":{lat:37.7621,lon:-122.3971},"wss://nostr.kungfu-g.rip":{lat:33.7865,lon:-84.4454},"wss://relay.artx.market":{lat:43.7064,lon:-79.3986},"wss://relay.notoshi.win":{lat:13.3622,lon:100.9835},"wss://vitor.nostr1.com":{lat:40.7143,lon:-74.006},"wss://nostr-02.yakihonne.com":{lat:1.3215,lon:103.6957},"wss://nostr-03.dorafactory.org":{lat:1.2897,lon:103.8501},"wss://n.ok0.org":{lat:-36.8485,lon:174.7635},"wss://nostr.0x7e.xyz":{lat:47.5056,lon:8.7241},"wss://relay.nostr.net":{lat:50.4779,lon:12.3713},"wss://strfry.openhoofd.nl":{lat:51.5717,lon:3.7042},"wss://relay.fountain.fm":{lat:39.0997,lon:-94.5786},"wss://relay.usefusion.ai":{lat:38.7135,lon:-78.1594},"wss://relay.varke.eu":{lat:52.6958,lon:6.1944},"wss://nostr.satstralia.com":{lat:64.1355,lon:-21.8954},"wss://relay.13room.space":{lat:37.7621,lon:-122.3971},"wss://nostr.myshosholoza.co.za":{lat:52.371,lon:4.9042},"wss://nostr.carroarmato0.be":{lat:50.8517,lon:3.6089},"wss://nostr.dbtc.link":{lat:37.7621,lon:-122.3971},"wss://orangepiller.org":{lat:60.1695,lon:24.9354},"wss://adre.su":{lat:59.9386,lon:30.3141},"wss://relay.sincensura.org":{lat:37.7621,lon:-122.3971},"wss://relay.freeplace.nl":{lat:52.374,lon:4.8897},"wss://bostr.bitcointxoko.com":{lat:64.1355,lon:-21.8954},"wss://nostr.plantroon.com":{lat:50.1025,lon:8.6299},"wss://srtrelay.c-stellar.net":{lat:37.7621,lon:-122.3971},"wss://nostr.jfischer.org":{lat:49.4453,lon:11.0222},"wss://nostr.novacisko.cz":{lat:52.2298,lon:21.0118},"wss://relay.lumina.rocks":{lat:49.4453,lon:11.0222},"wss://nostr.tavux.tech":{lat:50.9519,lon:1.8563},"wss://relay.nostrhub.fr":{lat:50.1155,lon:8.6842},"wss://relay.agorist.space":{lat:52.374,lon:4.8897},"wss://chorus.pjv.me":{lat:45.5229,lon:-122.9898},"wss://relay.cosmicbolt.net":{lat:37.3924,lon:-121.9623},"wss://santo.iguanatech.net":{lat:40.8344,lon:-74.1377},"wss://relay.tagayasu.xyz":{lat:45.4112,lon:-75.6981},"wss://relay.mostro.network":{lat:40.8344,lon:-74.1377},"wss://relay.zone667.com":{lat:60.1695,lon:24.9354},"wss://relay5.bitransfer.org":{lat:37.7621,lon:-122.3971},"wss://relay.illuminodes.com":{lat:47.6062,lon:-122.3321},"wss://relay2.angor.io":{lat:50.1155,lon:8.6842},"wss://relay.satsdays.com":{lat:1.2897,lon:103.8501},"wss://relay.angor.io":{lat:50.1155,lon:8.6842},"wss://orangesync.tech":{lat:50.9333,lon:6.95},"wss://nostr-relay.cbrx.io":{lat:37.7621,lon:-122.3971},"wss://relay.21e6.cz":{lat:50.088,lon:14.4208},"wss://nostr.chaima.info":{lat:50.1155,lon:8.6842},"wss://relay.satlantis.io":{lat:32.8546,lon:-79.9748},"wss://relay.digitalezukunft.cyou":{lat:45.5088,lon:-73.5878},"wss://relay.tapestry.ninja":{lat:40.8043,lon:-74.0121},"wss://relay.minibolt.info":{lat:37.7621,lon:-122.3971},"wss://nostr.bilthon.dev":{lat:25.813,lon:-80.232},"wss://nostr.makibisskey.work":{lat:37.7621,lon:-122.3971},"wss://relay.mattybs.lol":{lat:37.7621,lon:-122.3971},"wss://noxir.kpherox.dev":{lat:34.8436,lon:135.5084},"wss://sendit.nosflare.com":{lat:37.7621,lon:-122.3971},"wss://relay.coinos.io":{lat:37.7621,lon:-122.3971},"wss://relay.nostraddress.com":{lat:37.7621,lon:-122.3971},"wss://wot.nostr.party":{lat:36.1659,lon:-86.7844},"wss://nostrelites.org":{lat:41.85,lon:-87.65},"wss://relay.nostriot.com":{lat:43.7064,lon:-79.3986},"wss://prl.plus":{lat:55.7522,lon:37.6156},"wss://zap.watch":{lat:45.5088,lon:-73.5878},"wss://wot.codingarena.top":{lat:50.4779,lon:12.3713},"wss://nostr.azzamo.net":{lat:52.2284,lon:21.0522},"wss://wot.sudocarlos.com":{lat:43.7064,lon:-79.3986},"wss://relay.lnfi.network":{lat:45.6241,lon:8.7851},"wss://wot.nostr.net":{lat:37.7621,lon:-122.3971},"wss://relay.nostrdice.com":{lat:-33.8678,lon:151.2073},"wss://wot.sebastix.social":{lat:51.37,lon:6.1681},"wss://wheat.happytavern.co":{lat:37.7621,lon:-122.3971},"wss://relay.sigit.io":{lat:50.4779,lon:12.3713},"wss://strfry.bonsai.com":{lat:37.8716,lon:-122.2728},"wss://travis-shears-nostr-relay-v2.fly.dev":{lat:41.8119,lon:-87.6873},"wss://satsage.xyz":{lat:37.3924,lon:-121.9623},"wss://relay.degmods.com":{lat:50.4779,lon:12.3713},"wss://nostr.community.ath.cx":{lat:45.5088,lon:-73.5878},"wss://nostr.coincrowd.fund":{lat:39.0437,lon:-77.4875},"wss://strfry.shock.network":{lat:41.8847,lon:-88.204},"wss://cyberspace.nostr1.com":{lat:40.7143,lon:-74.006},"wss://relay02.lnfi.network":{lat:39.0997,lon:-94.5786},"wss://nostr-rs-relay.dev.fedibtc.com":{lat:39.0437,lon:-77.4875},"wss://relay.davidebtc.me":{lat:50.1155,lon:8.6842},"wss://wot.dtonon.com":{lat:37.7621,lon:-122.3971},"wss://relay.goodmorningbitcoin.com":{lat:37.7621,lon:-122.3971},"wss://articles.layer3.news":{lat:37.3394,lon:-121.895},"wss://bostr.syobon.net":{lat:37.7621,lon:-122.3971},"wss://nostr.agentcampfire.com":{lat:52.374,lon:4.8897},"wss://nostr.thebiglake.org":{lat:32.7244,lon:-96.6755},"wss://schnorr.me":{lat:37.7621,lon:-122.3971},"wss://relay.wolfcoil.com":{lat:35.609,lon:139.7302},"wss://nostr.camalolo.com":{lat:24.1469,lon:120.6839},"wss://nostr.tac.lol":{lat:47.474,lon:-122.261},"wss://dev-relay.lnfi.network":{lat:39.0997,lon:-94.5786},"wss://relay.bitcoinveneto.org":{lat:64.1355,lon:-21.8954},"wss://nostr.red5d.dev":{lat:37.7621,lon:-122.3971},"wss://relay-testnet.k8s.layer3.news":{lat:37.3394,lon:-121.895},"wss://promenade.fiatjaf.com":{lat:50.1155,lon:8.6842},"wss://nostrelay.memory-art.xyz":{lat:37.7621,lon:-122.3971},"wss://inbox.azzamo.net":{lat:52.2284,lon:21.0522},"wss://social.proxymana.net":{lat:60.1695,lon:24.9354},"wss://relay.netstr.io":{lat:53.3331,lon:-6.2489},"wss://premium.primal.net":{lat:37.7621,lon:-122.3971},"wss://nostr.lojong.info":{lat:37.7621,lon:-122.3971},"wss://nostr-rs-relay-ishosta.phamthanh.me":{lat:37.7621,lon:-122.3971},"wss://relay.stream.labs.h3.se":{lat:59.3294,lon:18.0687},"wss://tollbooth.stens.dev":{lat:51.4566,lon:7.0123},"wss://relay.chakany.systems":{lat:37.7621,lon:-122.3971},"wss://relay.mwaters.net":{lat:50.9519,lon:1.8563},"wss://nostr-relay.shirogaku.xyz":{lat:37.7621,lon:-122.3971},"wss://kitchen.zap.cooking":{lat:37.7621,lon:-122.3971},"wss://relay.arx-ccn.com":{lat:50.4779,lon:12.3713},"wss://relay.fr13nd5.com":{lat:50.1155,lon:8.6842},"wss://nostr.tegila.com.br":{lat:39.0437,lon:-77.4875},"wss://relay.jeffg.fyi":{lat:43.7064,lon:-79.3986},"wss://relay.bullishbounty.com":{lat:37.7621,lon:-122.3971},"wss://nostr.spicyz.io":{lat:37.7621,lon:-122.3971},"wss://relay04.lnfi.network":{lat:39.0997,lon:-94.5786},"wss://vidono.apps.slidestr.net":{lat:48.8534,lon:2.3488},"wss://relay03.lnfi.network":{lat:39.0997,lon:-94.5786},"wss://communities.nos.social":{lat:40.8344,lon:-74.1377},"wss://relay.evanverma.com":{lat:40.8344,lon:-74.1377},"wss://nostrelay.circum.space":{lat:51.4566,lon:7.0123},"wss://wot.brightbolt.net":{lat:47.6928,lon:-116.785},"wss://relayrs.notoshi.win":{lat:37.7621,lon:-122.3971},"wss://fenrir-s.notoshi.win":{lat:37.7621,lon:-122.3971},"wss://relay.nsnip.io":{lat:60.1695,lon:24.9354},"wss://x.kojira.io":{lat:37.7621,lon:-122.3971},"wss://relay.hasenpfeffr.com":{lat:39.0437,lon:-77.4875},"wss://relay01.lnfi.network":{lat:39.0997,lon:-94.5786},"wss://nostr.rtvslawenia.com":{lat:49.4542,lon:11.0775},"wss://relay.g1sms.fr":{lat:43.9298,lon:2.148},"wss://nostr.kalf.org":{lat:52.374,lon:4.8897},"wss://nostr.rblb.it":{lat:37.7621,lon:-122.3971},"wss://nostr.4rs.nl":{lat:49.4453,lon:11.0222},"wss://relay.vrtmrz.net":{lat:37.7621,lon:-122.3971},"wss://nostr.hoppe-relay.it.com":{lat:45.5946,lon:-121.1787},"wss://relay-rpi.edufeed.org":{lat:49.4453,lon:11.0222},"wss://relay.copylaradio.com":{lat:50.799,lon:-1.0913},"wss://relay.ru.ac.th":{lat:13.754,lon:100.5014},"wss://relay.bitcoinartclock.com":{lat:50.4779,lon:12.3713},"wss://wot.downisontheup.ca":{lat:47.6062,lon:-122.3321},"wss://nostr.coincards.com":{lat:43.7064,lon:-79.3986},"wss://relay.etch.social":{lat:41.2619,lon:-95.8608},"wss://relay.mess.ch":{lat:47.1345,lon:9.0964},"wss://relay.holzeis.me":{lat:37.7621,lon:-122.3971},"wss://relay-admin.thaliyal.com":{lat:40.822,lon:-74.4488},"wss://nostr.thaliyal.com":{lat:40.822,lon:-74.4488},"wss://strfry.felixzieger.de":{lat:50.1025,lon:8.6299},"wss://nostr.smut.cloud":{lat:37.7621,lon:-122.3971},"wss://r.bitcoinhold.net":{lat:37.7621,lon:-122.3971},"wss://nostr.blankfors.se":{lat:60.1695,lon:24.9354},"wss://portal-relay.pareto.space":{lat:49.4453,lon:11.0222},"wss://relay.getsafebox.app":{lat:43.7064,lon:-79.3986},"wss://relay.anzenkodo.workers.dev":{lat:37.7621,lon:-122.3971},"wss://relay.nostrhub.tech":{lat:49.4453,lon:11.0222},"wss://nostr.prl.plus":{lat:52.374,lon:4.8897},"wss://nostr-2.21crypto.ch":{lat:46.516,lon:6.6328},"wss://nostr.zenon.network":{lat:40.7143,lon:-74.006},"wss://nostr-relay.amethyst.name":{lat:35.7721,lon:-78.6386},"wss://relayone.geektank.ai":{lat:17.121,lon:-61.8433},"wss://fanfares.nostr1.com":{lat:40.7143,lon:-74.006},"wss://wot.geektank.ai":{lat:17.121,lon:-61.8433},"wss://relay-dev.satlantis.io":{lat:40.8344,lon:-74.1377},"wss://relay.siamdev.cc":{lat:13.9178,lon:100.424},"wss://relay.nosto.re":{lat:51.37,lon:6.1681},"wss://wot.soundhsa.com":{lat:39.0997,lon:-94.5786},"wss://nostr.n7ekb.net":{lat:47.5707,lon:-122.2221},"wss://relayone.soundhsa.com":{lat:39.0997,lon:-94.5786},"wss://relay.puresignal.news":{lat:37.7621,lon:-122.3971},"wss://relay.nostx.io":{lat:37.7621,lon:-122.3971},"wss://nostr.now":{lat:35.609,lon:139.7302},"wss://relay.artiostr.ch":{lat:37.7621,lon:-122.3971},"wss://relay.oldenburg.cool":{lat:50.1155,lon:8.6842},"wss://theoutpost.life":{lat:64.1355,lon:-21.8954},"wss://khatru.nostrver.se":{lat:51.37,lon:6.1681},"wss://relay.wavefunc.live":{lat:37.7915,lon:-122.4018},"wss://nostr-relay.zimage.com":{lat:34.0522,lon:-118.2437},"wss://relay.javi.space":{lat:43.4628,lon:11.8807},"wss://bostr.shop":{lat:42.8865,lon:-78.8784},"wss://relay.letsfo.com":{lat:52.2298,lon:21.0118},"wss://alien.macneilmediagroup.com":{lat:37.7621,lon:-122.3971},"wss://rn1.sotiras.org":{lat:37.7621,lon:-122.3971},"wss://gnostr.com":{lat:42.6975,lon:23.3241},"wss://relay.conduit.market":{lat:37.7621,lon:-122.3971},"wss://relay.hivetalk.org":{lat:37.3924,lon:-121.9623},"wss://nostr.l484.com":{lat:30.296,lon:-97.6396},"wss://relay.chorus.community":{lat:50.1155,lon:8.6842},"wss://nostr-relay.moe.gift":{lat:37.7621,lon:-122.3971},"wss://relay.nostrcal.com":{lat:37.7621,lon:-122.3971},"wss://temp.iris.to":{lat:37.7621,lon:-122.3971},"wss://librerelay.aaroniumii.com":{lat:37.7621,lon:-122.3971},"wss://nostr-relay-1.trustlessenterprise.com":{lat:37.7621,lon:-122.3971},"wss://relay.barine.co":{lat:37.7621,lon:-122.3971},"wss://nostr.rohoss.com":{lat:48.1374,lon:11.5755},"wss://wot.nostr.place":{lat:30.2672,lon:-97.7431},"wss://relay.utxo.farm":{lat:34.7331,lon:135.8183},"wss://relay.bankless.at":{lat:37.7621,lon:-122.3971},"wss://relay.toastr.net":{lat:40.8043,lon:-74.0121},"wss://nostr.excentered.com":{lat:52.5244,lon:13.4105},"wss://relay.mccormick.cx":{lat:52.374,lon:4.8897},"wss://relay.cypherflow.ai":{lat:48.8534,lon:2.3488},"wss://relay.laantungir.net":{lat:45.3134,lon:-73.8725},"wss://nostr.veladan.dev":{lat:37.7621,lon:-122.3971},"wss://nostr.tadryanom.me":{lat:37.7621,lon:-122.3971},"wss://nostr-relay.online":{lat:37.7621,lon:-122.3971},"wss://nostr.night7.space":{lat:50.4779,lon:12.3713},"wss://dev-nostr.bityacht.io":{lat:25.0531,lon:121.5264}};function parseGeo(t){try{return Geohash.decode(t)}catch{if(t.includes(",")){const r=t.split(",");if(r.length===2){const l=parseFloat(r[0]),c=parseFloat(r[1]);if(!isNaN(l)&&!isNaN(c))return{lat:l,lon:c}}}}return null}function findClosestRelay(t,e){let r=null,l=1/0;const c=new leafletSrcExports.LatLng(t,e);for(const[m,y]of Object.entries(allRelays))if(y.lat&&y.lon){const _=new leafletSrcExports.LatLng(y.lat,y.lon),w=c.distanceTo(_);w<l&&(l=w,r=m)}return r}const CommunityBadge=({event:t})=>{const e=t.tags.find(c=>c[0]==="a"&&c[1].startsWith("30023:")),r=useCommunityName(e?.[1]),l="px-2 py-1 text-xs font-semibold rounded-full inline-flex items-center space-x-1";return r?jsxRuntimeExports.jsxs("span",{className:`${l} bg-purple-100 text-purple-800`,children:[jsxRuntimeExports.jsx(Users,{size:12}),jsxRuntimeExports.jsx("span",{children:r})]}):jsxRuntimeExports.jsxs("span",{className:`${l} bg-gray-200 text-gray-800`,children:[jsxRuntimeExports.jsx(Globe,{size:12}),jsxRuntimeExports.jsx("span",{children:"Public"})]})};function EventMarker({event:t,onDetailsClick:e}){const r=t.tagValue("g"),l=useEventAttendance(t);if(l.size===0||!r)return null;const c=parseGeo(r);if(!c)return null;const m=t.tagValue("title"),y=t.tagValue("summary");return jsxRuntimeExports.jsx(Marker,{position:[c.lat,c.lon],children:jsxRuntimeExports.jsx(Popup,{children:jsxRuntimeExports.jsxs("div",{className:"min-w-[200px]",children:[jsxRuntimeExports.jsx("div",{className:"mb-2",children:jsxRuntimeExports.jsx(CommunityBadge,{event:t})}),jsxRuntimeExports.jsx("strong",{children:m||"Event"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-600",children:y||t.content}),jsxRuntimeExports.jsxs("div",{className:"mt-2",children:[jsxRuntimeExports.jsx("span",{className:"text-sm font-semibold",children:l.size}),jsxRuntimeExports.jsx("span",{className:"text-sm text-gray-600",children:" going"})]}),jsxRuntimeExports.jsx("button",{onClick:()=>e(t),className:"mt-2 w-full text-center px-3 py-1.5 bg-blue-600 text-white rounded-lg shadow-md hover:bg-blue-700 text-sm",children:"Details"})]})})})}function useNostrEvents(t,e){const{ndk:r}=useNDK(),[l,c]=reactExports.useState(new Map),m=reactExports.useMemo(()=>JSON.stringify(t),[t]);return reactExports.useEffect(()=>{if(!t)return;c(new Map);const _=r.subscribe(t,{closeOnEose:!1},e);return _.on("event",w=>{l.has(w.id)||c(k=>{const C=new Map(k);return C.set(w.id,w),C})}),()=>{_.stop()}},[r,m,e]),reactExports.useMemo(()=>Array.from(l.values()),[l])}const scriptRel="modulepreload",assetsURL=function(t){return"/Gather/"+t},seen={},__vitePreload=function t(e,r,l){let c=Promise.resolve();if(r&&r.length>0){let w=function(k){return Promise.all(k.map(C=>Promise.resolve(C).then(R=>({status:"fulfilled",value:R}),R=>({status:"rejected",reason:R}))))};document.getElementsByTagName("link");const y=document.querySelector("meta[property=csp-nonce]"),_=y?.nonce||y?.getAttribute("nonce");c=w(r.map(k=>{if(k=assetsURL(k),k in seen)return;seen[k]=!0;const C=k.endsWith(".css"),R=C?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${k}"]${R}`))return;const T=document.createElement("link");if(T.rel=C?"stylesheet":scriptRel,C||(T.as="script"),T.crossOrigin="",T.href=k,_&&T.setAttribute("nonce",_),document.head.appendChild(T),C)return new Promise((A,M)=>{T.addEventListener("load",A),T.addEventListener("error",()=>M(new Error(`Unable to preload CSS for ${k}`)))})}))}function m(y){const _=new Event("vite:preloadError",{cancelable:!0});if(_.payload=y,window.dispatchEvent(_),!_.defaultPrevented)throw y}return c.then(y=>{for(const _ of y||[])_.status==="rejected"&&m(_.reason);return e().catch(m)})};/*! Capacitor: https://capacitorjs.com/ - MIT License */var ExceptionCode;(function(t){t.Unimplemented="UNIMPLEMENTED",t.Unavailable="UNAVAILABLE"})(ExceptionCode||(ExceptionCode={}));class CapacitorException extends Error{constructor(e,r,l){super(e),this.message=e,this.code=r,this.data=l}}const getPlatformId=t=>{var e,r;return t?.androidBridge?"android":!((r=(e=t?.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||r===void 0)&&r.bridge?"ios":"web"},createCapacitor=t=>{const e=t.CapacitorCustomPlatform||null,r=t.Capacitor||{},l=r.Plugins=r.Plugins||{},c=()=>e!==null?e.name:getPlatformId(t),m=()=>c()!=="web",y=R=>{const T=k.get(R);return!!(T?.platforms.has(c())||_(R))},_=R=>{var T;return(T=r.PluginHeaders)===null||T===void 0?void 0:T.find(A=>A.name===R)},w=R=>t.console.error(R),k=new Map,C=(R,T={})=>{const A=k.get(R);if(A)return console.warn(`Capacitor plugin "${R}" already registered. Cannot register plugins twice.`),A.proxy;const M=c(),B=_(R);let j;const re=async()=>(!j&&M in T?j=typeof T[M]=="function"?j=await T[M]():j=T[M]:e!==null&&!j&&"web"in T&&(j=typeof T.web=="function"?j=await T.web():j=T.web),j),de=(te,le)=>{var me,F;if(B){const K=B?.methods.find(D=>le===D.name);if(K)return K.rtype==="promise"?D=>r.nativePromise(R,le.toString(),D):(D,Y)=>r.nativeCallback(R,le.toString(),D,Y);if(te)return(me=te[le])===null||me===void 0?void 0:me.bind(te)}else{if(te)return(F=te[le])===null||F===void 0?void 0:F.bind(te);throw new CapacitorException(`"${R}" plugin is not implemented on ${M}`,ExceptionCode.Unimplemented)}},se=te=>{let le;const me=(...F)=>{const K=re().then(D=>{const Y=de(D,te);if(Y){const $=Y(...F);return le=$?.remove,$}else throw new CapacitorException(`"${R}.${te}()" is not implemented on ${M}`,ExceptionCode.Unimplemented)});return te==="addListener"&&(K.remove=async()=>le()),K};return me.toString=()=>`${te.toString()}() { [capacitor code] }`,Object.defineProperty(me,"name",{value:te,writable:!1,configurable:!1}),me},ye=se("addListener"),z=se("removeListener"),W=(te,le)=>{const me=ye({eventName:te},le),F=async()=>{const D=await me;z({eventName:te,callbackId:D},le)},K=new Promise(D=>me.then(()=>D({remove:F})));return K.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await F()},K},Q=new Proxy({},{get(te,le){switch(le){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return B?W:ye;case"removeListener":return z;default:return se(le)}}});return l[R]=Q,k.set(R,{name:R,proxy:Q,platforms:new Set([...Object.keys(T),...B?[M]:[]])}),Q};return r.convertFileSrc||(r.convertFileSrc=R=>R),r.getPlatform=c,r.handleError=w,r.isNativePlatform=m,r.isPluginAvailable=y,r.registerPlugin=C,r.Exception=CapacitorException,r.DEBUG=!!r.DEBUG,r.isLoggingEnabled=!!r.isLoggingEnabled,r},initCapacitorGlobal=t=>t.Capacitor=createCapacitor(t),Capacitor=initCapacitorGlobal(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),registerPlugin=Capacitor.registerPlugin;class WebPlugin{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,r){let l=!1;this.listeners[e]||(this.listeners[e]=[],l=!0),this.listeners[e].push(r);const m=this.windowListeners[e];m&&!m.registered&&this.addWindowListener(m),l&&this.sendRetainedArgumentsForEvent(e);const y=async()=>this.removeListener(e,r);return Promise.resolve({remove:y})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,r,l){const c=this.listeners[e];if(!c){if(l){let m=this.retainedEventArguments[e];m||(m=[]),m.push(r),this.retainedEventArguments[e]=m}return}c.forEach(m=>m(r))}hasListeners(e){var r;return!!(!((r=this.listeners[e])===null||r===void 0)&&r.length)}registerWindowListener(e,r){this.windowListeners[r]={registered:!1,windowEventName:e,pluginEventName:r,handler:l=>{this.notifyListeners(r,l)}}}unimplemented(e="not implemented"){return new Capacitor.Exception(e,ExceptionCode.Unimplemented)}unavailable(e="not available"){return new Capacitor.Exception(e,ExceptionCode.Unavailable)}async removeListener(e,r){const l=this.listeners[e];if(!l)return;const c=l.indexOf(r);this.listeners[e].splice(c,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const r=this.retainedEventArguments[e];r&&(delete this.retainedEventArguments[e],r.forEach(l=>{this.notifyListeners(e,l)}))}}const encode=t=>encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),decode=t=>t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class CapacitorCookiesPluginWeb extends WebPlugin{async getCookies(){const e=document.cookie,r={};return e.split(";").forEach(l=>{if(l.length<=0)return;let[c,m]=l.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");c=decode(c).trim(),m=decode(m).trim(),r[c]=m}),r}async setCookie(e){try{const r=encode(e.key),l=encode(e.value),c=`; expires=${(e.expires||"").replace("expires=","")}`,m=(e.path||"/").replace("path=",""),y=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${r}=${l||""}${c}; path=${m}; ${y};`}catch(r){return Promise.reject(r)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(r){return Promise.reject(r)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const r of e)document.cookie=r.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}registerPlugin("CapacitorCookies",{web:()=>new CapacitorCookiesPluginWeb});const readBlobAsBase64=async t=>new Promise((e,r)=>{const l=new FileReader;l.onload=()=>{const c=l.result;e(c.indexOf(",")>=0?c.split(",")[1]:c)},l.onerror=c=>r(c),l.readAsDataURL(t)}),normalizeHttpHeaders=(t={})=>{const e=Object.keys(t);return Object.keys(t).map(c=>c.toLocaleLowerCase()).reduce((c,m,y)=>(c[m]=t[e[y]],c),{})},buildUrlParams=(t,e=!0)=>t?Object.entries(t).reduce((l,c)=>{const[m,y]=c;let _,w;return Array.isArray(y)?(w="",y.forEach(k=>{_=e?encodeURIComponent(k):k,w+=`${m}=${_}&`}),w.slice(0,-1)):(_=e?encodeURIComponent(y):y,w=`${m}=${_}`),`${l}&${w}`},"").substr(1):null,buildRequestInit=(t,e={})=>{const r=Object.assign({method:t.method||"GET",headers:t.headers},e),c=normalizeHttpHeaders(t.headers)["content-type"]||"";if(typeof t.data=="string")r.body=t.data;else if(c.includes("application/x-www-form-urlencoded")){const m=new URLSearchParams;for(const[y,_]of Object.entries(t.data||{}))m.set(y,_);r.body=m.toString()}else if(c.includes("multipart/form-data")||t.data instanceof FormData){const m=new FormData;if(t.data instanceof FormData)t.data.forEach((_,w)=>{m.append(w,_)});else for(const _ of Object.keys(t.data))m.append(_,t.data[_]);r.body=m;const y=new Headers(r.headers);y.delete("content-type"),r.headers=y}else(c.includes("application/json")||typeof t.data=="object")&&(r.body=JSON.stringify(t.data));return r};class CapacitorHttpPluginWeb extends WebPlugin{async request(e){const r=buildRequestInit(e,e.webFetchExtra),l=buildUrlParams(e.params,e.shouldEncodeUrlParams),c=l?`${e.url}?${l}`:e.url,m=await fetch(c,r),y=m.headers.get("content-type")||"";let{responseType:_="text"}=m.ok?e:{};y.includes("application/json")&&(_="json");let w,k;switch(_){case"arraybuffer":case"blob":k=await m.blob(),w=await readBlobAsBase64(k);break;case"json":w=await m.json();break;case"document":case"text":default:w=await m.text()}const C={};return m.headers.forEach((R,T)=>{C[T]=R}),{data:w,headers:C,status:m.status,url:m.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}registerPlugin("CapacitorHttp",{web:()=>new CapacitorHttpPluginWeb});function s(t){t.CapacitorUtils.Synapse=new Proxy({},{get(e,r){return new Proxy({},{get(l,c){return(m,y,_)=>{const w=t.Capacitor.Plugins[r];if(w===void 0){_(new Error(`Capacitor plugin ${r} not found`));return}if(typeof w[c]!="function"){_(new Error(`Method ${c} not found in Capacitor plugin ${r}`));return}(async()=>{try{const k=await w[c](m);y(k)}catch(k){_(k)}})()}}})}})}function u(t){t.CapacitorUtils.Synapse=new Proxy({},{get(e,r){return t.cordova.plugins[r]}})}function f(t=!1){typeof window>"u"||(window.CapacitorUtils=window.CapacitorUtils||{},window.Capacitor!==void 0&&!t?s(window):window.cordova!==void 0&&u(window))}const Geolocation=registerPlugin("Geolocation",{web:()=>__vitePreload(()=>import("./web-C8bqWKmU.js"),[]).then(t=>new t.GeolocationWeb)});f();function useGeolocation(){const[t,e]=reactExports.useState({coordinates:null,error:null});return reactExports.useEffect(()=>{(async()=>{try{const l=await Geolocation.getCurrentPosition({enableHighAccuracy:!0});e({coordinates:{lat:l.coords.latitude,lng:l.coords.longitude},error:null})}catch{"geolocation"in navigator?navigator.geolocation.getCurrentPosition(c=>{e({coordinates:{lat:c.coords.latitude,lng:c.coords.longitude},error:null})},c=>{e(m=>({...m,error:c.message}))}):e(c=>({...c,error:"Geolocation is not supported."}))}})()},[]),t}function Modal({isOpen:t,onClose:e,children:r}){return t?jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[1001] flex justify-center items-center",children:jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-lg relative",children:[jsxRuntimeExports.jsx("button",{onClick:e,className:"absolute top-3 right-3 text-gray-500 hover:text-gray-800",children:jsxRuntimeExports.jsx(X,{size:24})}),r]})}):null}function useProfiles(t){const{ndk:e}=useNDK(),[r,l]=reactExports.useState(new Map);return reactExports.useEffect(()=>{if(t.length===0){l(new Map);return}const c=t.map(y=>e.getUser({pubkey:y}));(async()=>{const y=new Map;for(const _ of c)await _.fetchProfile(),y.set(_.pubkey,_);l(y)})()},[e,JSON.stringify(t)]),Array.from(r.values())}const socialGraphCache={myFollows:new Set,friendsFollows:new Map};function useSocialGraph(){const{ndk:t,user:e}=useNDK(),[r,l]=reactExports.useState(!0);reactExports.useEffect(()=>{(async()=>{if(!e)return;const w=await t.getUser({pubkey:e.pubkey}).follows();socialGraphCache.myFollows=new Set(Array.from(w).map(C=>C.pubkey));const k=Array.from(w);for(const C of k){const R=await C.follows(),T=new Set(Array.from(R).map(A=>A.pubkey));socialGraphCache.friendsFollows.set(C.pubkey,T)}l(!1)})()},[t,e]);const c=reactExports.useCallback(y=>{if(socialGraphCache.myFollows.has(y))return 1;for(const _ of socialGraphCache.friendsFollows.values())if(_.has(y))return 2;return"?"},[]);return{isLoading:r,getDegree:c,findPath:async y=>(console.log(`Deep search triggered for ${y}`),new Promise(_=>setTimeout(()=>_(null),2e3)))}}function DegreeBadge({degree:t,onDeepSearch:e}){const[r,l]=reactExports.useState(t),[c,m]=reactExports.useState(!1),y=async()=>{m(!0);const C=await e();l(C||"Not found"),m(!1)},_="px-2 py-0.5 text-xs font-semibold rounded-full";let w="bg-gray-200 text-gray-800",k=r;if(r===1)w="bg-green-100 text-green-800",k="1st";else if(r===2)w="bg-blue-100 text-blue-800",k="2nd";else{if(r==="?")return jsxRuntimeExports.jsx("button",{onClick:y,className:`${_} ${w} hover:bg-gray-300`,children:c?"...":"?"});typeof r=="number"&&(w="bg-purple-100 text-purple-800",k=`${r}th`)}return jsxRuntimeExports.jsx("span",{className:`${_} ${w}`,children:k})}const Avatar=({user:t})=>{const e=t.profile?.image||`https://api.dicebear.com/8.x/identicon/svg?seed=${t.npub}`;return jsxRuntimeExports.jsx("img",{src:e,alt:t.profile?.name||"avatar",className:"w-8 h-8 rounded-full"})};function AttendeeList({pubkeys:t,creatorPubkey:e}){const r=useProfiles(t),{getDegree:l,findPath:c}=useSocialGraph();return t.length===0?jsxRuntimeExports.jsx("div",{className:"text-sm text-gray-600",children:"No one is going yet."}):jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h4",{className:"font-bold text-sm mb-2",children:"Who's Going"}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col space-y-2",children:[r.map(m=>jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2",children:[jsxRuntimeExports.jsx(Avatar,{user:m}),jsxRuntimeExports.jsx("span",{className:"text-sm",children:m.profile?.name||m.npub.substring(0,12)}),m.pubkey===e&&jsxRuntimeExports.jsx("span",{className:"px-2 py-0.5 text-xs font-semibold text-purple-800 bg-purple-100 rounded-full",children:"Creator"})]}),jsxRuntimeExports.jsx(DegreeBadge,{degree:l(m.pubkey),onDeepSearch:async()=>await c(m.pubkey)})]},m.npub)),r.length<t.length&&jsxRuntimeExports.jsx("div",{className:"text-sm text-gray-500",children:"Loading profiles..."})]})]})}function useEventChat(t){const{ndk:e,user:r}=useNDK(),[l,c]=reactExports.useState(new Map),m=t.tagValue("d"),y=`${t.kind}:${t.pubkey}:${m}`;reactExports.useEffect(()=>{if(!m)return;const k=e.subscribe({kinds:[1],"#a":[y]},{closeOnEose:!1});return k.on("event",C=>{c(R=>{const T=new Map(R);return T.set(C.id,C),T})}),()=>k.stop()},[e,y]);const _=async k=>{if(!r){alert("Please log in to chat.");return}const C=new NDKEvent(e);C.kind=1,C.content=k,C.tags=[["a",y,"root"]],await C.publish()};return{messages:reactExports.useMemo(()=>Array.from(l.values()).sort((k,C)=>(k.created_at||0)-(C.created_at||0)),[l]),sendMessage:_}}function useKickedUsers(t){const{ndk:e}=useNDK(),[r,l]=reactExports.useState(new Set);return reactExports.useEffect(()=>{const c=t.tags.find(w=>w[0]==="d"&&w[1]!=="gather-community");if(!c)return;const m=c[1],y=`30023:${t.pubkey}:${m}`;(async()=>{const w={kinds:[30024],"#a":[y],"#action":["kick"]},k=await e.fetchEvents(w),C=new Set;for(const R of k){const T=R.tags.find(A=>A[0]==="p");T&&C.add(T[1])}l(C)})()},[e,t]),r}const ChatMessage=({event:t})=>{const e=useProfiles([t.pubkey])[0],r=({user:l})=>{const c=l?.profile?.image||`https://api.dicebear.com/8.x/identicon/svg?seed=${t.author.npub}`;return jsxRuntimeExports.jsx("img",{src:c,alt:l?.profile?.name||"avatar",className:"w-6 h-6 rounded-full"})};return jsxRuntimeExports.jsxs("div",{className:"flex items-start space-x-2 text-sm",children:[jsxRuntimeExports.jsx(r,{user:e}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"font-bold",children:e?.profile?.name||t.author.npub.substring(0,12)}),jsxRuntimeExports.jsx("p",{className:"text-gray-700",children:t.content})]})]})};function EventChat({event:t}){const{messages:e,sendMessage:r}=useEventChat(t),[l,c]=reactExports.useState(""),m=t.tags.find(C=>C[0]==="a"&&C[1].startsWith("30023:")),y=new NDKEvent;if(m){const[,C,R]=m[1].split(":");y.pubkey=C,y.tags=[["d",R]]}const _=useKickedUsers(y),w=e.filter(C=>!_.has(C.pubkey)),k=C=>{C.preventDefault(),l.trim()&&(r(l.trim()),c(""))};return jsxRuntimeExports.jsxs("div",{className:"mt-4 pt-4 border-t",children:[jsxRuntimeExports.jsx("h4",{className:"font-bold text-sm mb-2",children:"Event Chat"}),jsxRuntimeExports.jsxs("div",{className:"space-y-2 max-h-48 overflow-y-auto mb-2 pr-2",children:[w.map(C=>jsxRuntimeExports.jsx(ChatMessage,{event:C},C.id)),w.length===0&&jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-500",children:"No messages yet. Start the conversation!"})]}),jsxRuntimeExports.jsxs("form",{onSubmit:k,className:"flex space-x-2",children:[jsxRuntimeExports.jsx("input",{type:"text",value:l,onChange:C=>c(C.target.value),placeholder:"Say something...",className:"flex-grow mt-1 block w-full px-3 py-1.5 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"}),jsxRuntimeExports.jsx("button",{type:"submit",className:"px-4 py-1.5 bg-blue-600 text-white rounded-lg shadow-md hover:bg-blue-700 text-sm",children:"Send"})]})]})}function useAttendEvent(){const{ndk:t,user:e}=useNDK();return async l=>{if(!e){alert("Please log in to attend an event.");return}const c=new NDKEvent(t);c.kind=31925,c.content="I'm going!",c.tags=[["a",`${l.kind}:${l.pubkey}:${l.tagValue("d")}`],["p",l.pubkey]];try{await c.publish(),alert(`RSVP'd to event: ${l.tagValue("title")}`)}catch(m){console.error("Failed to publish RSVP",m),alert("Failed to RSVP.")}}}function useUnattendEvent(){const{ndk:t,user:e}=useNDK();return async l=>{if(!e){alert("Please log in to unattend an event.");return}const c=l.tagValue("d"),m={kinds:[31925],authors:[e.pubkey],"#a":[`${l.kind}:${l.pubkey}:${c}`]},y=await t.fetchEvent(m);if(y)try{await y.delete("I'm no longer going."),alert("You have successfully un-attended the event.")}catch(_){console.error("Failed to delete RSVP",_),alert("Failed to un-attend.")}else console.warn("Could not find original RSVP to delete.")}}function AttendButton({event:t}){const{user:e}=useNDK(),r=useAttendEvent(),l=useUnattendEvent(),c=useEventAttendance(t);if(!e)return null;const m=c.has(e.pubkey),y=()=>{m?l(t):r(t)};return jsxRuntimeExports.jsx("button",{className:`mr-2 p-2 text-white rounded text-sm ${m?"bg-gray-500 hover:bg-gray-600":"bg-blue-600 hover:bg-blue-700"}`,onClick:y,children:m?"Un-attend":" Attend"})}function ZapButton({event:t}){const e=()=>{alert(`Zap button clicked for event ${t.id}`)};return jsxRuntimeExports.jsx("button",{className:"p-1 bg-yellow-500 text-white rounded",onClick:e,children:" Zap"})}const checkedInEvents=new Map;function useProximity(t){const{ndk:e,tempSigner:r}=useNDK(),{coordinates:l}=useGeolocation(),[c,m]=reactExports.useState(!1),[y,_]=reactExports.useState(!1),[w,k]=reactExports.useState(null),C=reactExports.useMemo(()=>{const A=t.tagValue("g");if(!A)return null;const M=parseGeo(A);return M?L$1.latLng(M.lat,M.lon):null},[t]),R=reactExports.useCallback(async()=>{const A=checkedInEvents.get(t.id);if(!A)return;const M=new NDKEvent(e);M.kind=5,M.tags=[["e",A]],await M.sign(r),await M.publish(),checkedInEvents.delete(t.id),_(!1)},[e,t,r]);reactExports.useEffect(()=>{if(l&&C){const M=L$1.latLng(l.lat,l.lng).distanceTo(C);k(M),M<100?m(!0):(m(!1),y&&R())}},[l,C,y,R]);const T=reactExports.useCallback(async()=>{const A=t.tagValue("d");if(!A)return;const M=new NDKEvent(e);M.kind=40001,M.content="ping",M.tags=[["a",`${t.kind}:${t.pubkey}:${A}`]],await M.sign(r),await M.publish(),checkedInEvents.set(t.id,M.id),_(!0)},[e,t,r]);return{canCheckIn:c,isCheckedIn:y,checkIn:T,distance:w}}function ProximityIndicator({event:t}){const{canCheckIn:e,isCheckedIn:r,checkIn:l,distance:c}=useProximity(t),m=reactExports.useMemo(()=>{const k=t.tagValue("d");return k?{kinds:[40001],"#a":[`${t.kind}:${t.pubkey}:${k}`]}:null},[t]),y=useNostrEvents(m||{}),_=reactExports.useMemo(()=>{const k=new Set;for(const C of y)k.add(C.pubkey);return k},[y]),w=k=>k===null?"Calculating distance...":k>1e3?`You are ${(k/1e3).toFixed(1)}km away.`:`You are ${k.toFixed(0)}m away.`;return jsxRuntimeExports.jsxs("div",{className:"p-4 border rounded-lg mt-4",children:[jsxRuntimeExports.jsx("h3",{className:"font-bold text-lg mb-2",children:"Live Proximity"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-2xl font-bold",children:_.size}),jsxRuntimeExports.jsx("span",{className:"text-gray-600",children:" users here now"})]}),e&&jsxRuntimeExports.jsx("button",{onClick:l,disabled:r,className:`px-4 py-2 text-white rounded-lg shadow-md text-sm ${r?"bg-gray-400":"bg-green-600 hover:bg-green-700"}`,children:r?"Checked In":"Check In"})]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-500 mt-2",children:w(c)})]})}const formatTime=t=>t?new Date(parseInt(t)*1e3).toLocaleString([],{dateStyle:"short",timeStyle:"short"}):"";function EventDetails({event:t}){const e=t.tagValue("title"),r=t.tagValue("summary"),l=t.tagValue("starts"),c=t.tagValue("ends"),m=Array.from(useEventAttendance(t));return jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold mb-2",children:e||"Event"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 mb-4",children:r||t.content}),l&&c&&jsxRuntimeExports.jsxs("div",{className:"text-md text-gray-800 my-4",children:[jsxRuntimeExports.jsxs("p",{children:[jsxRuntimeExports.jsx("strong",{children:"Starts:"})," ",formatTime(l)]}),jsxRuntimeExports.jsxs("p",{children:[jsxRuntimeExports.jsx("strong",{children:"Ends:"})," ",formatTime(c)]})]}),jsxRuntimeExports.jsx(ProximityIndicator,{event:t}),jsxRuntimeExports.jsxs("div",{className:"flex items-center my-4",children:[jsxRuntimeExports.jsx(AttendButton,{event:t}),jsxRuntimeExports.jsx(ZapButton,{event:t})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(AttendeeList,{pubkeys:m,creatorPubkey:t.pubkey})}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(EventChat,{event:t})})]})]})}function MapController({center:t,recenterRequest:e}){const r=useMap(),[l,c]=reactExports.useState(!1);return reactExports.useEffect(()=>{t&&(!l||e>0)&&(r.flyTo(t,14),c(!0))},[t,r,l,e]),null}const iconSVG=`
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25 41" width="25" height="41">
  <path fill="#28a745" d="M12.5 0C5.6 0 0 5.6 0 12.5c0 6.9 12.5 28.5 12.5 28.5S25 19.4 25 12.5C25 5.6 19.4 0 12.5 0z"/>
  <circle fill="white" cx="12.5" cy="12.5" r="4"/>
</svg>
`,greenIcon=new L$1.Icon({iconUrl:`data:image/svg+xml;base64,${btoa(iconSVG)}`,iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png",shadowSize:[41,41]});function UserMarker(){const{coordinates:t}=useGeolocation();if(!t)return null;const e=[t.lat,t.lng];return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Circle,{center:e,radius:100,pathOptions:{color:"blue",fillColor:"blue",fillOpacity:.1}}),jsxRuntimeExports.jsx(Marker,{position:e,icon:L$1.divIcon({className:"user-location-dot",html:'<div style="background-color: blue; width: 12px; height: 12px; border-radius: 50%; border: 2px solid white;"></div>',iconSize:[12,12]})})]})}function CenterMapControl({onRequestRecenter:t}){return jsxRuntimeExports.jsx("div",{className:"leaflet-bottom leaflet-right",children:jsxRuntimeExports.jsx("div",{className:"leaflet-control leaflet-bar",children:jsxRuntimeExports.jsx("button",{onClick:t,title:"Center on my location",children:jsxRuntimeExports.jsx(LocateFixed,{size:18})})})})}function MapEvents({onMoveEnd:t}){const e=useMapEvents({moveend:()=>{t(e.getCenter())}});return null}function MapView({timeFilter:t,mapFilter:e,onLaunchCreateEvent:r,communities:l,recenterRequest:c,onRequestRecenter:m}){const{ndk:y}=useNDK(),[_,w]=reactExports.useState(null),k=te=>{const le=findClosestRelay(te.lat,te.lng);le&&le!==_&&(console.log(`New closest relay found: ${le}`),w(le))},C=reactExports.useMemo(()=>{const te=new Set(y.pool.relays.values());if(_){const le=y.pool.getRelay(_);te.add(le)}return new NDKRelaySet(te,y)},[y,_]),R=reactExports.useMemo(()=>{if(e==="communities"){const te=l.map(le=>{const me=le.tags.find(F=>F[0]==="d"&&F[1]!=="gather-community");return me?`30023:${le.pubkey}:${me[1]}`:null}).filter(Boolean);return te.length===0?{kinds:[31923],"#a":["no-communities"]}:{kinds:[31923],"#a":te}}else return{kinds:[31923],"#t":["gather"]}},[e,l]),T=useNostrEvents(R,C),{coordinates:A}=useGeolocation(),[M,B]=reactExports.useState(null),[j,re]=reactExports.useState(null),de=te=>{B(te)},se=()=>{B(null)},ye=Math.floor(Date.now()/1e3),z=T.filter(te=>{const le=te.tagValue("expires_at");if(!le||parseInt(le)<=ye)return!1;const me=te.tagValue("starts");if(!me)return!1;const F=ye+360*60;return t==="live"?parseInt(me)<F:t==="upcoming"?parseInt(me)>=F:!0}),W=[32.65,-16.9],Q=A?[A.lat,A.lng]:null;return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs(MapContainer,{center:W,zoom:13,className:"w-full h-full z-0",zoomControl:!1,children:[jsxRuntimeExports.jsx(MapController,{center:Q,recenterRequest:c}),jsxRuntimeExports.jsx(TileLayer,{url:"https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",attribution:' <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors  <a href="https://carto.com/attributions">CARTO</a>'}),jsxRuntimeExports.jsx(MapEvents,{onMoveEnd:k}),jsxRuntimeExports.jsx(UserMarker,{}),jsxRuntimeExports.jsx(CenterMapControl,{onRequestRecenter:m}),z.map(te=>jsxRuntimeExports.jsx(EventMarker,{event:te,onDetailsClick:de},te.id)),j&&jsxRuntimeExports.jsx(Marker,{position:j,icon:greenIcon,children:jsxRuntimeExports.jsx(Popup,{children:jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("p",{className:"font-semibold",children:"Create event here?"}),jsxRuntimeExports.jsx("button",{onClick:()=>{r(j),re(null)},className:"mt-2 w-full text-center px-3 py-1.5 bg-blue-600 text-white rounded-lg shadow-md hover:bg-blue-700 text-sm",children:"Confirm"})]})})})]}),jsxRuntimeExports.jsx(Modal,{isOpen:!!M,onClose:se,children:M&&jsxRuntimeExports.jsx(EventDetails,{event:M})})]})}function LoginModal({isOpen:t,onClose:e}){const{login:r,loginWithNsec:l,setSigner:c}=useNDK(),[m,y]=reactExports.useState(!1),[_,w]=reactExports.useState(""),[k,C]=reactExports.useState(null),[R,T]=reactExports.useState(""),[A,M]=reactExports.useState(!1),B=()=>{if(_.startsWith("nsec"))try{l(_),e()}catch{C("Invalid nsec key. Please check and try again.")}else C('Key must start with "nsec".')},j=async()=>{M(!0),C(null);try{const{ndk:se}=useNDK(),ye=new NDKNip46Signer(se);c(ye),ye.on("authUrl",z=>{T(z)}),await ye.blockUntilReady(),e()}catch(se){console.error("NIP-46 connection error",se),C("Failed to connect with the signer app. Please try again.")}finally{M(!1)}},re=async()=>{await r(),e()},de=!!window.nostr;return jsxRuntimeExports.jsx(Modal,{isOpen:t,onClose:e,children:jsxRuntimeExports.jsxs("div",{className:"p-6",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-center mb-6",children:"Login"}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col space-y-4",children:[de&&jsxRuntimeExports.jsx("button",{onClick:re,className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg shadow-md hover:bg-blue-700",children:"Login with Extension (Recommended)"}),!de&&jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("p",{className:"mb-2",children:"Connect with a mobile signer:"}),R?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("a",{href:`nostrconnect://${R}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 break-all",children:`nostrconnect://${R}`}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Copy this code and paste it into your signer app."})]}):jsxRuntimeExports.jsx("button",{onClick:j,disabled:A,className:"w-full px-4 py-2 bg-green-600 text-white rounded-lg shadow-md hover:bg-green-700 disabled:bg-gray-400",children:A?"Waiting for connection...":"Login with Signer App"})]}),jsxRuntimeExports.jsx("div",{className:"text-center",children:jsxRuntimeExports.jsx("button",{onClick:()=>y(!m),className:"text-sm text-gray-500 hover:underline",children:"Or use a private key (nsec)"})}),m&&jsxRuntimeExports.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-red-700 font-bold mb-2",children:"Security Warning"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-red-600 mb-4",children:"Pasting your private key can be risky. It gives this app full control over your Nostr identity. Only proceed if you understand the risks."}),jsxRuntimeExports.jsx("input",{type:"password",value:_,onChange:se=>w(se.target.value),placeholder:"nsec...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg"}),jsxRuntimeExports.jsx("button",{onClick:B,className:"mt-2 w-full px-4 py-2 bg-red-600 text-white rounded-lg shadow-md hover:bg-red-700",children:"Login with nsec"})]}),k&&jsxRuntimeExports.jsx("p",{className:"text-red-500 text-sm text-center",children:k})]})]})})}function LoginButton(){const{user:t,logout:e}=useNDK(),[r,l]=reactExports.useState(!1),c=()=>{t?e():l(!0)};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("button",{onClick:c,className:"p-2 bg-white rounded-md shadow-md hover:bg-gray-100 flex items-center space-x-2",children:[t?jsxRuntimeExports.jsx(LogOut,{size:18}):jsxRuntimeExports.jsx(LogIn,{size:18}),jsxRuntimeExports.jsx("span",{className:"text-sm",children:t?"Logout":"Login"})]}),jsxRuntimeExports.jsx(LoginModal,{isOpen:r,onClose:()=>l(!1)})]})}function TimeFilter({filter:t,onFilterChange:e}){const r="px-4 py-2 text-sm font-medium",l="bg-blue-600 text-white",c="bg-white text-gray-700 hover:bg-gray-50";return jsxRuntimeExports.jsxs("div",{className:"inline-flex rounded-md shadow-sm",role:"group",children:[jsxRuntimeExports.jsx("button",{type:"button",className:`${r} rounded-l-lg border border-gray-200 ${t==="live"?l:c}`,onClick:()=>e("live"),children:"Live Now"}),jsxRuntimeExports.jsx("button",{type:"button",className:`${r} rounded-r-md border-t border-b border-r border-gray-200 ${t==="upcoming"?l:c}`,onClick:()=>e("upcoming"),children:"Upcoming"})]})}const byteToHex=[];for(let t=0;t<256;++t)byteToHex.push((t+256).toString(16).slice(1));function unsafeStringify(t,e=0){return(byteToHex[t[e+0]]+byteToHex[t[e+1]]+byteToHex[t[e+2]]+byteToHex[t[e+3]]+"-"+byteToHex[t[e+4]]+byteToHex[t[e+5]]+"-"+byteToHex[t[e+6]]+byteToHex[t[e+7]]+"-"+byteToHex[t[e+8]]+byteToHex[t[e+9]]+"-"+byteToHex[t[e+10]]+byteToHex[t[e+11]]+byteToHex[t[e+12]]+byteToHex[t[e+13]]+byteToHex[t[e+14]]+byteToHex[t[e+15]]).toLowerCase()}let getRandomValues;const rnds8=new Uint8Array(16);function rng(){if(!getRandomValues){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");getRandomValues=crypto.getRandomValues.bind(crypto)}return getRandomValues(rnds8)}const randomUUID=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),native={randomUUID};function v4(t,e,r){if(native.randomUUID&&!t)return native.randomUUID();t=t||{};const l=t.random??t.rng?.()??rng();if(l.length<16)throw new Error("Random bytes length must be >= 16");return l[6]=l[6]&15|64,l[8]=l[8]&63|128,unsafeStringify(l)}function useJoinCommunity(t){const{ndk:e,user:r}=useNDK();return async c=>{if(!r){alert("Please log in to join a community.");return}const m=await e.fetchEvent({kinds:[10002],authors:[r.pubkey]}),y=c.tags.find(C=>C[0]==="d"&&C[1]!=="gather-community");if(!y){console.error("Community event is missing a unique d tag.",c),alert("Cannot join this community: invalid format.");return}const _=y[1],w=["a",`30023:${c.pubkey}:${_}`],k=new NDKEvent(e);if(k.kind=10002,k.tags=m?m.tags:[],k.tags.some(C=>C[1]===w[1])){alert("You've already joined this community.");return}k.tags.push(w);try{await k.publish(),alert(`Successfully joined ${c.tagValue("title")}!`),t()}catch(C){console.error("Failed to join community",C),alert("Failed to join community.")}}}function usePublishGroup(t){const{ndk:e}=useNDK(),r=useJoinCommunity(t);async function l(c){const{name:m,description:y}=c,_=new NDKEvent(e);_.kind=30023,_.content=y;const w=v4();_.tags=[["d","gather-community"],["d",w],["title",m],["t","community"]];try{return await _.publish(),console.log("Published Group:",_.encode()),await r(_),!0}catch(k){return console.error("Failed to publish group",k),!1}}return l}function CreateGroupForm({refetchMyCommunities:t}){const[e,r]=reactExports.useState(""),[l,c]=reactExports.useState(""),m=usePublishGroup(t),y=async _=>{if(_.preventDefault(),!e||!l){alert("Please fill in all fields.");return}await m({name:e,description:l})?(r(""),c(""),alert("Community created successfully!")):alert("Failed to create community. Please try again.")};return jsxRuntimeExports.jsxs("form",{onSubmit:y,className:"p-4 border rounded-lg",children:[jsxRuntimeExports.jsx("h3",{className:"font-bold text-lg mb-2",children:"Create a New Community"}),jsxRuntimeExports.jsxs("div",{className:"mb-2",children:[jsxRuntimeExports.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Name"}),jsxRuntimeExports.jsx("input",{type:"text",id:"name",value:e,onChange:_=>r(_.target.value),className:"mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),jsxRuntimeExports.jsxs("div",{className:"mb-4",children:[jsxRuntimeExports.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"Description"}),jsxRuntimeExports.jsx("textarea",{id:"description",value:l,onChange:_=>c(_.target.value),className:"mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),jsxRuntimeExports.jsx("button",{type:"submit",className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg shadow-md hover:bg-blue-700",children:"Create Community"})]})}function useListAllCommunities(){const t=reactExports.useMemo(()=>({kinds:[30023],"#d":["gather-community"]}),[]);return useNostrEvents(t)}function useMyCommunities(){const{ndk:t,user:e}=useNDK(),[r,l]=reactExports.useState([]),c=reactExports.useCallback(async()=>{if(!e)return;const m=await t.fetchEvent({kinds:[10002],authors:[e.pubkey]});if(!m){l([]);return}const y=m.tags.filter(C=>C[0]==="a"&&C[1].startsWith("30023:")).map(C=>C[1]);if(y.length===0){l([]);return}const _=y.map(C=>{const[,R,T]=C.split(":");return{kinds:[30023],authors:[R],"#d":[T]}});if(_.length===0)return;const w=await t.fetchEvents(_),k=Array.from(w).filter(C=>C.tags.some(R=>R[0]==="d"&&R[1]==="gather-community"));l(k)},[t,e]);return reactExports.useEffect(()=>{c()},[c]),{communities:r,refetch:c}}function useLeaveCommunity(t){const{ndk:e,user:r}=useNDK();return async c=>{if(!r){alert("Please log in to leave a community.");return}const m=await e.fetchEvent({kinds:[10002],authors:[r.pubkey]});if(!m){alert("Could not find your list of communities.");return}const y=c.tags.find(C=>C[0]==="d"&&C[1]!=="gather-community");if(!y)return;const _=y[1],w=`30023:${c.pubkey}:${_}`,k=new NDKEvent(e);k.kind=10002,k.tags=m.tags.filter(C=>C[1]!==w);try{await k.publish(),alert(`Successfully left ${c.tagValue("title")}.`),t()}catch(C){console.error("Failed to leave community",C),alert("Failed to leave community.")}}}function CommunityList({title:t,communities:e,refetch:r=()=>{},isJoined:l,onCommunityClick:c}){const m=useJoinCommunity(r),y=useLeaveCommunity(r),_=w=>{const k=l?l(w):!1;return t==="My Communities"?jsxRuntimeExports.jsx("button",{onClick:()=>y(w),className:"px-3 py-1.5 text-white rounded-lg shadow-md text-sm bg-red-600 hover:bg-red-700",children:"Leave"}):k?jsxRuntimeExports.jsx("button",{onClick:()=>y(w),className:"px-3 py-1.5 text-white rounded-lg shadow-md text-sm bg-red-600 hover:bg-red-700",children:"Leave"}):jsxRuntimeExports.jsx("button",{onClick:()=>m(w),className:"px-3 py-1.5 text-white rounded-lg shadow-md text-sm bg-green-600 hover:bg-green-700",children:"Join"})};return jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-semibold mb-2",children:t}),e.length===0?jsxRuntimeExports.jsx("p",{className:"text-gray-500",children:"No communities found."}):jsxRuntimeExports.jsx("div",{className:"space-y-2",children:e.map(w=>{const k=w.tags.some(C=>C[0]==="private");return jsxRuntimeExports.jsxs("div",{className:"p-3 border rounded-lg flex justify-between items-center",children:[jsxRuntimeExports.jsxs("div",{className:`cursor-${c?"pointer":"default"}`,onClick:()=>c&&c(w),children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2",children:[k&&jsxRuntimeExports.jsx(Lock,{size:16,className:"text-gray-500"}),jsxRuntimeExports.jsx("h3",{className:"font-bold",children:w.tagValue("title")})]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-600",children:w.content})]}),_(w)]},w.id)})})]})}const EventList=({events:t})=>t.length===0?jsxRuntimeExports.jsx("p",{className:"text-gray-500",children:"No events found for this community."}):jsxRuntimeExports.jsx("div",{className:"space-y-2",children:t.map(e=>jsxRuntimeExports.jsxs("div",{className:"p-3 border rounded-lg",children:[jsxRuntimeExports.jsx("h4",{className:"font-bold",children:e.tagValue("title")}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-600",children:e.content})]},e.id))});function CommunityPage({community:t,onBack:e,refetchMyCommunities:r}){const l=t.tags.find(w=>w[0]==="d"&&w[1]!=="gather-community"),c=`30023:${t.pubkey}:${l?l[1]:""}`,m=reactExports.useMemo(()=>({kinds:[31923],"#a":[c]}),[c]),y=useNostrEvents(m),_=useLeaveCommunity(r);return jsxRuntimeExports.jsxs("div",{className:"p-4",children:[jsxRuntimeExports.jsxs("button",{onClick:e,className:"flex items-center space-x-2 text-blue-600 hover:underline mb-4",children:[jsxRuntimeExports.jsx(ArrowLeft,{size:18}),jsxRuntimeExports.jsx("span",{children:"Back to Communities"})]}),jsxRuntimeExports.jsxs("div",{className:"mb-6",children:[jsxRuntimeExports.jsx("h1",{className:"text-3xl font-bold",children:t.tagValue("title")}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 mt-2",children:t.content})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Community Events"}),jsxRuntimeExports.jsx(EventList,{events:y})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-semibold mb-2 mt-4",children:"Actions"}),jsxRuntimeExports.jsx("button",{onClick:()=>_(t),className:"px-4 py-2 bg-red-600 text-white rounded-lg shadow-md hover:bg-red-700",children:"Leave Community"})]})]})]})}function CommunitiesView(){const t=useListAllCommunities(),{communities:e,refetch:r}=useMyCommunities(),[l,c]=reactExports.useState(null),m=reactExports.useMemo(()=>new Set(e.map(_=>_.id)),[e]),y=_=>m.has(_.id);return l?jsxRuntimeExports.jsx(CommunityPage,{community:l,onBack:()=>c(null),refetchMyCommunities:r}):jsxRuntimeExports.jsxs("div",{className:"p-4",children:[jsxRuntimeExports.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Communities"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(CommunityList,{title:"My Communities",communities:e,onCommunityClick:c}),jsxRuntimeExports.jsx("div",{className:"mt-6",children:jsxRuntimeExports.jsx(CommunityList,{title:"Discover Communities",communities:t,refetch:r,isJoined:y})})]}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(CreateGroupForm,{refetchMyCommunities:r})})]})]})}const typedRelays=allRelays;function usePublishEvent(){const{ndk:t,user:e}=useNDK();async function r(l){const{title:c,summary:m,lat:y,lon:_,community:w}=l,k=new NDKEvent(t);k.kind=31923,k.content=m;const C=v4(),R=l.starts||Math.floor(Date.now()/1e3),T=l.ends||R+7200;k.tags=[["d",C],["title",c],["summary",m],["g",`${y},${_}`],["starts",R.toString()],["ends",T.toString()],["expires_at",T.toString()],["t","gather"]],w&&k.tags.push(["a",w]);try{const A=findClosestRelay(y,_),M=new Set(t.pool.relays.values());if(A){const re=t.pool.getRelay(A);M.add(re)}const B=new NDKRelaySet(M,t),j=Array.from(M).map(re=>{const de=typedRelays[re.url]?`(lat: ${typedRelays[re.url].lat}, lon: ${typedRelays[re.url].lon})`:"(geo not available)";return`  - ${re.url} ${de}`});if(console.log(`Publishing event to the following relays:
${j.join(`
`)}`),await k.publish(B),console.log("Published Event:",k.encode()),e){const re=new NDKEvent(t);re.kind=31925,re.content="I'm going!",re.tags=[["a",`${k.kind}:${e.pubkey}:${C}`],["p",e.pubkey]],await re.publish(B),console.log("Published auto-RSVP for creator.")}return!0}catch(A){return console.error("Failed to publish event or RSVP",A),!1}}return r}const toLocalISOString=t=>{const e=new Date().getTimezoneOffset()*6e4;return new Date(t.getTime()-e).toISOString().slice(0,-1).substring(0,16)};function CreateEventForm({lat:t,lon:e,onClose:r,communities:l}){const[c,m]=reactExports.useState(""),[y,_]=reactExports.useState(""),[w,k]=reactExports.useState(!0),[C,R]=reactExports.useState(toLocalISOString(new Date)),[T,A]=reactExports.useState(toLocalISOString(new Date(Date.now()+7200*1e3))),[M,B]=reactExports.useState(""),j=usePublishEvent(),re=async de=>{if(de.preventDefault(),!c||!y){alert("Please fill in all fields.");return}let se={title:c,summary:y,lat:t,lon:e};if(M&&(se.community=M),!w){if(!C||!T){alert("Please select a start and end date for the event.");return}const z=Math.floor(new Date(C).getTime()/1e3),W=Math.floor(new Date(T).getTime()/1e3);if(z>=W){alert("The event start time must be before the end time.");return}const Q=360*60;if(W-z>Q){alert("Events cannot be longer than 6 hours.");return}se.starts=z,se.ends=W}await j(se)?r():alert("Failed to create event. Please try again.")};return jsxRuntimeExports.jsxs("form",{onSubmit:re,className:"p-2 w-64",children:[jsxRuntimeExports.jsx("h3",{className:"font-bold text-lg mb-2",children:"Create a New Gathering"}),jsxRuntimeExports.jsxs("div",{className:"mb-2",children:[jsxRuntimeExports.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700",children:"Title"}),jsxRuntimeExports.jsx("input",{type:"text",id:"title",value:c,onChange:de=>m(de.target.value),className:"mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),jsxRuntimeExports.jsxs("div",{className:"mb-2",children:[jsxRuntimeExports.jsx("label",{htmlFor:"summary",className:"block text-sm font-medium text-gray-700",children:"Summary"}),jsxRuntimeExports.jsx("textarea",{id:"summary",value:y,onChange:de=>_(de.target.value),className:"mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),jsxRuntimeExports.jsxs("div",{className:"mb-2",children:[jsxRuntimeExports.jsx("label",{htmlFor:"community",className:"block text-sm font-medium text-gray-700",children:"Community (Optional)"}),jsxRuntimeExports.jsxs("select",{id:"community",value:M,onChange:de=>B(de.target.value),className:"mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[jsxRuntimeExports.jsx("option",{value:"",children:"Public Event"}),l.map(de=>{const se=de.tags.find(ye=>ye[0]==="d"&&ye[1]!=="gather-community");return se?jsxRuntimeExports.jsx("option",{value:`30023:${de.pubkey}:${se[1]}`,children:de.tagValue("title")},de.id):null})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center mb-2",children:[jsxRuntimeExports.jsx("input",{id:"isLive",type:"checkbox",checked:w,onChange:()=>k(!w),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),jsxRuntimeExports.jsx("label",{htmlFor:"isLive",className:"ml-2 block text-sm text-gray-900",children:"Live Now (lasts 2 hours)"})]}),!w&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"mb-2",children:[jsxRuntimeExports.jsx("label",{htmlFor:"startDate",className:"block text-sm font-medium text-gray-700",children:"Starts"}),jsxRuntimeExports.jsx("input",{type:"datetime-local",id:"startDate",value:C,onChange:de=>R(de.target.value),className:"mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),jsxRuntimeExports.jsxs("div",{className:"mb-4",children:[jsxRuntimeExports.jsx("label",{htmlFor:"endDate",className:"block text-sm font-medium text-gray-700",children:"Ends"}),jsxRuntimeExports.jsx("input",{type:"datetime-local",id:"endDate",value:T,onChange:de=>A(de.target.value),className:"mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]})]}),jsxRuntimeExports.jsx("button",{type:"submit",className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg shadow-md hover:bg-blue-700",children:"Publish Gathering"})]})}function CreateEventModal({isOpen:t,onClose:e,lat:r,lon:l,communities:c}){return jsxRuntimeExports.jsx(Modal,{isOpen:t,onClose:e,children:jsxRuntimeExports.jsx(CreateEventForm,{lat:r,lon:l,onClose:e,communities:c})})}function AppContent(){const[t,e]=reactExports.useState("live"),[r,l]=reactExports.useState("map"),[c,m]=reactExports.useState("public"),[y,_]=reactExports.useState(null),{user:w,login:k}=useNDK(),{communities:C}=useMyCommunities(),[R,T]=reactExports.useState(0),A=j=>{w?_(j):k()},M=()=>{_(null)},B=()=>{m(j=>{const re=j==="public"?"communities":"public";return re==="communities"&&C.length===0?(alert("You haven't joined any communities yet. Go to the Communities tab to find some!"),"public"):re})};return jsxRuntimeExports.jsxs("div",{className:"relative w-screen h-screen",children:[jsxRuntimeExports.jsx("div",{className:"absolute top-4 left-4 z-50 flex flex-col space-y-2 safe-area-padding-top",children:r==="map"&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(LoginButton,{}),jsxRuntimeExports.jsx(TimeFilter,{filter:t,onFilterChange:e}),jsxRuntimeExports.jsxs("button",{onClick:B,className:"p-2 bg-white rounded-md shadow-md hover:bg-gray-100 flex items-center space-x-2",children:[c==="public"?jsxRuntimeExports.jsx(Globe,{size:18}):jsxRuntimeExports.jsx(UsersRound,{size:18}),jsxRuntimeExports.jsx("span",{className:"text-sm",children:c==="public"?"Public":"My Communities"})]})]})}),jsxRuntimeExports.jsx("div",{className:"absolute top-4 right-4 z-50 safe-area-padding-top",children:jsxRuntimeExports.jsx("button",{onClick:()=>l(j=>j==="map"?"communities":"map"),className:"p-2 bg-white rounded-md shadow-md hover:bg-gray-100",children:r==="map"?jsxRuntimeExports.jsx(Users,{}):jsxRuntimeExports.jsx(Map$1,{})})}),r==="map"?jsxRuntimeExports.jsx(MapView,{timeFilter:t,mapFilter:c,onLaunchCreateEvent:A,communities:C,recenterRequest:R,onRequestRecenter:()=>T(j=>j+1)}):jsxRuntimeExports.jsx(CommunitiesView,{}),y&&jsxRuntimeExports.jsx(CreateEventModal,{isOpen:!!y,onClose:M,lat:y.lat,lon:y.lng,communities:C})]})}function App(){return jsxRuntimeExports.jsx(NostrProvider,{children:jsxRuntimeExports.jsx(AppContent,{})})}const markerIcon2x="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAABSCAMAAAAhFXfZAAAC91BMVEVMaXEzeak2f7I4g7g3g7cua5gzeKg8hJo3grY4g7c3grU0gLI2frE0daAubJc2gbQwd6QzeKk2gLMtd5sxdKIua5g1frA2f7IydaM0e6w2fq41fK01eqo3grgubJgta5cxdKI1f7AydaQydaMxc6EubJgvbJkwcZ4ubZkwcJwubZgubJcydqUydKIxapgubJctbJcubZcubJcvbJYubJcvbZkubJctbJctbZcubJg2f7AubJcrbZcubJcubJcua5g3grY0fq8ubJcubJdEkdEwhsw6i88vhswuhcsuhMtBjMgthMsrg8srgss6is8qgcs8i9A9iMYtg8spgcoogMo7hcMngMonf8olfso4gr8kfck5iM8jfMk4iM8he8k1fro7itAgesk2hs8eecgzfLcofssdeMg0hc4cd8g2hcsxeLQbdsgZdcgxeLImfcszhM0vda4xgckzhM4xg84wf8Yxgs4udKsvfcQucqhUndROmdM1fK0wcZ8vb5w0eqpQm9MzeKhXoNVcpdYydKNWn9VZotVKltJFjsIwcJ1Rms9OlslLmtH///8+kc9epdYzd6dbo9VHkMM2f7FHmNBClM8ydqVcpNY9hro3gLM9hLczealQmcw3fa46f7A8gLMxc6I3eagyc6FIldJMl9JSnNRSntNNl9JPnNJFi75UnM9ZodVKksg8kM45jc09e6ZHltFBk883gbRBh7pDk9EwcaBzn784g7dKkcY2i81Om9M7j85Llc81is09g7Q4grY/j9A0eqxKmdFFltBEjcXf6fFImdBCiLxJl9FGlNFBi78yiMxVndEvbpo6js74+vx+psPP3+o/ks5HkcpGmNCjwdZCkNDM3ehYoNJEls+lxNkxh8xHks0+jdC1zd5Lg6r+/v/H2ufz9/o3jM3t8/edvdM/k89Th61OiLBSjbZklbaTt9BfptdjmL1AicBHj8hGk9FAgK1dkLNTjLRekrdClc/k7fM0icy0y9tgp9c4jc2NtM9Dlc8zicxeXZn3AAAAQ3RSTlMAHDdTb4yPA+LtnEQmC4L2EmHqB7XA0d0sr478x4/Yd5i1zOfyPkf1sLVq4Nh3FvjxopQ2/STNuFzUwFIwxKaejILpIBEV9wAABhVJREFUeF6s1NdyFEcYBeBeoQIhRAkLlRDGrhIgY3BJL8CVeKzuyXFzzjkn5ZxzzuScg3PO8cKzu70JkO0LfxdTU//pM9vTu7Xgf6KqOVTb9X7toRrVEfBf1HTVjZccrT/2by1VV928Yty9ZbVuucdz90frG8DBjl9pVApbOstvmMuvVgaNXSfAAd6pGxpy6yxf5ph43pS/4f3uoaGm2rdu72S9xzOvMymkZFq/ptDrk90mhW7e4zl7HLzhxGWPR20xmSxJ/VqldG5m9XhaVOA1DadsNh3Pu5L2N6QtPO/32JpqQBVVk20oy/Pi2s23WEvyfHbe1thadVQttvm7Llf65gGmXK67XtupyoM7HQhmXdLS8oGWJNeOJ3C5fG5XCEJnkez3/oFdsvgJ4l2ANZwhrJKk/7OSXa+3Vw2WJMlKnGkobouYk6T0TyX30klOUnTD9HJ5qpckL3EW/w4XF3Xd0FGywXUrstrclVsqz5Pd/sXFYyDnPdrLcQODmGOK47IZb4CmibmMn+MYRzFZ5jg33ZL/EJrWcszHmANy3ARBK/IXtciJy8VsitPSdE3uuHxzougojcUdr8/32atnz/ev3f/K5wtpxUTpcaI45zusVDpYtZi+jg0oU9b3x74h7+n9ABvYEZeKaVq0sh0AtLKsFtqNBdeT0MrSzwwlq9+x6xAO4tgOtSzbCjrNQQiNvQUbUEubvzBUeGw26yDCsRHCoLkTHDa7IdOLIThs/gHvChszh2CimE8peRs47cxANI0lYNB5y1DljpOF0IhzBDPOZnDOqYYbeGKECbPzWnXludPphw5c2YBq5zlwXphIbO4VDCZ0gnPfUO1TwZoYwAs2ExPCedAu9DAjfQUjzITQb3jNj0KG2Sgt6BHaQUdYzWz+XmBktOHwanXjaSTcwwziBcuMOtwBmqPrTOxFQR/DRKKPqyur0aiW6cULYsx6tBm0jXpR/AUWR6HRq9WVW6MRhIq5jLyjbaCTDCijyYJNpCajdyobP/eTw0iexBAKkJ3gA5KcQb2zBXsIBckn+xVv8jkZSaEFHE+jFEleAEfayRU0MouNoBmB/L50Ai/HSLIHxcrpCvnhSQAuakKp2C/YbCylJjXRVy/z3+Kv/RrNcCo+WUzlVEhzKffnTQnxeN9fWF88fiNCUdSTsaufaChKWInHeysygfpIqagoakW+vV20J8uyl6TyNKEZWV4oRSPyCkWpgOLSbkCObT8o2r6tlG58HQquf6O0v50tB7JM7F4EORd2dx/K0w/KHsVkLPaoYrwgP/y7krr3SSMA4zj+OBgmjYkxcdIJQyQRKgg2viX9Hddi9UBb29LrKR7CVVEEEXWojUkXNyfTNDE14W9gbHJNuhjDettN3ZvbOvdOqCD3Jp/9l+/wJE+9PkYGjx/fqkys3S2rMozM/o2106rfMUINo6hVqz+eu/hd1c4xTg0TAfy5kV+4UG6+IthHTU9woWmxuKNbTfuCSfovBCxq7EtHqvYL4Sm6F8GVxsSXHMQ07TOi1DKtZxjWaaIyi4CXWjxPccUw8WVbMYY5wxC1mzEyXMJWkllpRloi+Kkoq69sxBTlElF6aAxYUbjXNlhlDZilDnM4U5SlN5biRsRHnbx3mbeWjEh4mEyiuJDl5XcWVmX5GvNkFgLWZM5qwsop4/AWfLhU1cR7k1VVvcYCWRkOI6Xy5gmnphCYIkvzuNYzHzosq2oNk2RtSs8khfUOfHIDgR6ysYBaMpl4uEgk2U/oJTs9AaTSwma7dT69geAE2ZpEjUsn2ieJNHeKfrI3EcAGJ2ZaNgVuC8EBctCLc57P5u5led6IOBkIYkuQMrmmjChs4VkfOerHqSBkPzZlhe06RslZ3zMjk2sscqKwY0RcjKK+LWbzd7KiHhkncs/siFJ+V5eXxD34B8nVuJEpGJNmxN2gH3vSvp7J70tF+D1Ej8qUJD1TkErAND2GZwTFg/LubvmgiBG3SOvdlsqFQrkEzJCL1rstlnVFROixZoDDSuXQFHESwVGlcuQcMb/b42NgjLowh5MTDFE3vNB5qStRIErdCQEh6pLPR92anSUb/wAIhldAaDMpGgAAAABJRU5ErkJggg==",markerIcon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAFgUlEQVR4Aa1XA5BjWRTN2oW17d3YaZtr2962HUzbDNpjszW24mRt28p47v7zq/bXZtrp/lWnXr337j3nPCe85NcypgSFdugCpW5YoDAMRaIMqRi6aKq5E3YqDQO3qAwjVWrD8Ncq/RBpykd8oZUb/kaJutow8r1aP9II0WmLKLIsJyv1w/kqw9Ch2MYdB++12Onxee/QMwvf4/Dk/Lfp/i4nxTXtOoQ4pW5Aj7wpici1A9erdAN2OH64x8OSP9j3Ft3b7aWkTg/Fm91siTra0f9on5sQr9INejH6CUUUpavjFNq1B+Oadhxmnfa8RfEmN8VNAsQhPqF55xHkMzz3jSmChWU6f7/XZKNH+9+hBLOHYozuKQPxyMPUKkrX/K0uWnfFaJGS1QPRtZsOPtr3NsW0uyh6NNCOkU3Yz+bXbT3I8G3xE5EXLXtCXbbqwCO9zPQYPRTZ5vIDXD7U+w7rFDEoUUf7ibHIR4y6bLVPXrz8JVZEql13trxwue/uDivd3fkWRbS6/IA2bID4uk0UpF1N8qLlbBlXs4Ee7HLTfV1j54APvODnSfOWBqtKVvjgLKzF5YdEk5ewRkGlK0i33Eofffc7HT56jD7/6U+qH3Cx7SBLNntH5YIPvODnyfIXZYRVDPqgHtLs5ABHD3YzLuespb7t79FY34DjMwrVrcTuwlT55YMPvOBnRrJ4VXTdNnYug5ucHLBjEpt30701A3Ts+HEa73u6dT3FNWwflY86eMHPk+Yu+i6pzUpRrW7SNDg5JHR4KapmM5Wv2E8Tfcb1HoqqHMHU+uWDD7zg54mz5/2BSnizi9T1Dg4QQXLToGNCkb6tb1NU+QAlGr1++eADrzhn/u8Q2YZhQVlZ5+CAOtqfbhmaUCS1ezNFVm2imDbPmPng5wmz+gwh+oHDce0eUtQ6OGDIyR0uUhUsoO3vfDmmgOezH0mZN59x7MBi++WDL1g/eEiU3avlidO671bkLfwbw5XV2P8Pzo0ydy4t2/0eu33xYSOMOD8hTf4CrBtGMSoXfPLchX+J0ruSePw3LZeK0juPJbYzrhkH0io7B3k164hiGvawhOKMLkrQLyVpZg8rHFW7E2uHOL888IBPlNZ1FPzstSJM694fWr6RwpvcJK60+0HCILTBzZLFNdtAzJaohze60T8qBzyh5ZuOg5e7uwQppofEmf2++DYvmySqGBuKaicF1blQjhuHdvCIMvp8whTTfZzI7RldpwtSzL+F1+wkdZ2TBOW2gIF88PBTzD/gpeREAMEbxnJcaJHNHrpzji0gQCS6hdkEeYt9DF/2qPcEC8RM28Hwmr3sdNyht00byAut2k3gufWNtgtOEOFGUwcXWNDbdNbpgBGxEvKkOQsxivJx33iow0Vw5S6SVTrpVq11ysA2Rp7gTfPfktc6zhtXBBC+adRLshf6sG2RfHPZ5EAc4sVZ83yCN00Fk/4kggu40ZTvIEm5g24qtU4KjBrx/BTTH8ifVASAG7gKrnWxJDcU7x8X6Ecczhm3o6YicvsLXWfh3Ch1W0k8x0nXF+0fFxgt4phz8QvypiwCCFKMqXCnqXExjq10beH+UUA7+nG6mdG/Pu0f3LgFcGrl2s0kNNjpmoJ9o4B29CMO8dMT4Q5ox8uitF6fqsrJOr8qnwNbRzv6hSnG5wP+64C7h9lp30hKNtKdWjtdkbuPA19nJ7Tz3zR/ibgARbhb4AlhavcBebmTHcFl2fvYEnW0ox9xMxKBS8btJ+KiEbq9zA4RthQXDhPa0T9TEe69gWupwc6uBUphquXgf+/FrIjweHQS4/pduMe5ERUMHUd9xv8ZR98CxkS4F2n3EUrUZ10EYNw7BWm9x1GiPssi3GgiGRDKWRYZfXlON+dfNbM+GgIwYdwAAAAASUVORK5CYII=",markerShadow="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACMUlEQVR4Ae3ShY7jQBAE0Aoz/f9/HTMzhg1zrdKUrJbdx+Kd2nD8VNudfsL/Th///dyQN2TH6f3y/BGpC379rV+S+qqetBOxImNQXL8JCAr2V4iMQXHGNJxeCfZXhSRBcQMfvkOWUdtfzlLgAENmZDcmo2TVmt8OSM2eXxBp3DjHSMFutqS7SbmemzBiR+xpKCNUIRkdkkYxhAkyGoBvyQFEJEefwSmmvBfJuJ6aKqKWnAkvGZOaZXTUgFqYULWNSHUckZuR1HIIimUExutRxwzOLROIG4vKmCKQt364mIlhSyzAf1m9lHZHJZrlAOMMztRRiKimp/rpdJDc9Awry5xTZCte7FHtuS8wJgeYGrex28xNTd086Dik7vUMscQOa8y4DoGtCCSkAKlNwpgNtphjrC6MIHUkR6YWxxs6Sc5xqn222mmCRFzIt8lEdKx+ikCtg91qS2WpwVfBelJCiQJwvzixfI9cxZQWgiSJelKnwBElKYtDOb2MFbhmUigbReQBV0Cg4+qMXSxXSyGUn4UbF8l+7qdSGnTC0XLCmahIgUHLhLOhpVCtw4CzYXvLQWQbJNmxoCsOKAxSgBJno75avolkRw8iIAFcsdc02e9iyCd8tHwmeSSoKTowIgvscSGZUOA7PuCN5b2BX9mQM7S0wYhMNU74zgsPBj3HU7wguAfnxxjFQGBE6pwN+GjME9zHY7zGp8wVxMShYX9NXvEWD3HbwJf4giO4CFIQxXScH1/TM+04kkBiAAAAAElFTkSuQmCC";delete L$1.Icon.Default.prototype._getIconUrl;L$1.Icon.Default.mergeOptions({iconRetinaUrl:markerIcon2x,iconUrl:markerIcon,shadowUrl:markerShadow});ReactDOM.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(React.StrictMode,{children:jsxRuntimeExports.jsx(App,{})}));export{WebPlugin as W};
